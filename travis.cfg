[buildout]
extends =
    https://raw.githubusercontent.com/collective/buildout.plonetest/master/test-5.0.x.cfg
    versions.cfg
parts =
    instance
    zopepy
    test

index = https://pypi.org/simple

allow-hosts =
    pypi.org
    files.pythonhosted.org
    *.wildcardcorp.com

package-name = castle.cms
package-extras = [test]

develop = .

eggs +=
    castle.cms[test]
    celery[sqlalchemy]
    collective.celery
    argon2_cffi
    Pillow
    Products.PloneKeywordManager
    plone.app.robotframework

versions = versions

[test-environment]
CELERY_TASK_ALWAYS_EAGER = True

[test]
environment = test-environment

[instance]
eggs += plone.reload
environment-vars =
    BROKER_URL sqla+sqlite:///${buildout:directory}/celerydb.sqlite?timeout=30
    CELERY_TASK_ALWAYS_EAGER True
    REDIS_SERVER 127.0.0.1:6379

[zopepy]
recipe = zc.recipe.egg
eggs =
    ${buildout:eggs}
    ${test:eggs}
    castle.cms
    Plone
    Products.CMFPlone
interpreter = zopepy
scripts =
    zopepy
    plone-compile-resources
