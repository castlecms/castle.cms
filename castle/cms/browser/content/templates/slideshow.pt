<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en-US" lang="en-US"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
  <head>
    <link rel="stylesheet" href="${context/portal_url}/++plone++castle/libs/revealjs/styles/reset.css" />
    <link rel="stylesheet" href="${context/portal_url}/++plone++castle/libs/revealjs/styles/reveal.css" />
    <link rel="stylesheet" href="${context/portal_url}/++plone++castle/libs/revealjs/styles/theme/black.css" />
    <link rel="stylesheet" href="${context/portal_url}/++plone++castle/libs/revealjs/styles/custom.css" />
    <!-- Flexbox Grid -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css"
      type="text/css"
    />
    <script src="${context/portal_url}/++plone++castle/libs/revealjs/reveal.js"/>
  </head>
  <body>
    <div class="reveal">
      <tal:defs tal:define="slides view/get_slides|nothing">
        <div class="slides" id="${view/get_id|nothing}" tal:condition="nocall: slides">
          <tal:item tal:repeat="slide slides">
            <tal:wrap tal:define="video python: slide['video'] or None;
                                  image python: slide['image'] or None;
                                  vert python: slide['vert'];
                                  hor python: slide['hor'];
                                  title python: slide['title'];
                                  textlines python: slide['text'].split('\n');">

              <!-- Full Background Video Slide -->
              <tal:container tal:condition="python: slide['displayType'] == 'background-video'">
                <section
                  class="background-video-slide"
                  data-background-video="${video}"
                  data-background-color="#000000"
                  data-background-video-loop
                  data-background-video-muted
                  data-transition="fade">
                  <div class="row ${vert}-xs ${hor}-xs">
                    <div class="col-xs-12 background-video-container">
                      <div class="box-row">
                        <h2 class="slide-title">${python: slide['title'] or None}</h2>
                        <p tal:condition="textlines" class="slide-text">
                          <tal:textline tal:repeat="textline textlines">
                            ${textline}
                            <br tal:condition="not:repeat/textline/end"/>
                          </tal:textline>
                        </p>
                      </div>
                    </div>
                  </div>
                </section>
              </tal:container>

              <!-- Left Video w/ Right Text Slide-->
              <tal:container tal:condition="python: slide['displayType'] == 'left-video-right-text'">
                <section class="left-video-slide">
                  <div class="row ${vert}-xs">
                    <div class="col-xs-6 video-container">
                      <video data-autoplay muted loop>
                        <source src="${video}"/>
                      </video>
                    </div>
                    <div class="col-xs-6 text-container">
                      <div class="text-section ${hor}">
                        <h2 class="slide-title">${python: slide['title'] or None}</h2>
                        <p tal:condition="textlines" class="slide-text">
                          <tal:textline tal:repeat="textline textlines">
                            ${textline}
                            <br tal:condition="not:repeat/textline/end"/>
                          </tal:textline>
                        </p>
                      </div>
                    </div>
                  </div>
                </section>
              </tal:container>

              <!-- Full Background Image Slide -->
                <tal:container tal:condition="python: slide['displayType'] == 'background-image'">
                  <section
                    tal:condition="image"
                    class="background-image-slide"
                    data-background="${image}"
                    data-transition="fade">
                    <div class="row ${vert}-xs ${hor}-lg">
                      <div class="col-xs-12 background-image-container">
                        <div class="box-row">
                          <h2 class="slide-title">${python: slide['title'] or None}</h2>
                          <p tal:condition="textlines" class="slide-text">
                            <tal:textline tal:repeat="textline textlines">
                              ${textline}
                              <br tal:condition="not:repeat/textline/end"/>
                            </tal:textline>
                          </p>
                        </div>
                      </div>
                    </div>
                  <div tal:condition="not: image">
                    Image slide with no image selected.
                  </div>
                </section>
              </tal:container>

              <!-- Left Image w/ Right Text Slide -->
              <tal:container tal:condition="python: slide['displayType'] == 'left-image-right-text'">
                <section class="left-image-slide">
                  <div class="row ${vert}-xs">
                    <div
                      class="col-xs-6 image-container"
                      style="height:100%; background: url('${image}'); background-size:cover; background-position: center;"></div>
                    <div class="col-xs-6 text-container">
                      <div class="text-section ${hor}">
                        <h2 class="slide-title">${python: slide['title'] or None}</h2>
                        <p tal:condition="textlines" class="slide-text">
                          <tal:textline tal:repeat="textline textlines">
                            ${textline}
                            <br tal:condition="not:repeat/textline/end"/>
                          </tal:textline>
                        </p>
                      </div>
                    </div>
                  </div>
                </section>
              </tal:container>
            </tal:wrap>
          </tal:item>
        </div>
      </tal:defs>
    </div>
    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependenciess

      /* @param {HTMLElement} slide
      function syncSlide( slide ) {
      Reveal.syncSlide({ })
      Reveal.configure({ backgroundTransition: "zoom" });
      */

      Reveal.initialize({
        // Slide Dimensions
        width: "100%",
        height: "100%",
        margin: 0,
        minScale: 1,
        maxScale: 1,

        transitionSpeed: "default", // default/fast/slow

        transition: "fade", // none/fade/slide/convex/concave/zoom

        dependencies: [
          { src: "${context/portal_url}/++plone++castle/libs/revealjs/plugin/markdown/marked.js" },
          { src: "${context/portal_url}/++plone++castle/libs/revealjs/plugin/markdown/markdown.js" },
          { src: "${context/portal_url}/++plone++castle/libs/revealjs/plugin/notes/notes.js", async: true },
          { src: "${context/portal_url}/++plone++castle/libs/revealjs/plugin/highlight/highlight.js", async: true }
        ]
      });
    </script>
  </body>
</html>
