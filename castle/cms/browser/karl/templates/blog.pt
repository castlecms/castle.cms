

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/prefs_main_template/macros/master"
      i18n:domain="plone">
<head>
  <script>
    function posted_by(people) {
      let lst = people[0].toString()
      if (people.length > 1) {
        for(i=1; i<people.length; i++) {
          lst += "," + people[i].toString();
        }
      }
      return lst
    }
  </script>
</head>
<body>
<metal:main metal:fill-slot="prefs_configlet_main" i18n:domain="plone">
  <div id="content-core"
       tal:define="info view/info;
                   communityId info/communityId;
                   title info/title;
                   files info/files;
                   archive info/archive;
                   roles info/roles;"
       >
    <h2>${title}</h2>
      
    <h3 tal:condition="python: len(files) == 0">Blog</h3>
    <input tal:condition="python: len(files) != 0" type="text" placeholder="Search.."></input>
    <br />
    <div tal:condition="python: len(files) != 0" class="row">
      <div class="col-sm-7">
        <h3>Blog</h3>
        <table class="table table-bordered" id="blog">
          <tbody>
            <tal:item tal:repeat="item files">
              <tr style="display: none">
                <td style="padding: 0 1em">
                    <h3 tal:define="title python: item.title.title();">
                      <a href="${item/absolute_url}">
                        ${title}
                      </a>
                    </h3>
                    <h4 tal:define="date python: str(item.modification_date).split(' ')[0];">${date}</h4>
                    <p tal:define="end python: 150 if len(item.text) &gt; 150 else len(item.text)">${python: item.text[0:end]}...</p>
                    <h4>Posted By ${python: item.creators[0]}<span tal:repeat="creator python: item.creators[1:]">, ${creator}</span></h4>
                </td>
              </tr>
            </tal:item>
          </tbody>
        </table>
        <div class="text-center" style="padding: 2em">
          <button id="show-more">Show More</button>
        </div>
        <script>
          let show = 0
          const btn = document.getElementById("show-more");
          btn.addEventListener("click", function(event) {
            showMore(10)
          });
          function showMore(x) {
            for(i=0; i<x; i++){
              const table = document.getElementById("blog");
              table.rows[show].style.display = null;
              show++;
              if (table.rows.length == show) {
                document.getElementById("show-more").disabled = true;
                break;
              }
            }
          }
          showMore(11)
        </script>
      </div>
      <div class="col-sm-1"><p></p><!--gutter column--></div>
      <div class="col-sm-4">
        <h3>Archive</h3>
        <table class="table table-bordered">
          <tbody>
            <tr tal:repeat="date archive">
              <td tal:define="month python: date.split(' ')[0];
                              year python: date.split(' ')[1]">
                <a href="${context/absolute_url}/@@blog?groupname=${communityId}&date=${month}-${year}">
                ${date}
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div tal:condition="python: len(files) == 0" class="col-sm-12">This community does not currently have a blog</div>
  </div>
</metal:main>

</body>
</html>