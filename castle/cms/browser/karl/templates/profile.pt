

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/prefs_main_template/macros/master"
      i18n:domain="plone">
<body>
<metal:main metal:fill-slot="prefs_configlet_main" i18n:domain="plone">
  <div id="content-core"
       tal:define="info view/info;
                   user info/user;
                   files info/files;
                   recentsPage info/recentsPage;
                   roles info/roles;"
       onload="setView(roles)">
    <h1 class="documentFirstHeading" i18n:translate="">${python: user.getProperty("fullname")}</h1>

    <br />
    <br />
    <div class="row">
      <div class="left-col">
        <h3 class="col-sm-8">Recent Activity</h3>
        <div class="col-sm-4 text-right">
          <h3 tal:content="None">spacer</h3>
          <div tal:condition="python: len(files) != 0 and files is not None">
            <tal:showing tal:condition="python: 20*recentsPage &lt;= len(files)" tal:on-error="None">
              showing ${python: (20*(recentsPage-1))+1}-${python: 20*recentsPage} of ${python: len(files)}
            </tal:showing>
            <tal:showing tal:condition="python: 20*recentsPage &gt; len(files)" tal:on-error="None">
              showing ${python: (20*(recentsPage-1))+1}-${python: len(files)} of ${python: len(files)}
            </tal:showing>
          </div>
        </div>
        <table class="table table-bordered">
          <tbody>
            <tal:head>
              <th>Date</th>
              <th>Title</th>
              <th>Type</th>
              <th>Modified By</th>
            </tal:head>
            <tr tal:condition="python: len(files) == 0" colspan="all">
              <td>You have not contributed any files yet</td>
            </tr>
            <tal:item tal:condition="python: files is not None and len(files) != 0"
                      tal:define="end python: 20*recentsPage if (len(files)/20)+1 != recentsPage else len(files)"
                      tal:repeat="item python: files[20*(recentsPage-1):end]">
              <tr tal:define="id python: item.id">
                <td tal:define="date python: str(item.modification_date).split(' ')[0]">
                  ${date}
                </td>
                <td style="max-width: 400px;
                          overflow: hidden;
                          text-overflow: ellipsis;
                          white-space: nowrap;">
                  <a tal:condition="python: item.portal_type == 'File' or item.portal_type == 'Document'"
                    tal:define="filename python: item.title.split('.')[0].replace('-', ' ').title();" 
                    href="${item/absolute_url}/@@download/file/${id}">
                    ${filename}
                  </a>
                  <a tal:condition="python: item.portal_type == 'Folder'"
                    tal:define="title python: item.title.title()"
                    href="${item/absolute_url}">
                    ${title}
                  </a>
                  <a tal:condition="python: item.portal_type == 'News Item'" 
                    tal:define="title python: item.title.title()"
                    href="${item/absolute_url}">
                    ${title}
                  </a>
                </td>
                <td>
                  <span tal:condition="python: item.portal_type == 'File' or item.portal_type == 'Document'" >
                    File
                  </span>
                  <span tal:condition="python: item.portal_type == 'Folder'" >
                    Folder
                  </span>
                  <span tal:condition="python: item.portal_type == 'News Item'" >
                    Blog Entry
                  </span>
                </td>
                <td>
                  <tal:creator tal:repeat="creator item/creators">
                    <a href="">
                      ${creator}
                    </a>
                  </tal:creator>
                </td>
              </tr>
            </tal:item>
          </tbody>
        </table>
        <div class="text-center"
          style="padding-bottom: 1em">
          <a tal:define="previous python: recentsPage - 1" href="${context/absolute_url}/@@user-profile?recentPage=${previous}" 
            style="color: white; 
                    background-color: #36619B;
                    border-radius: 50%;
                    padding:  1%;"
            class="glyphicon glyphicon-chevron-left"></a>
          <span tal:define="pageCount python: len(files)/20 if len(files)%20 == 0 else len(files)/20+1"
                style="padding: 2%">
            Page ${recentsPage} of ${pageCount}
          </span>
          <a tal:define="next python: recentsPage + 1"
            style="color: white; 
                    background-color: #36619B;
                    border-radius: 50%;
                    padding: 1%;"
            href="${context/absolute_url}/@@user-profile?recentPage=${next}" class="glyphicon glyphicon-chevron-right"></a>
        </div>
      </div>
      <div class="mid-col"><p></p><!--gutter column--></div>
      <div class="right-col">
        <h3 class="text-center">Profile</h3>
        <div class="row">
          <div tal:define="fullname python: '{} {}'.format(user.firstname[0], user.lastname[0]);
                           position python: str(user.position[0]);
                           organization python: str(user.organization[0]);
                           industry python: str(user.industry[0]);"
              class="col-sm-12">
            <h4>Name: ${fullname}</h4>
            <h4>Position: ${position}</h4>
            <h4>Organization: ${organization}</h4>
            <h4>Industry: ${industry}</h4>
          </div>
        </div>
        <div class="row text-center">
          <a href="">Edit Profile</a>
        </div>
      </div>
      <div tal:content="None" class="col-sm-1">gutter column</div>
      <div tal:content="None" class="col-sm-4" style="height: 2em">spacer</div>
      <div tal:content="None" class="col-sm-1">gutter column</div>
    </div>
  </div>
</metal:main>
<script>
  $( document ).ready(function() {
    admin = document.querySelector('#groupContent').dataset.admin;
    if (!admin.includes('True')) {
      $.each($(".right-col"), (index, item) => {
        item.classList.add("col-sm-4")
      });
      $.each($(".mid-col"), (index, item) => {
        item.classList.add("col-sm-1")
      });
      $.each($(".left-col"), (index, item) => {
        item.classList.add("col-sm-7")
      });
    }
    else {
      $.each($(".right-col"), (index, item) => {
          item.classList.add("col-sm-12")
      });


      $.each($(".right-col"), (index, item) => {
        item.classList.add("col-sm-12")
      });
      $.each($(".mid-col"), (index, item) => {
        item.classList.add("row")
      });
      $.each($(".left-col"), (index, item) => {
        item.classList.add("col-sm-12")
      });
    }
  });
</script>
</body>
</html>
