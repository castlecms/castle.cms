function createElement(a,b){var c=document.createElement(a);if(b.className&&(c.classList?c.classList.add(b.className):c.className+=" "+b.className),b.text&&(c.textContent=b.text),b.children)for(var d=0;d<b.children.length;d++)c.appendChild(b.children[d]);return c}define("mockup-patterns-inlinevalidation",["jquery","pat-base"],function(a,b){"use strict";return b.extend({name:"inlinevalidation",trigger:".pat-inlinevalidation",parser:"mockup",render_error:function(b,c){var d=a("div.fieldErrorBox",b);""!==c?(b.addClass("error"),d.html(c)):(b.removeClass("error"),d.html(""))},append_url_path:function(a,b){var c,d,e=a.split(/\?/);for(d=e[0],"/"!==d[d.length-1]&&(d+="/"),d+=b,c=1;c<e.length;c+=1)d+="?"+e[c];return d},validate_archetypes_field:function(b){var c=a(b),d=c.closest(".field"),e=d.attr("data-uid"),f=d.attr("data-fieldname"),g=c.val();c.prop("multiple")&&null===g&&(g=a([]).serialize());var h,i=a.param({uid:e,fname:f,value:g},h=!0);d&&e&&f&&a.post(a("base").attr("href")+"/at_validate_field",i,function(a){this.render_error(d,a.errmsg)})},validate_formlib_field:function(b){var c=a(b),d=c.closest(".field"),e=d.closest("form"),f=d.attr("data-fieldname");e.ajaxSubmit({url:this.append_url_path(e.attr("action"),"@@formlib_validate_field"),data:{fname:f},iframe:!1,success:a.proxy(function(a){this.render_error(d,a.errmsg)},this),dataType:"json"})},validate_z3cform_field:function(b){var c=a(b),d=c.closest(".field"),e=d.closest("form"),f=c.closest("fieldset").attr("data-fieldset"),g=d.attr("data-fieldname");g&&e.ajaxSubmit({url:this.append_url_path(e.attr("action"),"@@z3cform_validate_field"),data:{fname:g,fset:f},iframe:!1,success:a.proxy(function(a){this.render_error(d,a.errmsg)},this),dataType:"json"})},init:function(){this.$el.find('input[type="text"], input[type="password"], input[type="checkbox"], select, textarea').on("blur",a.proxy(function(a){"archetypes"===this.options.type?this.validate_archetypes_field(a.target):"z3c.form"===this.options.type?this.validate_z3cform_field(a.target):"formlib"===this.options.type&&this.validate_formlib_field(a.target)},this))}})}),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("castle-url/libs/react/react.min",[],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.React=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=a(19),e=a(32),f=a(34),g=a(33),h=a(38),i=a(39),j=a(55),k=(a(56),a(40)),l=a(51),m=a(54),n=a(64),o=a(68),p=a(73),q=a(76),r=a(79),s=a(82),t=a(27),u=a(115),v=a(142);m.inject();var w=j.createElement,x=j.createFactory,y=j.cloneElement,z=p.measure("React","render",o.render),A={Children:{map:e.map,forEach:e.forEach,count:e.count,only:v},Component:f,DOM:k,PropTypes:q,initializeTouchEvents:function(a){d.useTouchEvents=a},createClass:g.createClass,createElement:w,cloneElement:y,createFactory:x,createMixin:function(a){return a},constructAndRenderComponent:o.constructAndRenderComponent,constructAndRenderComponentByID:o.constructAndRenderComponentByID,findDOMNode:u,render:z,renderToString:s.renderToString,renderToStaticMarkup:s.renderToStaticMarkup,unmountComponentAtNode:o.unmountComponentAtNode,isValidElement:j.isValidElement,withContext:h.withContext,__spread:t};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:i,InstanceHandles:n,Mount:o,Reconciler:r,TextComponent:l}),A.version="0.13.3",b.exports=A},{115:115,142:142,19:19,27:27,32:32,33:33,34:34,38:38,39:39,40:40,51:51,54:54,55:55,56:56,64:64,68:68,73:73,76:76,79:79,82:82}],2:[function(a,b,c){"use strict";var d=a(117),e={componentDidMount:function(){this.props.autoFocus&&d(this.getDOMNode())}};b.exports=e},{117:117}],3:[function(a,b,c){"use strict";function d(a){return(a.ctrlKey||a.altKey||a.metaKey)&&!(a.ctrlKey&&a.altKey)}function e(a){switch(a){case B.topCompositionStart:return C.compositionStart;case B.topCompositionEnd:return C.compositionEnd;case B.topCompositionUpdate:return C.compositionUpdate}}function f(a,b){return a===B.topKeyDown&&b.keyCode===u}function g(a,b){switch(a){case B.topKeyUp:return-1!==t.indexOf(b.keyCode);case B.topKeyDown:return b.keyCode!==u;case B.topKeyPress:case B.topMouseDown:case B.topBlur:return!0;default:return!1}}function h(a){var b=a.detail;return"object"==typeof b&&"data"in b?b.data:null}function i(a,b,c,d){var i,j;if(v?i=e(a):E?g(a,d)&&(i=C.compositionEnd):f(a,d)&&(i=C.compositionStart),!i)return null;y&&(E||i!==C.compositionStart?i===C.compositionEnd&&E&&(j=E.getData()):E=p.getPooled(b));var k=q.getPooled(i,c,d);if(j)k.data=j;else{var l=h(d);null!==l&&(k.data=l)}return n.accumulateTwoPhaseDispatches(k),k}function j(a,b){switch(a){case B.topCompositionEnd:return h(b);case B.topKeyPress:return b.which!==z?null:(D=!0,A);case B.topTextInput:var c=b.data;return c===A&&D?null:c;default:return null}}function k(a,b){if(E){if(a===B.topCompositionEnd||g(a,b)){var c=E.getData();return p.release(E),E=null,c}return null}switch(a){case B.topPaste:return null;case B.topKeyPress:return b.which&&!d(b)?String.fromCharCode(b.which):null;case B.topCompositionEnd:return y?null:b.data;default:return null}}function l(a,b,c,d){var e;if(!(e=x?j(a,d):k(a,d)))return null;var f=r.getPooled(C.beforeInput,c,d);return f.data=e,n.accumulateTwoPhaseDispatches(f),f}var m=a(15),n=a(20),o=a(21),p=a(22),q=a(91),r=a(95),s=a(139),t=[9,13,27,32],u=229,v=o.canUseDOM&&"CompositionEvent"in window,w=null;o.canUseDOM&&"documentMode"in document&&(w=document.documentMode);var x=o.canUseDOM&&"TextEvent"in window&&!w&&!function(){var a=window.opera;return"object"==typeof a&&"function"==typeof a.version&&parseInt(a.version(),10)<=12}(),y=o.canUseDOM&&(!v||w&&w>8&&11>=w),z=32,A=String.fromCharCode(z),B=m.topLevelTypes,C={beforeInput:{phasedRegistrationNames:{bubbled:s({onBeforeInput:null}),captured:s({onBeforeInputCapture:null})},dependencies:[B.topCompositionEnd,B.topKeyPress,B.topTextInput,B.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:s({onCompositionEnd:null}),captured:s({onCompositionEndCapture:null})},dependencies:[B.topBlur,B.topCompositionEnd,B.topKeyDown,B.topKeyPress,B.topKeyUp,B.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:s({onCompositionStart:null}),captured:s({onCompositionStartCapture:null})},dependencies:[B.topBlur,B.topCompositionStart,B.topKeyDown,B.topKeyPress,B.topKeyUp,B.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:s({onCompositionUpdate:null}),captured:s({onCompositionUpdateCapture:null})},dependencies:[B.topBlur,B.topCompositionUpdate,B.topKeyDown,B.topKeyPress,B.topKeyUp,B.topMouseDown]}},D=!1,E=null,F={eventTypes:C,extractEvents:function(a,b,c,d){return[i(a,b,c,d),l(a,b,c,d)]}};b.exports=F},{139:139,15:15,20:20,21:21,22:22,91:91,95:95}],4:[function(a,b,c){"use strict";function d(a,b){return a+b.charAt(0).toUpperCase()+b.substring(1)}var e={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},f=["Webkit","ms","Moz","O"];Object.keys(e).forEach(function(a){f.forEach(function(b){e[d(b,a)]=e[a]})});var g={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},h={isUnitlessNumber:e,shorthandPropertyExpansions:g};b.exports=h},{}],5:[function(a,b,c){"use strict";var d=a(4),e=a(21),f=(a(106),a(111)),g=a(131),h=a(141),i=(a(150),h(function(a){return g(a)})),j="cssFloat";e.canUseDOM&&void 0===document.documentElement.style.cssFloat&&(j="styleFloat");var k={createMarkupForStyles:function(a){var b="";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];null!=d&&(b+=i(c)+":",b+=f(c,d)+";")}return b||null},setValueForStyles:function(a,b){var c=a.style;for(var e in b)if(b.hasOwnProperty(e)){var g=f(e,b[e]);if("float"===e&&(e=j),g)c[e]=g;else{var h=d.shorthandPropertyExpansions[e];if(h)for(var i in h)c[i]="";else c[e]=""}}}};b.exports=k},{106:106,111:111,131:131,141:141,150:150,21:21,4:4}],6:[function(a,b,c){"use strict";function d(){this._callbacks=null,this._contexts=null}var e=a(28),f=a(27),g=a(133);f(d.prototype,{enqueue:function(a,b){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(a),this._contexts.push(b)},notifyAll:function(){var a=this._callbacks,b=this._contexts;if(a){g(a.length===b.length),this._callbacks=null,this._contexts=null;for(var c=0,d=a.length;d>c;c++)a[c].call(b[c]);a.length=0,b.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),e.addPoolingTo(d),b.exports=d},{133:133,27:27,28:28}],7:[function(a,b,c){"use strict";function d(a){return"SELECT"===a.nodeName||"INPUT"===a.nodeName&&"file"===a.type}function e(a){var b=x.getPooled(C.change,E,a);u.accumulateTwoPhaseDispatches(b),w.batchedUpdates(f,b)}function f(a){t.enqueueEvents(a),t.processEventQueue()}function g(a,b){D=a,E=b,D.attachEvent("onchange",e)}function h(){D&&(D.detachEvent("onchange",e),D=null,E=null)}function i(a,b,c){return a===B.topChange?c:void 0}function j(a,b,c){a===B.topFocus?(h(),g(b,c)):a===B.topBlur&&h()}function k(a,b){D=a,E=b,F=a.value,G=Object.getOwnPropertyDescriptor(a.constructor.prototype,"value"),Object.defineProperty(D,"value",J),D.attachEvent("onpropertychange",m)}function l(){D&&(delete D.value,D.detachEvent("onpropertychange",m),D=null,E=null,F=null,G=null)}function m(a){if("value"===a.propertyName){var b=a.srcElement.value;b!==F&&(F=b,e(a))}}function n(a,b,c){return a===B.topInput?c:void 0}function o(a,b,c){a===B.topFocus?(l(),k(b,c)):a===B.topBlur&&l()}function p(a,b,c){return a!==B.topSelectionChange&&a!==B.topKeyUp&&a!==B.topKeyDown||!D||D.value===F?void 0:(F=D.value,E)}function q(a){return"INPUT"===a.nodeName&&("checkbox"===a.type||"radio"===a.type)}function r(a,b,c){return a===B.topClick?c:void 0}var s=a(15),t=a(17),u=a(20),v=a(21),w=a(85),x=a(93),y=a(134),z=a(136),A=a(139),B=s.topLevelTypes,C={change:{phasedRegistrationNames:{bubbled:A({onChange:null}),captured:A({onChangeCapture:null})},dependencies:[B.topBlur,B.topChange,B.topClick,B.topFocus,B.topInput,B.topKeyDown,B.topKeyUp,B.topSelectionChange]}},D=null,E=null,F=null,G=null,H=!1;v.canUseDOM&&(H=y("change")&&(!("documentMode"in document)||document.documentMode>8));var I=!1;v.canUseDOM&&(I=y("input")&&(!("documentMode"in document)||document.documentMode>9));var J={get:function(){return G.get.call(this)},set:function(a){F=""+a,G.set.call(this,a)}},K={eventTypes:C,extractEvents:function(a,b,c,e){var f,g;if(d(b)?H?f=i:g=j:z(b)?I?f=n:(f=p,g=o):q(b)&&(f=r),f){var h=f(a,b,c);if(h){var k=x.getPooled(C.change,h,e);return u.accumulateTwoPhaseDispatches(k),k}}g&&g(a,b,c)}};b.exports=K},{134:134,136:136,139:139,15:15,17:17,20:20,21:21,85:85,93:93}],8:[function(a,b,c){"use strict";var d=0,e={createReactRootIndex:function(){return d++}};b.exports=e},{}],9:[function(a,b,c){"use strict";function d(a,b,c){a.insertBefore(b,a.childNodes[c]||null)}var e=a(12),f=a(70),g=a(145),h=a(133),i={dangerouslyReplaceNodeWithMarkup:e.dangerouslyReplaceNodeWithMarkup,updateTextContent:g,processUpdates:function(a,b){for(var c,i=null,j=null,k=0;k<a.length;k++)if(c=a[k],c.type===f.MOVE_EXISTING||c.type===f.REMOVE_NODE){var l=c.fromIndex,m=c.parentNode.childNodes[l],n=c.parentID;h(m),i=i||{},i[n]=i[n]||[],i[n][l]=m,j=j||[],j.push(m)}var o=e.dangerouslyRenderMarkup(b);if(j)for(var p=0;p<j.length;p++)j[p].parentNode.removeChild(j[p]);for(var q=0;q<a.length;q++)switch(c=a[q],c.type){case f.INSERT_MARKUP:d(c.parentNode,o[c.markupIndex],c.toIndex);break;case f.MOVE_EXISTING:d(c.parentNode,i[c.parentID][c.fromIndex],c.toIndex);break;case f.TEXT_CONTENT:g(c.parentNode,c.textContent);break;case f.REMOVE_NODE:}}};b.exports=i},{12:12,133:133,145:145,70:70}],10:[function(a,b,c){"use strict";function d(a,b){return(a&b)===b}var e=a(133),f={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(a){var b=a.Properties||{},c=a.DOMAttributeNames||{},g=a.DOMPropertyNames||{},i=a.DOMMutationMethods||{};a.isCustomAttribute&&h._isCustomAttributeFunctions.push(a.isCustomAttribute);for(var j in b){e(!h.isStandardName.hasOwnProperty(j)),h.isStandardName[j]=!0;var k=j.toLowerCase();if(h.getPossibleStandardName[k]=j,c.hasOwnProperty(j)){var l=c[j];h.getPossibleStandardName[l]=j,h.getAttributeName[j]=l}else h.getAttributeName[j]=k;h.getPropertyName[j]=g.hasOwnProperty(j)?g[j]:j,i.hasOwnProperty(j)?h.getMutationMethod[j]=i[j]:h.getMutationMethod[j]=null;var m=b[j];h.mustUseAttribute[j]=d(m,f.MUST_USE_ATTRIBUTE),h.mustUseProperty[j]=d(m,f.MUST_USE_PROPERTY),h.hasSideEffects[j]=d(m,f.HAS_SIDE_EFFECTS),h.hasBooleanValue[j]=d(m,f.HAS_BOOLEAN_VALUE),h.hasNumericValue[j]=d(m,f.HAS_NUMERIC_VALUE),h.hasPositiveNumericValue[j]=d(m,f.HAS_POSITIVE_NUMERIC_VALUE),h.hasOverloadedBooleanValue[j]=d(m,f.HAS_OVERLOADED_BOOLEAN_VALUE),e(!h.mustUseAttribute[j]||!h.mustUseProperty[j]),e(h.mustUseProperty[j]||!h.hasSideEffects[j]),e(!!h.hasBooleanValue[j]+!!h.hasNumericValue[j]+!!h.hasOverloadedBooleanValue[j]<=1)}}},g={},h={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(a){for(var b=0;b<h._isCustomAttributeFunctions.length;b++){if((0,h._isCustomAttributeFunctions[b])(a))return!0}return!1},getDefaultValueForProperty:function(a,b){var c,d=g[a];return d||(g[a]=d={}),b in d||(c=document.createElement(a),d[b]=c[b]),d[b]},injection:f};b.exports=h},{133:133}],11:[function(a,b,c){"use strict";function d(a,b){return null==b||e.hasBooleanValue[a]&&!b||e.hasNumericValue[a]&&isNaN(b)||e.hasPositiveNumericValue[a]&&1>b||e.hasOverloadedBooleanValue[a]&&!1===b}var e=a(10),f=a(143),g=(a(150),{createMarkupForID:function(a){return e.ID_ATTRIBUTE_NAME+"="+f(a)},createMarkupForProperty:function(a,b){if(e.isStandardName.hasOwnProperty(a)&&e.isStandardName[a]){if(d(a,b))return"";var c=e.getAttributeName[a];return e.hasBooleanValue[a]||e.hasOverloadedBooleanValue[a]&&!0===b?c:c+"="+f(b)}return e.isCustomAttribute(a)?null==b?"":a+"="+f(b):null},setValueForProperty:function(a,b,c){if(e.isStandardName.hasOwnProperty(b)&&e.isStandardName[b]){var f=e.getMutationMethod[b];if(f)f(a,c);else if(d(b,c))this.deleteValueForProperty(a,b);else if(e.mustUseAttribute[b])a.setAttribute(e.getAttributeName[b],""+c);else{var g=e.getPropertyName[b];e.hasSideEffects[b]&&""+a[g]==""+c||(a[g]=c)}}else e.isCustomAttribute(b)&&(null==c?a.removeAttribute(b):a.setAttribute(b,""+c))},deleteValueForProperty:function(a,b){if(e.isStandardName.hasOwnProperty(b)&&e.isStandardName[b]){var c=e.getMutationMethod[b];if(c)c(a,void 0);else if(e.mustUseAttribute[b])a.removeAttribute(e.getAttributeName[b]);else{var d=e.getPropertyName[b],f=e.getDefaultValueForProperty(a.nodeName,d);e.hasSideEffects[b]&&""+a[d]===f||(a[d]=f)}}else e.isCustomAttribute(b)&&a.removeAttribute(b)}});b.exports=g},{10:10,143:143,150:150}],12:[function(a,b,c){"use strict";function d(a){return a.substring(1,a.indexOf(" "))}var e=a(21),f=a(110),g=a(112),h=a(125),i=a(133),j=/^(<[^ \/>]+)/,k="data-danger-index",l={dangerouslyRenderMarkup:function(a){i(e.canUseDOM);for(var b,c={},l=0;l<a.length;l++)i(a[l]),b=d(a[l]),b=h(b)?b:"*",c[b]=c[b]||[],c[b][l]=a[l];var m=[],n=0;for(b in c)if(c.hasOwnProperty(b)){var o,p=c[b];for(o in p)if(p.hasOwnProperty(o)){var q=p[o];p[o]=q.replace(j,"$1 "+k+'="'+o+'" ')}for(var r=f(p.join(""),g),s=0;s<r.length;++s){var t=r[s];t.hasAttribute&&t.hasAttribute(k)&&(o=+t.getAttribute(k),t.removeAttribute(k),i(!m.hasOwnProperty(o)),m[o]=t,n+=1)}}return i(n===m.length),i(m.length===a.length),m},dangerouslyReplaceNodeWithMarkup:function(a,b){i(e.canUseDOM),i(b),i("html"!==a.tagName.toLowerCase());var c=f(b,g)[0];a.parentNode.replaceChild(c,a)}};b.exports=l},{110:110,112:112,125:125,133:133,21:21}],13:[function(a,b,c){"use strict";var d=a(139),e=[d({ResponderEventPlugin:null}),d({SimpleEventPlugin:null}),d({TapEventPlugin:null}),d({EnterLeaveEventPlugin:null}),d({ChangeEventPlugin:null}),d({SelectEventPlugin:null}),d({BeforeInputEventPlugin:null}),d({AnalyticsEventPlugin:null}),d({MobileSafariClickEventPlugin:null})];b.exports=e},{139:139}],14:[function(a,b,c){"use strict";var d=a(15),e=a(20),f=a(97),g=a(68),h=a(139),i=d.topLevelTypes,j=g.getFirstReactDOM,k={mouseEnter:{registrationName:h({onMouseEnter:null}),dependencies:[i.topMouseOut,i.topMouseOver]},mouseLeave:{registrationName:h({onMouseLeave:null}),dependencies:[i.topMouseOut,i.topMouseOver]}},l=[null,null],m={eventTypes:k,extractEvents:function(a,b,c,d){if(a===i.topMouseOver&&(d.relatedTarget||d.fromElement))return null;if(a!==i.topMouseOut&&a!==i.topMouseOver)return null;var h;if(b.window===b)h=b;else{var m=b.ownerDocument;h=m?m.defaultView||m.parentWindow:window}var n,o;if(a===i.topMouseOut?(n=b,o=j(d.relatedTarget||d.toElement)||h):(n=h,o=b),n===o)return null;var p=n?g.getID(n):"",q=o?g.getID(o):"",r=f.getPooled(k.mouseLeave,p,d);r.type="mouseleave",r.target=n,r.relatedTarget=o;var s=f.getPooled(k.mouseEnter,q,d);return s.type="mouseenter",s.target=o,s.relatedTarget=n,e.accumulateEnterLeaveDispatches(r,s,p,q),l[0]=r,l[1]=s,l}};b.exports=m},{139:139,15:15,20:20,68:68,97:97}],15:[function(a,b,c){"use strict";var d=a(138),e=d({bubbled:null,captured:null}),f=d({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),g={topLevelTypes:f,PropagationPhases:e};b.exports=g},{138:138}],16:[function(a,b,c){var d=a(112),e={listen:function(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),{remove:function(){a.removeEventListener(b,c,!1)}}):a.attachEvent?(a.attachEvent("on"+b,c),{remove:function(){a.detachEvent("on"+b,c)}}):void 0},capture:function(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!0),{remove:function(){a.removeEventListener(b,c,!0)}}):{remove:d}},registerDefault:function(){}};b.exports=e},{112:112}],17:[function(a,b,c){"use strict";var d=a(18),e=a(19),f=a(103),g=a(118),h=a(133),i={},j=null,k=function(a){if(a){var b=e.executeDispatch,c=d.getPluginModuleForEvent(a);c&&c.executeDispatch&&(b=c.executeDispatch),e.executeDispatchesInOrder(a,b),a.isPersistent()||a.constructor.release(a)}},l=null,m={injection:{injectMount:e.injection.injectMount,injectInstanceHandle:function(a){l=a},getInstanceHandle:function(){return l},injectEventPluginOrder:d.injectEventPluginOrder,injectEventPluginsByName:d.injectEventPluginsByName},eventNameDispatchConfigs:d.eventNameDispatchConfigs,registrationNameModules:d.registrationNameModules,putListener:function(a,b,c){h(!c||"function"==typeof c),(i[b]||(i[b]={}))[a]=c},getListener:function(a,b){var c=i[b];return c&&c[a]},deleteListener:function(a,b){var c=i[b];c&&delete c[a]},deleteAllListeners:function(a){for(var b in i)delete i[b][a]},extractEvents:function(a,b,c,e){for(var g,h=d.plugins,i=0,j=h.length;j>i;i++){var k=h[i];if(k){var l=k.extractEvents(a,b,c,e);l&&(g=f(g,l))}}return g},enqueueEvents:function(a){a&&(j=f(j,a))},processEventQueue:function(){var a=j;j=null,g(a,k),h(!j)},__purge:function(){i={}},__getListenerBank:function(){return i}};b.exports=m},{103:103,118:118,133:133,18:18,19:19}],18:[function(a,b,c){"use strict";function d(){if(h)for(var a in i){var b=i[a],c=h.indexOf(a);if(g(c>-1),!j.plugins[c]){g(b.extractEvents),j.plugins[c]=b;var d=b.eventTypes;for(var f in d)g(e(d[f],b,f))}}}function e(a,b,c){g(!j.eventNameDispatchConfigs.hasOwnProperty(c)),j.eventNameDispatchConfigs[c]=a;var d=a.phasedRegistrationNames;if(d){for(var e in d)if(d.hasOwnProperty(e)){var h=d[e];f(h,b,c)}return!0}return!!a.registrationName&&(f(a.registrationName,b,c),!0)}function f(a,b,c){g(!j.registrationNameModules[a]),j.registrationNameModules[a]=b,j.registrationNameDependencies[a]=b.eventTypes[c].dependencies}var g=a(133),h=null,i={},j={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(a){g(!h),h=Array.prototype.slice.call(a),d()},injectEventPluginsByName:function(a){var b=!1;for(var c in a)if(a.hasOwnProperty(c)){var e=a[c];i.hasOwnProperty(c)&&i[c]===e||(g(!i[c]),i[c]=e,b=!0)}b&&d()},getPluginModuleForEvent:function(a){var b=a.dispatchConfig;if(b.registrationName)return j.registrationNameModules[b.registrationName]||null;for(var c in b.phasedRegistrationNames)if(b.phasedRegistrationNames.hasOwnProperty(c)){var d=j.registrationNameModules[b.phasedRegistrationNames[c]];if(d)return d}return null},_resetEventPlugins:function(){h=null;for(var a in i)i.hasOwnProperty(a)&&delete i[a];j.plugins.length=0;var b=j.eventNameDispatchConfigs;for(var c in b)b.hasOwnProperty(c)&&delete b[c];var d=j.registrationNameModules;for(var e in d)d.hasOwnProperty(e)&&delete d[e]}};b.exports=j},{133:133}],19:[function(a,b,c){"use strict";function d(a){return a===q.topMouseUp||a===q.topTouchEnd||a===q.topTouchCancel}function e(a){return a===q.topMouseMove||a===q.topTouchMove}function f(a){return a===q.topMouseDown||a===q.topTouchStart}function g(a,b){var c=a._dispatchListeners,d=a._dispatchIDs;if(Array.isArray(c))for(var e=0;e<c.length&&!a.isPropagationStopped();e++)b(a,c[e],d[e]);else c&&b(a,c,d)}function h(a,b,c){a.currentTarget=p.Mount.getNode(c);var d=b(a,c);return a.currentTarget=null,d}function i(a,b){g(a,b),a._dispatchListeners=null,a._dispatchIDs=null}function j(a){var b=a._dispatchListeners,c=a._dispatchIDs;if(Array.isArray(b)){for(var d=0;d<b.length&&!a.isPropagationStopped();d++)if(b[d](a,c[d]))return c[d]}else if(b&&b(a,c))return c;return null}function k(a){var b=j(a);return a._dispatchIDs=null,a._dispatchListeners=null,b}function l(a){var b=a._dispatchListeners,c=a._dispatchIDs;o(!Array.isArray(b));var d=b?b(a,c):null;return a._dispatchListeners=null,a._dispatchIDs=null,d}function m(a){return!!a._dispatchListeners}var n=a(15),o=a(133),p={Mount:null,injectMount:function(a){p.Mount=a}},q=n.topLevelTypes,r={isEndish:d,isMoveish:e,isStartish:f,executeDirectDispatch:l,executeDispatch:h,executeDispatchesInOrder:i,executeDispatchesInOrderStopAtTrue:k,hasDispatches:m,injection:p,useTouchEvents:!1};b.exports=r},{133:133,15:15}],20:[function(a,b,c){"use strict";function d(a,b,c){var d=b.dispatchConfig.phasedRegistrationNames[c];return q(a,d)}function e(a,b,c){var e=b?p.bubbled:p.captured,f=d(a,c,e);f&&(c._dispatchListeners=n(c._dispatchListeners,f),c._dispatchIDs=n(c._dispatchIDs,a))}function f(a){a&&a.dispatchConfig.phasedRegistrationNames&&m.injection.getInstanceHandle().traverseTwoPhase(a.dispatchMarker,e,a)}function g(a,b,c){if(c&&c.dispatchConfig.registrationName){var d=c.dispatchConfig.registrationName,e=q(a,d);e&&(c._dispatchListeners=n(c._dispatchListeners,e),c._dispatchIDs=n(c._dispatchIDs,a))}}function h(a){a&&a.dispatchConfig.registrationName&&g(a.dispatchMarker,null,a)}function i(a){o(a,f)}function j(a,b,c,d){m.injection.getInstanceHandle().traverseEnterLeave(c,d,g,a,b)}function k(a){o(a,h)}var l=a(15),m=a(17),n=a(103),o=a(118),p=l.PropagationPhases,q=m.getListener,r={accumulateTwoPhaseDispatches:i,accumulateDirectDispatches:k,accumulateEnterLeaveDispatches:j};b.exports=r},{103:103,118:118,15:15,17:17}],21:[function(a,b,c){"use strict";var d=!("undefined"==typeof window||!window.document||!window.document.createElement),e={canUseDOM:d,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:d&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:d&&!!window.screen,isInWorker:!d};b.exports=e},{}],22:[function(a,b,c){"use strict";function d(a){this._root=a,this._startText=this.getText(),this._fallbackText=null}var e=a(28),f=a(27),g=a(128);f(d.prototype,{getText:function(){return"value"in this._root?this._root.value:this._root[g()]},getData:function(){if(this._fallbackText)return this._fallbackText;var a,b,c=this._startText,d=c.length,e=this.getText(),f=e.length;for(a=0;d>a&&c[a]===e[a];a++);var g=d-a;for(b=1;g>=b&&c[d-b]===e[f-b];b++);var h=b>1?1-b:void 0;return this._fallbackText=e.slice(a,h),this._fallbackText}}),e.addPoolingTo(d),b.exports=d},{128:128,27:27,28:28}],23:[function(a,b,c){"use strict";var d,e=a(10),f=a(21),g=e.injection.MUST_USE_ATTRIBUTE,h=e.injection.MUST_USE_PROPERTY,i=e.injection.HAS_BOOLEAN_VALUE,j=e.injection.HAS_SIDE_EFFECTS,k=e.injection.HAS_NUMERIC_VALUE,l=e.injection.HAS_POSITIVE_NUMERIC_VALUE,m=e.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(f.canUseDOM){var n=document.implementation;d=n&&n.hasFeature&&n.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var o={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:g|i,allowTransparency:g,alt:null,async:i,autoComplete:null,autoPlay:i,cellPadding:null,cellSpacing:null,charSet:g,checked:h|i,classID:g,className:d?g:h,cols:g|l,colSpan:null,content:null,contentEditable:null,contextMenu:g,controls:h|i,coords:null,crossOrigin:null,data:null,dateTime:g,defer:i,dir:null,disabled:g|i,download:m,draggable:null,encType:null,form:g,formAction:g,formEncType:g,formMethod:g,formNoValidate:i,formTarget:g,frameBorder:g,headers:null,height:g,hidden:g|i,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:h,label:null,lang:null,list:g,loop:h|i,low:null,manifest:g,marginHeight:null,marginWidth:null,max:null,maxLength:g,media:g,mediaGroup:null,method:null,min:null,multiple:h|i,muted:h|i,name:null,noValidate:i,open:i,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:h|i,rel:null,required:i,role:g,rows:g|l,rowSpan:null,sandbox:null,scope:null,scoped:i,scrolling:null,seamless:g|i,selected:h|i,shape:null,size:g|l,sizes:g,span:l,spellCheck:null,src:null,srcDoc:h,srcSet:g,start:k,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:h|j,width:g,wmode:g,autoCapitalize:null,autoCorrect:null,itemProp:g,itemScope:g|i,itemType:g,itemID:g,itemRef:g,property:null,unselectable:g},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};b.exports=o},{10:10,21:21}],24:[function(a,b,c){"use strict";function d(a){j(null==a.props.checkedLink||null==a.props.valueLink)}function e(a){d(a),j(null==a.props.value&&null==a.props.onChange)}function f(a){d(a),j(null==a.props.checked&&null==a.props.onChange)}function g(a){this.props.valueLink.requestChange(a.target.value)}function h(a){this.props.checkedLink.requestChange(a.target.checked)}var i=a(76),j=a(133),k={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},l={Mixin:{propTypes:{value:function(a,b,c){return!a[b]||k[a.type]||a.onChange||a.readOnly||a.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(a,b,c){return!a[b]||a.onChange||a.readOnly||a.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:i.func}},getValue:function(a){return a.props.valueLink?(e(a),a.props.valueLink.value):a.props.value},getChecked:function(a){return a.props.checkedLink?(f(a),a.props.checkedLink.value):a.props.checked},getOnChange:function(a){return a.props.valueLink?(e(a),g):a.props.checkedLink?(f(a),h):a.props.onChange}};b.exports=l},{133:133,76:76}],25:[function(a,b,c){"use strict";function d(a){a.remove()}var e=a(30),f=a(103),g=a(118),h=a(133),i={trapBubbledEvent:function(a,b){h(this.isMounted());var c=this.getDOMNode();h(c);var d=e.trapBubbledEvent(a,b,c);this._localEventListeners=f(this._localEventListeners,d)},componentWillUnmount:function(){this._localEventListeners&&g(this._localEventListeners,d)}};b.exports=i},{103:103,118:118,133:133,30:30}],26:[function(a,b,c){"use strict";var d=a(15),e=a(112),f=d.topLevelTypes,g={eventTypes:null,extractEvents:function(a,b,c,d){if(a===f.topTouchStart){var g=d.target;g&&!g.onclick&&(g.onclick=e)}}};b.exports=g},{112:112,15:15}],27:[function(a,b,c){"use strict";function d(a,b){if(null==a)throw new TypeError("Object.assign target cannot be null or undefined");for(var c=Object(a),d=Object.prototype.hasOwnProperty,e=1;e<arguments.length;e++){var f=arguments[e];if(null!=f){var g=Object(f);for(var h in g)d.call(g,h)&&(c[h]=g[h])}}return c}b.exports=d},{}],28:[function(a,b,c){"use strict";var d=a(133),e=function(a){var b=this;if(b.instancePool.length){var c=b.instancePool.pop();return b.call(c,a),c}return new b(a)},f=function(a,b){var c=this;if(c.instancePool.length){var d=c.instancePool.pop();return c.call(d,a,b),d}return new c(a,b)},g=function(a,b,c){var d=this;if(d.instancePool.length){var e=d.instancePool.pop();return d.call(e,a,b,c),e}return new d(a,b,c)},h=function(a,b,c,d,e){var f=this;if(f.instancePool.length){var g=f.instancePool.pop();return f.call(g,a,b,c,d,e),g}return new f(a,b,c,d,e)},i=function(a){var b=this;d(a instanceof b),a.destructor&&a.destructor(),b.instancePool.length<b.poolSize&&b.instancePool.push(a)},j=e,k=function(a,b){var c=a;return c.instancePool=[],c.getPooled=b||j,c.poolSize||(c.poolSize=10),c.release=i,c},l={addPoolingTo:k,oneArgumentPooler:e,twoArgumentPooler:f,threeArgumentPooler:g,fiveArgumentPooler:h};b.exports=l},{133:133}],29:[function(a,b,c){"use strict";var d=a(115),e={getDOMNode:function(){return d(this)}};b.exports=e},{115:115}],30:[function(a,b,c){"use strict";function d(a){return Object.prototype.hasOwnProperty.call(a,p)||(a[p]=n++,l[a[p]]={}),l[a[p]]}var e=a(15),f=a(17),g=a(18),h=a(59),i=a(102),j=a(27),k=a(134),l={},m=!1,n=0,o={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",
topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},p="_reactListenersID"+String(Math.random()).slice(2),q=j({},h,{ReactEventListener:null,injection:{injectReactEventListener:function(a){a.setHandleTopLevel(q.handleTopLevel),q.ReactEventListener=a}},setEnabled:function(a){q.ReactEventListener&&q.ReactEventListener.setEnabled(a)},isEnabled:function(){return!(!q.ReactEventListener||!q.ReactEventListener.isEnabled())},listenTo:function(a,b){for(var c=b,f=d(c),h=g.registrationNameDependencies[a],i=e.topLevelTypes,j=0,l=h.length;l>j;j++){var m=h[j];f.hasOwnProperty(m)&&f[m]||(m===i.topWheel?k("wheel")?q.ReactEventListener.trapBubbledEvent(i.topWheel,"wheel",c):k("mousewheel")?q.ReactEventListener.trapBubbledEvent(i.topWheel,"mousewheel",c):q.ReactEventListener.trapBubbledEvent(i.topWheel,"DOMMouseScroll",c):m===i.topScroll?k("scroll",!0)?q.ReactEventListener.trapCapturedEvent(i.topScroll,"scroll",c):q.ReactEventListener.trapBubbledEvent(i.topScroll,"scroll",q.ReactEventListener.WINDOW_HANDLE):m===i.topFocus||m===i.topBlur?(k("focus",!0)?(q.ReactEventListener.trapCapturedEvent(i.topFocus,"focus",c),q.ReactEventListener.trapCapturedEvent(i.topBlur,"blur",c)):k("focusin")&&(q.ReactEventListener.trapBubbledEvent(i.topFocus,"focusin",c),q.ReactEventListener.trapBubbledEvent(i.topBlur,"focusout",c)),f[i.topBlur]=!0,f[i.topFocus]=!0):o.hasOwnProperty(m)&&q.ReactEventListener.trapBubbledEvent(m,o[m],c),f[m]=!0)}},trapBubbledEvent:function(a,b,c){return q.ReactEventListener.trapBubbledEvent(a,b,c)},trapCapturedEvent:function(a,b,c){return q.ReactEventListener.trapCapturedEvent(a,b,c)},ensureScrollValueMonitoring:function(){if(!m){var a=i.refreshScrollValues;q.ReactEventListener.monitorScrollValue(a),m=!0}},eventNameDispatchConfigs:f.eventNameDispatchConfigs,registrationNameModules:f.registrationNameModules,putListener:f.putListener,getListener:f.getListener,deleteListener:f.deleteListener,deleteAllListeners:f.deleteAllListeners});b.exports=q},{102:102,134:134,15:15,17:17,18:18,27:27,59:59}],31:[function(a,b,c){"use strict";var d=a(79),e=a(116),f=a(132),g=a(147),h={instantiateChildren:function(a,b,c){var d=e(a);for(var g in d)if(d.hasOwnProperty(g)){var h=d[g],i=f(h,null);d[g]=i}return d},updateChildren:function(a,b,c,h){var i=e(b);if(!i&&!a)return null;var j;for(j in i)if(i.hasOwnProperty(j)){var k=a&&a[j],l=k&&k._currentElement,m=i[j];if(g(l,m))d.receiveComponent(k,m,c,h),i[j]=k;else{k&&d.unmountComponent(k,j);var n=f(m,null);i[j]=n}}for(j in a)!a.hasOwnProperty(j)||i&&i.hasOwnProperty(j)||d.unmountComponent(a[j]);return i},unmountChildren:function(a){for(var b in a){var c=a[b];d.unmountComponent(c)}}};b.exports=h},{116:116,132:132,147:147,79:79}],32:[function(a,b,c){"use strict";function d(a,b){this.forEachFunction=a,this.forEachContext=b}function e(a,b,c,d){var e=a;e.forEachFunction.call(e.forEachContext,b,d)}function f(a,b,c){if(null==a)return a;var f=d.getPooled(b,c);n(a,e,f),d.release(f)}function g(a,b,c){this.mapResult=a,this.mapFunction=b,this.mapContext=c}function h(a,b,c,d){var e=a,f=e.mapResult;if(!f.hasOwnProperty(c)){var g=e.mapFunction.call(e.mapContext,b,d);f[c]=g}}function i(a,b,c){if(null==a)return a;var d={},e=g.getPooled(d,b,c);return n(a,h,e),g.release(e),m.create(d)}function j(a,b,c,d){return null}function k(a,b){return n(a,j,null)}var l=a(28),m=a(61),n=a(149),o=(a(150),l.twoArgumentPooler),p=l.threeArgumentPooler;l.addPoolingTo(d,o),l.addPoolingTo(g,p);var q={forEach:f,map:i,count:k};b.exports=q},{149:149,150:150,28:28,61:61}],33:[function(a,b,c){"use strict";function d(a,b){var c=y.hasOwnProperty(b)?y[b]:null;A.hasOwnProperty(b)&&s(c===w.OVERRIDE_BASE),a.hasOwnProperty(b)&&s(c===w.DEFINE_MANY||c===w.DEFINE_MANY_MERGED)}function e(a,b){if(b){s("function"!=typeof b),s(!m.isValidElement(b));var c=a.prototype;b.hasOwnProperty(v)&&z.mixins(a,b.mixins);for(var e in b)if(b.hasOwnProperty(e)&&e!==v){var f=b[e];if(d(c,e),z.hasOwnProperty(e))z[e](a,f);else{var g=y.hasOwnProperty(e),j=c.hasOwnProperty(e),k=f&&f.__reactDontBind,l="function"==typeof f,n=l&&!g&&!j&&!k;if(n)c.__reactAutoBindMap||(c.__reactAutoBindMap={}),c.__reactAutoBindMap[e]=f,c[e]=f;else if(j){var o=y[e];s(g&&(o===w.DEFINE_MANY_MERGED||o===w.DEFINE_MANY)),o===w.DEFINE_MANY_MERGED?c[e]=h(c[e],f):o===w.DEFINE_MANY&&(c[e]=i(c[e],f))}else c[e]=f}}}}function f(a,b){if(b)for(var c in b){var d=b[c];if(b.hasOwnProperty(c)){var e=c in z;s(!e);var f=c in a;s(!f),a[c]=d}}}function g(a,b){s(a&&b&&"object"==typeof a&&"object"==typeof b);for(var c in b)b.hasOwnProperty(c)&&(s(void 0===a[c]),a[c]=b[c]);return a}function h(a,b){return function(){var c=a.apply(this,arguments),d=b.apply(this,arguments);if(null==c)return d;if(null==d)return c;var e={};return g(e,c),g(e,d),e}}function i(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}function j(a,b){return b.bind(a)}function k(a){for(var b in a.__reactAutoBindMap)if(a.__reactAutoBindMap.hasOwnProperty(b)){var c=a.__reactAutoBindMap[b];a[b]=j(a,n.guard(c,a.constructor.displayName+"."+b))}}var l=a(34),m=(a(39),a(55)),n=a(58),o=a(65),p=a(66),q=(a(75),a(74),a(84)),r=a(27),s=a(133),t=a(138),u=a(139),v=(a(150),u({mixins:null})),w=t({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),x=[],y={mixins:w.DEFINE_MANY,statics:w.DEFINE_MANY,propTypes:w.DEFINE_MANY,contextTypes:w.DEFINE_MANY,childContextTypes:w.DEFINE_MANY,getDefaultProps:w.DEFINE_MANY_MERGED,getInitialState:w.DEFINE_MANY_MERGED,getChildContext:w.DEFINE_MANY_MERGED,render:w.DEFINE_ONCE,componentWillMount:w.DEFINE_MANY,componentDidMount:w.DEFINE_MANY,componentWillReceiveProps:w.DEFINE_MANY,shouldComponentUpdate:w.DEFINE_ONCE,componentWillUpdate:w.DEFINE_MANY,componentDidUpdate:w.DEFINE_MANY,componentWillUnmount:w.DEFINE_MANY,updateComponent:w.OVERRIDE_BASE},z={displayName:function(a,b){a.displayName=b},mixins:function(a,b){if(b)for(var c=0;c<b.length;c++)e(a,b[c])},childContextTypes:function(a,b){a.childContextTypes=r({},a.childContextTypes,b)},contextTypes:function(a,b){a.contextTypes=r({},a.contextTypes,b)},getDefaultProps:function(a,b){a.getDefaultProps?a.getDefaultProps=h(a.getDefaultProps,b):a.getDefaultProps=b},propTypes:function(a,b){a.propTypes=r({},a.propTypes,b)},statics:function(a,b){f(a,b)}},A={replaceState:function(a,b){q.enqueueReplaceState(this,a),b&&q.enqueueCallback(this,b)},isMounted:function(){var a=o.get(this);return a&&a!==p.currentlyMountingInstance},setProps:function(a,b){q.enqueueSetProps(this,a),b&&q.enqueueCallback(this,b)},replaceProps:function(a,b){q.enqueueReplaceProps(this,a),b&&q.enqueueCallback(this,b)}},B=function(){};r(B.prototype,l.prototype,A);var C={createClass:function(a){var b=function(a,b){this.__reactAutoBindMap&&k(this),this.props=a,this.context=b,this.state=null;var c=this.getInitialState?this.getInitialState():null;s("object"==typeof c&&!Array.isArray(c)),this.state=c};b.prototype=new B,b.prototype.constructor=b,x.forEach(e.bind(null,b)),e(b,a),b.getDefaultProps&&(b.defaultProps=b.getDefaultProps()),s(b.prototype.render);for(var c in y)b.prototype[c]||(b.prototype[c]=null);return b.type=b,b},injection:{injectMixin:function(a){x.push(a)}}};b.exports=C},{133:133,138:138,139:139,150:150,27:27,34:34,39:39,55:55,58:58,65:65,66:66,74:74,75:75,84:84}],34:[function(a,b,c){"use strict";function d(a,b){this.props=a,this.context=b}var e=a(84),f=a(133);a(150),d.prototype.setState=function(a,b){f("object"==typeof a||"function"==typeof a||null==a),e.enqueueSetState(this,a),b&&e.enqueueCallback(this,b)},d.prototype.forceUpdate=function(a){e.enqueueForceUpdate(this),a&&e.enqueueCallback(this,a)},b.exports=d},{133:133,150:150,84:84}],35:[function(a,b,c){"use strict";var d=a(44),e=a(68),f={processChildrenUpdates:d.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:d.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(a){e.purgeID(a)}};b.exports=f},{44:44,68:68}],36:[function(a,b,c){"use strict";var d=a(133),e=!1,f={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(a){d(!e),f.unmountIDFromEnvironment=a.unmountIDFromEnvironment,f.replaceNodeWithMarkupByID=a.replaceNodeWithMarkupByID,f.processChildrenUpdates=a.processChildrenUpdates,e=!0}}};b.exports=f},{133:133}],37:[function(a,b,c){"use strict";function d(a){var b=a._currentElement._owner||null;if(b){var c=b.getName();if(c)return" Check the render method of `"+c+"`."}return""}var e=a(36),f=a(38),g=a(39),h=a(55),i=(a(56),a(65)),j=a(66),k=a(71),l=a(73),m=a(75),n=(a(74),a(79)),o=a(85),p=a(27),q=a(113),r=a(133),s=a(147),t=(a(150),1),u={construct:function(a){this._currentElement=a,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._isTopLevel=!1,this._pendingCallbacks=null},mountComponent:function(a,b,c){this._context=c,this._mountOrder=t++,this._rootNodeID=a;var d=this._processProps(this._currentElement.props),e=this._processContext(this._currentElement._context),f=k.getComponentClassForElement(this._currentElement),g=new f(d,e);g.props=d,g.context=e,g.refs=q,this._instance=g,i.set(g,this);var h=g.state;void 0===h&&(g.state=h=null),r("object"==typeof h&&!Array.isArray(h)),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1;var l,m,o=j.currentlyMountingInstance;j.currentlyMountingInstance=this;try{g.componentWillMount&&(g.componentWillMount(),this._pendingStateQueue&&(g.state=this._processPendingState(g.props,g.context))),l=this._getValidatedChildContext(c),m=this._renderValidatedComponent(l)}finally{j.currentlyMountingInstance=o}this._renderedComponent=this._instantiateReactComponent(m,this._currentElement.type);var p=n.mountComponent(this._renderedComponent,a,b,this._mergeChildContext(c,l));return g.componentDidMount&&b.getReactMountReady().enqueue(g.componentDidMount,g),p},unmountComponent:function(){var a=this._instance;if(a.componentWillUnmount){var b=j.currentlyUnmountingInstance;j.currentlyUnmountingInstance=this;try{a.componentWillUnmount()}finally{j.currentlyUnmountingInstance=b}}n.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,i.remove(a)},_setPropsInternal:function(a,b){var c=this._pendingElement||this._currentElement;this._pendingElement=h.cloneAndReplaceProps(c,p({},c.props,a)),o.enqueueUpdate(this,b)},_maskContext:function(a){var b=null;if("string"==typeof this._currentElement.type)return q;var c=this._currentElement.type.contextTypes;if(!c)return q;b={};for(var d in c)b[d]=a[d];return b},_processContext:function(a){return this._maskContext(a)},_getValidatedChildContext:function(a){var b=this._instance,c=b.getChildContext&&b.getChildContext();if(c){r("object"==typeof b.constructor.childContextTypes);for(var d in c)r(d in b.constructor.childContextTypes);return c}return null},_mergeChildContext:function(a,b){return b?p({},a,b):a},_processProps:function(a){return a},_checkPropTypes:function(a,b,c){var e=this.getName();for(var f in a)if(a.hasOwnProperty(f)){var g;try{r("function"==typeof a[f]),g=a[f](b,f,e,c)}catch(a){g=a}g instanceof Error&&(d(this),m.prop)}},receiveComponent:function(a,b,c){var d=this._currentElement,e=this._context;this._pendingElement=null,this.updateComponent(b,d,a,e,c)},performUpdateIfNecessary:function(a){null!=this._pendingElement&&n.receiveComponent(this,this._pendingElement||this._currentElement,a,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(a,this._currentElement,this._currentElement,this._context,this._context)},_warnIfContextsDiffer:function(a,b){a=this._maskContext(a),b=this._maskContext(b);for(var c=Object.keys(b).sort(),d=(this.getName(),0);d<c.length;d++)c[d]},updateComponent:function(a,b,c,d,e){var f=this._instance,g=f.context,h=f.props;b!==c&&(g=this._processContext(c._context),h=this._processProps(c.props),f.componentWillReceiveProps&&f.componentWillReceiveProps(h,g));var i=this._processPendingState(h,g);this._pendingForceUpdate||!f.shouldComponentUpdate||f.shouldComponentUpdate(h,i,g)?(this._pendingForceUpdate=!1,this._performComponentUpdate(c,h,i,g,a,e)):(this._currentElement=c,this._context=e,f.props=h,f.state=i,f.context=g)},_processPendingState:function(a,b){var c=this._instance,d=this._pendingStateQueue,e=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!d)return c.state;if(e&&1===d.length)return d[0];for(var f=p({},e?d[0]:c.state),g=e?1:0;g<d.length;g++){var h=d[g];p(f,"function"==typeof h?h.call(c,f,a,b):h)}return f},_performComponentUpdate:function(a,b,c,d,e,f){var g=this._instance,h=g.props,i=g.state,j=g.context;g.componentWillUpdate&&g.componentWillUpdate(b,c,d),this._currentElement=a,this._context=f,g.props=b,g.state=c,g.context=d,this._updateRenderedComponent(e,f),g.componentDidUpdate&&e.getReactMountReady().enqueue(g.componentDidUpdate.bind(g,h,i,j),g)},_updateRenderedComponent:function(a,b){var c=this._renderedComponent,d=c._currentElement,e=this._getValidatedChildContext(),f=this._renderValidatedComponent(e);if(s(d,f))n.receiveComponent(c,f,a,this._mergeChildContext(b,e));else{var g=this._rootNodeID,h=c._rootNodeID;n.unmountComponent(c),this._renderedComponent=this._instantiateReactComponent(f,this._currentElement.type);var i=n.mountComponent(this._renderedComponent,g,a,this._mergeChildContext(b,e));this._replaceNodeWithMarkupByID(h,i)}},_replaceNodeWithMarkupByID:function(a,b){e.replaceNodeWithMarkupByID(a,b)},_renderValidatedComponentWithoutOwnerOrContext:function(){return this._instance.render()},_renderValidatedComponent:function(a){var b,c=f.current;f.current=this._mergeChildContext(this._currentElement._context,a),g.current=this;try{b=this._renderValidatedComponentWithoutOwnerOrContext()}finally{f.current=c,g.current=null}return r(null===b||!1===b||h.isValidElement(b)),b},attachRef:function(a,b){var c=this.getPublicInstance();(c.refs===q?c.refs={}:c.refs)[a]=b.getPublicInstance()},detachRef:function(a){delete this.getPublicInstance().refs[a]},getName:function(){var a=this._currentElement.type,b=this._instance&&this._instance.constructor;return a.displayName||b&&b.displayName||a.name||b&&b.name||null},getPublicInstance:function(){return this._instance},_instantiateReactComponent:null};l.measureMethods(u,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var v={Mixin:u};b.exports=v},{113:113,133:133,147:147,150:150,27:27,36:36,38:38,39:39,55:55,56:56,65:65,66:66,71:71,73:73,74:74,75:75,79:79,85:85}],38:[function(a,b,c){"use strict";var d=a(27),e=a(113),f=(a(150),{current:e,withContext:function(a,b){var c,e=f.current;f.current=d({},e,a);try{c=b()}finally{f.current=e}return c}});b.exports=f},{113:113,150:150,27:27}],39:[function(a,b,c){"use strict";var d={current:null};b.exports=d},{}],40:[function(a,b,c){"use strict";function d(a){return e.createFactory(a)}var e=a(55),f=(a(56),a(140)),g=f({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul",var:"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},d);b.exports=g},{140:140,55:55,56:56}],41:[function(a,b,c){"use strict";var d=a(2),e=a(29),f=a(33),g=a(55),h=a(138),i=g.createFactory("button"),j=h({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),k=f.createClass({displayName:"ReactDOMButton",tagName:"BUTTON",mixins:[d,e],render:function(){var a={};for(var b in this.props)!this.props.hasOwnProperty(b)||this.props.disabled&&j[b]||(a[b]=this.props[b]);return i(a,this.props.children)}});b.exports=k},{138:138,2:2,29:29,33:33,55:55}],42:[function(a,b,c){"use strict";function d(a){a&&(null!=a.dangerouslySetInnerHTML&&(r(null==a.children),r("object"==typeof a.dangerouslySetInnerHTML&&"__html"in a.dangerouslySetInnerHTML)),r(null==a.style||"object"==typeof a.style))}function e(a,b,c,d){var e=m.findReactContainerForID(a);if(e){var f=e.nodeType===y?e.ownerDocument:e;u(b,f)}d.getPutListenerQueue().enqueuePutListener(a,b,c)}function f(a){D.call(C,a)||(r(B.test(a)),C[a]=!0)}function g(a){f(a),this._tag=a,this._renderedChildren=null,this._previousStyleCopy=null,this._rootNodeID=null}var h=a(5),i=a(10),j=a(11),k=a(30),l=a(35),m=a(68),n=a(69),o=a(73),p=a(27),q=a(114),r=a(133),s=(a(134),a(139)),t=(a(150),k.deleteListener),u=k.listenTo,v=k.registrationNameModules,w={string:!0,number:!0},x=s({style:null}),y=1,z=null,A={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},B=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,C={},D={}.hasOwnProperty;g.displayName="ReactDOMComponent",g.Mixin={construct:function(a){this._currentElement=a},mountComponent:function(a,b,c){this._rootNodeID=a,d(this._currentElement.props);var e=A[this._tag]?"":"</"+this._tag+">";return this._createOpenTagMarkupAndPutListeners(b)+this._createContentMarkup(b,c)+e},_createOpenTagMarkupAndPutListeners:function(a){var b=this._currentElement.props,c="<"+this._tag;for(var d in b)if(b.hasOwnProperty(d)){var f=b[d];if(null!=f)if(v.hasOwnProperty(d))e(this._rootNodeID,d,f,a);else{d===x&&(f&&(f=this._previousStyleCopy=p({},b.style)),f=h.createMarkupForStyles(f));var g=j.createMarkupForProperty(d,f);g&&(c+=" "+g)}}return a.renderToStaticMarkup?c+">":c+" "+j.createMarkupForID(this._rootNodeID)+">"},_createContentMarkup:function(a,b){var c="";("listing"===this._tag||"pre"===this._tag||"textarea"===this._tag)&&(c="\n");var d=this._currentElement.props,e=d.dangerouslySetInnerHTML;if(null!=e){if(null!=e.__html)return c+e.__html}else{var f=w[typeof d.children]?d.children:null,g=null!=f?null:d.children;if(null!=f)return c+q(f);if(null!=g){return c+this.mountChildren(g,a,b).join("")}}return c},receiveComponent:function(a,b,c){var d=this._currentElement;this._currentElement=a,this.updateComponent(b,d,a,c)},updateComponent:function(a,b,c,e){d(this._currentElement.props),this._updateDOMProperties(b.props,a),this._updateDOMChildren(b.props,a,e)},_updateDOMProperties:function(a,b){var c,d,f,g=this._currentElement.props;for(c in a)if(!g.hasOwnProperty(c)&&a.hasOwnProperty(c))if(c===x){var h=this._previousStyleCopy;for(d in h)h.hasOwnProperty(d)&&(f=f||{},f[d]="");this._previousStyleCopy=null}else v.hasOwnProperty(c)?t(this._rootNodeID,c):(i.isStandardName[c]||i.isCustomAttribute(c))&&z.deletePropertyByID(this._rootNodeID,c);for(c in g){var j=g[c],k=c===x?this._previousStyleCopy:a[c];if(g.hasOwnProperty(c)&&j!==k)if(c===x)if(j?j=this._previousStyleCopy=p({},j):this._previousStyleCopy=null,k){for(d in k)!k.hasOwnProperty(d)||j&&j.hasOwnProperty(d)||(f=f||{},f[d]="");for(d in j)j.hasOwnProperty(d)&&k[d]!==j[d]&&(f=f||{},f[d]=j[d])}else f=j;else v.hasOwnProperty(c)?e(this._rootNodeID,c,j,b):(i.isStandardName[c]||i.isCustomAttribute(c))&&z.updatePropertyByID(this._rootNodeID,c,j)}f&&z.updateStylesByID(this._rootNodeID,f)},_updateDOMChildren:function(a,b,c){var d=this._currentElement.props,e=w[typeof a.children]?a.children:null,f=w[typeof d.children]?d.children:null,g=a.dangerouslySetInnerHTML&&a.dangerouslySetInnerHTML.__html,h=d.dangerouslySetInnerHTML&&d.dangerouslySetInnerHTML.__html,i=null!=e?null:a.children,j=null!=f?null:d.children,k=null!=e||null!=g,l=null!=f||null!=h;null!=i&&null==j?this.updateChildren(null,b,c):k&&!l&&this.updateTextContent(""),null!=f?e!==f&&this.updateTextContent(""+f):null!=h?g!==h&&z.updateInnerHTMLByID(this._rootNodeID,h):null!=j&&this.updateChildren(j,b,c)},unmountComponent:function(){this.unmountChildren(),k.deleteAllListeners(this._rootNodeID),l.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null}},o.measureMethods(g,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),p(g.prototype,g.Mixin,n.Mixin),g.injection={injectIDOperations:function(a){g.BackendIDOperations=z=a}},b.exports=g},{10:10,11:11,114:114,133:133,134:134,139:139,150:150,27:27,30:30,35:35,5:5,68:68,69:69,73:73}],43:[function(a,b,c){"use strict";var d=a(15),e=a(25),f=a(29),g=a(33),h=a(55),i=h.createFactory("form"),j=g.createClass({displayName:"ReactDOMForm",tagName:"FORM",mixins:[f,e],render:function(){return i(this.props)},componentDidMount:function(){this.trapBubbledEvent(d.topLevelTypes.topReset,"reset"),this.trapBubbledEvent(d.topLevelTypes.topSubmit,"submit")}});b.exports=j},{15:15,25:25,29:29,33:33,55:55}],44:[function(a,b,c){"use strict";var d=a(5),e=a(9),f=a(11),g=a(68),h=a(73),i=a(133),j=a(144),k={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:function(a,b,c){var d=g.getNode(a);i(!k.hasOwnProperty(b)),null!=c?f.setValueForProperty(d,b,c):f.deleteValueForProperty(d,b)},deletePropertyByID:function(a,b,c){var d=g.getNode(a);i(!k.hasOwnProperty(b)),f.deleteValueForProperty(d,b,c)},updateStylesByID:function(a,b){var c=g.getNode(a);d.setValueForStyles(c,b)},updateInnerHTMLByID:function(a,b){var c=g.getNode(a);j(c,b)},updateTextContentByID:function(a,b){var c=g.getNode(a);e.updateTextContent(c,b)},dangerouslyReplaceNodeWithMarkupByID:function(a,b){var c=g.getNode(a);e.dangerouslyReplaceNodeWithMarkup(c,b)},dangerouslyProcessChildrenUpdates:function(a,b){for(var c=0;c<a.length;c++)a[c].parentNode=g.getNode(a[c].parentID);e.processUpdates(a,b)}};h.measureMethods(l,"ReactDOMIDOperations",{updatePropertyByID:"updatePropertyByID",deletePropertyByID:"deletePropertyByID",updateStylesByID:"updateStylesByID",updateInnerHTMLByID:"updateInnerHTMLByID",updateTextContentByID:"updateTextContentByID",dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),b.exports=l},{11:11,133:133,144:144,5:5,68:68,73:73,9:9}],45:[function(a,b,c){"use strict";var d=a(15),e=a(25),f=a(29),g=a(33),h=a(55),i=h.createFactory("iframe"),j=g.createClass({displayName:"ReactDOMIframe",tagName:"IFRAME",mixins:[f,e],render:function(){return i(this.props)},componentDidMount:function(){this.trapBubbledEvent(d.topLevelTypes.topLoad,"load")}});b.exports=j},{15:15,25:25,29:29,33:33,55:55}],46:[function(a,b,c){"use strict";var d=a(15),e=a(25),f=a(29),g=a(33),h=a(55),i=h.createFactory("img"),j=g.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[f,e],render:function(){return i(this.props)},componentDidMount:function(){this.trapBubbledEvent(d.topLevelTypes.topLoad,"load"),this.trapBubbledEvent(d.topLevelTypes.topError,"error")}});b.exports=j},{15:15,25:25,29:29,33:33,55:55}],47:[function(a,b,c){"use strict";function d(){this.isMounted()&&this.forceUpdate()}var e=a(2),f=a(11),g=a(24),h=a(29),i=a(33),j=a(55),k=a(68),l=a(85),m=a(27),n=a(133),o=j.createFactory("input"),p={},q=i.createClass({displayName:"ReactDOMInput",tagName:"INPUT",mixins:[e,g.Mixin,h],getInitialState:function(){var a=this.props.defaultValue;return{initialChecked:this.props.defaultChecked||!1,initialValue:null!=a?a:null}},render:function(){var a=m({},this.props);a.defaultChecked=null,a.defaultValue=null;var b=g.getValue(this);a.value=null!=b?b:this.state.initialValue;var c=g.getChecked(this);return a.checked=null!=c?c:this.state.initialChecked,a.onChange=this._handleChange,o(a,this.props.children)},componentDidMount:function(){var a=k.getID(this.getDOMNode());p[a]=this},componentWillUnmount:function(){var a=this.getDOMNode(),b=k.getID(a);delete p[b]},componentDidUpdate:function(a,b,c){var d=this.getDOMNode();null!=this.props.checked&&f.setValueForProperty(d,"checked",this.props.checked||!1);var e=g.getValue(this);null!=e&&f.setValueForProperty(d,"value",""+e)},_handleChange:function(a){var b,c=g.getOnChange(this);c&&(b=c.call(this,a)),l.asap(d,this);var e=this.props.name;if("radio"===this.props.type&&null!=e){for(var f=this.getDOMNode(),h=f;h.parentNode;)h=h.parentNode;for(var i=h.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),j=0,m=i.length;m>j;j++){var o=i[j];if(o!==f&&o.form===f.form){var q=k.getID(o);n(q);var r=p[q];n(r),l.asap(d,r)}}}return b}});b.exports=q},{11:11,133:133,2:2,24:24,27:27,29:29,33:33,55:55,68:68,85:85}],48:[function(a,b,c){"use strict";var d=a(29),e=a(33),f=a(55),g=(a(150),f.createFactory("option")),h=e.createClass({displayName:"ReactDOMOption",tagName:"OPTION",mixins:[d],componentWillMount:function(){},render:function(){return g(this.props,this.props.children)}});b.exports=h},{150:150,29:29,33:33,55:55}],49:[function(a,b,c){"use strict";function d(){if(this._pendingUpdate){this._pendingUpdate=!1;var a=h.getValue(this);null!=a&&this.isMounted()&&f(this,a)}}function e(a,b,c){if(null==a[b])return null;if(a.multiple){if(!Array.isArray(a[b]))return new Error("The `"+b+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(a[b]))return new Error("The `"+b+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function f(a,b){var c,d,e,f=a.getDOMNode().options;if(a.props.multiple){for(c={},d=0,e=b.length;e>d;d++)c[""+b[d]]=!0;for(d=0,e=f.length;e>d;d++){var g=c.hasOwnProperty(f[d].value);f[d].selected!==g&&(f[d].selected=g)}}else{for(c=""+b,d=0,e=f.length;e>d;d++)if(f[d].value===c)return void(f[d].selected=!0);f.length&&(f[0].selected=!0)}}var g=a(2),h=a(24),i=a(29),j=a(33),k=a(55),l=a(85),m=a(27),n=k.createFactory("select"),o=j.createClass({displayName:"ReactDOMSelect",tagName:"SELECT",mixins:[g,h.Mixin,i],propTypes:{defaultValue:e,value:e},render:function(){var a=m({},this.props);return a.onChange=this._handleChange,a.value=null,n(a,this.props.children)},componentWillMount:function(){this._pendingUpdate=!1},componentDidMount:function(){var a=h.getValue(this);null!=a?f(this,a):null!=this.props.defaultValue&&f(this,this.props.defaultValue)},componentDidUpdate:function(a){var b=h.getValue(this);null!=b?(this._pendingUpdate=!1,f(this,b)):!a.multiple!=!this.props.multiple&&(null!=this.props.defaultValue?f(this,this.props.defaultValue):f(this,this.props.multiple?[]:""))},_handleChange:function(a){var b,c=h.getOnChange(this);return c&&(b=c.call(this,a)),this._pendingUpdate=!0,l.asap(d,this),b}});b.exports=o},{2:2,24:24,27:27,29:29,33:33,55:55,85:85}],50:[function(a,b,c){"use strict";function d(a,b,c,d){return a===c&&b===d}function e(a){var b=document.selection,c=b.createRange(),d=c.text.length,e=c.duplicate();e.moveToElementText(a),e.setEndPoint("EndToStart",c);var f=e.text.length;return{start:f,end:f+d}}function f(a){var b=window.getSelection&&window.getSelection();if(!b||0===b.rangeCount)return null;var c=b.anchorNode,e=b.anchorOffset,f=b.focusNode,g=b.focusOffset,h=b.getRangeAt(0),i=d(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),j=i?0:h.toString().length,k=h.cloneRange();k.selectNodeContents(a),k.setEnd(h.startContainer,h.startOffset);var l=d(k.startContainer,k.startOffset,k.endContainer,k.endOffset),m=l?0:k.toString().length,n=m+j,o=document.createRange();o.setStart(c,e),o.setEnd(f,g);var p=o.collapsed;return{start:p?n:m,end:p?m:n}}function g(a,b){var c,d,e=document.selection.createRange().duplicate();void 0===b.end?(c=b.start,d=c):b.start>b.end?(c=b.end,d=b.start):(c=b.start,d=b.end),e.moveToElementText(a),e.moveStart("character",c),e.setEndPoint("EndToStart",e),e.moveEnd("character",d-c),e.select()}function h(a,b){if(window.getSelection){var c=window.getSelection(),d=a[k()].length,e=Math.min(b.start,d),f=void 0===b.end?e:Math.min(b.end,d);if(!c.extend&&e>f){var g=f;f=e,e=g}var h=j(a,e),i=j(a,f);if(h&&i){var l=document.createRange();l.setStart(h.node,h.offset),c.removeAllRanges(),e>f?(c.addRange(l),c.extend(i.node,i.offset)):(l.setEnd(i.node,i.offset),c.addRange(l))}}}var i=a(21),j=a(126),k=a(128),l=i.canUseDOM&&"selection"in document&&!("getSelection"in window),m={getOffsets:l?e:f,setOffsets:l?g:h};b.exports=m},{126:126,128:128,21:21}],51:[function(a,b,c){"use strict";var d=a(11),e=a(35),f=a(42),g=a(27),h=a(114),i=function(a){};g(i.prototype,{construct:function(a){this._currentElement=a,this._stringText=""+a,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(a,b,c){this._rootNodeID=a;var e=h(this._stringText);return b.renderToStaticMarkup?e:"<span "+d.createMarkupForID(a)+">"+e+"</span>"},receiveComponent:function(a,b){if(a!==this._currentElement){this._currentElement=a;var c=""+a;c!==this._stringText&&(this._stringText=c,f.BackendIDOperations.updateTextContentByID(this._rootNodeID,c))}},unmountComponent:function(){e.unmountIDFromEnvironment(this._rootNodeID)}}),b.exports=i},{11:11,114:114,27:27,35:35,42:42}],52:[function(a,b,c){"use strict";function d(){this.isMounted()&&this.forceUpdate()}var e=a(2),f=a(11),g=a(24),h=a(29),i=a(33),j=a(55),k=a(85),l=a(27),m=a(133),n=(a(150),j.createFactory("textarea")),o=i.createClass({displayName:"ReactDOMTextarea",tagName:"TEXTAREA",mixins:[e,g.Mixin,h],getInitialState:function(){var a=this.props.defaultValue,b=this.props.children;null!=b&&(m(null==a),Array.isArray(b)&&(m(b.length<=1),b=b[0]),a=""+b),null==a&&(a="");var c=g.getValue(this);return{initialValue:""+(null!=c?c:a)}},render:function(){var a=l({},this.props);return m(null==a.dangerouslySetInnerHTML),a.defaultValue=null,a.value=null,a.onChange=this._handleChange,n(a,this.state.initialValue)},componentDidUpdate:function(a,b,c){var d=g.getValue(this);if(null!=d){var e=this.getDOMNode();f.setValueForProperty(e,"value",""+d)}},_handleChange:function(a){var b,c=g.getOnChange(this);return c&&(b=c.call(this,a)),k.asap(d,this),b}});b.exports=o},{11:11,133:133,150:150,2:2,24:24,27:27,
29:29,33:33,55:55,85:85}],53:[function(a,b,c){"use strict";function d(){this.reinitializeTransaction()}var e=a(85),f=a(101),g=a(27),h=a(112),i={initialize:h,close:function(){m.isBatchingUpdates=!1}},j={initialize:h,close:e.flushBatchedUpdates.bind(e)},k=[j,i];g(d.prototype,f.Mixin,{getTransactionWrappers:function(){return k}});var l=new d,m={isBatchingUpdates:!1,batchedUpdates:function(a,b,c,d,e){var f=m.isBatchingUpdates;m.isBatchingUpdates=!0,f?a(b,c,d,e):l.perform(a,null,b,c,d,e)}};b.exports=m},{101:101,112:112,27:27,85:85}],54:[function(a,b,c){"use strict";function d(a){return o.createClass({tagName:a.toUpperCase(),render:function(){return new C(a,null,null,null,null,this.props)}})}function e(){E.EventEmitter.injectReactEventListener(D),E.EventPluginHub.injectEventPluginOrder(i),E.EventPluginHub.injectInstanceHandle(F),E.EventPluginHub.injectMount(G),E.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:K,EnterLeaveEventPlugin:j,ChangeEventPlugin:g,MobileSafariClickEventPlugin:m,SelectEventPlugin:I,BeforeInputEventPlugin:f}),E.NativeComponent.injectGenericComponentClass(r),E.NativeComponent.injectTextComponentClass(B),E.NativeComponent.injectAutoWrapper(d),E.Class.injectMixin(n),E.NativeComponent.injectComponentClasses({button:s,form:t,iframe:w,img:u,input:x,option:y,select:z,textarea:A,html:M("html"),head:M("head"),body:M("body")}),E.DOMProperty.injectDOMPropertyConfig(l),E.DOMProperty.injectDOMPropertyConfig(L),E.EmptyComponent.injectEmptyComponent("noscript"),E.Updates.injectReconcileTransaction(H),E.Updates.injectBatchingStrategy(q),E.RootIndex.injectCreateReactRootIndex(k.canUseDOM?h.createReactRootIndex:J.createReactRootIndex),E.Component.injectEnvironment(p),E.DOMComponent.injectIDOperations(v)}var f=a(3),g=a(7),h=a(8),i=a(13),j=a(14),k=a(21),l=a(23),m=a(26),n=a(29),o=a(33),p=a(35),q=a(53),r=a(42),s=a(41),t=a(43),u=a(46),v=a(44),w=a(45),x=a(47),y=a(48),z=a(49),A=a(52),B=a(51),C=a(55),D=a(60),E=a(62),F=a(64),G=a(68),H=a(78),I=a(87),J=a(88),K=a(89),L=a(86),M=a(109);b.exports={inject:e}},{109:109,13:13,14:14,21:21,23:23,26:26,29:29,3:3,33:33,35:35,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,51:51,52:52,53:53,55:55,60:60,62:62,64:64,68:68,7:7,78:78,8:8,86:86,87:87,88:88,89:89}],55:[function(a,b,c){"use strict";var d=a(38),e=a(39),f=a(27),g=(a(150),{key:!0,ref:!0}),h=function(a,b,c,d,e,f){this.type=a,this.key=b,this.ref=c,this._owner=d,this._context=e,this.props=f};h.prototype={_isReactElement:!0},h.createElement=function(a,b,c){var f,i={},j=null,k=null;if(null!=b){k=void 0===b.ref?null:b.ref,j=void 0===b.key?null:""+b.key;for(f in b)b.hasOwnProperty(f)&&!g.hasOwnProperty(f)&&(i[f]=b[f])}var l=arguments.length-2;if(1===l)i.children=c;else if(l>1){for(var m=Array(l),n=0;l>n;n++)m[n]=arguments[n+2];i.children=m}if(a&&a.defaultProps){var o=a.defaultProps;for(f in o)void 0===i[f]&&(i[f]=o[f])}return new h(a,j,k,e.current,d.current,i)},h.createFactory=function(a){var b=h.createElement.bind(null,a);return b.type=a,b},h.cloneAndReplaceProps=function(a,b){return new h(a.type,a.key,a.ref,a._owner,a._context,b)},h.cloneElement=function(a,b,c){var d,i=f({},a.props),j=a.key,k=a.ref,l=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,l=e.current),void 0!==b.key&&(j=""+b.key);for(d in b)b.hasOwnProperty(d)&&!g.hasOwnProperty(d)&&(i[d]=b[d])}var m=arguments.length-2;if(1===m)i.children=c;else if(m>1){for(var n=Array(m),o=0;m>o;o++)n[o]=arguments[o+2];i.children=n}return new h(a.type,j,k,l,a._context,i)},h.isValidElement=function(a){return!(!a||!a._isReactElement)},b.exports=h},{150:150,27:27,38:38,39:39}],56:[function(a,b,c){"use strict";function d(){if(s.current){var a=s.current.getName();if(a)return" Check the render method of `"+a+"`."}return""}function e(a){var b=a&&a.getPublicInstance();if(b){var c=b.constructor;return c?c.displayName||c.name||void 0:void 0}}function f(){var a=s.current;return a&&e(a)||void 0}function g(a,b){a._store.validated||null!=a.key||(a._store.validated=!0,i('Each child in an array or iterator should have a unique "key" prop.',a,b))}function h(a,b,c){y.test(a)&&i("Child objects should have non-numeric keys so ordering is preserved.",b,c)}function i(a,b,c){var d=f(),g="string"==typeof c?c:c.displayName||c.name,h=d||g,i=w[a]||(w[a]={});if(!i.hasOwnProperty(h)){i[h]=!0;if(b&&b._owner&&b._owner!==s.current){" It was passed a child from "+e(b._owner)+"."}}}function j(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++){var d=a[c];p.isValidElement(d)&&g(d,b)}else if(p.isValidElement(a))a._store.validated=!0;else if(a){var e=u(a);if(e){if(e!==a.entries)for(var f,i=e.call(a);!(f=i.next()).done;)p.isValidElement(f.value)&&g(f.value,b)}else if("object"==typeof a){var j=q.extractIfFragment(a);for(var k in j)j.hasOwnProperty(k)&&h(k,j[k],b)}}}function k(a,b,c,e){for(var f in b)if(b.hasOwnProperty(f)){var g;try{v("function"==typeof b[f]),g=b[f](c,f,a,e)}catch(a){g=a}g instanceof Error&&!(g.message in x)&&(x[g.message]=!0,d(this))}}function l(a,b){var c=b.type,d="string"==typeof c?c:c.displayName,e=b._owner?b._owner.getPublicInstance().constructor.displayName:null,f=a+"|"+d+"|"+e;if(!z.hasOwnProperty(f)){z[f]=!0;d&&" <"+d+" />";e&&" The element was created by "+e+"."}}function m(a,b){return a!==a?b!==b:0===a&&0===b?1/a==1/b:a===b}function n(a){if(a._store){var b=a._store.originalProps,c=a.props;for(var d in c)c.hasOwnProperty(d)&&(b.hasOwnProperty(d)&&m(b[d],c[d])||(l(d,a),b[d]=c[d]))}}function o(a){if(null!=a.type){var b=t.getComponentClassForElement(a),c=b.displayName||b.name;b.propTypes&&k(c,b.propTypes,a.props,r.prop),b.getDefaultProps}}var p=a(55),q=a(61),r=a(75),s=(a(74),a(39)),t=a(71),u=a(124),v=a(133),w=(a(150),{}),x={},y=/^\d+$/,z={},A={checkAndWarnForMutatedProps:n,createElement:function(a,b,c){var d=p.createElement.apply(this,arguments);if(null==d)return d;for(var e=2;e<arguments.length;e++)j(arguments[e],a);return o(d),d},createFactory:function(a){var b=A.createElement.bind(null,a);return b.type=a,b},cloneElement:function(a,b,c){for(var d=p.cloneElement.apply(this,arguments),e=2;e<arguments.length;e++)j(arguments[e],d.type);return o(d),d}};b.exports=A},{124:124,133:133,150:150,39:39,55:55,61:61,71:71,74:74,75:75}],57:[function(a,b,c){"use strict";function d(a){k[a]=!0}function e(a){delete k[a]}function f(a){return!!k[a]}var g,h=a(55),i=a(65),j=a(133),k={},l={injectEmptyComponent:function(a){g=h.createFactory(a)}},m=function(){};m.prototype.componentDidMount=function(){var a=i.get(this);a&&d(a._rootNodeID)},m.prototype.componentWillUnmount=function(){var a=i.get(this);a&&e(a._rootNodeID)},m.prototype.render=function(){return j(g),g()};var n=h.createElement(m),o={emptyElement:n,injection:l,isNullComponentID:f};b.exports=o},{133:133,55:55,65:65}],58:[function(a,b,c){"use strict";var d={guard:function(a,b){return a}};b.exports=d},{}],59:[function(a,b,c){"use strict";function d(a){e.enqueueEvents(a),e.processEventQueue()}var e=a(17),f={handleTopLevel:function(a,b,c,f){d(e.extractEvents(a,b,c,f))}};b.exports=f},{17:17}],60:[function(a,b,c){"use strict";function d(a){var b=l.getID(a),c=k.getReactRootIDFromNodeID(b),d=l.findReactContainerForID(c);return l.getFirstReactDOM(d)}function e(a,b){this.topLevelType=a,this.nativeEvent=b,this.ancestors=[]}function f(a){for(var b=l.getFirstReactDOM(o(a.nativeEvent))||window,c=b;c;)a.ancestors.push(c),c=d(c);for(var e=0,f=a.ancestors.length;f>e;e++){b=a.ancestors[e];var g=l.getID(b)||"";q._handleTopLevel(a.topLevelType,b,g,a.nativeEvent)}}function g(a){a(p(window))}var h=a(16),i=a(21),j=a(28),k=a(64),l=a(68),m=a(85),n=a(27),o=a(123),p=a(129);n(e.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),j.addPoolingTo(e,j.twoArgumentPooler);var q={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:i.canUseDOM?window:null,setHandleTopLevel:function(a){q._handleTopLevel=a},setEnabled:function(a){q._enabled=!!a},isEnabled:function(){return q._enabled},trapBubbledEvent:function(a,b,c){var d=c;return d?h.listen(d,b,q.dispatchEvent.bind(null,a)):null},trapCapturedEvent:function(a,b,c){var d=c;return d?h.capture(d,b,q.dispatchEvent.bind(null,a)):null},monitorScrollValue:function(a){var b=g.bind(null,a);h.listen(window,"scroll",b)},dispatchEvent:function(a,b){if(q._enabled){var c=e.getPooled(a,b);try{m.batchedUpdates(f,c)}finally{e.release(c)}}}};b.exports=q},{123:123,129:129,16:16,21:21,27:27,28:28,64:64,68:68,85:85}],61:[function(a,b,c){"use strict";var d=(a(55),a(150),{create:function(a){return a},extract:function(a){return a},extractIfFragment:function(a){return a}});b.exports=d},{150:150,55:55}],62:[function(a,b,c){"use strict";var d=a(10),e=a(17),f=a(36),g=a(33),h=a(57),i=a(30),j=a(71),k=a(42),l=a(73),m=a(81),n=a(85),o={Component:f.injection,Class:g.injection,DOMComponent:k.injection,DOMProperty:d.injection,EmptyComponent:h.injection,EventPluginHub:e.injection,EventEmitter:i.injection,NativeComponent:j.injection,Perf:l.injection,RootIndex:m.injection,Updates:n.injection};b.exports=o},{10:10,17:17,30:30,33:33,36:36,42:42,57:57,71:71,73:73,81:81,85:85}],63:[function(a,b,c){"use strict";function d(a){return f(document.documentElement,a)}var e=a(50),f=a(107),g=a(117),h=a(119),i={hasSelectionCapabilities:function(a){return a&&("INPUT"===a.nodeName&&"text"===a.type||"TEXTAREA"===a.nodeName||"true"===a.contentEditable)},getSelectionInformation:function(){var a=h();return{focusedElem:a,selectionRange:i.hasSelectionCapabilities(a)?i.getSelection(a):null}},restoreSelection:function(a){var b=h(),c=a.focusedElem,e=a.selectionRange;b!==c&&d(c)&&(i.hasSelectionCapabilities(c)&&i.setSelection(c,e),g(c))},getSelection:function(a){var b;if("selectionStart"in a)b={start:a.selectionStart,end:a.selectionEnd};else if(document.selection&&"INPUT"===a.nodeName){var c=document.selection.createRange();c.parentElement()===a&&(b={start:-c.moveStart("character",-a.value.length),end:-c.moveEnd("character",-a.value.length)})}else b=e.getOffsets(a);return b||{start:0,end:0}},setSelection:function(a,b){var c=b.start,d=b.end;if(void 0===d&&(d=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(d,a.value.length);else if(document.selection&&"INPUT"===a.nodeName){var f=a.createTextRange();f.collapse(!0),f.moveStart("character",c),f.moveEnd("character",d-c),f.select()}else e.setOffsets(a,b)}};b.exports=i},{107:107,117:117,119:119,50:50}],64:[function(a,b,c){"use strict";function d(a){return n+a.toString(36)}function e(a,b){return a.charAt(b)===n||b===a.length}function f(a){return""===a||a.charAt(0)===n&&a.charAt(a.length-1)!==n}function g(a,b){return 0===b.indexOf(a)&&e(b,a.length)}function h(a){return a?a.substr(0,a.lastIndexOf(n)):""}function i(a,b){if(m(f(a)&&f(b)),m(g(a,b)),a===b)return a;var c,d=a.length+o;for(c=d;c<b.length&&!e(b,c);c++);return b.substr(0,c)}function j(a,b){var c=Math.min(a.length,b.length);if(0===c)return"";for(var d=0,g=0;c>=g;g++)if(e(a,g)&&e(b,g))d=g;else if(a.charAt(g)!==b.charAt(g))break;var h=a.substr(0,d);return m(f(h)),h}function k(a,b,c,d,e,f){a=a||"",b=b||"",m(a!==b);var j=g(b,a);m(j||g(a,b));for(var k=0,l=j?h:i,n=a;;n=l(n,b)){var o;if(e&&n===a||f&&n===b||(o=c(n,j,d)),!1===o||n===b)break;m(k++<p)}}var l=a(81),m=a(133),n=".",o=n.length,p=100,q={createReactRootID:function(){return d(l.createReactRootIndex())},createReactID:function(a,b){return a+b},getReactRootIDFromNodeID:function(a){if(a&&a.charAt(0)===n&&a.length>1){var b=a.indexOf(n,1);return b>-1?a.substr(0,b):a}return null},traverseEnterLeave:function(a,b,c,d,e){var f=j(a,b);f!==a&&k(a,f,c,d,!1,!0),f!==b&&k(f,b,c,e,!0,!1)},traverseTwoPhase:function(a,b,c){a&&(k("",a,b,c,!0,!1),k(a,"",b,c,!1,!0))},traverseAncestors:function(a,b,c){k("",a,b,c,!0,!1)},_getFirstCommonAncestorID:j,_getNextDescendantID:i,isAncestorIDOf:g,SEPARATOR:n};b.exports=q},{133:133,81:81}],65:[function(a,b,c){"use strict";var d={remove:function(a){a._reactInternalInstance=void 0},get:function(a){return a._reactInternalInstance},has:function(a){return void 0!==a._reactInternalInstance},set:function(a,b){a._reactInternalInstance=b}};b.exports=d},{}],66:[function(a,b,c){"use strict";var d={currentlyMountingInstance:null,currentlyUnmountingInstance:null};b.exports=d},{}],67:[function(a,b,c){"use strict";var d=a(104),e={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(a){var b=d(a);return a.replace(">"," "+e.CHECKSUM_ATTR_NAME+'="'+b+'">')},canReuseMarkup:function(a,b){var c=b.getAttribute(e.CHECKSUM_ATTR_NAME);return c=c&&parseInt(c,10),d(a)===c}};b.exports=e},{104:104}],68:[function(a,b,c){"use strict";function d(a,b){for(var c=Math.min(a.length,b.length),d=0;c>d;d++)if(a.charAt(d)!==b.charAt(d))return d;return a.length===b.length?-1:c}function e(a){var b=D(a);return b&&P.getID(b)}function f(a){var b=g(a);if(b)if(K.hasOwnProperty(b)){var c=K[b];c!==a&&(F(!k(c,b)),K[b]=a)}else K[b]=a;return b}function g(a){return a&&a.getAttribute&&a.getAttribute(J)||""}function h(a,b){var c=g(a);c!==b&&delete K[c],a.setAttribute(J,b),K[b]=a}function i(a){return K.hasOwnProperty(a)&&k(K[a],a)||(K[a]=P.findReactNodeByID(a)),K[a]}function j(a){var b=v.get(a)._rootNodeID;return t.isNullComponentID(b)?null:(K.hasOwnProperty(b)&&k(K[b],b)||(K[b]=P.findReactNodeByID(b)),K[b])}function k(a,b){if(a){F(g(a)===b);var c=P.findReactContainerForID(b);if(c&&C(c,a))return!0}return!1}function l(a){delete K[a]}function m(a){var b=K[a];return!(!b||!k(b,a))&&void(O=b)}function n(a){O=null,u.traverseAncestors(a,m);var b=O;return O=null,b}function o(a,b,c,d,e){var f=y.mountComponent(a,b,d,B);a._isTopLevel=!0,P._mountImageIntoNode(f,c,e)}function p(a,b,c,d){var e=A.ReactReconcileTransaction.getPooled();e.perform(o,null,a,b,c,e,d),A.ReactReconcileTransaction.release(e)}var q=a(10),r=a(30),s=(a(39),a(55)),t=(a(56),a(57)),u=a(64),v=a(65),w=a(67),x=a(73),y=a(79),z=a(84),A=a(85),B=a(113),C=a(107),D=a(127),E=a(132),F=a(133),G=a(144),H=a(147),I=(a(150),u.SEPARATOR),J=q.ID_ATTRIBUTE_NAME,K={},L={},M={},N=[],O=null,P={_instancesByReactRootID:L,scrollMonitor:function(a,b){b()},_updateRootComponent:function(a,b,c,d){return P.scrollMonitor(c,function(){z.enqueueElementInternal(a,b),d&&z.enqueueCallbackInternal(a,d)}),a},_registerComponent:function(a,b){F(b&&(1===b.nodeType||9===b.nodeType)),r.ensureScrollValueMonitoring();var c=P.registerContainer(b);return L[c]=a,c},_renderNewRootComponent:function(a,b,c){var d=E(a,null),e=P._registerComponent(d,b);return A.batchedUpdates(p,d,e,b,c),d},render:function(a,b,c){F(s.isValidElement(a));var d=L[e(b)];if(d){var f=d._currentElement;if(H(f,a))return P._updateRootComponent(d,a,b,c).getPublicInstance();P.unmountComponentAtNode(b)}var g=D(b),h=g&&P.isRenderedByReact(g),i=h&&!d,j=P._renderNewRootComponent(a,b,i).getPublicInstance();return c&&c.call(j),j},constructAndRenderComponent:function(a,b,c){var d=s.createElement(a,b);return P.render(d,c)},constructAndRenderComponentByID:function(a,b,c){var d=document.getElementById(c);return F(d),P.constructAndRenderComponent(a,b,d)},registerContainer:function(a){var b=e(a);return b&&(b=u.getReactRootIDFromNodeID(b)),b||(b=u.createReactRootID()),M[b]=a,b},unmountComponentAtNode:function(a){F(a&&(1===a.nodeType||9===a.nodeType));var b=e(a),c=L[b];return!!c&&(P.unmountComponentFromNode(c,a),delete L[b],delete M[b],!0)},unmountComponentFromNode:function(a,b){for(y.unmountComponent(a),9===b.nodeType&&(b=b.documentElement);b.lastChild;)b.removeChild(b.lastChild)},findReactContainerForID:function(a){var b=u.getReactRootIDFromNodeID(a);return M[b]},findReactNodeByID:function(a){var b=P.findReactContainerForID(a);return P.findComponentRoot(b,a)},isRenderedByReact:function(a){if(1!==a.nodeType)return!1;var b=P.getID(a);return!!b&&b.charAt(0)===I},getFirstReactDOM:function(a){for(var b=a;b&&b.parentNode!==b;){if(P.isRenderedByReact(b))return b;b=b.parentNode}return null},findComponentRoot:function(a,b){var c=N,d=0,e=n(b)||a;for(c[0]=e.firstChild,c.length=1;d<c.length;){for(var f,g=c[d++];g;){var h=P.getID(g);h?b===h?f=g:u.isAncestorIDOf(h,b)&&(c.length=d=0,c.push(g.firstChild)):c.push(g.firstChild),g=g.nextSibling}if(f)return c.length=0,f}c.length=0,F(!1)},_mountImageIntoNode:function(a,b,c){if(F(b&&(1===b.nodeType||9===b.nodeType)),c){var e=D(b);if(w.canReuseMarkup(a,e))return;var f=e.getAttribute(w.CHECKSUM_ATTR_NAME);e.removeAttribute(w.CHECKSUM_ATTR_NAME);var g=e.outerHTML;e.setAttribute(w.CHECKSUM_ATTR_NAME,f);var h=d(a,g);a.substring(h-20,h+20),g.substring(h-20,h+20),F(9!==b.nodeType)}F(9!==b.nodeType),G(b,a)},getReactRootID:e,getID:f,setID:h,getNode:i,getNodeFromInstance:j,purgeID:l};x.measureMethods(P,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),b.exports=P},{10:10,107:107,113:113,127:127,132:132,133:133,144:144,147:147,150:150,30:30,39:39,55:55,56:56,57:57,64:64,65:65,67:67,73:73,79:79,84:84,85:85}],69:[function(a,b,c){"use strict";function d(a,b,c){o.push({parentID:a,parentNode:null,type:k.INSERT_MARKUP,markupIndex:p.push(b)-1,textContent:null,fromIndex:null,toIndex:c})}function e(a,b,c){o.push({parentID:a,parentNode:null,type:k.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:b,toIndex:c})}function f(a,b){o.push({parentID:a,parentNode:null,type:k.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:b,toIndex:null})}function g(a,b){o.push({parentID:a,parentNode:null,type:k.TEXT_CONTENT,markupIndex:null,textContent:b,fromIndex:null,toIndex:null})}function h(){o.length&&(j.processChildrenUpdates(o,p),i())}function i(){o.length=0,p.length=0}var j=a(36),k=a(70),l=a(79),m=a(31),n=0,o=[],p=[],q={Mixin:{mountChildren:function(a,b,c){var d=m.instantiateChildren(a,b,c);this._renderedChildren=d;var e=[],f=0;for(var g in d)if(d.hasOwnProperty(g)){var h=d[g],i=this._rootNodeID+g,j=l.mountComponent(h,i,b,c);h._mountIndex=f,e.push(j),f++}return e},updateTextContent:function(a){n++;var b=!0;try{var c=this._renderedChildren;m.unmountChildren(c);for(var d in c)c.hasOwnProperty(d)&&this._unmountChildByName(c[d],d);this.setTextContent(a),b=!1}finally{--n||(b?i():h())}},updateChildren:function(a,b,c){n++;var d=!0;try{this._updateChildren(a,b,c),d=!1}finally{--n||(d?i():h())}},_updateChildren:function(a,b,c){var d=this._renderedChildren,e=m.updateChildren(d,a,b,c);if(this._renderedChildren=e,e||d){var f,g=0,h=0;for(f in e)if(e.hasOwnProperty(f)){var i=d&&d[f],j=e[f];i===j?(this.moveChild(i,h,g),g=Math.max(i._mountIndex,g),i._mountIndex=h):(i&&(g=Math.max(i._mountIndex,g),this._unmountChildByName(i,f)),this._mountChildByNameAtIndex(j,f,h,b,c)),h++}for(f in d)!d.hasOwnProperty(f)||e&&e.hasOwnProperty(f)||this._unmountChildByName(d[f],f)}},unmountChildren:function(){var a=this._renderedChildren;m.unmountChildren(a),this._renderedChildren=null},moveChild:function(a,b,c){a._mountIndex<c&&e(this._rootNodeID,a._mountIndex,b)},createChild:function(a,b){d(this._rootNodeID,b,a._mountIndex)},removeChild:function(a){f(this._rootNodeID,a._mountIndex)},setTextContent:function(a){g(this._rootNodeID,a)},_mountChildByNameAtIndex:function(a,b,c,d,e){var f=this._rootNodeID+b,g=l.mountComponent(a,f,d,e);a._mountIndex=c,this.createChild(a,g)},_unmountChildByName:function(a,b){this.removeChild(a),a._mountIndex=null}}};b.exports=q},{31:31,36:36,70:70,79:79}],70:[function(a,b,c){"use strict";var d=a(138),e=d({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});b.exports=e},{138:138}],71:[function(a,b,c){"use strict";function d(a){if("function"==typeof a.type)return a.type;var b=a.type,c=l[b];return null==c&&(l[b]=c=j(b)),c}function e(a){return i(k),new k(a.type,a.props)}function f(a){return new m(a)}function g(a){return a instanceof m}var h=a(27),i=a(133),j=null,k=null,l={},m=null,n={injectGenericComponentClass:function(a){k=a},injectTextComponentClass:function(a){m=a},injectComponentClasses:function(a){h(l,a)},injectAutoWrapper:function(a){j=a}},o={getComponentClassForElement:d,createInternalComponent:e,createInstanceForText:f,isTextComponent:g,injection:n};b.exports=o},{133:133,27:27}],72:[function(a,b,c){"use strict";var d=a(133),e={isValidOwner:function(a){return!(!a||"function"!=typeof a.attachRef||"function"!=typeof a.detachRef)},addComponentAsRefTo:function(a,b,c){d(e.isValidOwner(c)),c.attachRef(b,a)},removeComponentAsRefFrom:function(a,b,c){d(e.isValidOwner(c)),c.getPublicInstance().refs[b]===a.getPublicInstance()&&c.detachRef(b)}};b.exports=e},{133:133}],73:[function(a,b,c){"use strict";function d(a,b,c){return c}var e={enableMeasure:!1,storedMeasure:d,measureMethods:function(a,b,c){},measure:function(a,b,c){return c},injection:{injectMeasure:function(a){e.storedMeasure=a}}};b.exports=e},{}],74:[function(a,b,c){"use strict";var d={};b.exports=d},{}],75:[function(a,b,c){"use strict";var d=a(138),e=d({prop:null,context:null,childContext:null});b.exports=e},{138:138}],76:[function(a,b,c){"use strict";function d(a){function b(b,c,d,e,f){if(e=e||s,null==c[d]){var g=q[f];return b?new Error("Required "+g+" `"+d+"` was not specified in `"+e+"`."):null}return a(c,d,e,f)}var c=b.bind(null,!1);return c.isRequired=b.bind(null,!0),c}function e(a){function b(b,c,d,e){var f=b[c];if(m(f)!==a){var g=q[e],h=n(f);return new Error("Invalid "+g+" `"+c+"` of type `"+h+"` supplied to `"+d+"`, expected `"+a+"`.")}return null}return d(b)}function f(a){function b(b,c,d,e){var f=b[c];if(!Array.isArray(f)){var g=q[e],h=m(f);return new Error("Invalid "+g+" `"+c+"` of type `"+h+"` supplied to `"+d+"`, expected an array.")}for(var i=0;i<f.length;i++){var j=a(f,i,d,e);if(j instanceof Error)return j}return null}return d(b)}function g(a){function b(b,c,d,e){if(!(b[c]instanceof a)){var f=q[e],g=a.name||s;return new Error("Invalid "+f+" `"+c+"` supplied to `"+d+"`, expected instance of `"+g+"`.")}return null}return d(b)}function h(a){function b(b,c,d,e){for(var f=b[c],g=0;g<a.length;g++)if(f===a[g])return null;var h=q[e],i=JSON.stringify(a);return new Error("Invalid "+h+" `"+c+"` of value `"+f+"` supplied to `"+d+"`, expected one of "+i+".")}return d(b)}function i(a){function b(b,c,d,e){var f=b[c],g=m(f);if("object"!==g){var h=q[e];return new Error("Invalid "+h+" `"+c+"` of type `"+g+"` supplied to `"+d+"`, expected an object.")}for(var i in f)if(f.hasOwnProperty(i)){var j=a(f,i,d,e);if(j instanceof Error)return j}return null}return d(b)}function j(a){function b(b,c,d,e){for(var f=0;f<a.length;f++){if(null==(0,a[f])(b,c,d,e))return null}var g=q[e];return new Error("Invalid "+g+" `"+c+"` supplied to `"+d+"`.")}return d(b)}function k(a){function b(b,c,d,e){var f=b[c],g=m(f);if("object"!==g){var h=q[e];return new Error("Invalid "+h+" `"+c+"` of type `"+g+"` supplied to `"+d+"`, expected `object`.")}for(var i in a){var j=a[i];if(j){var k=j(f,i,d,e);if(k)return k}}return null}return d(b)}function l(a){switch(typeof a){case"number":case"string":case"undefined":return!0;case"boolean":return!a;case"object":if(Array.isArray(a))return a.every(l);if(null===a||o.isValidElement(a))return!0;a=p.extractIfFragment(a);for(var b in a)if(!l(a[b]))return!1;return!0;default:return!1}}function m(a){var b=typeof a;return Array.isArray(a)?"array":a instanceof RegExp?"object":b}function n(a){var b=m(a);if("object"===b){if(a instanceof Date)return"date";if(a instanceof RegExp)return"regexp"}return b}var o=a(55),p=a(61),q=a(74),r=a(112),s="<<anonymous>>",t=function(){function a(a,b,c,d){if(!o.isValidElement(a[b])){var e=q[d];return new Error("Invalid "+e+" `"+b+"` supplied to `"+c+"`, expected a ReactElement.")}return null}return d(a)}(),u=function(){function a(a,b,c,d){if(!l(a[b])){var e=q[d];return new Error("Invalid "+e+" `"+b+"` supplied to `"+c+"`, expected a ReactNode.")}return null}return d(a)}(),v={array:e("array"),bool:e("boolean"),func:e("function"),number:e("number"),object:e("object"),string:e("string"),any:function(){return d(r.thatReturns(null))}(),arrayOf:f,element:t,instanceOf:g,node:u,objectOf:i,oneOf:h,oneOfType:j,shape:k};b.exports=v},{112:112,55:55,61:61,74:74}],77:[function(a,b,c){"use strict";function d(){this.listenersToPut=[]}var e=a(28),f=a(30);a(27)(d.prototype,{enqueuePutListener:function(a,b,c){this.listenersToPut.push({rootNodeID:a,propKey:b,propValue:c})},putListeners:function(){for(var a=0;a<this.listenersToPut.length;a++){var b=this.listenersToPut[a];f.putListener(b.rootNodeID,b.propKey,b.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),e.addPoolingTo(d),b.exports=d},{27:27,28:28,30:30}],78:[function(a,b,c){"use strict";function d(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=e.getPooled(null),this.putListenerQueue=i.getPooled()}var e=a(6),f=a(28),g=a(30),h=a(63),i=a(77),j=a(101),k=a(27),l={initialize:h.getSelectionInformation,close:h.restoreSelection},m={initialize:function(){var a=g.isEnabled();return g.setEnabled(!1),a},close:function(a){g.setEnabled(a)}},n={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},o={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},p=[o,l,m,n],q={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){e.release(this.reactMountReady),this.reactMountReady=null,i.release(this.putListenerQueue),this.putListenerQueue=null}};k(d.prototype,j.Mixin,q),f.addPoolingTo(d),b.exports=d},{101:101,27:27,28:28,30:30,6:6,63:63,77:77}],79:[function(a,b,c){"use strict";function d(){e.attachRefs(this,this._currentElement)}var e=a(80),f=(a(56),{mountComponent:function(a,b,c,e){var f=a.mountComponent(b,c,e);return c.getReactMountReady().enqueue(d,a),f},unmountComponent:function(a){e.detachRefs(a,a._currentElement),a.unmountComponent()},receiveComponent:function(a,b,c,f){var g=a._currentElement;if(b!==g||null==b._owner){var h=e.shouldUpdateRefs(g,b);h&&e.detachRefs(a,g),a.receiveComponent(b,c,f),h&&c.getReactMountReady().enqueue(d,a)}},performUpdateIfNecessary:function(a,b){a.performUpdateIfNecessary(b)}});b.exports=f},{56:56,80:80}],80:[function(a,b,c){"use strict";function d(a,b,c){"function"==typeof a?a(b.getPublicInstance()):f.addComponentAsRefTo(b,a,c)}function e(a,b,c){"function"==typeof a?a(null):f.removeComponentAsRefFrom(b,a,c)}var f=a(72),g={};g.attachRefs=function(a,b){var c=b.ref;null!=c&&d(c,a,b._owner)},g.shouldUpdateRefs=function(a,b){return b._owner!==a._owner||b.ref!==a.ref},g.detachRefs=function(a,b){var c=b.ref;null!=c&&e(c,a,b._owner)},b.exports=g},{72:72}],81:[function(a,b,c){"use strict";var d={injectCreateReactRootIndex:function(a){e.createReactRootIndex=a}},e={createReactRootIndex:null,injection:d};b.exports=e},{}],82:[function(a,b,c){"use strict";function d(a){l(f.isValidElement(a));var b;try{var c=g.createReactRootID();return b=i.getPooled(!1),b.perform(function(){var d=k(a,null),e=d.mountComponent(c,b,j);return h.addChecksumToMarkup(e)},null)}finally{i.release(b)}}function e(a){l(f.isValidElement(a));var b;try{var c=g.createReactRootID();return b=i.getPooled(!0),b.perform(function(){return k(a,null).mountComponent(c,b,j)},null)}finally{i.release(b)}}var f=a(55),g=a(64),h=a(67),i=a(83),j=a(113),k=a(132),l=a(133);b.exports={renderToString:d,renderToStaticMarkup:e}},{113:113,132:132,133:133,55:55,64:64,67:67,83:83}],83:[function(a,b,c){"use strict";function d(a){this.reinitializeTransaction(),this.renderToStaticMarkup=a,this.reactMountReady=f.getPooled(null),this.putListenerQueue=g.getPooled()}var e=a(28),f=a(6),g=a(77),h=a(101),i=a(27),j=a(112),k={initialize:function(){this.reactMountReady.reset()},close:j},l={initialize:function(){this.putListenerQueue.reset()},close:j},m=[l,k],n={getTransactionWrappers:function(){return m},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){f.release(this.reactMountReady),this.reactMountReady=null,g.release(this.putListenerQueue),this.putListenerQueue=null}};i(d.prototype,h.Mixin,n),e.addPoolingTo(d),b.exports=d},{101:101,112:112,27:27,28:28,6:6,77:77}],84:[function(a,b,c){"use strict";function d(a){a!==f.currentlyMountingInstance&&j.enqueueUpdate(a)}function e(a,b){l(null==g.current);var c=i.get(a);return c?c===f.currentlyUnmountingInstance?null:c:null}var f=a(66),g=a(39),h=a(55),i=a(65),j=a(85),k=a(27),l=a(133),m=(a(150),{enqueueCallback:function(a,b){l("function"==typeof b);var c=e(a);return c&&c!==f.currentlyMountingInstance?(c._pendingCallbacks?c._pendingCallbacks.push(b):c._pendingCallbacks=[b],void d(c)):null},enqueueCallbackInternal:function(a,b){l("function"==typeof b),a._pendingCallbacks?a._pendingCallbacks.push(b):a._pendingCallbacks=[b],d(a)},enqueueForceUpdate:function(a){var b=e(a,"forceUpdate");b&&(b._pendingForceUpdate=!0,d(b))},enqueueReplaceState:function(a,b){var c=e(a,"replaceState");c&&(c._pendingStateQueue=[b],c._pendingReplaceState=!0,d(c))},enqueueSetState:function(a,b){var c=e(a,"setState");if(c){(c._pendingStateQueue||(c._pendingStateQueue=[])).push(b),d(c)}},enqueueSetProps:function(a,b){var c=e(a,"setProps");if(c){l(c._isTopLevel);var f=c._pendingElement||c._currentElement,g=k({},f.props,b);c._pendingElement=h.cloneAndReplaceProps(f,g),d(c)}},enqueueReplaceProps:function(a,b){var c=e(a,"replaceProps");if(c){l(c._isTopLevel);var f=c._pendingElement||c._currentElement;c._pendingElement=h.cloneAndReplaceProps(f,b),d(c)}},enqueueElementInternal:function(a,b){a._pendingElement=b,d(a)}});b.exports=m},{133:133,150:150,27:27,39:39,55:55,65:65,66:66,85:85}],85:[function(a,b,c){"use strict";function d(){q(A.ReactReconcileTransaction&&u)}function e(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=k.getPooled(),this.reconcileTransaction=A.ReactReconcileTransaction.getPooled()}function f(a,b,c,e,f){d(),u.batchedUpdates(a,b,c,e,f)}function g(a,b){return a._mountOrder-b._mountOrder}function h(a){var b=a.dirtyComponentsLength;q(b===r.length),r.sort(g);for(var c=0;b>c;c++){var d=r[c],e=d._pendingCallbacks;if(d._pendingCallbacks=null,n.performUpdateIfNecessary(d,a.reconcileTransaction),e)for(var f=0;f<e.length;f++)a.callbackQueue.enqueue(e[f],d.getPublicInstance())}}function i(a){return d(),u.isBatchingUpdates?void r.push(a):void u.batchedUpdates(i,a)}function j(a,b){q(u.isBatchingUpdates),s.enqueue(a,b),t=!0}var k=a(6),l=a(28),m=(a(39),a(73)),n=a(79),o=a(101),p=a(27),q=a(133),r=(a(150),[]),s=k.getPooled(),t=!1,u=null,v={initialize:function(){this.dirtyComponentsLength=r.length},close:function(){this.dirtyComponentsLength!==r.length?(r.splice(0,this.dirtyComponentsLength),y()):r.length=0}},w={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},x=[v,w];p(e.prototype,o.Mixin,{getTransactionWrappers:function(){return x},destructor:function(){this.dirtyComponentsLength=null,k.release(this.callbackQueue),this.callbackQueue=null,A.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(a,b,c){return o.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,a,b,c)}}),l.addPoolingTo(e);var y=function(){for(;r.length||t;){if(r.length){var a=e.getPooled();a.perform(h,null,a),e.release(a)}if(t){t=!1;var b=s;s=k.getPooled(),b.notifyAll(),k.release(b)}}};y=m.measure("ReactUpdates","flushBatchedUpdates",y);var z={injectReconcileTransaction:function(a){q(a),A.ReactReconcileTransaction=a},injectBatchingStrategy:function(a){q(a),q("function"==typeof a.batchedUpdates),q("boolean"==typeof a.isBatchingUpdates),u=a}},A={ReactReconcileTransaction:null,batchedUpdates:f,enqueueUpdate:i,flushBatchedUpdates:y,injection:z,asap:j};b.exports=A},{101:101,133:133,150:150,27:27,28:28,39:39,6:6,73:73,79:79}],86:[function(a,b,c){"use strict";var d=a(10),e=d.injection.MUST_USE_ATTRIBUTE,f={Properties:{clipPath:e,cx:e,cy:e,d:e,dx:e,dy:e,fill:e,fillOpacity:e,fontFamily:e,fontSize:e,fx:e,fy:e,gradientTransform:e,gradientUnits:e,markerEnd:e,markerMid:e,markerStart:e,offset:e,opacity:e,patternContentUnits:e,patternUnits:e,points:e,preserveAspectRatio:e,r:e,
rx:e,ry:e,spreadMethod:e,stopColor:e,stopOpacity:e,stroke:e,strokeDasharray:e,strokeLinecap:e,strokeOpacity:e,strokeWidth:e,textAnchor:e,transform:e,version:e,viewBox:e,x1:e,x2:e,x:e,y1:e,y2:e,y:e},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};b.exports=f},{10:10}],87:[function(a,b,c){"use strict";function d(a){if("selectionStart"in a&&h.hasSelectionCapabilities(a))return{start:a.selectionStart,end:a.selectionEnd};if(window.getSelection){var b=window.getSelection();return{anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}}if(document.selection){var c=document.selection.createRange();return{parentElement:c.parentElement(),text:c.text,top:c.boundingTop,left:c.boundingLeft}}}function e(a){if(s||null==p||p!==j())return null;var b=d(p);if(!r||!m(r,b)){r=b;var c=i.getPooled(o.select,q,a);return c.type="select",c.target=p,g.accumulateTwoPhaseDispatches(c),c}}var f=a(15),g=a(20),h=a(63),i=a(93),j=a(119),k=a(136),l=a(139),m=a(146),n=f.topLevelTypes,o={select:{phasedRegistrationNames:{bubbled:l({onSelect:null}),captured:l({onSelectCapture:null})},dependencies:[n.topBlur,n.topContextMenu,n.topFocus,n.topKeyDown,n.topMouseDown,n.topMouseUp,n.topSelectionChange]}},p=null,q=null,r=null,s=!1,t={eventTypes:o,extractEvents:function(a,b,c,d){switch(a){case n.topFocus:(k(b)||"true"===b.contentEditable)&&(p=b,q=c,r=null);break;case n.topBlur:p=null,q=null,r=null;break;case n.topMouseDown:s=!0;break;case n.topContextMenu:case n.topMouseUp:return s=!1,e(d);case n.topSelectionChange:case n.topKeyDown:case n.topKeyUp:return e(d)}}};b.exports=t},{119:119,136:136,139:139,146:146,15:15,20:20,63:63,93:93}],88:[function(a,b,c){"use strict";var d=Math.pow(2,53),e={createReactRootIndex:function(){return Math.ceil(Math.random()*d)}};b.exports=e},{}],89:[function(a,b,c){"use strict";var d=a(15),e=a(19),f=a(20),g=a(90),h=a(93),i=a(94),j=a(96),k=a(97),l=a(92),m=a(98),n=a(99),o=a(100),p=a(120),q=a(133),r=a(139),s=(a(150),d.topLevelTypes),t={blur:{phasedRegistrationNames:{bubbled:r({onBlur:!0}),captured:r({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:r({onClick:!0}),captured:r({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:r({onContextMenu:!0}),captured:r({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:r({onCopy:!0}),captured:r({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:r({onCut:!0}),captured:r({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:r({onDoubleClick:!0}),captured:r({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:r({onDrag:!0}),captured:r({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:r({onDragEnd:!0}),captured:r({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:r({onDragEnter:!0}),captured:r({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:r({onDragExit:!0}),captured:r({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:r({onDragLeave:!0}),captured:r({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:r({onDragOver:!0}),captured:r({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:r({onDragStart:!0}),captured:r({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:r({onDrop:!0}),captured:r({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:r({onFocus:!0}),captured:r({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:r({onInput:!0}),captured:r({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:r({onKeyDown:!0}),captured:r({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:r({onKeyPress:!0}),captured:r({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:r({onKeyUp:!0}),captured:r({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:r({onLoad:!0}),captured:r({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:r({onError:!0}),captured:r({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:r({onMouseDown:!0}),captured:r({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:r({onMouseMove:!0}),captured:r({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:r({onMouseOut:!0}),captured:r({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:r({onMouseOver:!0}),captured:r({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:r({onMouseUp:!0}),captured:r({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:r({onPaste:!0}),captured:r({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:r({onReset:!0}),captured:r({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:r({onScroll:!0}),captured:r({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:r({onSubmit:!0}),captured:r({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:r({onTouchCancel:!0}),captured:r({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:r({onTouchEnd:!0}),captured:r({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:r({onTouchMove:!0}),captured:r({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:r({onTouchStart:!0}),captured:r({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:r({onWheel:!0}),captured:r({onWheelCapture:!0})}}},u={topBlur:t.blur,topClick:t.click,topContextMenu:t.contextMenu,topCopy:t.copy,topCut:t.cut,topDoubleClick:t.doubleClick,topDrag:t.drag,topDragEnd:t.dragEnd,topDragEnter:t.dragEnter,topDragExit:t.dragExit,topDragLeave:t.dragLeave,topDragOver:t.dragOver,topDragStart:t.dragStart,topDrop:t.drop,topError:t.error,topFocus:t.focus,topInput:t.input,topKeyDown:t.keyDown,topKeyPress:t.keyPress,topKeyUp:t.keyUp,topLoad:t.load,topMouseDown:t.mouseDown,topMouseMove:t.mouseMove,topMouseOut:t.mouseOut,topMouseOver:t.mouseOver,topMouseUp:t.mouseUp,topPaste:t.paste,topReset:t.reset,topScroll:t.scroll,topSubmit:t.submit,topTouchCancel:t.touchCancel,topTouchEnd:t.touchEnd,topTouchMove:t.touchMove,topTouchStart:t.touchStart,topWheel:t.wheel};for(var v in u)u[v].dependencies=[v];var w={eventTypes:t,executeDispatch:function(a,b,c){!1===e.executeDispatch(a,b,c)&&(a.stopPropagation(),a.preventDefault())},extractEvents:function(a,b,c,d){var e=u[a];if(!e)return null;var r;switch(a){case s.topInput:case s.topLoad:case s.topError:case s.topReset:case s.topSubmit:r=h;break;case s.topKeyPress:if(0===p(d))return null;case s.topKeyDown:case s.topKeyUp:r=j;break;case s.topBlur:case s.topFocus:r=i;break;case s.topClick:if(2===d.button)return null;case s.topContextMenu:case s.topDoubleClick:case s.topMouseDown:case s.topMouseMove:case s.topMouseOut:case s.topMouseOver:case s.topMouseUp:r=k;break;case s.topDrag:case s.topDragEnd:case s.topDragEnter:case s.topDragExit:case s.topDragLeave:case s.topDragOver:case s.topDragStart:case s.topDrop:r=l;break;case s.topTouchCancel:case s.topTouchEnd:case s.topTouchMove:case s.topTouchStart:r=m;break;case s.topScroll:r=n;break;case s.topWheel:r=o;break;case s.topCopy:case s.topCut:case s.topPaste:r=g}q(r);var t=r.getPooled(e,c,d);return f.accumulateTwoPhaseDispatches(t),t}};b.exports=w},{100:100,120:120,133:133,139:139,15:15,150:150,19:19,20:20,90:90,92:92,93:93,94:94,96:96,97:97,98:98,99:99}],90:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(93),f={clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}};e.augmentClass(d,f),b.exports=d},{93:93}],91:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(93),f={data:null};e.augmentClass(d,f),b.exports=d},{93:93}],92:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(97),f={dataTransfer:null};e.augmentClass(d,f),b.exports=d},{97:97}],93:[function(a,b,c){"use strict";function d(a,b,c){this.dispatchConfig=a,this.dispatchMarker=b,this.nativeEvent=c;var d=this.constructor.Interface;for(var e in d)if(d.hasOwnProperty(e)){var f=d[e];this[e]=f?f(c):c[e]}var h=null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue;this.isDefaultPrevented=h?g.thatReturnsTrue:g.thatReturnsFalse,this.isPropagationStopped=g.thatReturnsFalse}var e=a(28),f=a(27),g=a(112),h=a(123),i={type:null,target:h,currentTarget:g.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};f(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a.preventDefault?a.preventDefault():a.returnValue=!1,this.isDefaultPrevented=g.thatReturnsTrue},stopPropagation:function(){var a=this.nativeEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this.isPropagationStopped=g.thatReturnsTrue},persist:function(){this.isPersistent=g.thatReturnsTrue},isPersistent:g.thatReturnsFalse,destructor:function(){var a=this.constructor.Interface;for(var b in a)this[b]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),d.Interface=i,d.augmentClass=function(a,b){var c=this,d=Object.create(c.prototype);f(d,a.prototype),a.prototype=d,a.prototype.constructor=a,a.Interface=f({},c.Interface,b),a.augmentClass=c.augmentClass,e.addPoolingTo(a,e.threeArgumentPooler)},e.addPoolingTo(d,e.threeArgumentPooler),b.exports=d},{112:112,123:123,27:27,28:28}],94:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(99),f={relatedTarget:null};e.augmentClass(d,f),b.exports=d},{99:99}],95:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(93),f={data:null};e.augmentClass(d,f),b.exports=d},{93:93}],96:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(99),f=a(120),g=a(121),h=a(122),i={key:g,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:h,charCode:function(a){return"keypress"===a.type?f(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===a.type?f(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}};e.augmentClass(d,i),b.exports=d},{120:120,121:121,122:122,99:99}],97:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(99),f=a(102),g=a(122),h={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:g,button:function(a){var b=a.button;return"which"in a?b:2===b?2:4===b?1:0},buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},pageX:function(a){return"pageX"in a?a.pageX:a.clientX+f.currentScrollLeft},pageY:function(a){return"pageY"in a?a.pageY:a.clientY+f.currentScrollTop}};e.augmentClass(d,h),b.exports=d},{102:102,122:122,99:99}],98:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(99),f=a(122),g={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:f};e.augmentClass(d,g),b.exports=d},{122:122,99:99}],99:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(93),f=a(123),g={view:function(a){if(a.view)return a.view;var b=f(a);if(null!=b&&b.window===b)return b;var c=b.ownerDocument;return c?c.defaultView||c.parentWindow:window},detail:function(a){return a.detail||0}};e.augmentClass(d,g),b.exports=d},{123:123,93:93}],100:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,a,b,c)}var e=a(97),f={deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null};e.augmentClass(d,f),b.exports=d},{97:97}],101:[function(a,b,c){"use strict";var d=a(133),e={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(a,b,c,e,f,g,h,i){d(!this.isInTransaction());var j,k;try{this._isInTransaction=!0,j=!0,this.initializeAll(0),k=a.call(b,c,e,f,g,h,i),j=!1}finally{try{if(j)try{this.closeAll(0)}catch(a){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return k},initializeAll:function(a){for(var b=this.transactionWrappers,c=a;c<b.length;c++){var d=b[c];try{this.wrapperInitData[c]=f.OBSERVED_ERROR,this.wrapperInitData[c]=d.initialize?d.initialize.call(this):null}finally{if(this.wrapperInitData[c]===f.OBSERVED_ERROR)try{this.initializeAll(c+1)}catch(a){}}}},closeAll:function(a){d(this.isInTransaction());for(var b=this.transactionWrappers,c=a;c<b.length;c++){var e,g=b[c],h=this.wrapperInitData[c];try{e=!0,h!==f.OBSERVED_ERROR&&g.close&&g.close.call(this,h),e=!1}finally{if(e)try{this.closeAll(c+1)}catch(a){}}}this.wrapperInitData.length=0}},f={Mixin:e,OBSERVED_ERROR:{}};b.exports=f},{133:133}],102:[function(a,b,c){"use strict";var d={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(a){d.currentScrollLeft=a.x,d.currentScrollTop=a.y}};b.exports=d},{}],103:[function(a,b,c){"use strict";function d(a,b){if(e(null!=b),null==a)return b;var c=Array.isArray(a),d=Array.isArray(b);return c&&d?(a.push.apply(a,b),a):c?(a.push(b),a):d?[a].concat(b):[a,b]}var e=a(133);b.exports=d},{133:133}],104:[function(a,b,c){"use strict";function d(a){for(var b=1,c=0,d=0;d<a.length;d++)b=(b+a.charCodeAt(d))%e,c=(c+b)%e;return b|c<<16}var e=65521;b.exports=d},{}],105:[function(a,b,c){function d(a){return a.replace(e,function(a,b){return b.toUpperCase()})}var e=/-(.)/g;b.exports=d},{}],106:[function(a,b,c){"use strict";function d(a){return e(a.replace(f,"ms-"))}var e=a(105),f=/^-ms-/;b.exports=d},{105:105}],107:[function(a,b,c){function d(a,b){return!(!a||!b)&&(a===b||!e(a)&&(e(b)?d(a,b.parentNode):a.contains?a.contains(b):!!a.compareDocumentPosition&&!!(16&a.compareDocumentPosition(b))))}var e=a(137);b.exports=d},{137:137}],108:[function(a,b,c){function d(a){return!!a&&("object"==typeof a||"function"==typeof a)&&"length"in a&&!("setInterval"in a)&&"number"!=typeof a.nodeType&&(Array.isArray(a)||"callee"in a||"item"in a)}function e(a){return d(a)?Array.isArray(a)?a.slice():f(a):[a]}var f=a(148);b.exports=e},{148:148}],109:[function(a,b,c){"use strict";function d(a){var b=f.createFactory(a);return e.createClass({tagName:a.toUpperCase(),displayName:"ReactFullPageComponent"+a,componentWillUnmount:function(){g(!1)},render:function(){return b(this.props)}})}var e=a(33),f=a(55),g=a(133);b.exports=d},{133:133,33:33,55:55}],110:[function(a,b,c){function d(a){var b=a.match(k);return b&&b[1].toLowerCase()}function e(a,b){var c=j;i(!!j);var e=d(a),f=e&&h(e);if(f){c.innerHTML=f[1]+a+f[2];for(var k=f[0];k--;)c=c.lastChild}else c.innerHTML=a;var l=c.getElementsByTagName("script");l.length&&(i(b),g(l).forEach(b));for(var m=g(c.childNodes);c.lastChild;)c.removeChild(c.lastChild);return m}var f=a(21),g=a(108),h=a(125),i=a(133),j=f.canUseDOM?document.createElement("div"):null,k=/^\s*<(\w+)/;b.exports=e},{108:108,125:125,133:133,21:21}],111:[function(a,b,c){"use strict";function d(a,b){return null==b||"boolean"==typeof b||""===b?"":isNaN(b)||0===b||f.hasOwnProperty(a)&&f[a]?""+b:("string"==typeof b&&(b=b.trim()),b+"px")}var e=a(4),f=e.isUnitlessNumber;b.exports=d},{4:4}],112:[function(a,b,c){function d(a){return function(){return a}}function e(){}e.thatReturns=d,e.thatReturnsFalse=d(!1),e.thatReturnsTrue=d(!0),e.thatReturnsNull=d(null),e.thatReturnsThis=function(){return this},e.thatReturnsArgument=function(a){return a},b.exports=e},{}],113:[function(a,b,c){"use strict";var d={};b.exports=d},{}],114:[function(a,b,c){"use strict";function d(a){return f[a]}function e(a){return(""+a).replace(g,d)}var f={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},g=/[&><"']/g;b.exports=e},{}],115:[function(a,b,c){"use strict";function d(a){return null==a?null:h(a)?a:e.has(a)?f.getNodeFromInstance(a):(g(null==a.render||"function"!=typeof a.render),void g(!1))}var e=(a(39),a(65)),f=a(68),g=a(133),h=a(135);a(150),b.exports=d},{133:133,135:135,150:150,39:39,65:65,68:68}],116:[function(a,b,c){"use strict";function d(a,b,c){var d=a;!d.hasOwnProperty(c)&&null!=b&&(d[c]=b)}function e(a){if(null==a)return a;var b={};return f(a,d,b),b}var f=a(149);a(150),b.exports=e},{149:149,150:150}],117:[function(a,b,c){"use strict";function d(a){try{a.focus()}catch(a){}}b.exports=d},{}],118:[function(a,b,c){"use strict";var d=function(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)};b.exports=d},{}],119:[function(a,b,c){function d(){try{return document.activeElement||document.body}catch(a){return document.body}}b.exports=d},{}],120:[function(a,b,c){"use strict";function d(a){var b,c=a.keyCode;return"charCode"in a?0===(b=a.charCode)&&13===c&&(b=13):b=c,b>=32||13===b?b:0}b.exports=d},{}],121:[function(a,b,c){"use strict";function d(a){if(a.key){var b=f[a.key]||a.key;if("Unidentified"!==b)return b}if("keypress"===a.type){var c=e(a);return 13===c?"Enter":String.fromCharCode(c)}return"keydown"===a.type||"keyup"===a.type?g[a.keyCode]||"Unidentified":""}var e=a(120),f={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};b.exports=d},{120:120}],122:[function(a,b,c){"use strict";function d(a){var b=this,c=b.nativeEvent;if(c.getModifierState)return c.getModifierState(a);var d=f[a];return!!d&&!!c[d]}function e(a){return d}var f={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};b.exports=e},{}],123:[function(a,b,c){"use strict";function d(a){var b=a.target||a.srcElement||window;return 3===b.nodeType?b.parentNode:b}b.exports=d},{}],124:[function(a,b,c){"use strict";function d(a){var b=a&&(e&&a[e]||a[f]);return"function"==typeof b?b:void 0}var e="function"==typeof Symbol&&Symbol.iterator,f="@@iterator";b.exports=d},{}],125:[function(a,b,c){function d(a){return f(!!g),m.hasOwnProperty(a)||(a="*"),h.hasOwnProperty(a)||(g.innerHTML="*"===a?"<link />":"<"+a+"></"+a+">",h[a]=!g.firstChild),h[a]?m[a]:null}var e=a(21),f=a(133),g=e.canUseDOM?document.createElement("div"):null,h={circle:!0,clipPath:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},i=[1,'<select multiple="true">',"</select>"],j=[1,"<table>","</table>"],k=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],m={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:i,option:i,caption:j,colgroup:j,tbody:j,tfoot:j,thead:j,td:k,th:k,circle:l,clipPath:l,defs:l,ellipse:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};b.exports=d},{133:133,21:21}],126:[function(a,b,c){"use strict";function d(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function e(a){for(;a;){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}function f(a,b){for(var c=d(a),f=0,g=0;c;){if(3===c.nodeType){if(g=f+c.textContent.length,b>=f&&g>=b)return{node:c,offset:b-f};f=g}c=d(e(c))}}b.exports=f},{}],127:[function(a,b,c){"use strict";function d(a){return a?a.nodeType===e?a.documentElement:a.firstChild:null}var e=9;b.exports=d},{}],128:[function(a,b,c){"use strict";function d(){return!f&&e.canUseDOM&&(f="textContent"in document.documentElement?"textContent":"innerText"),f}var e=a(21),f=null;b.exports=d},{21:21}],129:[function(a,b,c){"use strict";function d(a){return a===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:a.scrollLeft,y:a.scrollTop}}b.exports=d},{}],130:[function(a,b,c){function d(a){return a.replace(e,"-$1").toLowerCase()}var e=/([A-Z])/g;b.exports=d},{}],131:[function(a,b,c){"use strict";function d(a){return e(a).replace(f,"-ms-")}var e=a(130),f=/^ms-/;b.exports=d},{130:130}],132:[function(a,b,c){"use strict";function d(a){return"function"==typeof a&&void 0!==a.prototype&&"function"==typeof a.prototype.mountComponent&&"function"==typeof a.prototype.receiveComponent}function e(a,b){var c;if((null===a||!1===a)&&(a=g.emptyElement),"object"==typeof a){var e=a;c=b===e.type&&"string"==typeof e.type?h.createInternalComponent(e):d(e.type)?new e.type(e):new k}else"string"==typeof a||"number"==typeof a?c=h.createInstanceForText(a):j(!1);return c.construct(a),c._mountIndex=0,c._mountImage=null,c}var f=a(37),g=a(57),h=a(71),i=a(27),j=a(133),k=(a(150),function(){});i(k.prototype,f.Mixin,{_instantiateReactComponent:e}),b.exports=e},{133:133,150:150,27:27,37:37,57:57,71:71}],133:[function(a,b,c){"use strict";var d=function(a,b,c,d,e,f,g,h){if(!a){var i;if(void 0===b)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var j=[c,d,e,f,g,h],k=0;i=new Error("Invariant Violation: "+b.replace(/%s/g,function(){return j[k++]}))}throw i.framesToPop=1,i}};b.exports=d},{}],134:[function(a,b,c){"use strict";function d(a,b){if(!f.canUseDOM||b&&!("addEventListener"in document))return!1;var c="on"+a,d=c in document;if(!d){var g=document.createElement("div");g.setAttribute(c,"return;"),d="function"==typeof g[c]}return!d&&e&&"wheel"===a&&(d=document.implementation.hasFeature("Events.wheel","3.0")),d}var e,f=a(21);f.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),b.exports=d},{21:21}],135:[function(a,b,c){function d(a){return!(!a||!("function"==typeof Node?a instanceof Node:"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName))}b.exports=d},{}],136:[function(a,b,c){"use strict";function d(a){return a&&("INPUT"===a.nodeName&&e[a.type]||"TEXTAREA"===a.nodeName)}var e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};b.exports=d},{}],137:[function(a,b,c){function d(a){return e(a)&&3==a.nodeType}var e=a(135);b.exports=d},{135:135}],138:[function(a,b,c){"use strict";var d=a(133),e=function(a){var b,c={};d(a instanceof Object&&!Array.isArray(a));for(b in a)a.hasOwnProperty(b)&&(c[b]=b);return c};b.exports=e},{133:133}],139:[function(a,b,c){var d=function(a){var b;for(b in a)if(a.hasOwnProperty(b))return b;return null};b.exports=d},{}],140:[function(a,b,c){"use strict";function d(a,b,c){if(!a)return null;var d={};for(var f in a)e.call(a,f)&&(d[f]=b.call(c,a[f],f,a));return d}var e=Object.prototype.hasOwnProperty;b.exports=d},{}],141:[function(a,b,c){"use strict";function d(a){var b={};return function(c){return b.hasOwnProperty(c)||(b[c]=a.call(this,c)),b[c]}}b.exports=d},{}],142:[function(a,b,c){"use strict";function d(a){return f(e.isValidElement(a)),a}var e=a(55),f=a(133);b.exports=d},{133:133,55:55}],143:[function(a,b,c){"use strict";function d(a){return'"'+e(a)+'"'}var e=a(114);b.exports=d},{114:114}],144:[function(a,b,c){"use strict";var d=a(21),e=/^[ \r\n\t\f]/,f=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,g=function(a,b){a.innerHTML=b};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(g=function(a,b){MSApp.execUnsafeLocalFunction(function(){a.innerHTML=b})}),d.canUseDOM){var h=document.createElement("div");h.innerHTML=" ",""===h.innerHTML&&(g=function(a,b){if(a.parentNode&&a.parentNode.replaceChild(a,a),e.test(b)||"<"===b[0]&&f.test(b)){a.innerHTML="\ufeff"+b;var c=a.firstChild;1===c.data.length?a.removeChild(c):c.deleteData(0,1)}else a.innerHTML=b})}b.exports=g},{21:21}],145:[function(a,b,c){"use strict";var d=a(21),e=a(114),f=a(144),g=function(a,b){a.textContent=b};d.canUseDOM&&("textContent"in document.documentElement||(g=function(a,b){f(a,e(b))})),b.exports=g},{114:114,144:144,21:21}],146:[function(a,b,c){"use strict";function d(a,b){if(a===b)return!0;var c;for(c in a)if(a.hasOwnProperty(c)&&(!b.hasOwnProperty(c)||a[c]!==b[c]))return!1;for(c in b)if(b.hasOwnProperty(c)&&!a.hasOwnProperty(c))return!1;return!0}b.exports=d},{}],147:[function(a,b,c){"use strict";function d(a,b){if(null!=a&&null!=b){var c=typeof a,d=typeof b;if("string"===c||"number"===c)return"string"===d||"number"===d;if("object"===d&&a.type===b.type&&a.key===b.key){return a._owner===b._owner}}return!1}a(150),b.exports=d},{150:150}],148:[function(a,b,c){function d(a){var b=a.length;if(e(!Array.isArray(a)&&("object"==typeof a||"function"==typeof a)),e("number"==typeof b),e(0===b||b-1 in a),a.hasOwnProperty)try{return Array.prototype.slice.call(a)}catch(a){}for(var c=Array(b),d=0;b>d;d++)c[d]=a[d];return c}var e=a(133);b.exports=d},{133:133}],149:[function(a,b,c){"use strict";function d(a){return q[a]}function e(a,b){return a&&null!=a.key?g(a.key):b.toString(36)}function f(a){return(""+a).replace(r,d)}function g(a){return"$"+f(a)}function h(a,b,c,d,f){var i=typeof a;if(("undefined"===i||"boolean"===i)&&(a=null),null===a||"string"===i||"number"===i||j.isValidElement(a))return d(f,a,""===b?o+e(a,0):b,c),1;var l,q,r,s=0;if(Array.isArray(a))for(var t=0;t<a.length;t++)l=a[t],q=(""!==b?b+p:o)+e(l,t),r=c+s,s+=h(l,q,r,d,f);else{var u=m(a);if(u){var v,w=u.call(a);if(u!==a.entries)for(var x=0;!(v=w.next()).done;)l=v.value,q=(""!==b?b+p:o)+e(l,x++),r=c+s,s+=h(l,q,r,d,f);else for(;!(v=w.next()).done;){var y=v.value;y&&(l=y[1],q=(""!==b?b+p:o)+g(y[0])+p+e(l,0),r=c+s,s+=h(l,q,r,d,f))}}else if("object"===i){n(1!==a.nodeType);var z=k.extract(a);for(var A in z)z.hasOwnProperty(A)&&(l=z[A],q=(""!==b?b+p:o)+g(A)+p+e(l,0),r=c+s,s+=h(l,q,r,d,f))}}return s}function i(a,b,c){return null==a?0:h(a,"",0,b,c)}var j=a(55),k=a(61),l=a(64),m=a(124),n=a(133),o=(a(150),l.SEPARATOR),p=":",q={"=":"=0",".":"=1",":":"=2"},r=/[=.:]/g;b.exports=i},{124:124,133:133,150:150,55:55,61:61,64:64}],150:[function(a,b,c){"use strict";var d=a(112),e=d;b.exports=e},{112:112}]},{},[1])(1)}),define("castle-url/patterns/querystring/widgets/string",["castle-url/libs/react/react.min"],function(a){"use strict";var b=a.DOM;return a.createClass({render:function(){return b.input({type:"text",onChange:this.props.onChange,value:this.props.value,className:"querystring-criteria-value-StringWidget form-control"})}})}),define("castle-url/patterns/querystring/widgets/select2",["jquery","castle-url/libs/react/react.min"],function(a,b){"use strict";var c=b.DOM;return b.createClass({getInitialState:function(){return{renderedValue:this.props.value,renderedOptions:this.props.options}},getDefaultProps:function(){return{value:"",width:"10em",multiple:!1}},componentDidMount:function(){this.load()},load:function(){var b=this,c=a(this.refs.select.getDOMNode());c.select2(),c.on("change",function(){b.props.onChange&&b.props.onChange.call(b,{target:{value:c.select2("val")}})}),this.props.value?c.select2("val",this.props.value):c.select2("val",""),b.state.renderedValue=this.props.value,b.state.renderedOptions=this.props.options},componentDidUpdate:function(){var b=this,c=a(this.refs.select.getDOMNode());JSON.stringify(b.state.renderedOptions)!==JSON.stringify(this.props.options)?(c.select2("destroy"),this.load()):b.state.renderedValue!==this.props.value&&(c.select2("val",b.props.value),b.state.renderedValue=this.props.value)},render:function(){var a=[],b={};this.props.options.forEach(function(d){var e=c.option({value:d.value},d.label);d.group?(b[d.group]||(b[d.group]=[]),b[d.group].push(e)):a.push(e)});for(var d in b)a.push(c.optgroup({label:d},b[d]));return c.select({ref:"select",value:this.props.value,style:{width:this.props.width},multiple:this.props.multiple},a)}})}),define("castle-url/patterns/querystring/widgets/multipleselection",["castle-url/libs/react/react.min","castle-url/patterns/querystring/widgets/select2"],function(a,b){"use strict";return a.createClass({render:function(){var c=[];for(var d in this.props.index.values){var e=this.props.index.values[d].title;c.push({value:d,label:e})}return a.createElement(b,{onChange:this.props.onChange,value:this.props.value,options:c,multiple:!0})}})}),define("castle-url/patterns/querystring/widgets/relativedate",["jquery","castle-url/libs/react/react.min"],function(a,b){"use strict";var c=b.DOM;return b.createClass({onKeyDown:function(a){if(-1===[8,9,13,27].indexOf(a.charCode||a.keyCode)){var b=String.fromCharCode(a.charCode||a.keyCode);isNaN(b)&&a.preventDefault()}},render:function(){return c.input({type:"number",value:this.props.value,onChange:this.props.onChange,onKeyDown:this.onKeyDown,className:"querystring-criteria-value-RelativeDateWidget"})}})}),define("castle-url/patterns/querystring/widgets/daterange",["jquery","castle-url/libs/react/react.min","mockup-patterns-pickadate"],function(a,b,c){"use strict";var d=b.DOM;return b.createClass({getInitialState:function(){return{value:["",""]}},componentDidMount:function(){var b=this,d=a(this.refs.input1.getDOMNode());this.props.pickadate1=new c(d,{time:!1});var e=a(this.refs.input2.getDOMNode());this.props.pickadate2=new c(e,{time:!1}),this.props.pickadate1.on("updated.pickadate.patterns",function(){b.props.value||(b.props.value=["",""]),b.props.value[0]=d.val(),b.pushChange()}),this.props.pickadate2.on("updated.pickadate.patterns",function(){b.props.value||(b.props.value=["",""]),b.props.value[1]=e.val(),b.pushChange()})},componentDidUpdate:function(){var b=this,c=a(this.refs.input1.getDOMNode()).parent().find(".pattern-pickadate-date"),d=a(this.refs.input2.getDOMNode()).parent().find(".pattern-pickadate-date");b.props.value||(b.props.value=["",""]),this.props.value[0]?c.pickadate("select",this.props.value[0]):c.pickadate("clear"),this.props.value[1]?d.pickadate("select",this.props.value[1]):d.pickadate("clear")},pushChange:function(){this.props.onChange.call(this,{target:{value:this.props.value,force:!0}},!0)},render:function(){var a=this.props.value;return a&&a[0]&&a[1]||(a=["",""]),d.div({className:"querystring-date-range"},[d.span({className:"querystring-date-wrapper"},d.input({className:"pat-pickadate",ref:"input1",value:a[0]})),d.span({className:"querystring-criteria-betweendt"},"to"),d.span({className:"querystring-date-wrapper"},d.input({className:"pat-pickadate",ref:"input2",value:a[1]}))])}})}),define("castle-url/patterns/querystring/widgets/date",["jquery","castle-url/libs/react/react.min","mockup-patterns-pickadate"],function(a,b,c){"use strict";var d=b.DOM;return b.createClass({componentDidMount:function(){var b=this,d=a(b.refs.input.getDOMNode());new c(d,{time:!1}).on("updated.pickadate.patterns",function(){b.props.onChange.call(b,{target:{value:d.val()}})})},componentDidUpdate:function(){var b=a(this.refs.input.getDOMNode()).parent().find(".pattern-pickadate-date");this.props.value?b.pickadate("select",this.props.value):b.pickadate("clear")},render:function(){return d.input({className:"pat-pickadate",ref:"input",value:this.props.value})}})}),
define("castle-url/components/utils",["jquery","castle-url/libs/react/react.min"],function(a,b){"use strict";var c=function(a,c){var e=[];a.forEach(function(a){a.original_class?e.push(a.original_class):e.push(a)});var f=[!0,{}].concat(e);f.push(c);var g=d.apply(null,f),h=b.createClass(g);return h.original_class=g,h},d=function(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a},e=function(a,c,d){void 0===d&&(d={});var e=document.getElementById(c);e&&e.parentNode.removeChild(e);var f=document.createElement("div");return f.id=c,f.className="component-wrapper",document.body.appendChild(f),d.parent||(d.parent=this),b.render(b.createElement(a,d),f)},f=function(c,d,e){return function(f){if(void 0===e&&(e={}),d){var g=d(f);if("function"==typeof g)return g(function(d){return e=a.extend({},!0,d,e),b.render(b.createElement(c,e),f)});e=a.extend({},!0,g,e)}return b.render(b.createElement(c,e),f)}};return{Class:c,createModalComponent:e,extend:d,BindComponentFactory:f,BindComponentFactoryRoot:function(b,c,d){return function(e){a("#"+d).remove();var g=a('<div id="'+d+'" class="component-wrapper" />');return a("body").append(g),f(b,c,e)(g[0])}},getToolbarSettings:function(){var b=a(".pat-castletoolbar,.castletoolbar-settings");return b.length>0?JSON.parse(b.attr("data-pat-castletoolbar")):{}}}}),define("castle-url/patterns/querystring/widgets/reference",["jquery","castle-url/libs/react/react.min","mockup-utils","castle-url/components/utils"],function(a,b,c,d){"use strict";var e=b.DOM;return b.createClass({getDefaultProps:function(){return{value:""}},getDepth:function(){var a=this.props.value;return a?-1===a.indexOf("::")?-1:a.split("::")[1]:-1},getPath:function(){var a=this.props.value;return a?-1===a.indexOf("::")?a:a.split("::")[0]:""},browseClicked:function(b){var e=this;b.preventDefault();var f=JSON.parse(a("body").attr("data-pat-tinymce")),g=new c.QueryHelper({vocabularyUrl:f.relatedItems.vocabularyUrl,batchSize:30,sort_on:"getObjPositionInParent",sort_order:"ascending",attributes:["UID","Title","portal_type","path","review_state","is_folderish"]});g.pattern.browsing=!0,g.currentPath="/";var h=require("castle-url/components/content-browser");d.BindComponentFactoryRoot(h,function(){return{onSelectItem:function(a){e.props.onChange({target:{value:a.path+"::"+e.getDepth()}}),e.props.value=a.path+"::"+e.getDepth()},query:g,multiple:!1}},"content-browser-react-container")({}),a("#content-browser-react-container").off("click").on("click",function(){var b=a("#popover-structure-query.active");b.length>0&&setTimeout(function(){b.parent().find(".input-group-btn a").trigger("click")},10)})},depthChange:function(a){var b=this,c=a.target.value;b.props.onChange({target:{value:b.getPath()+"::"+c}}),b.props.value=b.getPath()+"::"+c},render:function(){var a=this,b="";a.getPath()&&(b=e.span({},[e.b({},"Selected: "),a.getPath()]));var c=[e.option({value:"-1"},"Unlimited")];return[0,1,2,3,4,5].forEach(function(a){c.push(e.option({value:a},a))}),e.div({className:"querystring-reference-widget"},[b,e.button({className:"plone-btn plone-btn-default plone-btn-xs",onClick:this.browseClicked},"Browse"),e.div({className:"depth-select-box form-group"},[e.label({htmlFor:"depth-select"},"Depth"),e.select({name:"depth-select",onChange:this.depthChange,value:this.getDepth(),className:"querystring-criteria-depth form-control"},c)])])}})}),define("castle-url/patterns/querystring/widgets/relativepath",["jquery","castle-url/libs/react/react.min"],function(a,b){"use strict";var c=b.DOM;return b.createClass({render:function(){return c.div({className:"querystring-relative-path"},[c.select({onChange:this.props.onChange,value:this.props.value,className:"form-control"},[c.option({value:""},"Select"),c.option({value:"../::1"},"Parent"),c.option({value:"./::1"},"Current")])])}})}),define("castle-url/patterns/querystring/criteria",["jquery","castle-url/libs/react/react.min","castle-url/patterns/querystring/widgets/string","castle-url/patterns/querystring/widgets/multipleselection","castle-url/patterns/querystring/widgets/relativedate","castle-url/patterns/querystring/widgets/daterange","castle-url/patterns/querystring/widgets/date","castle-url/patterns/querystring/widgets/reference","castle-url/patterns/querystring/widgets/relativepath","castle-url/patterns/querystring/widgets/select2"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=b.DOM;return b.createClass({widgets:{StringWidget:c,MultipleSelectionWidget:d,RelativeDateWidget:e,DateRangeWidget:f,DateWidget:g,ReferenceWidget:h,RelativePathWidget:i},getDefaultProps:function(){return{indexWidth:"20em",classWrapperName:"querystring-criteria-wrapper",classIndexName:"querystring-criteria-index",classOperatorName:"querystring-criteria-operator",classValueName:"querystring-criteria-value",classRemoveName:"querystring-criteria-remove",classResultsName:"querystring-criteria-results",classClearName:"querystring-criteria-clear",i:null,o:null,v:"",idx:-1}},indexSelected:function(a){var b=this.props.parent.props.indexes,c=b[a.target.value];this.props.storage.dispatcher.handleViewAction({actionType:"updateCriteria",idx:this.props.idx,data:{i:a.target.value,o:c.operations[0],v:""}})},operatorSelected:function(a){this.props.storage.dispatcher.handleViewAction({actionType:"updateCriteria",idx:this.props.idx,data:{o:a.target.value,v:""}})},valueChanged:function(a,b){this.props.storage.dispatcher.handleViewAction({actionType:"updateCriteria",idx:this.props.idx,data:{v:a.target.value},force:b})},removeClicked:function(){this.props.storage.dispatcher.handleViewAction({actionType:"removeCriteria",idx:this.props.idx})},render:function(){return k.div({className:this.props.classWrapperName},[k.div({className:this.props.classRemoveName,onClick:this.removeClicked}),this.renderIndexSelector(),this.renderOperatorSelector(),this.renderValueSelector(),k.div({className:"querystring-criteria-clear"})])},renderValueSelector:function(){var a=this,c=a.props.parent.props.indexes;if(!a.props.i||!a.props.o)return"";var d=c[a.props.i],e=d.operators[a.props.o];if(null===e.widget)return"";var f=b.createElement(this.widgets[e.widget],{index:d,operator:e,value:this.props.v,onChange:this.valueChanged});return k.div({className:this.props.classValueName,key:this.props.idx+e.widget},f)},renderOperatorSelector:function(){var a=this,c=a.props.parent.props.indexes;if(!a.props.i)return"";var d=c[a.props.i],e=[];return d.operations.forEach(function(a){var b=d.operators[a];e.push({value:a,label:b.title})}),k.div({className:this.props.classOperatorName},b.createElement(j,{onChange:this.operatorSelected,options:e,parent:this,value:this.props.o}))},renderIndexSelector:function(){var a=[{value:"",label:"Select criteria"}];for(var c in this.props.parent.props.indexes){var d=this.props.parent.props.indexes[c];d.enabled&&a.push({value:c,label:d.title,group:d.group})}return k.div({className:this.props.classIndexName},b.createElement(j,{onChange:this.indexSelected,options:a,parent:this,value:this.props.i,width:this.props.indexWidth}))}})}),define("castle-url/patterns/querystring/querystring",["jquery","castle-url/libs/react/react.min","castle-url/patterns/querystring/criteria","castle-url/patterns/querystring/widgets/select2","castle-url/components/utils"],function(a,b,c,d,e){"use strict";var f=b.DOM;return b.createClass({getInitialState:function(){return{sortOn:"",reversed:!1,criterias:[]}},getDefaultProps:function(){return{afterChange:function(){}}},componentDidMount:function(){this.props.storage.store.addChangeListener("change",this._onChange)},componentWillUnmount:function(){this.props.storage.store.removeChangeListener("change",this._onChange)},_onChange:function(){var a=this;this.setState(this.props.storage.store.getData(),function(){a.props.afterChange()})},reverseClicked:function(a){this.props.storage.dispatcher.handleViewAction({actionType:"update",data:{reversed:a.target.checked}})},sortOnChanged:function(a){this.props.storage.dispatcher.handleViewAction({actionType:"update",data:{sortOn:a.target.value}})},addCriteriaClicked:function(a){a.preventDefault(),this.props.storage.dispatcher.handleViewAction({actionType:"addCriteria",data:{i:"",o:"",v:""}})},render:function(){return f.div({className:this.props.classWrapperName},[this.renderCriterias(),f.div({className:this.props.classAddCriteriaName,style:{clear:"both"}},[f.button({className:"plone-btn plone-btn-default plone-btn-xs",onClick:this.addCriteriaClicked},"Add criteria")]),this.renderSorting()])},renderCriterias:function(){var a=this;if(0===this.state.criterias.length)return f.p({className:"querystring-empty-criterias"},"No criteria defined.");var d=[];return this.state.criterias.forEach(function(f,g){d.push(b.createElement(c,e.extend(f,{parent:a,idx:g,storage:a.props.storage})))}),d},getQueryString:function(){var a=[];return this.state.criterias.forEach(function(b){b.i&&b.o&&a.push(b)}),a},renderSorting:function(){var a=[{value:"",label:"No sorting"}];for(var c in this.props.sortable_indexes){var e=this.props.sortable_indexes[c];a.push({value:c,label:e.title})}return f.div({className:this.props.classSortWrapperName},[f.span({className:this.props.classSortLabelName},"Sort on"),b.createElement(d,{parent:this,onChange:this.sortOnChanged,options:a,value:this.state.sortOn,ref:"sortOn"}),f.label({className:this.props.classSortReverseName},[f.input({type:"checkbox",onClick:this.reverseClicked,checked:this.state.reversed,ref:"sortOrder"}),"Reversed Order"])])}})}),function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function c(a){return"object"==typeof a&&null!==a}function d(a){L=a}function e(a){P=a}function f(){return function(){K(h)}}function g(){return function(){setTimeout(h,1)}}function h(){for(var a=0;a<O;a+=2){(0,V[a])(V[a+1]),V[a]=void 0,V[a+1]=void 0}O=0}function i(){}function j(){return new TypeError("You cannot resolve a promise with itself")}function k(){return new TypeError("A promises callback cannot return that same promise.")}function l(a){try{return a.then}catch(a){return Z.error=a,Z}}function m(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function n(a,b,c){P(function(a){var d=!1,e=m(c,b,function(c){d||(d=!0,b!==c?q(a,c):s(a,c))},function(b){d||(d=!0,t(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,t(a,e))},a)}function o(a,b){b._state===X?s(a,b._result):b._state===Y?t(a,b._result):u(b,void 0,function(b){q(a,b)},function(b){t(a,b)})}function p(a,c){if(c.constructor===a.constructor)o(a,c);else{var d=l(c);d===Z?t(a,Z.error):void 0===d?s(a,c):b(d)?n(a,c,d):s(a,c)}}function q(b,c){b===c?t(b,j()):a(c)?p(b,c):s(b,c)}function r(a){a._onerror&&a._onerror(a._result),v(a)}function s(a,b){a._state===W&&(a._result=b,a._state=X,0!==a._subscribers.length&&P(v,a))}function t(a,b){a._state===W&&(a._state=Y,a._result=b,P(r,a))}function u(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+X]=c,e[f+Y]=d,0===f&&a._state&&P(v,a)}function v(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?y(c,d,e,f):e(f);a._subscribers.length=0}}function w(){this.error=null}function x(a,b){try{return a(b)}catch(a){return $.error=a,$}}function y(a,c,d,e){var f,g,h,i,j=b(d);if(j){if(f=x(d,e),f===$?(i=!0,g=f.error,f=null):h=!0,c===f)return void t(c,k())}else f=e,h=!0;c._state!==W||(j&&h?q(c,f):i?t(c,g):a===X?s(c,f):a===Y&&t(c,f))}function z(a,b){try{b(function(b){q(a,b)},function(b){t(a,b)})}catch(b){t(a,b)}}function A(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(i),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?s(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&s(c.promise,c._result))):t(c.promise,c._validationError())}function B(a){return new _(this,a).promise}function C(a){function b(a){q(e,a)}function c(a){t(e,a)}var d=this,e=new d(i);if(!N(a))return t(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===W&&g<f;g++)u(d.resolve(a[g]),void 0,b,c);return e}function D(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(i);return q(c,a),c}function E(a){var b=this,c=new b(i);return t(c,a),c}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function G(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(a){this._id=ea++,this._state=void 0,this._result=void 0,this._subscribers=[],i!==a&&(b(a)||F(),this instanceof H||G(),z(this,a))}function I(){var a;if("undefined"!=typeof global)a=global;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;b&&"[object Promise]"===Object.prototype.toString.call(b.resolve())&&!b.cast||(a.Promise=fa)}var J;J=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var K,L,M,N=J,O=0,P=function(a,b){V[O]=a,V[O+1]=b,2===(O+=2)&&(L?L(h):M())},Q="undefined"!=typeof window?window:void 0,R=Q||{},S=R.MutationObserver||R.WebKitMutationObserver,T="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),U="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3);M=T?function(){return function(){process.nextTick(h)}}():S?function(){var a=0,b=new S(h),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}():U?function(){var a=new MessageChannel;return a.port1.onmessage=h,function(){a.port2.postMessage(0)}}():void 0===Q&&"function"==typeof require?function(){try{var a=require,b=a("vertx");return K=b.runOnLoop||b.runOnContext,f()}catch(a){return g()}}():g();var W=void 0,X=1,Y=2,Z=new w,$=new w;A.prototype._validateInput=function(a){return N(a)},A.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},A.prototype._init=function(){this._result=new Array(this.length)};var _=A;A.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===W&&e<b;e++)a._eachEntry(d[e],e)},A.prototype._eachEntry=function(a,b){var d=this,e=d._instanceConstructor;c(a)?a.constructor===e&&a._state!==W?(a._onerror=null,d._settledAt(a._state,b,a._result)):d._willSettleAt(e.resolve(a),b):(d._remaining--,d._result[b]=a)},A.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===W&&(d._remaining--,a===Y?t(e,c):d._result[b]=c),0===d._remaining&&s(e,d._result)},A.prototype._willSettleAt=function(a,b){var c=this;u(a,void 0,function(a){c._settledAt(X,b,a)},function(a){c._settledAt(Y,b,a)})};var aa=B,ba=C,ca=D,da=E,ea=0,fa=H;H.all=aa,H.race=ba,H.resolve=ca,H.reject=da,H._setScheduler=d,H._setAsap=e,H._asap=P,H.prototype={constructor:H,then:function(a,b){var c=this,d=c._state;if(d===X&&!a||d===Y&&!b)return this;var e=new this.constructor(i),f=c._result;if(d){var g=arguments[d-1];P(function(){y(d,e,g,f)})}else u(c,e,a,b);return e},catch:function(a){return this.then(null,a)}};var ga=I,ha={Promise:fa,polyfill:ga};"function"==typeof define&&define.amd?define("castle-url/libs/es6-promise/promise.min",[],function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:void 0!==this&&(this.ES6Promise=ha),ga()}.call(this),define("castle-url/libs/object-assign",[],function(){"use strict";function a(a){if(null===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}return Object.assign||function(b){for(var c,d,e=a(b),f=1;f<arguments.length;f++){c=arguments[f],d=Object.keys(Object(c));for(var g=0;g<d.length;g++)e[d[g]]=c[d[g]]}return e}}),define("castle-url/libs/dispatcher",["jquery","castle-url/libs/es6-promise/promise.min","castle-url/libs/object-assign"],function(a,b,c){"use strict";var d=[],e=[],f=function(){};return f.prototype=c({},f.prototype,{register:function(a){return d.push(a),d.length-1},dispatch:function(a){var c=[],f=[];e=d.map(function(a,d){return new b.Promise(function(a,b){c[d]=a,f[d]=b})}),d.forEach(function(d,e){b.Promise.resolve(d(a)).then(function(){c[e](a)},function(){f[e](new Error("Dispatcher callback unsuccessful"))})}),e=[]},handleViewAction:function(a){this.dispatch(a)}}),f}),function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&-1!==(d=b(f[e],c))&&f[e].splice(d,1);return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(f in g)if(g.hasOwnProperty(f))for(c=g[f].slice(0),e=c.length;e--;)d=c[e],!0===d.once&&this.removeListener(a,d.listener),d.listener.apply(this,b||[])===this._getOnceReturnValue()&&this.removeListener(a,d.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("castle-url/libs/eventEmitter/EventEmitter.min",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}.call(this),define("castle-url/patterns/querystring/store",["castle-url/libs/dispatcher","castle-url/libs/eventEmitter/EventEmitter.min","castle-url/libs/object-assign","castle-url/components/utils"],function(a,b,c,d){"use strict";var e=c({},b.prototype,{data:null,initialize:function(){this.data={sortOn:"",reversed:!1,criterias:[]}},setData:function(a){this.data=a},getData:function(){return this.data},getAllCriterias:function(){return this.data.criterias||[]},getCriteria:function(a){return this.data.criterias[a]},addCriteria:function(a){this.data.criterias||(this.data.criterias=[]),this.data.criterias.push(a)},update:function(a){var b=!1;return a.sortOn===this.data.sortOn&&a.reversed===this.data.reversed||(b=!0),this.data=d.extend(this.data,a),b},updateCriteria:function(a,b){if(this.data.criterias&&this.data.criterias[a]){var c=!1,e=this.data.criterias[a];for(var f in b)e[f]!==b[f]&&(c=!0);return this.data.criterias[a]=d.extend(this.data.criterias[a],b),c}},removeCriteria:function(a){this.data.criterias&&this.data.criterias[a]&&this.data.criterias.splice(a,1)},addChangeListener:function(a,b){this.on(a,b)},removeChangeListener:function(a,b){this.removeListener(a,b)}});return function(){var b=c({},e),d=new a;return b.initialize(),d.register(function(a){switch(a.actionType){case"addCriteria":b.addCriteria(a.data),b.emit("change",a);break;case"updateCriteria":(b.updateCriteria(a.idx,a.data)||a.force)&&b.emit("change",a);break;case"removeCriteria":b.removeCriteria(a.idx),b.emit("change",a);break;case"update":b.update(a.data)&&b.emit("change",a)}}),{store:b,dispatcher:d}}}),define("mockup-patterns-querystring",["jquery","pat-base","castle-url/libs/react/react.min","castle-url/patterns/querystring/querystring","castle-url/patterns/querystring/store"],function(a,b,c,d,e){"use strict";return b.extend({name:"querystring",trigger:".pat-querystring",parser:"mockup",defaults:{indexes:[],classWrapperName:"querystring-wrapper",criteria:{},indexOptionsUrl:null,previewURL:"portal_factory/@@querybuilder_html_results",previewCountURL:"portal_factory/@@querybuildernumberofresults",classSortLabelName:"querystring-sort-label",classSortReverseName:"querystring-sortreverse",classSortReverseLabelName:"querystring-sortreverse-label",classPreviewCountWrapperName:"querystring-previewcount-wrapper",classPreviewResultsWrapperName:"querystring-previewresults-wrapper",classPreviewWrapperName:"querystring-preview-wrapper",classPreviewName:"querystring-preview",classPreviewTitleName:"querystring-preview-title",classPreviewDescriptionName:"querystring-preview-description",classSortWrapperName:"querystring-sort-wrapper",classAddCriteriaName:"querystring-add-criteria-wrapper",showPreviews:!0},init:function(){var b=this;b.$el.hide(),b.$wrapper=a("<div/>"),b.$el.after(b.$wrapper),b.initialized=!1,b.findRelatedFields(),b.options.indexOptionsUrl?a.ajax({url:b.options.indexOptionsUrl,success:function(a){b.options.indexes=a.indexes,b.options.sortable_indexes=a.sortable_indexes,b._init()},error:function(a){}}):b._init()},findRelatedFields:function(){var b=this;b.$originalSortOn=b.$originalReversed=null;var c=b.$el.closest("form");if(0!==c.size()){var d=a('input[id*="-sort_on"]',c);d.size()>0&&(b.$originalSortOn=d,b.$originalSortOn.closest(".field").hide());var e=a('input[id*="-sort_reversed"]',c);e.size()>0&&(b.$originalReversed=e,b.$originalReversed.closest(".field").hide())}},_init:function(){var b=this;b.timer=null,b.reversedValue=!1,b.sortOnValue=!1,this.storage=e(),this.options.storage=this.storage,b.options.afterChange=function(){b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){b.sortOnValue!==b.component.state.sortOn&&b.$sortOn.trigger("change"),b.reversedValue!==b.component.state.reversed&&b.$sortOrder.trigger("change"),b.$el.val(JSON.stringify(b.component.getQueryString())),b.$el.trigger("change"),b.reversedValue=b.component.state.reversed,b.sortOnValue=b.component.state.sortOn,b.$originalSortOn&&(b.$originalSortOn.val(b.sortOnValue),b.$originalSortOn.trigger("change")),b.$originalReversed&&(b.$originalReversed[0].checked=b.reversedValue,b.$originalReversed.trigger("change"))},300)};var f=c.render(c.createElement(d,this.options),this.$wrapper[0]);b.component=b.$el[0].component=f,b.$sortOn=a(b.component.refs.sortOn.refs.select.getDOMNode()),b.$sortOrder=a(b.component.refs.sortOrder.getDOMNode());var g={},h=b.$el.val();if(h)try{g.criterias=JSON.parse(h)}catch(a){}b.$originalSortOn&&(g.sortOn=b.$originalSortOn.val()),b.$originalReversed&&(g.reversed=b.$originalReversed[0].checked),b.storage.store.setData(g),f.setState(g),b.$el.trigger("initialized",b)}})}),function(a){define("resource-plone-app-jquerytools-js",["jquery"],function(){return function(){!function(a){function b(b,e){var f,g,h,i=this,j=b.add(i),k=a(window),l=a.tools.expose&&(e.mask||e.expose),m=Math.random().toString().slice(10);l&&("string"==typeof l&&(l={color:l}),l.closeOnClick=l.closeOnEsc=!1);var n=e.target||b.attr("rel");if(g=n?a(n):b,!g.length)throw"Could not find Overlay: "+n;b&&-1==b.index(g)&&b.click(function(a){return i.load(a),a.preventDefault()}),a.extend(i,{load:function(b){if(i.isOpened())return i;var f=d[e.effect];if(!f)throw'Overlay: cannot find effect : "'+e.effect+'"';if(e.oneInstance&&a.each(c,function(){this.close(b)}),b=b||a.Event(),b.type="onBeforeLoad",j.trigger(b),b.isDefaultPrevented())return i;h=!0,l&&a(g).expose(l);var n=e.top,o=e.left,p=g.outerWidth(!0),q=g.outerHeight(!0);return"string"==typeof n&&(n="center"==n?Math.max((k.height()-q)/2,0):parseInt(n,10)/100*k.height()),"center"==o&&(o=Math.max((k.width()-p)/2,0)),f[0].call(i,{top:n,left:o},function(){h&&(b.type="onLoad",j.trigger(b))}),l&&e.closeOnClick&&a.mask.getMask().one("click",i.close),e.closeOnClick&&a(document).on("click."+m,function(b){a(b.target).parents(g).length||i.close(b)}),e.closeOnEsc&&a(document).on("keydown."+m,function(a){27==a.keyCode&&i.close(a)}),i},close:function(b){return i.isOpened()?(b=b||a.Event(),b.type="onBeforeClose",j.trigger(b),b.isDefaultPrevented()?void 0:(h=!1,d[e.effect][1].call(i,function(){b.type="onClose",j.trigger(b)}),a(document).off("click."+m+" keydown."+m),l&&a.mask.close(),i)):i},getOverlay:function(){return g},getTrigger:function(){return b},getClosers:function(){return f},isOpened:function(){return h},getConf:function(){return e}}),a.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(b,c){a.isFunction(e[c])&&a(i).on(c,e[c]),i[c]=function(b){return b&&a(i).on(c,b),i}}),f=g.find(e.close||".close"),f.length||e.close||(f=a('<a class="close"></a>'),g.prepend(f)),f.click(function(a){i.close(a)}),e.load&&i.load()}a.tools=a.tools||{version:"@VERSION"},a.tools.overlay={addEffect:function(a,b,c){d[a]=[b,c]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var c=[],d={};a.tools.overlay.addEffect("default",function(b,c){var d=this.getConf(),e=a(window);d.fixed||(b.top+=e.scrollTop(),b.left+=e.scrollLeft()),b.position=d.fixed?"fixed":"absolute",this.getOverlay().css(b).fadeIn(d.speed,c)},function(a){this.getOverlay().fadeOut(this.getConf().closeSpeed,a)}),a.fn.overlay=function(d){var e=this.data("overlay");return e||(a.isFunction(d)&&(d={onBeforeLoad:d}),d=a.extend(!0,{},a.tools.overlay.conf,d),this.each(function(){e=new b(a(this),d),c.push(e),a(this).data("overlay",e)}),d.api?e:this)}}(jQuery),function(a){function b(b,c){var d=a(c);return d.length<2?d:b.parent().find(c)}function c(c,e){var f=this,g=c.add(f),h=c.children(),i=0,j=e.vertical;if(d||(d=f),h.length>1&&(h=a(e.items,c)),e.size>1&&(e.circular=!1),a.extend(f,{getConf:function(){return e},getIndex:function(){return i},getSize:function(){return f.getItems().size()},getNaviButtons:function(){return n.add(o)},getRoot:function(){return c},getItemWrap:function(){return h},getItems:function(){return h.find(e.item).not("."+e.clonedClass)},move:function(a,b){return f.seekTo(i+a,b)},next:function(a){return f.move(e.size,a)},prev:function(a){return f.move(-e.size,a)},begin:function(a){return f.seekTo(0,a)},end:function(a){return f.seekTo(f.getSize()-1,a)},focus:function(){return d=f,f},addItem:function(b){return b=a(b),e.circular?(h.children().last().before(b),h.children().first().replaceWith(b.clone().addClass(e.clonedClass))):(h.append(b),o.removeClass("disabled")),g.trigger("onAddItem",[b]),f},seekTo:function(b,c,k){if(b.jquery||(b*=1),e.circular&&0===b&&-1==i&&0!==c)return f;if(!e.circular&&b<0||b>f.getSize()||b<-1)return f;var l=b;b.jquery?b=f.getItems().index(b):l=f.getItems().eq(b);var m=a.Event("onBeforeSeek");if(!k&&(g.trigger(m,[b,c]),m.isDefaultPrevented()||!l.length))return f;var n=j?{top:-l.position().top}:{left:-l.position().left};return i=b,d=f,void 0===c&&(c=e.speed),h.animate(n,c,e.easing,k||function(){g.trigger("onSeek",[b])}),f}}),a.each(["onBeforeSeek","onSeek","onAddItem"],function(b,c){a.isFunction(e[c])&&a(f).on(c,e[c]),f[c]=function(b){return b&&a(f).on(c,b),f}}),e.circular){var k=f.getItems().slice(-1).clone().prependTo(h),l=f.getItems().eq(1).clone().appendTo(h);k.add(l).addClass(e.clonedClass),f.onBeforeSeek(function(a,b,c){if(!a.isDefaultPrevented())return-1==b?(f.seekTo(k,c,function(){f.end(0)}),a.preventDefault()):void(b==f.getSize()&&f.seekTo(l,c,function(){f.begin(0)}))});var m=c.parents().add(c).filter(function(){if("none"===a(this).css("display"))return!0});m.length?(m.show(),f.seekTo(0,0,function(){}),m.hide()):f.seekTo(0,0,function(){})}var n=b(c,e.prev).click(function(a){a.stopPropagation(),f.prev()}),o=b(c,e.next).click(function(a){a.stopPropagation(),f.next()});if(e.circular||(f.onBeforeSeek(function(a,b){setTimeout(function(){a.isDefaultPrevented()||(n.toggleClass(e.disabledClass,b<=0),o.toggleClass(e.disabledClass,b>=f.getSize()-1))},1)}),e.initialIndex||n.addClass(e.disabledClass)),f.getSize()<2&&n.add(o).addClass(e.disabledClass),e.mousewheel&&a.fn.mousewheel&&c.mousewheel(function(a,b){if(e.mousewheel)return f.move(b<0?1:-1,e.wheelSpeed||50),!1}),e.touch){var p={};h[0].ontouchstart=function(a){var b=a.touches[0];p.x=b.clientX,p.y=b.clientY},h[0].ontouchmove=function(a){if(1==a.touches.length&&!h.is(":animated")){var b=a.touches[0],c=p.x-b.clientX,d=p.y-b.clientY;f[j&&d>0||!j&&c>0?"next":"prev"](),a.preventDefault()}}}e.keyboard&&a(document).on("keydown.scrollable",function(b){if(!(!e.keyboard||b.altKey||b.ctrlKey||b.metaKey||a(b.target).is(":input")||"static"!=e.keyboard&&d!=f)){var c=b.keyCode;return!j||38!=c&&40!=c?j||37!=c&&39!=c?void 0:(f.move(37==c?-1:1),b.preventDefault()):(f.move(38==c?-1:1),b.preventDefault())}}),e.initialIndex&&f.seekTo(e.initialIndex,0,function(){})}a.tools=a.tools||{version:"@VERSION"},a.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var d;a.fn.scrollable=function(b){var d=this.data("scrollable");return d||(b=a.extend({},a.tools.scrollable.conf,b),this.each(function(){d=new c(a(this),b),a(this).data("scrollable",d)}),b.api?d:this)}}(jQuery),function(a){function b(b,c,d){var f,g=this,h=b.add(this),i=b.find(d.tabs),j=c.jquery?c:b.children(c);i.length||(i=b.children()),j.length||(j=b.parent().find(c)),j.length||(j=a(c)),a.extend(this,{click:function(c,j){var k=i.eq(c),l=!b.data("tabs");if("string"==typeof c&&c.replace("#","")&&(k=i.filter('[href*="'+c.replace("#","")+'"]'),c=Math.max(i.index(k),0)),d.rotate){var m=i.length-1;if(c<0)return g.click(m,j);if(c>m)return g.click(0,j)}if(!k.length){if(f>=0)return g;c=d.initialIndex,k=i.eq(c)}if(c===f)return g;if(j=j||a.Event(),j.type="onBeforeClick",h.trigger(j,[c]),!j.isDefaultPrevented()){var n=l?d.initialEffect&&d.effect||"default":d.effect;return e[n].call(g,c,function(){f=c,j.type="onClick",h.trigger(j,[c])}),i.removeClass(d.current),k.addClass(d.current),g}},getConf:function(){return d},getTabs:function(){return i},getPanes:function(){return j},getCurrentPane:function(){return j.eq(f)},getCurrentTab:function(){return i.eq(f)},getIndex:function(){return f},next:function(){return g.click(f+1)},prev:function(){return g.click(f-1)},destroy:function(){return i.off(d.event).removeClass(d.current),j.find('a[href^="#"]').off("click.T"),g}}),a.each("onBeforeClick,onClick".split(","),function(b,c){a.isFunction(d[c])&&a(g).on(c,d[c]),g[c]=function(b){return b&&a(g).on(c,b),g}}),d.history&&a.fn.history&&(a.tools.history.init(i),d.event="history"),i.each(function(b){a(this).on(d.event,function(a){
return g.click(b,a),a.preventDefault()})}),j.find('a[href^="#"]').on("click.T",function(b){g.click(a(this).attr("href"),b)}),location.hash&&"a"==d.tabs&&b.find('[href="'+location.hash+'"]').length?g.click(location.hash):(0===d.initialIndex||d.initialIndex>0)&&g.click(d.initialIndex)}a.tools=a.tools||{version:"@VERSION"},a.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(a,b){e[a]=b}};var c,d,e={default:function(a,b){this.getPanes().hide().eq(a).show(),b.call()},fade:function(a,b){var c=this.getConf(),d=c.fadeOutSpeed,e=this.getPanes();d?e.fadeOut(d):e.hide(),e.eq(a).fadeIn(c.fadeInSpeed,b)},slide:function(a,b){var c=this.getConf();this.getPanes().slideUp(c.slideUpSpeed),this.getPanes().eq(a).slideDown(c.slideDownSpeed,b)},ajax:function(a,b){this.getPanes().eq(0).load(this.getTabs().eq(a).attr("href"),b)}};a.tools.tabs.addEffect("horizontal",function(b,e){if(!c){var f=this.getPanes().eq(b),g=this.getCurrentPane();d||(d=this.getPanes().eq(0).width()),c=!0,f.show(),g.animate({width:0},{step:function(a){f.css("width",d-a)},complete:function(){a(this).hide(),e.call(),c=!1}}),g.length||(e.call(),c=!1)}}),a.fn.tabs=function(c,d){var e=this.data("tabs");return e&&(e.destroy(),this.removeData("tabs")),a.isFunction(d)&&(d={onBeforeClick:d}),d=a.extend({},a.tools.tabs.conf,d),this.each(function(){e=new b(a(this),c,d),a(this).data("tabs",e)}),d.api?e:this}}(jQuery),function(a){function b(a){if(a){var b=d.contentWindow.document;b.open().close(),b.location.hash=a}}var c,d,e,f;a.tools=a.tools||{version:"@VERSION"},a.tools.history={init:function(g){f||(a.browser.msie&&a.browser.version<"8"?d||(d=a("<iframe/>").attr("src","javascript:false;").hide().get(0),a("body").append(d),setInterval(function(){var b=d.contentWindow.document,e=b.location.hash;c!==e&&a(window).trigger("hash",e)},100),b(location.hash||"#")):setInterval(function(){var b=location.hash;b!==c&&a(window).trigger("hash",b)},100),e=e?e.add(g):g,g.click(function(c){var e=a(this).attr("href");if(d&&b(e),"#"!=e.slice(0,1))return location.href="#"+e,c.preventDefault()}),f=!0)}},a(window).on("hash",function(b,d){d?e.filter(function(){var b=a(this).attr("href");return b==d||b==d.replace("#","")}).trigger("history",[d]):e.eq(0).trigger("history",[d]),c=d}),a.fn.history=function(b){return a.tools.history.init(this),this.on("history",b)}}(jQuery),function(a){function b(){if(/msie/.test(navigator.userAgent.toLowerCase())){var b=a(document).height(),c=a(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b-c<20?c:b]}return[a(document).width(),a(document).height()]}function c(b){if(b)return b.call(a.mask)}a.tools=a.tools||{version:"@VERSION"};var d;d=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var e,f,g,h,i;a.mask={load:function(j,k){if(g)return this;"string"==typeof j&&(j={color:j}),j=j||h,h=j=a.extend(a.extend({},d.conf),j),e=a("#"+j.maskId),e.length||(e=a("<div/>").attr("id",j.maskId),a("body").append(e));var l=b();return e.css({position:"absolute",top:0,left:0,width:l[0],height:l[1],display:"none",opacity:j.startOpacity,zIndex:j.zIndex}),j.color&&e.css("backgroundColor",j.color),!1===c(j.onBeforeLoad)?this:(j.closeOnEsc&&a(document).on("keydown.mask",function(b){27==b.keyCode&&a.mask.close(b)}),j.closeOnClick&&e.on("click.mask",function(b){a.mask.close(b)}),a(window).on("resize.mask",function(){a.mask.fit()}),k&&k.length&&(i=k.eq(0).css("zIndex"),a.each(k,function(){var b=a(this);/relative|absolute|fixed/i.test(b.css("position"))||b.css("position","relative")}),f=k.css({zIndex:Math.max(j.zIndex+1,"auto"==i?0:i)})),e.css({display:"block"}).fadeTo(j.loadSpeed,j.opacity,function(){a.mask.fit(),c(j.onLoad),g="full"}),g=!0,this)},close:function(){if(g){if(!1===c(h.onBeforeClose))return this;e.fadeOut(h.closeSpeed,function(){f&&f.css({zIndex:i}),g=!1,c(h.onClose)}),a(document).off("keydown.mask"),e.off("click.mask"),a(window).off("resize.mask")}return this},fit:function(){if(g){var a=b();e.css({width:a[0],height:a[1]})}},getMask:function(){return e},isLoaded:function(a){return a?"full"==g:g},getConf:function(){return h},getExposed:function(){return f}},a.fn.mask=function(b){return a.mask.load(b),this},a.fn.expose=function(b){return a.mask.load(b,this),this}}(jQuery),function(a){function b(b,c,d){var e=d.relative?b.position().top:b.offset().top,f=d.relative?b.position().left:b.offset().left,g=d.position[0];e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop());var h=c.outerHeight()+b.outerHeight();"center"==g&&(e+=h/2),"bottom"==g&&(e+=h),g=d.position[1];var i=c.outerWidth()+b.outerWidth();return"center"==g&&(f-=i/2),"left"==g&&(f-=i),{top:e,left:f}}function c(c,e){var f,g,h=this,i=c.add(h),j=0,k=0,l=c.attr("title"),m=c.attr("data-tooltip"),n=d[e.effect],o=c.is(":input"),p=o&&c.is(":checkbox, :radio, select, :button, :submit"),q=c.attr("type"),r=e.events[q]||e.events[o?p?"widget":"input":"def"];if(!n)throw'Nonexistent effect "'+e.effect+'"';if(r=r.split(/,\s*/),2!=r.length)throw"Tooltip: bad events configuration for "+q;c.on(r[0],function(a){clearTimeout(j),e.predelay?k=setTimeout(function(){h.show(a)},e.predelay):h.show(a)}).on(r[1],function(a){clearTimeout(k),e.delay?j=setTimeout(function(){h.hide(a)},e.delay):h.hide(a)}),l&&e.cancelDefault&&(c.removeAttr("title"),c.data("title",l)),a.extend(h,{show:function(d){if(!f&&(m?f=a(m):e.tip?f=a(e.tip).eq(0):l?f=a(e.layout).addClass(e.tipClass).appendTo(document.body).hide().append(l):(f=c.find("."+e.tipClass),f.length||(f=c.next()),f.length||(f=c.parent().next())),!f.length))throw"Cannot find tooltip for "+c;if(h.isShown())return h;f.stop(!0,!0);var o=b(c,f,e);if(e.tip&&f.html(c.data("title")),d=a.Event(),d.type="onBeforeShow",i.trigger(d,[o]),d.isDefaultPrevented())return h;o=b(c,f,e),f.css({position:"absolute",top:o.top,left:o.left}),g=!0,n[0].call(h,function(){d.type="onShow",g="full",i.trigger(d)});var p=e.events.tooltip.split(/,\s*/);return f.data("__set")||(f.off(p[0]).on(p[0],function(){clearTimeout(j),clearTimeout(k)}),p[1]&&!c.is("input:not(:checkbox, :radio), textarea")&&f.off(p[1]).on(p[1],function(a){a.relatedTarget!=c[0]&&c.trigger(r[1].split(" ")[0])}),e.tip||f.data("__set",!0)),h},hide:function(b){return f&&h.isShown()?(b=a.Event(),b.type="onBeforeHide",i.trigger(b),b.isDefaultPrevented()?void 0:(g=!1,d[e.effect][1].call(h,function(){b.type="onHide",i.trigger(b)}),h)):h},isShown:function(a){return a?"full"==g:g},getConf:function(){return e},getTip:function(){return f},getTrigger:function(){return c}}),a.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(b,c){a.isFunction(e[c])&&a(h).on(c,e[c]),h[c]=function(b){return b&&a(h).on(c,b),h}})}a.tools=a.tools||{version:"@VERSION"},a.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,b,c){d[a]=[b,c]}};var d={toggle:[function(a){var b=this.getConf(),c=this.getTip(),d=b.opacity;d<1&&c.css({opacity:d}),c.show(),a.call()},function(a){this.getTip().hide(),a.call()}],fade:[function(a){var b=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||b.fadeIE?this.getTip().fadeTo(b.fadeInSpeed,b.opacity,a):(this.getTip().show(),a())},function(a){var b=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||b.fadeIE?this.getTip().fadeOut(b.fadeOutSpeed,a):(this.getTip().hide(),a())}]};a.fn.tooltip=function(b){var d=this.data("tooltip");return d||(b=a.extend(!0,{},a.tools.tooltip.conf,b),"string"==typeof b.position&&(b.position=b.position.split(/,?\s/)),this.each(function(){d=new c(a(this),b),a(this).data("tooltip",d)}),b.api?d:this)}}(jQuery)}.apply(a,arguments)})}(this),function(a){define("resource-plone-app-jquerytools-dateinput-js",["jquery"],function(){return function(){!function(a,b){function c(a,b){return new Date(a,b+1,0).getDate()}function d(a,b){for(a=""+a,b=b||2;a.length<b;)a="0"+a;return a}function e(a,b,c,e){var f=b.getDate(),g=b.getDay(),h=b.getMonth(),i=b.getFullYear(),j={d:f,dd:d(f),ddd:n[e].shortDays[g],dddd:n[e].days[g],m:h+1,mm:d(h+1),mmm:n[e].shortMonths[h],mmmm:n[e].months[h],yy:String(i).slice(2),yyyy:i},k=l[a](c,b,j,e);return o.html(k).html()}function f(a){return parseInt(a,10)}function g(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()}function h(a){if(a!==b){if(a.constructor==Date)return a;if("string"==typeof a){var c=a.split("-");if(3==c.length)return new Date(f(c[0]),f(c[1])-1,f(c[2]));if(!/^-?\d+$/.test(a))return;a=f(a)}var d=new Date;return d.setDate(d.getDate()+a),d}}function i(d,i){function j(b,c,f){return d.attr("readonly")?void w.hide(f):(D=b,r=b.getFullYear(),s=b.getMonth(),t=b.getDate(),f||(f=a.Event("api")),"click"!=f.type||/msie/.test(navigator.userAgent.toLowerCase())||d.focus(),f.type="beforeChange",I.trigger(f,[b]),void(f.isDefaultPrevented()||(d.val(e(c.formatter,b,c.format,c.lang)),f.type="change",f.target=d[0],I.trigger(f),d.data("date",b),w.hide(f))))}function l(b){b.type="onShow",I.trigger(b),a(document).on("keydown.d",function(b){if(b.ctrlKey)return!0;var c=b.keyCode;if(8==c||46==c)return d.val(""),w.hide(b);if(27==c||9==c)return w.hide(b);if(a(m).index(c)>=0){if(!u)return w.show(b),b.preventDefault();var e=a("#"+z.weeks+" a"),f=a("."+z.focus),g=e.index(f);return f.removeClass(z.focus),74==c||40==c?g+=7:75==c||38==c?g-=7:76==c||39==c?g+=1:(72==c||37==c)&&(g-=1),g>41?(w.addMonth(),f=a("#"+z.weeks+" a:eq("+(g-42)+")")):0>g?(w.addMonth(-1),f=a("#"+z.weeks+" a:eq("+(g+42)+")")):f=e.eq(g),f.addClass(z.focus),b.preventDefault()}return 34==c?w.addMonth():33==c?w.addMonth(-1):36==c?w.today():(13==c&&(a(b.target).is("select")||a("."+z.focus).click()),a([16,17,18,9]).index(c)>=0)}),a(document).on("click.d",function(b){var c=b.target;c.id==z.root||a(c).parents("#"+z.root).length||c==d[0]||o&&c==o[0]||w.hide(b)})}var o,p,q,r,s,t,u,v,w=this,x=new Date,y=x.getFullYear(),z=i.css,A=n[i.lang],B=a("#"+z.root),C=B.find("#"+z.title),D=d.attr("data-value")||i.value||d.val(),E=d.attr("min")||i.min,F=d.attr("max")||i.max;if(0===E&&(E="0"),D=h(D)||x,E=h(E||new Date(y+i.yearRange[0],1,1)),F=h(F||new Date(y+i.yearRange[1]+1,1,-1)),!A)throw"Dateinput: invalid language: "+i.lang;if("date"==d.attr("type")){var v=d.clone(),G=v.wrap("<div/>").parent().html(),H=a(G.replace(/type/i,"type=text data-orig-type"));i.value&&H.val(i.value),d.replaceWith(H),d=H}d.addClass(z.input);var I=d.add(w);if(!B.length){if(B=a("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",z.root),B.children().eq(0).attr("id",z.head).end().eq(1).attr("id",z.body).children().eq(0).attr("id",z.days).end().eq(1).attr("id",z.weeks).end().end().end().find("a").eq(0).attr("id",z.prev).end().eq(1).attr("id",z.next),C=B.find("#"+z.head).find("div").attr("id",z.title),i.selectors){var J=a("<select/>").attr("id",z.month),K=a("<select/>").attr("id",z.year);C.html(J.add(K))}for(var L=B.find("#"+z.days),M=0;7>M;M++)L.append(a("<span/>").text(A.shortDays[(M+i.firstDay)%7]));a("body").append(B)}i.trigger&&(o=a("<a/>").attr("href","#").addClass(z.trigger).click(function(a){return i.toggle?w.toggle():w.show(),a.preventDefault()}).insertAfter(d));var N=B.find("#"+z.weeks);K=B.find("#"+z.year),J=B.find("#"+z.month),a.extend(w,{show:function(b){if(!d.attr("disabled")&&!u&&(b=b||a.Event(),b.type="onBeforeShow",I.trigger(b),!b.isDefaultPrevented())){a.each(k,function(){this.hide()}),u=!0,J.off("change").change(function(){w.setValue(f(K.val()),f(a(this).val()))}),K.off("change").change(function(){w.setValue(f(a(this).val()),f(J.val()))}),p=B.find("#"+z.prev).off("click").click(function(){return p.hasClass(z.disabled)||w.addMonth(-1),!1}),q=B.find("#"+z.next).off("click").click(function(){return q.hasClass(z.disabled)||w.addMonth(),!1}),w.setValue(D);var c=d.offset();return/iPad/i.test(navigator.userAgent)&&(c.top-=a(window).scrollTop()),B.css({top:c.top+d.outerHeight(!0)+i.offset[0],left:c.left+i.offset[1]}),i.speed?B.show(i.speed,function(){l(b)}):(B.show(),l(b)),w}},setValue:function(d,e,k){var l=f(e)>=-1?new Date(f(d),f(e),f(k==b||isNaN(k)?1:k)):d||D;if(E>l?l=E:l>F&&(l=F),"string"==typeof d&&(l=h(d)),d=l.getFullYear(),e=l.getMonth(),k=l.getDate(),-1==e?(e=11,d--):12==e&&(e=0,d++),!u)return j(l,i),w;s=e,r=d,t=k;var m,n=new Date(d,e,1-i.firstDay),o=n.getDay(),v=c(d,e),y=c(d,e-1);if(i.selectors){J.empty(),a.each(A.months,function(b,c){E<new Date(d,b+1,1)&&F>new Date(d,b,0)&&J.append(a("<option/>").html(c).attr("value",b))}),K.empty();for(var B=x.getFullYear(),G=B+i.yearRange[0];G<B+i.yearRange[1];G++)E<new Date(G+1,0,1)&&F>new Date(G,0,0)&&K.append(a("<option/>").text(G));J.val(e),K.val(d)}else C.html(A.months[e]+" "+d);N.empty(),p.add(q).removeClass(z.disabled);for(var H,I,L=o?0:-7;(o?42:35)>L;L++)H=a("<a/>"),L%7==0&&(m=a("<div/>").addClass(z.week),N.append(m)),o>L?(H.addClass(z.off),I=y-o+L+1,l=new Date(d,e-1,I)):L>=o+v?(H.addClass(z.off),I=L-v-o+1,l=new Date(d,e+1,I)):(I=L-o+1,l=new Date(d,e,I),g(D,l)?H.attr("id",z.current).addClass(z.focus):g(x,l)&&H.attr("id",z.today)),E&&E>l&&H.add(p).addClass(z.disabled),F&&l>F&&H.add(q).addClass(z.disabled),H.attr("href","#"+I).text(I).data("date",l),m.append(H);return N.find("a").click(function(b){var c=a(this);return c.hasClass(z.disabled)||(a("#"+z.current).removeAttr("id"),c.attr("id",z.current),j(c.data("date"),i,b)),!1}),z.sunday&&N.find("."+z.week).each(function(){var b=i.firstDay?7-i.firstDay:0;a(this).children().slice(b,b+1).addClass(z.sunday)}),w},setMin:function(a,b){return E=h(a),b&&E>D&&w.setValue(E),w},setMax:function(a,b){return F=h(a),b&&D>F&&w.setValue(F),w},today:function(){return w.setValue(x)},addDay:function(a){return this.setValue(r,s,t+(a||1))},addMonth:function(a){var b=s+(a||1),d=c(r,b),e=d>=t?t:d;return this.setValue(r,b,e)},addYear:function(a){return this.setValue(r+(a||1),s,t)},destroy:function(){d.add(document).off("click.d keydown.d"),B.add(o).remove(),d.removeData("dateinput").removeClass(z.input),v&&d.replaceWith(v)},hide:function(b){if(u){if(b=a.Event(),b.type="onHide",I.trigger(b),b.isDefaultPrevented())return;a(document).off("click.d keydown.d"),B.hide(),u=!1}return w},toggle:function(){return w.isOpen()?w.hide():w.show()},getConf:function(){return i},getInput:function(){return d},getCalendar:function(){return B},getValue:function(a){return a?e(i.formatter,D,a,i.lang):D},isOpen:function(){return u}}),a.each(["onBeforeShow","onShow","change","onHide"],function(b,c){a.isFunction(i[c])&&a(w).on(c,i[c]),w[c]=function(b){return b&&a(w).on(c,b),w}}),i.editable||d.on("focus.d click.d",w.show).keydown(function(b){var c=b.keyCode;return!u&&a(m).index(c)>=0?(w.show(b),b.preventDefault()):((8==c||46==c)&&d.val(""),!!(b.shiftKey||b.ctrlKey||b.altKey||9==c)||b.preventDefault())}),h(d.val())&&j(D,i)}a.tools=a.tools||{version:"@VERSION"};var j,k=[],l={},m=[75,76,38,39,74,72,40,37],n={};j=a.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:b,max:b,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(a,b){l[a]=b},localize:function(b,c){a.each(c,function(a,b){c[a]=b.split(",")}),n[b]=c}},j.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var o=a("<a/>");j.addFormatter("default",function(a,b,c){return a.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function(a){return a in c?c[a]:a})}),j.addFormatter("prefixed",function(a,b,c){return a.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function(a,b){return b in c?c[b]:a})}),a.expr[":"].date=function(b){var c=b.getAttribute("type");return c&&"date"==c||!!a(b).data("dateinput")},a.fn.dateinput=function(b){if(this.data("dateinput"))return this;b=a.extend(!0,{},j.conf,b),a.each(b.css,function(a,c){c||"prefix"==a||(b.css[a]=(b.css.prefix||"")+(c||a))});var c;return this.each(function(){var d=new i(a(this),b);k.push(d);var e=d.getInput().data("dateinput",d);c=c?c.add(e):e}),c||this}}(jQuery)}.apply(a,arguments)})}(this),function(a){define("jquery.tmpl",["jquery"],function(){return function(){!function(a,b){function c(b,c,d,e){var f={data:e||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:k,nest:l,wrap:m,html:n,update:o};return b&&a.extend(f,b,{nodes:[],parent:c}),d&&(f.tmpl=d,f._ctnt=f._ctnt||f.tmpl(a,f),f.key=++w,(y.length?u:t)[w]=f),f}function d(b,c,f){var g,h=f?a.map(f,function(a){return"string"==typeof a?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+r+'="'+b.key+'" $2'):a:d(a,b,a._ctnt)}):b;return c?h:(h=h.join(""),h.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(b,c,d,f){g=a(d).get(),j(g),c&&(g=e(c).concat(g)),f&&(g=g.concat(e(f)))}),g||e(h))}function e(b){var c=document.createElement("div");return c.innerHTML=b,a.makeArray(c.childNodes)}function f(b){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(b,c,d,e,f,g,i){var j,k,l,m=a.tmpl.tag[d];if(!m)throw"Template command not found: "+d;return j=m._default||[],g&&!/\w$/.test(f)&&(f+=g,g=""),f?(f=h(f),i=i?","+h(i)+")":g?")":"",k=g?f.indexOf(".")>-1?f+g:"("+f+").call($item"+i:f,l=g?k:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=k=j.$1||"null",e=h(e),"');"+m[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(k).split("$2").join(e?e.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(a,b,c,d){return d=d?","+d+")":c?")":"",d?"("+b+").call($item"+d:a}):j.$2||"")+"_.push('"})+"');}return _;")}function g(b,c){b._wrap=d(b,!0,a.isArray(c)?c:[s.test(c)?c:a(c).html()]).join("")}function h(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function i(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML}function j(b){function d(b){function d(a){a+=j,g=k[a]=k[a]||c(g,t[g.parent.key+j]||g.parent,null,!0)}var e,f,g,h,i=b;if(h=b.getAttribute(r)){for(;i.parentNode&&1===(i=i.parentNode).nodeType&&!(e=i.getAttribute(r)););e!==h&&(i=i.parentNode?11===i.nodeType?0:i.getAttribute(r)||0:0,(g=t[h])||(g=u[h],g=c(g,t[i]||u[i],null,!0),g.key=++w,t[w]=g),x&&d(h)),b.removeAttribute(r)}else x&&(g=a.data(b,"tmplItem"))&&(d(g.key),t[g.key]=g,i=a.data(b.parentNode,"tmplItem"),i=i?i.key:0);if(g){for(f=g;f&&f.key!=i;)f.nodes.push(b),f=f.parent;delete g._ctnt,delete g._wrap,a.data(b,"tmplItem",g)}}var e,f,g,h,i,j="_"+x,k={};for(g=0,h=b.length;g<h;g++)if(1===(e=b[g]).nodeType){for(f=e.getElementsByTagName("*"),i=f.length-1;i>=0;i--)d(f[i]);d(e)}}function k(a,b,c,d){if(!a)return y.pop();y.push({_:a,tmpl:b,item:this,data:c,options:d})}function l(b,c,d){return a.tmpl(a.template(b),c,d,this)}function m(b,c){var d=b.options||{};return d.wrapped=c,a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function n(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||i(a)})}function o(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}var p,q=a.fn.domManip,r="_tmplitem",s=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,t={},u={},v={key:0,data:{}},w=0,x=0,y=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e,f,g,h,i=[],j=a(d),k=1===this.length&&this[0].parentNode;if(p=t||{},k&&11===k.nodeType&&1===k.childNodes.length&&1===j.length)j[c](this[0]),i=this;else{for(f=0,g=j.length;f<g;f++)x=f,e=(f>0?this.clone(!0):this).get(),a.fn[c].apply(a(j[f]),e),i=i.concat(e);x=0,i=this.pushStack(i,b,j.selector)}return h=p,p=null,a.tmpl.complete(h),i}}),a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,c,d,e){if(b[0]&&b[0].nodeType){for(var f,g=a.makeArray(arguments),h=b.length,i=0;i<h&&!(f=a.data(b[i++],"tmplItem")););h>1&&(g[0]=[a.makeArray(b)]),f&&x&&(g[2]=function(b){a.tmpl.afterManip(this,b,d)}),q.apply(this,g)}else q.apply(this,arguments);return x=0,p||a.tmpl.complete(t),this}}),a.extend({tmpl:function(b,e,f,h){var i,j=!h;if(j)h=v,b=a.template[b]||a.template(null,b),u={};else if(!b)return b=h.tmpl,t[h.key]=h,h.nodes=[],h.wrapped&&g(h,h.wrapped),a(d(h,null,h.tmpl(a,h)));return b?("function"==typeof e&&(e=e.call(h||{})),f&&f.wrapped&&g(f,f.wrapped),i=a.isArray(e)?a.map(e,function(a){return a?c(f,h,b,a):null}):[c(f,h,b,e)],j?a(d(h,null,i)):i):[]},tmplItem:function(b){var c;for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode););return c||v},template:function(b,c){return c?("string"==typeof c?c=f(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",f(c.innerHTML))),"string"==typeof b?a.template[b]=c:c):b?"string"!=typeof b?a.template(null,b):a.template[b]||a.template(null,s.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(a){t={}},afterManip:function(b,c,d){var e=11===c.nodeType?a.makeArray(c.childNodes):1===c.nodeType?[c]:[];d.call(b,c),j(e),x++}})}(jQuery)}.apply(a,arguments)})}(this),function(a){define("jquery.recurrenceinput",["jquery","resource-plone-app-jquerytools-js","resource-plone-app-jquerytools-dateinput-js","jquery.tmpl"],function(){return function(){!function(a){function b(a,b){for(a=a.toString(),b=b||2;a.length<b;)a="0"+a;return a}function c(a,c,d){var e=a.getDate(),f=a.getDay(),g=a.getMonth(),h=a.getFullYear(),i={d:e,dd:b(e),ddd:d.i18n.shortWeekdays[f],dddd:d.i18n.weekdays[f],m:g+1,mm:b(g+1),mmm:d.i18n.shortMonths[g],mmmm:d.i18n.months[g],yy:String(h).slice(2),yyyy:h};return c.replace(o,function(a){return i.hasOwnProperty(a)?i[a]:a.slice(1,a.length-1)})}function d(b,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=b.find("select[name=rirtemplate]").val(),u=d.rtemplate[t],v=u.rrule,w=d.i18n.rtemplate[t];for(j=0;j<u.fields.length;j++)switch(f=b.find("#"+u.fields[j]),f.attr("id")){case"ridailyinterval":q=f.find("input[name=ridailyinterval]").val(),"1"!==q&&(v+=";INTERVAL="+q),w=q+" "+d.i18n.dailyInterval2;break;case"riweeklyinterval":q=f.find("input[name=riweeklyinterval]").val(),"1"!==q&&(v+=";INTERVAL="+q),w=q+" "+d.i18n.weeklyInterval2;break;case"riweeklyweekdays":for(h="",i="",k=0;k<d.weekdays.length;k++)g=f.find("input[name=riweeklyweekdays"+d.weekdays[k]+"]"),g.is(":checked")&&(h&&(h+=",",i+=", "),h+=d.weekdays[k],i+=d.i18n.weekdays[k]);h&&(v+=";BYDAY="+h,w+=" "+d.i18n.weeklyWeekdaysHuman+" "+i);break;case"rimonthlyinterval":q=f.find("input[name=rimonthlyinterval]").val(),"1"!==q&&(v+=";INTERVAL="+q),w=q+" "+d.i18n.monthlyInterval2;break;case"rimonthlyoptions":switch(a("input[name=rimonthlytype]:checked",b).val()){case"DAYOFMONTH":n=a("select[name=rimonthlydayofmonthday]",b).val(),v+=";BYMONTHDAY="+n,w+=", "+d.i18n.monthlyDayOfMonth1Human+" "+n+" "+d.i18n.monthlyDayOfMonth2;break;case"WEEKDAYOFMONTH":l=a("select[name=rimonthlyweekdayofmonthindex]",b).val(),n=a("select[name=rimonthlyweekdayofmonth]",b).val(),a.inArray(n,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(v+=";BYDAY="+l+n,w+=", "+d.i18n.monthlyWeekdayOfMonth1Human+" ",w+=" "+d.i18n.orderIndexes[a.inArray(l,d.orderIndexes)],w+=" "+d.i18n.monthlyWeekdayOfMonth2,w+=" "+d.i18n.weekdays[a.inArray(n,d.weekdays)],w+=" "+d.i18n.monthlyDayOfMonth2)}break;case"riyearlyinterval":q=f.find("input[name=riyearlyinterval]").val(),"1"!==q&&(v+=";INTERVAL="+q),w=q+" "+d.i18n.yearlyInterval2;break;case"riyearlyoptions":switch(a("input[name=riyearlyType]:checked",b).val()){case"DAYOFMONTH":o=a("select[name=riyearlydayofmonthmonth]",b).val(),n=a("select[name=riyearlydayofmonthday]",b).val(),v+=";BYMONTH="+o,v+=";BYMONTHDAY="+n,w+=", "+d.i18n.yearlyDayOfMonth1Human+" "+d.i18n.months[o-1]+" "+n;break;case"WEEKDAYOFMONTH":l=a("select[name=riyearlyweekdayofmonthindex]",b).val(),n=a("select[name=riyearlyweekdayofmonthday]",b).val(),o=a("select[name=riyearlyweekdayofmonthmonth]",b).val(),v+=";BYMONTH="+o,a.inArray(n,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(v+=";BYDAY="+l+n,w+=", "+d.i18n.yearlyWeekdayOfMonth1Human,w+=" "+d.i18n.orderIndexes[a.inArray(l,d.orderIndexes)],w+=" "+d.i18n.yearlyWeekdayOfMonth2,w+=" "+d.i18n.weekdays[a.inArray(n,d.weekdays)],w+=" "+d.i18n.yearlyWeekdayOfMonth3,w+=" "+d.i18n.months[o-1],w+=" "+d.i18n.yearlyWeekdayOfMonth4)}break;case"rirangeoptions":switch(b.find("input[name=rirangetype]:checked").val()){case"BYOCCURRENCES":r=b.find("input[name=rirangebyoccurrencesvalue]").val(),v+=";COUNT="+r,w+=", "+d.i18n.rangeByOccurrences1Human,w+=" "+r,w+=" "+d.i18n.rangeByOccurrences2;break;case"BYENDDATE":f=b.find("input[name=rirangebyenddatecalendar]"),s=f.data("dateinput").getValue("yyyymmdd"),v+=";UNTIL="+s+"T000000",!0===e&&(v+="Z"),w+=", "+d.i18n.rangeByEndDateHuman,w+=" "+f.data("dateinput").getValue(d.i18n.longDateFormat)}}if(void 0!==b.ical.RDATE&&b.ical.RDATE.length>0){for(b.ical.RDATE.sort(),m=[],j=0;j<b.ical.RDATE.length;j++)""!==b.ical.RDATE[j]&&(p=parseInt(b.ical.RDATE[j].substring(0,4),10),o=parseInt(b.ical.RDATE[j].substring(4,6),10)-1,n=parseInt(b.ical.RDATE[j].substring(6,8),10),m.push(c(new Date(p,o,n),d.i18n.longDateFormat,d)));0!==m.length&&(w=w+d.i18n.including+" "+m.join("; "))}if(void 0!==b.ical.EXDATE&&b.ical.EXDATE.length>0){for(b.ical.EXDATE.sort(),m=[],j=0;j<b.ical.EXDATE.length;j++)""!==b.ical.EXDATE[j]&&(p=parseInt(b.ical.EXDATE[j].substring(0,4),10),o=parseInt(b.ical.EXDATE[j].substring(4,6),10)-1,n=parseInt(b.ical.EXDATE[j].substring(6,8),10),m.push(c(new Date(p,o,n),d.i18n.longDateFormat,d)));0!==m.length&&(w=w+d.i18n.except+" "+m.join("; "))}return v="RRULE:"+v,void 0!==b.ical.EXDATE&&""!==b.ical.EXDATE.join()&&(m=a.map(b.ical.EXDATE,function(a){return 8===a.length&&(a+="T000000"),!0===e&&(a+="Z"),a}),v=v+"\nEXDATE:"+m),void 0!==b.ical.RDATE&&""!==b.ical.RDATE.join()&&(m=a.map(b.ical.RDATE,function(a){return 8===a.length&&(a+="T000000"),!0===e&&(a+="Z"),a}),v=v+"\nRDATE:"+m),{result:v,description:w}}function e(a){var b={},c=a.indexOf(":"),d=a.substring(0,c);return b.value=a.substring(c+1),-1!==d.indexOf(";")?(c=d.indexOf(";"),b.parameters=d.substring(c+1),b.property=d.substring(0,c)):(b.parameters=null,b.property=d),b}function f(a){var b,c=[],d=a.split(",");for(b in d)d.hasOwnProperty(b)&&(-1!==d[b].indexOf("Z")?c.push(d[b].substring(0,15)):c.push(d[b]));return c}function g(a){var b,c=[],d={},g=null;for(c=a.split("\n"),c.reverse();;){if(c.length>0){if(b=c.pop()," "===b.charAt(0)||"\t"===b.charAt(0)){g+=b;continue}}else b="";if(null!==g&&(g=e(g),"RDATE"===g.property||"EXDATE"===g.property?d[g.property]=f(g.value):d[g.property]=g.value),""===(g=b))break}return d}function h(b,c,d,e){var f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=[];if(b.ical=g(d),void 0===b.ical.RRULE){if(B.push(c.i18n.noRule),!e)return-1}else{h=/INTERVAL=([0-9]+);?/.exec(b.ical.RRULE),r=h?h[1]:"1",h=/BYDAY=([^;]+);?/.exec(b.ical.RRULE),s=h?h[1]:"",h=/BYMONTHDAY=([^;]+);?/.exec(b.ical.RRULE),u=h?h[1].split(","):null,h=/BYMONTH=([^;]+);?/.exec(b.ical.RRULE),t=h?h[1].split(","):null,h=/COUNT=([0-9]+);?/.exec(b.ical.RRULE),v=h?h[1]:null,h=/UNTIL=([0-9T]+);?/.exec(b.ical.RRULE),w=h?h[1]:null,h=/BYSETPOS=([^;]+);?/.exec(b.ical.RRULE),h&&B.push(c.i18n.bysetpos),i="",j=null;for(f in c.rtemplate)c.rtemplate.hasOwnProperty(f)&&(k=c.rtemplate[f],0===b.ical.RRULE.indexOf(k.rrule)&&b.ical.RRULE.length>i.length&&(i=b.ical.RRULE,j=f));if(i)k=c.rtemplate[j],b.find("select[name=rirtemplate]").val(j);else{for(k in c.rtemplate)if(c.rtemplate.hasOwnProperty(k)){k=c.rtemplate[k];break}B.push(c.i18n.noTemplateMatch)}for(f=0;f<k.fields.length;f++)switch(p=b.find("#"+k.fields[f]),p.attr("id")){case"ridailyinterval":p.find("input[name=ridailyinterval]").val(r);break;case"riweeklyinterval":p.find("input[name=riweeklyinterval]").val(r);break;case"riweeklyweekdays":for(s=s.split(","),l=0;l<c.weekdays.length;l++)x=c.weekdays[l],m=p.find("input[name=riweeklyweekdays"+x+"]"),m.attr("checked",-1!==a.inArray(x,s));break;case"rimonthlyinterval":p.find("input[name=rimonthlyinterval]").val(r);break;case"rimonthlyoptions":var C="DAYOFMONTH";for(u&&(C="DAYOFMONTH",u.length>1&&(B.push(c.i18n.multipleDayOfMonth),u=u[0]),p.find("select[name=rimonthlydayofmonthday]").val(u)),s&&(C="WEEKDAYOFMONTH",-1!==s.indexOf(",")&&(B.push(c.i18n.multipleDayOfMonth),s=s.split(",")[0]),n=s.slice(0,-2),"+"!==n.charAt(0)&&"-"!==n.charAt(0)&&(n="+"+n),A=s.slice(-2),p.find("select[name=rimonthlyweekdayofmonthindex]").val(n),p.find("select[name=rimonthlyweekdayofmonth]").val(A)),o=p.find("input[name=rimonthlytype]"),n=0;n<o.length;n++)q=o[n],a(q).attr("checked",q.value===C);break;case"riyearlyinterval":p.find("input[name=riyearlyinterval]").val(r);break;case"riyearlyoptions":var D="DAYOFMONTH";for(u&&(D="DAYOFMONTH",u.length>1&&(B.push(c.i18n.multipleDayOfMonth),u=u[0]),p.find("select[name=riyearlydayofmonthmonth]").val(t),p.find("select[name=riyearlydayofmonthday]").val(u)),s&&(D="WEEKDAYOFMONTH",-1!==s.indexOf(",")&&(B.push(c.i18n.multipleDayOfMonth),s=s.split(",")[0]),n=s.slice(0,-2),"+"!==n.charAt(0)&&"-"!==n.charAt(0)&&(n="+"+n),A=s.slice(-2),p.find("select[name=riyearlyweekdayofmonthindex]").val(n),p.find("select[name=riyearlyweekdayofmonthday]").val(A),p.find("select[name=riyearlyweekdayofmonthmonth]").val(t)),o=p.find("input[name=riyearlyType]"),n=0;n<o.length;n++)q=o[n],a(q).attr("checked",q.value===D);break;case"rirangeoptions":var E="NOENDDATE";for(v&&(E="BYOCCURRENCES",p.find("input[name=rirangebyoccurrencesvalue]").val(v)),w&&(E="BYENDDATE",m=p.find("input[name=rirangebyenddatecalendar]"),z=w.slice(0,4),y=w.slice(4,6),y=parseInt(y,10)-1,x=w.slice(6,8),m.data("dateinput").setValue(new Date(z,y,x))),o=p.find("input[name=rirangetype]"),n=0;n<o.length;n++)q=o[n],a(q).attr("checked",q.value===E)}}var F=b.find("#messagearea");return 0!==B.length?(F.text(c.i18n.unsupportedFeatures+" "+B.join("; ")),F.show(),1):(F.text(""),F.hide(),0)}function i(b,e){function f(a){var c;y.find(".rifield").hide();var d=a.val();if(d){var e=b.rtemplate[d];for(c=0;c<e.fields.length;c++)y.find("#"+e.fields[c]).show()}}function g(b){b.preventDefault(),void 0===y.ical.EXDATE&&(y.ical.EXDATE=[]),y.ical.EXDATE.push(this.attributes.date.value);var c=a(this);c.attr("class","exdate"),c.parent().parent().addClass("exdate"),c.unbind(b),
c.click(i)}function i(b){b.preventDefault(),y.ical.EXDATE.splice(a.inArray(this.attributes.date.value,y.ical.EXDATE),1);var c=a(this);c.attr("class","rrule"),c.parent().parent().removeClass("exdate"),c.unbind(b),c.click(g)}function j(b){b.preventDefault(),y.ical.RDATE.splice(a.inArray(this.attributes.date.value,y.ical.RDATE),1),a(this).parent().parent().hide("slow",function(){a(this).remove()})}function l(c){c.preventDefault();var d=y.find(".riaddoccurrence input#adddate").data("dateinput"),e=d.getValue("yyyymmddT000000");void 0===y.ical.RDATE&&(y.ical.RDATE=[]);var f=y.find(".riaddoccurrence div.errorarea");if(f.text(""),f.hide(),-1===a.inArray(e,y.ical.RDATE)){y.ical.RDATE.push(e);var g=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',d.getValue(b.i18n.longDateFormat),'<span class="rlabel">'+b.i18n.additionalDate+"</span>","</span>",'<span class="action">','<a date="'+e+'" href="#" class="rdate" >',"Include","</a>","</span>","</div>"].join("\n");y.find("div.rioccurrences").prepend(g),a(y.find("div.rioccurrences div")[0]).slideDown(),a(y.find("div.rioccurrences .action a.rdate")[0]).click(j)}else f.text(b.i18n.alreadyAdded).show()}function m(d,e,f,h){var k,l;k=h?z:y,l=k.find(".rioccurrences"),l.hide();var n,o,p;n=d.getFullYear(),o=d.getMonth()+1,p=d.getDate();var q={year:n,month:o,day:p,rrule:e,format:b.i18n.longDateFormat,start:f},r={url:b.ajaxURL,async:!1,type:"post",dataType:"json",contentType:b.ajaxContentType,cache:!1,data:q,success:function(f,k,n){var o,p;p=h?z:y,f.readOnly=h,f.i18n=b.i18n;var q,r,s,t,u,v;for(v in f.occurrences)f.occurrences.hasOwnProperty(v)&&(q=f.occurrences[v],r=q.date,s=parseInt(r.substring(0,4),10),t=parseInt(r.substring(4,6),10)-1,u=parseInt(r.substring(6,8),10),q.formattedDate=c(new Date(s,t,u),b.i18n.longDateFormat,b));o=a.tmpl("occurrenceTmpl",f),l=p.find(".rioccurrences"),l.replaceWith(o),p.find(".rioccurrences .batching a").click(function(a){a.preventDefault(),m(d,e,this.attributes.start.value,h)}),h||(p.find(".rioccurrences .action a.rrule").click(g),p.find(".rioccurrences .action a.exdate").click(i),p.find(".rioccurrences .action a.rdate").click(j)),p.find(".rioccurrences").show()},error:function(a,b,c){alert(b)}};a.ajax(r)}function n(b){var c=a(b);return c.length||(c=a("#"+b)),c.length||(c=a("input[name='"+b+"']")),c}function o(){var a,c,d,e,f=null;if(b.startField){if(a=n(b.startField),!a.length)return null;f=a.data("dateinput"),f?f=f.getValue():""===(f=a.val())&&(f=a.text()),"string"==typeof f&&(f=f.replace(" ","T")),f=new Date(f)}else if(b.startFieldYear&&b.startFieldMonth&&b.startFieldDay){if(c=n(b.startFieldYear),d=n(b.startFieldMonth),e=n(b.startFieldDay),!c.length&&!d.length&&!e.length)return null;f=new Date(c.val(),d.val()-1,e.val())}return null===f?null:isNaN(f)?null:f}function p(a){var b,c;return b=a.find("input[name=rirangebyenddatecalendar]"),c=b.data("dateinput"),c=c?c.getValue():b.val(),c=new Date(c),isNaN(c)||""===b.val()?null:c}function q(a,b){var c,d;return c=b.find("input[name="+a+"]"),d=c.val(),isNaN(d)||-1!==d.toString().indexOf(".")||""===c.val()?null:d}function r(a){var c,e,g,i;a&&h(y,b,a,!0),e=o(),null!==e?(y.find("select[name=rimonthlydayofmonthday]").val(e.getDate()),g=b.orderIndexes[Math.floor((e.getDate()-1)/7)],i=b.weekdays[e.getDay()],y.find("select[name=rimonthlyweekdayofmonthindex]").val(g),y.find("select[name=rimonthlyweekdayofmonth]").val(i),y.find("select[name=riyearlydayofmonthmonth]").val(e.getMonth()+1),y.find("select[name=riyearlydayofmonthday]").val(e.getDate()),y.find("select[name=riyearlyweekdayofmonthindex]").val(g),y.find("select[name=riyearlyweekdayofmonthday]").val(i),y.find("select[name=riyearlyweekdayofmonthmonth]").val(e.getMonth()+1),m(e,d(y,b,!1).result,0,!1),y.find("div.rioccurrencesactions").show()):y.find("div.rioccurrencesactions").hide(),c=y.find("select[name=rirtemplate]"),f(c)}function s(){var a=d(y,b,!1);z.find("label[class=ridisplay]").text(b.i18n.displayActivate+" "+a.description),e.val(a.result).change();var c=o();null!==c&&m(c,d(y,b,!1).result,0,!0),z.find('button[name="riedit"]').text(b.i18n.edit_rules),z.find('button[name="ridelete"]').show()}function t(){z.find("label[class=ridisplay]").text(b.i18n.displayUnactivate),e.val("").change(),z.find(".rioccurrences").hide(),z.find('button[name="riedit"]').text(b.i18n.add_rules),z.find('button[name="ridelete"]').hide()}function u(a){var c,d,e,f;if(c=o(),f=a.find("#messagearea"),f.text(""),f.hide(),a.find(".riaddoccurrence div.errorarea").text("").hide(),"block"===a.find("#ridailyinterval").css("display")&&(!(e=q("ridailyinterval",a))||e<1||e>1e3))return f.text(b.i18n.noRepeatEvery).show(),!1;if("block"===a.find("#riweeklyinterval").css("display")&&(!(e=q("riweeklyinterval",a))||e<1||e>1e3))return f.text(b.i18n.noRepeatEvery).show(),!1;if("block"===a.find("#rimonthlyinterval").css("display")){if(!(e=q("rimonthlyinterval",a))||e<1||e>1e3)return f.text(b.i18n.noRepeatEvery).show(),!1;if(0===a.find("#rimonthlyoptions input:checked").length)return f.text(b.i18n.noRepeatOn).show(),!1}if("block"===a.find("#riyearlyinterval").css("display")){if(!(e=q("riyearlyinterval",a))||e<1||e>1e3)return f.text(b.i18n.noRepeatEvery).show(),!1;if(0===a.find("#riyearlyoptions input:checked").length)return f.text(b.i18n.noRepeatOn).show(),!1}if(a.find('input[value="BYOCCURRENCES"]:visible:checked').length>0&&(!(e=q("rirangebyoccurrencesvalue",a))||e<1||e>1e3))return f.text(b.i18n.noEndAfterNOccurrences).show(),!1;if(a.find('input[value="BYENDDATE"]:visible:checked').length>0){if(!(d=p(a)))return f.text(b.i18n.noEndDate).show(),!1;if(d<c)return f.text(b.i18n.pastEndDate).show(),!1}return!0}function v(a){a.preventDefault(),u(y)&&(y.overlay().close(),s())}function w(a){a.preventDefault(),y.overlay().close()}function x(){var a;a=o(),u(y)&&m(a,d(y,b,!1).result,0,!1)}var y,z,A,B,C=this,D=[];for(B=0;B<7;B++)A=B+b.firstDay,A>6&&(A-=7),D.push(A);if(a.extend(b,{orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:D}),z=a.tmpl("displayTmpl",b),y=a.tmpl("formTmpl",b),y.overlay(b.formOverlay).hide(),y.ical={RDATE:[],EXDATE:[]},a.tools.dateinput.localize(b.lang,{months:k[b.lang].months.join(),shortMonths:k[b.lang].shortMonths.join(),days:k[b.lang].weekdays.join(),shortDays:k[b.lang].shortWeekdays.join()}),y.find("input[name=rirangebyenddatecalendar]").dateinput({selectors:!0,lang:b.lang,format:b.i18n.shortDateFormat,firstDay:b.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),e.val()){if(-1===h(y,b,e.val(),!1)){z.find("label[class=ridisplay]").text(b.i18n.noRule)}else s()}z.find("button[name=ridelete]").click(function(a){a.preventDefault(),t()}),z.find("button[name=riedit]").click(function(a){r(e.val()),a.preventDefault(),y.overlay().load()}),y.find("div.riaddoccurrence input#adddate").dateinput({selectors:!0,lang:b.lang,format:b.i18n.shortDateFormat,firstDay:b.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),y.find("input#addaction").click(l),y.find("a.rirefreshbutton").click(function(a){a.preventDefault(),x()}),y.find("select[name=rirtemplate]").change(function(b){f(a(this))}),y.find("select").change(function(b){a(this).parent().find("> input").click().change()}),y.find("input[name=rirangebyoccurrencesvalue]").change(function(b){a(this).parent().find("input[name=rirangetype]").click().change()}),y.find("input[name=rirangebyenddatecalendar]").change(function(){a(this).parent().find("input[name=rirangetype]").click(),0!==y.find(".rioccurrencesactions:visible").length&&x()}),y.find("input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]").change(function(a){0!==y.find(".rioccurrencesactions:visible").length&&x()}),y.find(".ricancelbutton").click(w),y.find(".risavebutton").click(v),a.extend(C,{display:z,form:y,loadData:r,save:v})}a.tools=a.tools||{version:"@VERSION"};var j,k={};j=a.tools.recurrenceinput={conf:{lang:"en",readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,formOverlay:{speed:"fast",fixed:!1},template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},localize:function(a,b){k[a]=b},setTemplates:function(a,b){var c,d;j.conf.rtemplate=a;for(c in b)if(b.hasOwnProperty(c))for(d in b[c])b[c].hasOwnProperty(d)&&(k[c].rtemplate[d]=b[c][d])}},j.localize("en",{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}});var l=['<div class="rioccurrences">',"{{each occurrences}}",'<div class="occurrence ${occurrences[$index].type}">',"<span>","${occurrences[$index].formattedDate}",'{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>',"{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>',"{{/if}}","</span>","{{if !readOnly}}",'<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">',"${i18n.exclude}","</a>","{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >',"${i18n.remove}","</a>","{{/if}}",'{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">',"${i18n.include}","</a>","{{/if}}","</span>","{{/if}}","</div>","{{/each}}",'<div class="batching">',"{{each batch.batches}}",'{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',"{{if $index === batch.currentBatch}}</span>{{/if}}","{{/each}}","</div></div>"].join("\n");a.template("occurrenceTmpl",l);var m=['<div class="ridisplay">','<div class="rimain">',"{{if !readOnly}}",'<button name="riedit">${i18n.add_rules}</button>','<button name="ridelete" style="display:none">${i18n.delete_rules}</button>',"{{/if}}",'<label class="ridisplay">${i18n.displayUnactivate}</label>',"</div>",'<div class="rioccurrences" style="display:none" /></div>'].join("\n");a.template("displayTmpl",m);var n=['<div class="riform">',"<form>","<h1>${i18n.title}</h1>",'<div id="messagearea" style="display: none;">',"</div>",'<div id="rirtemplate">','<label for="${name}rtemplate" class="label">',"${i18n.recurrenceType}","</label>",'<select id="rirtemplate" name="rirtemplate" class="field">',"{{each rtemplate}}",'<option value="${$index}">${i18n.rtemplate[$index]}</value>',"{{/each}}","</select>","<div>",'<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">',"${i18n.dailyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />',"${i18n.dailyInterval2}","</div>","</div>",'<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">',"${i18n.weeklyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>',"${i18n.weeklyInterval2}","</div>","</div>",'<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">',"{{each orderedWeekdays}}",'<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>',"</div>","{{/each}}","</div>","</div>",'<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>',"${i18n.monthlyInterval2}","</div>","</div>",'<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">',"${i18n.monthlyDayOfMonth1}","</label>",'<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyDayOfMonth2}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">',"${i18n.monthlyWeekdayOfMonth1}","</label>",'<select name="rimonthlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth2}",'<select name="rimonthlyweekdayofmonth">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth3}","</div>","</div>","</div>",'<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>',"${i18n.yearlyInterval2}","</div>","</div>",'<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">',"${i18n.yearlyDayOfMonth1}","</label>",'<select name="riyearlydayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth2}",'<select name="riyearlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth3}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth1}","</label>",'<select name="riyearlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>",'<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth2}","</label>",'<select name="riyearlyweekdayofmonthday">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth3}",'<select name="riyearlyweekdayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth4}","</div>","</div>","</div>",'<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">',"{{if hasRepeatForeverButton}}","<div>","<input",'type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">',"${i18n.rangeNoEnd}","</label>","</div>","{{/if}}","<div>","<input",'type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">',"${i18n.rangeByOccurrences1}","</label>","<input",'type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />',"${i18n.rangeByOccurrences2}","</div>","<div>","<input",'type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">',"${i18n.rangeByEndDate}","</label>","<input",'type="date"','name="rirangebyenddatecalendar" />',"</div>","</div>","</div>","</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.preview}</h2>",'<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">',"${i18n.refresh}","</a>","</span>","</div>","</div>",'<div class="rioccurrences">',"</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.addDate}</h2>","</div>",'<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">',"</div>","</div>",'<div class="ributtons">',"<input",'type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />',"<input",'type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />',"</div>","</form></div>"].join("\n");a.template("formTmpl",n);var o=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;a.fn.recurrenceinput=function(b){if(this.data("recurrenceinput"))return this.data("recurrenceinput");var c=a.extend({},j.conf);a.extend(c,b),a.extend(c,{i18n:k[c.lang],name:this.attr("name")});var d=new i(c,this);return d.form.appendTo("body"),this.after(d.display),this.hide(),this.data("recurrenceinput",d),d}}(jQuery)}.apply(a,arguments)})}(this),define("mockup-patterns-recurrence",["jquery","pat-base","jquery.recurrenceinput"],function(a,b){"use strict";return b.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{language:"en",localization:null,configuration:{}},init:function(){this.$el.addClass("recurrence-widget"),this.options.localization&&a.tools.recurrenceinput.localize(this.options.language,this.options.localization),this.$el.recurrenceinput(this.options.configuration)}})}),function(a){define("jqtree",["jquery"],function(){return function(){!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=19)}([function(a,b,c){function d(a){for(var c in b.position_names)if(b.position_names.hasOwnProperty(c)&&b.position_names[c]===a)return c;return""}function e(a){return b.position_names[a]}b.__esModule=!0;var f;!function(a){a[a.Before=1]="Before",a[a.After=2]="After",a[a.Inside=3]="Inside",a[a.None=4]="None"}(f=b.Position||(b.Position={})),b.position_names={before:f.Before,after:f.After,inside:f.Inside,none:f.None},b.getPositionName=d,b.getPosition=e;var g=function(){function a(b,c,d){void 0===c&&(c=!1),void 0===d&&(d=a),this.name="",this.setData(b),this.children=[],this.parent=null,c&&(this.id_mapping={},this.tree=this,this.node_class=d)}return a.prototype.setData=function(a){var b=this,c=function(a){null!=a&&(b.name=a)};if(a)if("object"!=typeof a)c(a);else for(var d in a)if(a.hasOwnProperty(d)){var e=a[d];"label"===d?c(e):"children"!==d&&(this[d]=e)}},a.prototype.loadFromData=function(a){this.removeChildren();for(var b=0,c=a;b<c.length;b++){var d=c[b],e=new this.tree.node_class(d);this.addChild(e),"object"==typeof d&&d.children&&e.loadFromData(d.children)}},a.prototype.addChild=function(a){this.children.push(a),a._setParent(this)},a.prototype.addChildAtPosition=function(a,b){this.children.splice(b,0,a),a._setParent(this)},a.prototype.removeChild=function(a){a.removeChildren(),this._removeChild(a)},a.prototype.getChildIndex=function(a){return $.inArray(a,this.children)},a.prototype.hasChildren=function(){return 0!==this.children.length},a.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand},a.prototype.iterate=function(a){var b=function(c,d){if(c.children)for(var e=0,f=c.children;e<f.length;e++){var g=f[e],h=a(g,d);h&&g.hasChildren()&&b(g,d+1)}};b(this,0)},a.prototype.moveNode=function(a,b,c){a.parent&&!a.isParentOf(b)&&(a.parent._removeChild(a),c===f.After?b.parent&&b.parent.addChildAtPosition(a,b.parent.getChildIndex(b)+1):c===f.Before?b.parent&&b.parent.addChildAtPosition(a,b.parent.getChildIndex(b)):c===f.Inside&&b.addChildAtPosition(a,0))},a.prototype.getData=function(a){function b(a){return a.map(function(a){var c={};for(var d in a)if(-1===["parent","children","element","tree"].indexOf(d)&&Object.prototype.hasOwnProperty.call(a,d)){var e=a[d];c[d]=e}return a.hasChildren()&&(c.children=b(a.children)),c})}return void 0===a&&(a=!1),b(a?[this]:this.children)},a.prototype.getNodeByName=function(a){return this.getNodeByCallback(function(b){return b.name===a})},a.prototype.getNodeByCallback=function(a){var b=null;return this.iterate(function(c){return!a(c)||(b=c,!1)}),b},a.prototype.addAfter=function(a){if(this.parent){var b=new this.tree.node_class(a),c=this.parent.getChildIndex(this);return this.parent.addChildAtPosition(b,c+1),"object"==typeof a&&a.children&&a.children.length&&b.loadFromData(a.children),b}return null},a.prototype.addBefore=function(a){if(this.parent){var b=new this.tree.node_class(a),c=this.parent.getChildIndex(this);return this.parent.addChildAtPosition(b,c),"object"==typeof a&&a.children&&a.children.length&&b.loadFromData(a.children),b}return null},a.prototype.addParent=function(a){if(this.parent){var b=new this.tree.node_class(a);b._setParent(this.tree);for(var c=this.parent,d=0,e=c.children;d<e.length;d++){var f=e[d];b.addChild(f)}return c.children=[],c.addChild(b),b}return null},a.prototype.remove=function(){this.parent&&(this.parent.removeChild(this),this.parent=null)},a.prototype.append=function(a){var b=new this.tree.node_class(a);return this.addChild(b),"object"==typeof a&&a.children&&a.children.length&&b.loadFromData(a.children),b},a.prototype.prepend=function(a){var b=new this.tree.node_class(a);return this.addChildAtPosition(b,0),"object"==typeof a&&a.children&&a.children.length&&b.loadFromData(a.children),b},a.prototype.isParentOf=function(a){for(var b=a.parent;b;){if(b===this)return!0;b=b.parent}return!1},a.prototype.getLevel=function(){for(var a=0,b=this;b.parent;)a+=1,b=b.parent;return a},a.prototype.getNodeById=function(a){return this.id_mapping[a]},a.prototype.addNodeToIndex=function(a){null!=a.id&&(this.id_mapping[a.id]=a)},a.prototype.removeNodeFromIndex=function(a){null!=a.id&&delete this.id_mapping[a.id]},a.prototype.removeChildren=function(){var a=this;this.iterate(function(b){return a.tree.removeNodeFromIndex(b),!0}),this.children=[]},a.prototype.getPreviousSibling=function(){if(this.parent){var a=this.parent.getChildIndex(this)-1;return a>=0?this.parent.children[a]:null}return null},a.prototype.getNextSibling=function(){if(this.parent){var a=this.parent.getChildIndex(this)+1;return a<this.parent.children.length?this.parent.children[a]:null}return null},a.prototype.getNodesByProperty=function(a,b){return this.filter(function(c){return c[a]===b})},a.prototype.filter=function(a){var b=[];return this.iterate(function(c){return a(c)&&b.push(c),!0}),b},a.prototype.getNextNode=function(a){if(void 0===a&&(a=!0),a&&this.hasChildren()&&this.is_open)return this.children[0];if(this.parent){var b=this.getNextSibling();return b||this.parent.getNextNode(!1)}return null},a.prototype.getPreviousNode=function(){if(this.parent){var a=this.getPreviousSibling();return a?a.hasChildren()&&a.is_open?a.getLastChild():a:this.getParent()}return null},a.prototype.getParent=function(){return this.parent&&this.parent.parent?this.parent:null},a.prototype.getLastChild=function(){if(this.hasChildren()){var a=this.children[this.children.length-1];return a.hasChildren()&&a.is_open?a.getLastChild():a}return null},a.prototype.initFromData=function(a){var b=this,c=function(a){for(var c=0,d=a;c<d.length;c++){var e=d[c],f=new b.tree.node_class("");f.initFromData(e),b.addChild(f)}};!function(a){b.setData(a),a.children&&c(a.children)}(a)},a.prototype._setParent=function(a){this.parent=a,this.tree=a.tree,this.tree.addNodeToIndex(this)},a.prototype._removeChild=function(a){this.children.splice(this.getChildIndex(a),1),this.tree.removeNodeFromIndex(a)},a}();b.Node=g},function(a,b,c){function d(a){return"number"==typeof a&&a%1==0}function e(a){return"function"==typeof a}function f(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function g(a){return a?"true":"false"}b.__esModule=!0,b.isInt=d,b.isFunction=e,b.html_escape=f,b.getBoolString=g},function(a,b,c){b.__esModule=!0;var d=function(){function a(a,b){this.$el=$(a);var c=this.constructor.defaults;this.options=$.extend({},c,b)}return a.register=function(b,c){function d(b,c){var d=$.data(b,c);return d&&d instanceof a?d:null}function e(a,c){for(var e=h(),f=0,g=a.get();f<g.length;f++){var i=g[f];if(!d(i,e)){var j=new b(i,c);$.data(i,e)||$.data(i,e,j),j._init()}}return a}function f(a){for(var b=h(),c=0,e=a.get();c<e.length;c++){var f=e[c],g=d(f,b);g&&g.destroy(),$.removeData(f,b)}}function g(b,c,d){for(var e=null,f=0,g=b.get();f<g.length;f++){var i=g[f],j=$.data(i,h());if(j&&j instanceof a){var k=j[c];k&&"function"==typeof k&&(e=k.apply(j,d))}}return e}var h=function(){return"simple_widget_"+c};$.fn[c]=function(a){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var h=this;if(void 0===a||"object"==typeof a){return e(h,a)}if("string"==typeof a&&"_"!==a[0]){var i=a;return"destroy"===i?f(h):"get_widget_class"===i?b:g(h,i,c)}}},a.prototype.destroy=function(){this._deinit()},a.prototype._init=function(){},a.prototype._deinit=function(){},a}();d.defaults={},b.default=d},function(a,b,c){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b.__esModule=!0;var e=c(12),f=c(4),g=c(5),h=c(6),i=c(7),j=c(9),k=c(10),l=c(11),m=c(2),n=c(0),o=c(1),p=c(8),q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.toggle=function(a,b){var c=null==b?this.options.slide:b;return a.is_open?this.closeNode(a,c):this.openNode(a,c),this.element},b.prototype.getTree=function(){return this.tree},b.prototype.selectNode=function(a){return this._selectNode(a,!1),this.element},b.prototype.getSelectedNode=function(){return!!this.select_node_handler&&this.select_node_handler.getSelectedNode()},b.prototype.toJson=function(){return JSON.stringify(this.tree.getData())},b.prototype.loadData=function(a,b){return this._loadData(a,b),this.element},b.prototype.loadDataFromUrl=function(a,b,c){return"string"===$.type(a)?this._loadDataFromUrl(a,b,c):this._loadDataFromUrl(null,a,b),this.element},b.prototype.reload=function(a){return this._loadDataFromUrl(null,null,a),this.element},b.prototype.getNodeById=function(a){return this.tree.getNodeById(a)},b.prototype.getNodeByName=function(a){return this.tree.getNodeByName(a)},b.prototype.getNodesByProperty=function(a,b){return this.tree.getNodesByProperty(a,b)},b.prototype.getNodeByHtmlElement=function(a){return this._getNode($(a))},b.prototype.getNodeByCallback=function(a){return this.tree.getNodeByCallback(a)},b.prototype.openNode=function(a,b,c){var d=this,e=function(){var a,e;return o.isFunction(b)?(a=b,e=null):(e=b,a=c),null==e&&(e=d.options.slide),[e,a]}(),f=e[0],g=e[1];return a&&this._openNode(a,f,g),this.element},b.prototype.closeNode=function(a,b){var c=null==b?this.options.slide:b;return a.isFolder()&&(new p.FolderElement(a,this).close(c),this._saveState()),this.element},b.prototype.isDragging=function(){return!!this.dnd_handler&&this.dnd_handler.is_dragging},b.prototype.refreshHitAreas=function(){return this.dnd_handler&&this.dnd_handler.refresh(),this.element},b.prototype.addNodeAfter=function(a,b){var c=b.addAfter(a);return c&&this._refreshElements(b.parent),c},b.prototype.addNodeBefore=function(a,b){var c=b.addBefore(a);return c&&this._refreshElements(b.parent),c},b.prototype.addParentNode=function(a,b){var c=b.addParent(a);return c&&this._refreshElements(c.parent),c},b.prototype.removeNode=function(a){return a.parent&&this.select_node_handler&&(this.select_node_handler.removeFromSelection(a,!0),a.remove(),
this._refreshElements(a.parent)),this.element},b.prototype.appendNode=function(a,b){var c=b||this.tree,d=c.append(a);return this._refreshElements(c),d},b.prototype.prependNode=function(a,b){var c=b||this.tree,d=c.prepend(a);return this._refreshElements(c),d},b.prototype.updateNode=function(a,b){var c=b.id&&b.id!==a.id;return c&&this.tree.removeNodeFromIndex(a),a.setData(b),c&&this.tree.addNodeToIndex(a),"object"==typeof b&&b.children&&(a.removeChildren(),b.children.length&&a.loadFromData(b.children)),this.renderer.renderFromNode(a),this._selectCurrentNode(),this.element},b.prototype.moveNode=function(a,b,c){var d=n.getPosition(c);return this.tree.moveNode(a,b,d),this._refreshElements(null),this.element},b.prototype.getStateFromStorage=function(){if(this.save_state_handler)return this.save_state_handler.getStateFromStorage()},b.prototype.addToSelection=function(a){return a&&this.select_node_handler&&(this.select_node_handler.addToSelection(a),this._getNodeElementForNode(a).select(),this._saveState()),this.element},b.prototype.getSelectedNodes=function(){return this.select_node_handler?this.select_node_handler.getSelectedNodes():[]},b.prototype.isNodeSelected=function(a){return!!this.select_node_handler&&this.select_node_handler.isNodeSelected(a)},b.prototype.removeFromSelection=function(a){return this.select_node_handler&&(this.select_node_handler.removeFromSelection(a),this._getNodeElementForNode(a).deselect(),this._saveState()),this.element},b.prototype.scrollToNode=function(a){if(this.scroll_handler){var b=$(a.element),c=b.offset().top-this.$el.offset().top;this.scroll_handler.scrollTo(c)}return this.element},b.prototype.getState=function(){if(this.save_state_handler)return this.save_state_handler.getState()},b.prototype.setState=function(a){return this.save_state_handler&&(this.save_state_handler.setInitialState(a),this._refreshElements(null)),this.element},b.prototype.setOption=function(a,b){return this.options[a]=b,this.element},b.prototype.moveDown=function(){return this.key_handler&&this.key_handler.moveDown(),this.element},b.prototype.moveUp=function(){return this.key_handler&&this.key_handler.moveUp(),this.element},b.prototype.getVersion=function(){return e.default},b.prototype.testGenerateHitAreas=function(a){return this.dnd_handler?(this.dnd_handler.current_item=this._getNodeElementForNode(a),this.dnd_handler.generateHitAreas(),this.dnd_handler.hit_areas):[]},b.prototype._triggerEvent=function(a,b){var c=$.Event(a);return $.extend(c,b),this.element.trigger(c),c},b.prototype._openNode=function(a,b,c){var d=this;void 0===b&&(b=!0);var e=function(a,b,c){new p.FolderElement(a,d).open(c,b)};if(a.isFolder())if(a.load_on_demand)this._loadFolderOnDemand(a,b,c);else{for(var f=a.parent;f;)f.parent&&e(f,!1,null),f=f.parent;e(a,b,c),this._saveState()}},b.prototype._refreshElements=function(a){this.renderer.render(a),this._triggerEvent("tree.refresh")},b.prototype._getNodeElementForNode=function(a){return a.isFolder()?new p.FolderElement(a,this):new p.NodeElement(a,this)},b.prototype._getNodeElement=function(a){var b=this._getNode(a);return b?this._getNodeElementForNode(b):null},b.prototype._containsElement=function(a){var b=this._getNode($(a));return null!=b&&b.tree===this.tree},b.prototype._init=function(){a.prototype._init.call(this),this.element=this.$el,this.mouse_delay=300,this.is_initialized=!1,this.options.rtl=this._getRtlOption(),this.options.closedIcon||(this.options.closedIcon=this._getDefaultClosedIcon()),this.renderer=new g.default(this),null!=j.default?this.save_state_handler=new j.default(this):this.options.saveState=!1,null!=l.default&&(this.select_node_handler=new l.default(this)),null!=f.DragAndDropHandler?this.dnd_handler=new f.DragAndDropHandler(this):this.options.dragAndDrop=!1,null!=k.default&&(this.scroll_handler=new k.default(this)),null!=h.default&&null!=l.default&&(this.key_handler=new h.default(this)),this._initData(),this.element.click($.proxy(this._click,this)),this.element.dblclick($.proxy(this._dblclick,this)),this.options.useContextMenu&&this.element.on("contextmenu",$.proxy(this._contextmenu,this))},b.prototype._deinit=function(){this.element.empty(),this.element.off(),this.key_handler&&this.key_handler.deinit(),this.tree=new n.Node({},!0),a.prototype._deinit.call(this)},b.prototype._mouseCapture=function(a){return!(!this.options.dragAndDrop||!this.dnd_handler)&&this.dnd_handler.mouseCapture(a)},b.prototype._mouseStart=function(a){return!(!this.options.dragAndDrop||!this.dnd_handler)&&this.dnd_handler.mouseStart(a)},b.prototype._mouseDrag=function(a){if(this.options.dragAndDrop&&this.dnd_handler){var b=this.dnd_handler.mouseDrag(a);return this.scroll_handler&&this.scroll_handler.checkScrolling(),b}return!1},b.prototype._mouseStop=function(a){return!(!this.options.dragAndDrop||!this.dnd_handler)&&this.dnd_handler.mouseStop(a)},b.prototype._initData=function(){if(this.options.data)this._loadData(this.options.data,null);else{this._getDataUrlInfo(null)?this._loadDataFromUrl(null,null,null):this._loadData([],null)}},b.prototype._getDataUrlInfo=function(a){var b=this,c=this.options.dataUrl||this.element.data("url");return $.isFunction(c)?c(a):"string"===$.type(c)?function(){var d={url:c};if(a&&a.id){var e={node:a.id};d.data=e}else{var f=b._getNodeIdToBeSelected();if(f){var e={selected_node:f};d.data=e}}return d}():c},b.prototype._getNodeIdToBeSelected=function(){return this.options.saveState&&this.save_state_handler?this.save_state_handler.getNodeIdToBeSelected():null},b.prototype._initTree=function(a){var b=this,c=function(){b.is_initialized||(b.is_initialized=!0,b._triggerEvent("tree.init"))};this.tree=new this.options.nodeClass(null,!0,this.options.nodeClass),this.select_node_handler&&this.select_node_handler.clear(),this.tree.loadFromData(a);var d=this._setInitialState();this._refreshElements(null),d?this._setInitialStateOnDemand(c):c()},b.prototype._setInitialState=function(){var a=this,b=function(){if(a.options.saveState&&a.save_state_handler){var b=a.save_state_handler.getStateFromStorage();if(b){return[!0,a.save_state_handler.setInitialState(b)]}return[!1,!1]}return[!1,!1]}(),c=b[0],d=b[1];return c||(d=function(){if(!1===a.options.autoOpen)return!1;var b=a._getAutoOpenMaxLevel(),c=!1;return a.tree.iterate(function(a,d){return a.load_on_demand?(c=!0,!1):!!a.hasChildren()&&(a.is_open=!0,d!==b)}),c}()),d},b.prototype._setInitialStateOnDemand=function(a){var b=this;(function(){if(b.options.saveState&&b.save_state_handler){var c=b.save_state_handler.getStateFromStorage();return!!c&&(b.save_state_handler.setInitialStateOnDemand(c,a),!0)}return!1})()||function(){var c=b._getAutoOpenMaxLevel(),d=0,e=function(a){d+=1,b._openNode(a,!1,function(){d-=1,f()})},f=function(){b.tree.iterate(function(a,d){return a.load_on_demand?(a.is_loading||e(a),!1):(b._openNode(a,!1,null),d!==c)}),0===d&&a()};f()}()},b.prototype._getAutoOpenMaxLevel=function(){return!0===this.options.autoOpen?-1:parseInt(this.options.autoOpen,10)},b.prototype._click=function(a){var b=this._getClickTarget(a.target);if(b)if("button"===b.type)this.toggle(b.node,this.options.slide),a.preventDefault(),a.stopPropagation();else if("label"===b.type){var c=b.node,d=this._triggerEvent("tree.click",{node:c,click_event:a});d.isDefaultPrevented()||this._selectNode(c,!0)}},b.prototype._dblclick=function(a){var b=this._getClickTarget(a.target);b&&"label"===b.type&&this._triggerEvent("tree.dblclick",{node:b.node,click_event:a})},b.prototype._getClickTarget=function(a){var b=$(a),c=b.closest(".jqtree-toggler");if(c.length){var d=this._getNode(c);if(d)return{type:"button",node:d}}else{var e=b.closest(".jqtree-element");if(e.length){var d=this._getNode(e);if(d)return{type:"label",node:d}}}return null},b.prototype._getNode=function(a){var b=a.closest("li.jqtree_common");return 0===b.length?null:b.data("node")},b.prototype._contextmenu=function(a){var b=$(a.target).closest("ul.jqtree-tree .jqtree-element");if(b.length){var c=this._getNode(b);if(c)return a.preventDefault(),a.stopPropagation(),this._triggerEvent("tree.contextmenu",{node:c,click_event:a}),!1}return null},b.prototype._saveState=function(){this.options.saveState&&this.save_state_handler&&this.save_state_handler.saveState()},b.prototype._selectCurrentNode=function(){var a=this.getSelectedNode();if(a){var b=this._getNodeElementForNode(a);b&&b.select()}},b.prototype._deselectCurrentNode=function(){var a=this.getSelectedNode();a&&this.removeFromSelection(a)},b.prototype._getDefaultClosedIcon=function(){return this.options.rtl?"&#x25c0;":"&#x25ba;"},b.prototype._getRtlOption=function(){if(null!=this.options.rtl)return this.options.rtl;var a=this.element.data("rtl");return null!=a&&!1!==a},b.prototype._notifyLoading=function(a,b,c){this.options.onLoading&&this.options.onLoading(a,b,c)},b.prototype._selectNode=function(a,b){var c=this;if(void 0===b&&(b=!1),this.select_node_handler){var d=function(){c.options.saveState&&c.save_state_handler&&c.save_state_handler.saveState()};if(!a)return this._deselectCurrentNode(),void d();if(function(){return c.options.onCanSelectNode?c.options.selectable&&c.options.onCanSelectNode(a):c.options.selectable}()){if(this.select_node_handler.isNodeSelected(a))b&&(this._deselectCurrentNode(),this._triggerEvent("tree.select",{node:null,previous_node:a}));else{var e=this.getSelectedNode();this._deselectCurrentNode(),this.addToSelection(a),this._triggerEvent("tree.select",{node:a,deselected_node:e}),function(){var b=a.parent;b&&b.parent&&!b.is_open&&c.openNode(b,!1)}()}d()}}},b.prototype._loadData=function(a,b){a&&(this._triggerEvent("tree.load_data",{tree_data:a}),b?(this._deselectNodes(b),this._loadSubtree(a,b)):this._initTree(a),this.isDragging()&&this.dnd_handler&&this.dnd_handler.refresh())},b.prototype._deselectNodes=function(a){if(this.select_node_handler)for(var b=this.select_node_handler.getSelectedNodesUnder(a),c=0,d=b;c<d.length;c++){var e=d[c];this.select_node_handler.removeFromSelection(e)}},b.prototype._loadSubtree=function(a,b){b.loadFromData(a),b.load_on_demand=!1,b.is_loading=!1,this._refreshElements(b)},b.prototype._loadDataFromUrl=function(a,b,c){var d=this,e=null,f=a,g=function(){e&&(e.removeClass("jqtree-loading"),d._notifyLoading(!1,b,e))},h=function(){return"string"===$.type(f)?{url:f}:(f.method||(f.method="get"),f)},i=function(a){g(),d._loadData(a,b),c&&$.isFunction(c)&&c()},j=function(a){return $.isArray(a)||"object"==typeof a?a:null!=a?$.parseJSON(a):[]},k=function(a){return d.options.dataFilter?d.options.dataFilter(a):a},l=function(a){var b=k(j(a));i(b)},m=function(a){g(),d.options.onLoadFailed&&d.options.onLoadFailed(a)};return a||(f=this._getDataUrlInfo(b)),function(){e=b?$(b.element):d.element,e.addClass("jqtree-loading"),d._notifyLoading(!0,b,e)}(),f?$.isArray(f)?void i(f):void function(){var a=h();$.ajax($.extend({},a,{method:null!=f.method?f.method.toUpperCase():"GET",cache:!1,dataType:"json",success:l,error:m}))}():void g()},b.prototype._loadFolderOnDemand=function(a,b,c){var d=this;void 0===b&&(b=!0),a.is_loading=!0,this._loadDataFromUrl(null,a,function(){d._openNode(a,b,c)})},b}(i.default);q.defaults={autoOpen:!1,saveState:!1,dragAndDrop:!1,selectable:!0,useContextMenu:!0,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:!0,dataUrl:null,closedIcon:null,openedIcon:"&#x25bc;",slide:!0,nodeClass:n.Node,dataFilter:null,keyboardSupport:!0,openFolderDelay:500,rtl:!1,onDragMove:null,onDragStop:null,buttonLeft:!0,onLoading:null},m.default.register(q,"tree")},function(a,b,c){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b.__esModule=!0;var e=c(0),f=c(1),g=function(){function a(a){this.tree_widget=a,this.hovered_area=null,this.$ghost=null,this.hit_areas=[],this.is_dragging=!1,this.current_item=null}return a.prototype.mouseCapture=function(a){var b=$(a.target);if(!this.mustCaptureElement(b))return null;if(this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(b))return null;var c=this.tree_widget._getNodeElement(b);return c&&this.tree_widget.options.onCanMove&&(this.tree_widget.options.onCanMove(c.node)||(c=null)),this.current_item=c,null!=this.current_item},a.prototype.generateHitAreas=function(){if(this.current_item){var a=new i(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom);this.hit_areas=a.generate()}else this.hit_areas=[]},a.prototype.mouseStart=function(a){if(this.current_item){this.refresh();var b=$(a.target).offset(),c=this.current_item.node,d=this.tree_widget.options.autoEscape?f.html_escape(c.name):c.name;return this.drag_element=new j(d,a.page_x-b.left,a.page_y-b.top,this.tree_widget.element),this.is_dragging=!0,this.current_item.$element.addClass("jqtree-moving"),!0}return!1},a.prototype.mouseDrag=function(a){if(this.current_item&&this.drag_element){this.drag_element.move(a.page_x,a.page_y);var b=this.findHoveredArea(a.page_x,a.page_y);return this.canMoveToArea(b)&&b?(b.node.isFolder()||this.stopOpenFolderTimer(),this.hovered_area!==b&&(this.hovered_area=b,this.mustOpenFolderTimer(b)?this.startOpenFolderTimer(b.node):this.stopOpenFolderTimer(),this.updateDropHint())):(this.removeHover(),this.removeDropHint(),this.stopOpenFolderTimer()),b||this.tree_widget.options.onDragMove&&this.tree_widget.options.onDragMove(this.current_item.node,a.original_event),!0}return!1},a.prototype.mouseStop=function(a){this.moveItem(a),this.clear(),this.removeHover(),this.removeDropHint(),this.removeHitAreas();var b=this.current_item;return this.current_item&&(this.current_item.$element.removeClass("jqtree-moving"),this.current_item=null),this.is_dragging=!1,!this.hovered_area&&b&&this.tree_widget.options.onDragStop&&this.tree_widget.options.onDragStop(b.node,a.original_event),!1},a.prototype.refresh=function(){this.removeHitAreas(),this.current_item&&(this.generateHitAreas(),this.current_item=this.tree_widget._getNodeElementForNode(this.current_item.node),this.is_dragging&&this.current_item.$element.addClass("jqtree-moving"))},a.prototype.mustCaptureElement=function(a){return!a.is("input,select,textarea")},a.prototype.canMoveToArea=function(a){if(a&&this.current_item){if(this.tree_widget.options.onCanMoveTo){var b=e.getPositionName(a.position);return this.tree_widget.options.onCanMoveTo(this.current_item.node,a.node,b)}return!0}return!1},a.prototype.removeHitAreas=function(){this.hit_areas=[]},a.prototype.clear=function(){this.drag_element&&(this.drag_element.remove(),this.drag_element=null)},a.prototype.removeDropHint=function(){this.previous_ghost&&this.previous_ghost.remove()},a.prototype.removeHover=function(){this.hovered_area=null},a.prototype.findHoveredArea=function(a,b){var c=this.getTreeDimensions();if(a<c.left||b<c.top||a>c.right||b>c.bottom)return null;for(var d=0,e=this.hit_areas.length;d<e;){var f=d+e>>1,g=this.hit_areas[f];if(b<g.top)e=f;else{if(!(b>g.bottom))return g;d=f+1}}return null},a.prototype.mustOpenFolderTimer=function(a){var b=a.node;return b.isFolder()&&!b.is_open&&a.position===e.Position.Inside},a.prototype.updateDropHint=function(){if(this.hovered_area){this.removeDropHint();var a=this.tree_widget._getNodeElementForNode(this.hovered_area.node);this.previous_ghost=a.addDropHint(this.hovered_area.position)}},a.prototype.startOpenFolderTimer=function(a){var b=this,c=function(){b.tree_widget._openNode(a,b.tree_widget.options.slide,function(){b.refresh(),b.updateDropHint()})};this.stopOpenFolderTimer(),this.open_folder_timer=setTimeout(c,this.tree_widget.options.openFolderDelay)},a.prototype.stopOpenFolderTimer=function(){this.open_folder_timer&&(clearTimeout(this.open_folder_timer),this.open_folder_timer=null)},a.prototype.moveItem=function(a){var b=this;if(this.current_item&&this.hovered_area&&this.hovered_area.position!==e.Position.None&&this.canMoveToArea(this.hovered_area)){var c=this.current_item.node,d=this.hovered_area.node,f=this.hovered_area.position,g=c.parent;f===e.Position.Inside&&(this.hovered_area.node.is_open=!0);var h=function(){b.tree_widget.tree.moveNode(c,d,f),b.tree_widget.element.empty(),b.tree_widget._refreshElements(null)};this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:c,target_node:d,position:e.getPositionName(f),previous_parent:g,do_move:h,original_event:a.original_event}}).isDefaultPrevented()||h()}},a.prototype.getTreeDimensions=function(){var a=this.tree_widget.element.offset();return{left:a.left,top:a.top,right:a.left+this.tree_widget.element.width(),bottom:a.top+this.tree_widget.element.height()+16}},a}();b.DragAndDropHandler=g;var h=function(){function a(a){this.tree=a}return a.prototype.iterate=function(){var a=this,b=!0,c=function(d,e){var f=(d.is_open||!d.element)&&d.hasChildren(),g=null;if(d.element){if(g=$(d.element),!g.is(":visible"))return;b&&(a.handleFirstNode(d),b=!1),d.hasChildren()?d.is_open?a.handleOpenFolder(d,g)||(f=!1):a.handleClosedFolder(d,e,g):a.handleNode(d,e,g)}if(f){var h=d.children.length;d.children.forEach(function(a,b){b===h-1?c(d.children[b],null):c(d.children[b],d.children[b+1])}),d.is_open&&g&&a.handleAfterOpenFolder(d,e)}};c(this.tree,null)},a}(),i=function(a){function b(b,c,d){var e=a.call(this,b)||this;return e.current_node=c,e.tree_bottom=d,e}return d(b,a),b.prototype.generate=function(){return this.positions=[],this.last_top=0,this.iterate(),this.generateHitAreas(this.positions)},b.prototype.generateHitAreas=function(a){for(var b=-1,c=[],d=[],e=0,f=a;e<f.length;e++){var g=f[e];g.top!==b&&c.length&&(c.length&&this.generateHitAreasForGroup(d,c,b,g.top),b=g.top,c=[]),c.push(g)}return this.generateHitAreasForGroup(d,c,b,this.tree_bottom),d},b.prototype.handleOpenFolder=function(a,b){return a!==this.current_node&&(a.children[0]!==this.current_node&&this.addPosition(a,e.Position.Inside,this.getTop(b)),!0)},b.prototype.handleClosedFolder=function(a,b,c){var d=this.getTop(c);a===this.current_node?this.addPosition(a,e.Position.None,d):(this.addPosition(a,e.Position.Inside,d),b!==this.current_node&&this.addPosition(a,e.Position.After,d))},b.prototype.handleFirstNode=function(a){a!==this.current_node&&this.addPosition(a,e.Position.Before,this.getTop($(a.element)))},b.prototype.handleAfterOpenFolder=function(a,b){a===this.current_node||b===this.current_node?this.addPosition(a,e.Position.None,this.last_top):this.addPosition(a,e.Position.After,this.last_top)},b.prototype.handleNode=function(a,b,c){var d=this.getTop(c);a===this.current_node?this.addPosition(a,e.Position.None,d):this.addPosition(a,e.Position.Inside,d),b===this.current_node||a===this.current_node?this.addPosition(a,e.Position.None,d):this.addPosition(a,e.Position.After,d)},b.prototype.getTop=function(a){return a.offset().top},b.prototype.addPosition=function(a,b,c){var d={top:c,bottom:0,node:a,position:b};this.positions.push(d),this.last_top=c},b.prototype.generateHitAreasForGroup=function(a,b,c,d){for(var e=Math.min(b.length,4),f=Math.round((d-c)/e),g=c,h=0;h<e;){var i=b[h];a.push({top:g,bottom:g+f,node:i.node,position:i.position}),g+=f,h+=1}},b}(h);b.HitAreasGenerator=i;var j=function(){function a(a,b,c,d){this.offset_x=b,this.offset_y=c,this.$element=$('<span class="jqtree-title jqtree-dragging">'+a+"</span>"),this.$element.css("position","absolute"),d.append(this.$element)}return a.prototype.move=function(a,b){this.$element.offset({left:a-this.offset_x,top:b-this.offset_y})},a.prototype.remove=function(){this.$element.remove()},a}();b.DragElement=j},function(a,b,c){b.__esModule=!0;var d=c(1),e=function(){function a(a){this.tree_widget=a,this.opened_icon_element=this.createButtonElement(a.options.openedIcon),this.closed_icon_element=this.createButtonElement(a.options.closedIcon)}return a.prototype.render=function(a){a&&a.parent?this.renderFromNode(a):this.renderFromRoot()},a.prototype.renderFromRoot=function(){var a=this.tree_widget.element;a.empty(),this.createDomElements(a[0],this.tree_widget.tree.children,!0,1)},a.prototype.renderFromNode=function(a){var b=$(a.element),c=this.createLi(a,a.getLevel());this.attachNodeData(a,c),b.after(c),b.remove(),a.children&&this.createDomElements(c,a.children,!1,a.getLevel()+1)},a.prototype.createDomElements=function(a,b,c,d){var e=this.createUl(c);a.appendChild(e);for(var f=0,g=b;f<g.length;f++){var h=g[f],i=this.createLi(h,d);e.appendChild(i),this.attachNodeData(h,i),h.hasChildren()&&this.createDomElements(i,h.children,!1,d+1)}},a.prototype.attachNodeData=function(a,b){a.element=b,$(b).data("node",a)},a.prototype.createUl=function(a){var b,c;a?(b="jqtree-tree",c="tree",this.tree_widget.options.rtl&&(b+=" jqtree-rtl")):(b="",c="group");var d=document.createElement("ul");return d.className="jqtree_common "+b,d.setAttribute("role",c),d},a.prototype.createLi=function(a,b){var c=Boolean(this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(a)),d=a.isFolder()?this.createFolderLi(a,b,c):this.createNodeLi(a,b,c);return this.tree_widget.options.onCreateLi&&this.tree_widget.options.onCreateLi(a,$(d),c),d},a.prototype.createFolderLi=function(a,b,c){var d=this.getButtonClasses(a),e=this.getFolderClasses(a,c),f=a.is_open?this.opened_icon_element:this.closed_icon_element,g=document.createElement("li");g.className="jqtree_common "+e,g.setAttribute("role","presentation");var h=document.createElement("div");h.className="jqtree-element jqtree_common",h.setAttribute("role","presentation"),g.appendChild(h);var i=document.createElement("a");return i.className=d,i.appendChild(f.cloneNode(!1)),i.setAttribute("role","presentation"),i.setAttribute("aria-hidden","true"),this.tree_widget.options.buttonLeft&&h.appendChild(i),h.appendChild(this.createTitleSpan(a.name,b,c,a.is_open,!0)),this.tree_widget.options.buttonLeft||h.appendChild(i),g},a.prototype.createNodeLi=function(a,b,c){var d=["jqtree_common"];c&&d.push("jqtree-selected");var e=d.join(" "),f=document.createElement("li");f.className=e,f.setAttribute("role","presentation");var g=document.createElement("div");return g.className="jqtree-element jqtree_common",g.setAttribute("role","presentation"),f.appendChild(g),g.appendChild(this.createTitleSpan(a.name,b,c,a.is_open,!1)),f},a.prototype.createTitleSpan=function(a,b,c,e,f){var g=document.createElement("span"),h="jqtree-title jqtree_common";return f&&(h+=" jqtree-title-folder"),g.className=h,g.setAttribute("role","treeitem"),g.setAttribute("aria-level",""+b),g.setAttribute("aria-selected",d.getBoolString(c)),g.setAttribute("aria-expanded",d.getBoolString(e)),c&&g.setAttribute("tabindex","0"),g.innerHTML=this.escapeIfNecessary(a),g},a.prototype.getButtonClasses=function(a){var b=["jqtree-toggler","jqtree_common"];return a.is_open||b.push("jqtree-closed"),this.tree_widget.options.buttonLeft?b.push("jqtree-toggler-left"):b.push("jqtree-toggler-right"),b.join(" ")},a.prototype.getFolderClasses=function(a,b){var c=["jqtree-folder"];return a.is_open||c.push("jqtree-closed"),b&&c.push("jqtree-selected"),a.is_loading&&c.push("jqtree-loading"),c.join(" ")},a.prototype.escapeIfNecessary=function(a){return this.tree_widget.options.autoEscape?d.html_escape(a):a},a.prototype.createButtonElement=function(a){if("string"==typeof a){var b=document.createElement("div");return b.innerHTML=a,document.createTextNode(b.innerHTML)}return $(a)[0]},a}();b.default=e},function(a,b,c){b.__esModule=!0;var d=function(){function a(a){this.tree_widget=a,a.options.keyboardSupport&&$(document).on("keydown.jqtree",$.proxy(this.handleKeyDown,this))}return a.prototype.deinit=function(){$(document).off("keydown.jqtree")},a.prototype.moveDown=function(){var a=this.tree_widget.getSelectedNode();return!!a&&this.selectNode(a.getNextNode())},a.prototype.moveUp=function(){var a=this.tree_widget.getSelectedNode();return!!a&&this.selectNode(a.getPreviousNode())},a.prototype.moveRight=function(){var a=this.tree_widget.getSelectedNode();return!a||(!a.isFolder()||(a.is_open?this.selectNode(a.getNextNode()):(this.tree_widget.openNode(a),!1)))},a.prototype.moveLeft=function(){var a=this.tree_widget.getSelectedNode();return!a||(a.isFolder()&&a.is_open?(this.tree_widget.closeNode(a),!1):this.selectNode(a.getParent()))},a.prototype.handleKeyDown=function(b){if(!this.canHandleKeyboard())return!0;switch(b.which){case a.DOWN:return this.moveDown();case a.UP:return this.moveUp();case a.RIGHT:return this.moveRight();case a.LEFT:return this.moveLeft();default:return!0}},a.prototype.selectNode=function(a){return!a||(this.tree_widget.selectNode(a),this.tree_widget.scroll_handler&&!this.tree_widget.scroll_handler.isScrolledIntoView($(a.element).find(".jqtree-element"))&&this.tree_widget.scrollToNode(a),!1)},a.prototype.canHandleKeyboard=function(){return this.tree_widget.options.keyboardSupport&&this.isFocusOnTree()&&null!=this.tree_widget.getSelectedNode()},a.prototype.isFocusOnTree=function(){var a=document.activeElement;return a&&"SPAN"===a.tagName&&this.tree_widget._containsElement(a)},a}();d.LEFT=37,d.UP=38,d.RIGHT=39,d.DOWN=40,b.default=d},function(a,b,c){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b.__esModule=!0;var e=c(2),f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.setMouseDelay=function(a){this.mouse_delay=a},b.prototype._init=function(){this.$el.on("mousedown.mousewidget",$.proxy(this._mouseDown,this)),this.$el.on("touchstart.mousewidget",$.proxy(this._touchStart,this)),this.is_mouse_started=!1,this.mouse_delay=0,this._mouse_delay_timer=null,this._is_mouse_delay_met=!0,this.mouse_down_info=null},b.prototype._deinit=function(){this.$el.off("mousedown.mousewidget"),this.$el.off("touchstart.mousewidget");var a=$(document);a.off("mousemove.mousewidget"),a.off("mouseup.mousewidget")},b.prototype._mouseDown=function(a){if(1===a.which){var b=this._handleMouseDown(this._getPositionInfo(a));return b&&a.preventDefault(),b}},b.prototype._handleMouseDown=function(a){if(this.is_mouse_started&&this._handleMouseUp(a),this.mouse_down_info=a,this._mouseCapture(a))return this._handleStartMouse(),!0},b.prototype._handleStartMouse=function(){var a=$(document);a.on("mousemove.mousewidget",$.proxy(this._mouseMove,this)),a.on("touchmove.mousewidget",$.proxy(this._touchMove,this)),a.on("mouseup.mousewidget",$.proxy(this._mouseUp,this)),a.on("touchend.mousewidget",$.proxy(this._touchEnd,this)),this.mouse_delay&&this._startMouseDelayTimer()},b.prototype._startMouseDelayTimer=function(){var a=this;this._mouse_delay_timer&&clearTimeout(this._mouse_delay_timer),this._mouse_delay_timer=setTimeout(function(){a._is_mouse_delay_met=!0},this.mouse_delay),this._is_mouse_delay_met=!1},b.prototype._mouseMove=function(a){return this._handleMouseMove(a,this._getPositionInfo(a))},b.prototype._handleMouseMove=function(a,b){return this.is_mouse_started?(this._mouseDrag(b),a.preventDefault()):!(!this.mouse_delay||this._is_mouse_delay_met)||(this.mouse_down_info&&(this.is_mouse_started=!1!==this._mouseStart(this.mouse_down_info)),this.is_mouse_started?this._mouseDrag(b):this._handleMouseUp(b),!this.is_mouse_started)},b.prototype._getPositionInfo=function(a){return{page_x:a.pageX,page_y:a.pageY,target:a.target,original_event:a}},b.prototype._mouseUp=function(a){return this._handleMouseUp(this._getPositionInfo(a))},b.prototype._handleMouseUp=function(a){var b=$(document);b.off("mousemove.mousewidget"),b.off("touchmove.mousewidget"),b.off("mouseup.mousewidget"),b.off("touchend.mousewidget"),this.is_mouse_started&&(this.is_mouse_started=!1,this._mouseStop(a))},b.prototype._touchStart=function(a){var b=a.originalEvent;if(!(b.touches.length>1)){var c=b.changedTouches[0];return this._handleMouseDown(this._getPositionInfo(c))}},b.prototype._touchMove=function(a){var b=a.originalEvent;if(!(b.touches.length>1)){var c=b.changedTouches[0];return this._handleMouseMove(a,this._getPositionInfo(c))}},b.prototype._touchEnd=function(a){var b=a.originalEvent;if(!(b.touches.length>1)){var c=b.changedTouches[0];return this._handleMouseUp(this._getPositionInfo(c))}},b}(e.default);b.default=f},function(a,b,c){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b.__esModule=!0;var e=c(0),f=function(){function a(a,b){this.init(a,b)}return a.prototype.init=function(a,b){this.node=a,this.tree_widget=b,a.element||(a.element=this.tree_widget.element.get(0)),this.$element=$(a.element)},a.prototype.addDropHint=function(a){return a===e.Position.Inside?new h(this.$element):new i(this.node,this.$element,a)},a.prototype.select=function(){var a=this.getLi();a.addClass("jqtree-selected"),a.attr("aria-selected","true");var b=this.getSpan();b.attr("tabindex",0),b.focus()},a.prototype.deselect=function(){var a=this.getLi();a.removeClass("jqtree-selected"),a.attr("aria-selected","false");var b=this.getSpan();b.attr("tabindex",-1),b.blur()},a.prototype.getUl=function(){return this.$element.children("ul:first")},a.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")},a.prototype.getLi=function(){return this.$element},a}();b.NodeElement=f;var g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),b.prototype.open=function(a,b){var c=this;if(void 0===b&&(b=!0),!this.node.is_open){this.node.is_open=!0;var d=this.getButton();d.removeClass("jqtree-closed"),d.html("");var e=d.get(0);if(e){var f=this.tree_widget.renderer.opened_icon_element.cloneNode(!1);e.appendChild(f)}var g=function(){c.getLi().removeClass("jqtree-closed"),c.getSpan().attr("aria-expanded","true"),a&&a(c.node),c.tree_widget._triggerEvent("tree.open",{node:c.node})};b?this.getUl().slideDown("fast",g):(this.getUl().show(),g())}},b.prototype.close=function(a){var b=this;if(void 0===a&&(a=!0),this.node.is_open){this.node.is_open=!1;var c=this.getButton();c.addClass("jqtree-closed"),c.html("");var d=c.get(0);if(d){var e=this.tree_widget.renderer.closed_icon_element.cloneNode(!1);d.appendChild(e)}var f=function(){b.getLi().addClass("jqtree-closed"),b.getSpan().attr("aria-expanded","false"),b.tree_widget._triggerEvent("tree.close",{node:b.node})};a?this.getUl().slideUp("fast",f):(this.getUl().hide(),f())}},b.prototype.addDropHint=function(a){return this.node.is_open||a!==e.Position.Inside?new i(this.node,this.$element,a):new h(this.$element)},b.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")},b}(f);b.FolderElement=g;var h=function(){function a(a){var b=a.children(".jqtree-element"),c=a.width()-4;this.$hint=$('<span class="jqtree-border"></span>'),b.append(this.$hint),this.$hint.css({width:c,height:b.outerHeight()-4})}return a.prototype.remove=function(){this.$hint.remove()},a}();b.BorderDropHint=h;var i=function(){function a(a,b,c){this.$element=b,this.node=a,this.$ghost=$('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span>\n            <span class="jqtree_common jqtree-line"></span></li>'),c===e.Position.After?this.moveAfter():c===e.Position.Before?this.moveBefore():c===e.Position.Inside&&(a.isFolder()&&a.is_open?this.moveInsideOpenFolder():this.moveInside())}return a.prototype.remove=function(){this.$ghost.remove()},a.prototype.moveAfter=function(){this.$element.after(this.$ghost)},a.prototype.moveBefore=function(){this.$element.before(this.$ghost)},
a.prototype.moveInsideOpenFolder=function(){$(this.node.children[0].element).before(this.$ghost)},a.prototype.moveInside=function(){this.$element.after(this.$ghost),this.$ghost.addClass("jqtree-inside")},a}();b.GhostDropHint=i},function(a,b,c){b.__esModule=!0;var d=c(1),e=function(){function a(a){this.tree_widget=a}return a.prototype.saveState=function(){var a=JSON.stringify(this.getState());this.tree_widget.options.onSetStateFromStorage?this.tree_widget.options.onSetStateFromStorage(a):this.supportsLocalStorage()&&localStorage.setItem(this.getKeyName(),a)},a.prototype.getStateFromStorage=function(){var a=this._loadFromStorage();return a?this._parseState(a):null},a.prototype.getState=function(){var a=this;return{open_nodes:function(){var b=[];return a.tree_widget.tree.iterate(function(a){return a.is_open&&a.id&&a.hasChildren()&&b.push(a.id),!0}),b}(),selected_node:function(){return a.tree_widget.getSelectedNodes().map(function(a){return a.id})}()}},a.prototype.setInitialState=function(a){if(a){var b=!1;return a.open_nodes&&(b=this._openInitialNodes(a.open_nodes)),a.selected_node&&(this._resetSelection(),this._selectInitialNodes(a.selected_node)),b}return!1},a.prototype.setInitialStateOnDemand=function(a,b){a?this._setInitialStateOnDemand(a.open_nodes,a.selected_node,b):b()},a.prototype.getNodeIdToBeSelected=function(){var a=this.getStateFromStorage();return a&&a.selected_node?a.selected_node[0]:null},a.prototype._parseState=function(a){var b=$.parseJSON(a);return b&&b.selected_node&&d.isInt(b.selected_node)&&(b.selected_node=[b.selected_node]),b},a.prototype._loadFromStorage=function(){return this.tree_widget.options.onGetStateFromStorage?this.tree_widget.options.onGetStateFromStorage():this.supportsLocalStorage()?localStorage.getItem(this.getKeyName()):void 0},a.prototype._openInitialNodes=function(a){for(var b=!1,c=0,d=a;c<d.length;c++){var e=d[c],f=this.tree_widget.getNodeById(e);f&&(f.load_on_demand?b=!0:f.is_open=!0)}return b},a.prototype._selectInitialNodes=function(a){for(var b=0,c=0,d=a;c<d.length;c++){var e=d[c],f=this.tree_widget.getNodeById(e);f&&(b+=1,this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.addToSelection(f))}return 0!==b},a.prototype._resetSelection=function(){var a=this.tree_widget.select_node_handler;if(a){a.getSelectedNodes().forEach(function(b){a.removeFromSelection(b)})}},a.prototype._setInitialStateOnDemand=function(a,b,c){var d=this,e=0,f=a,g=function(){for(var a=[],g=0,i=f;g<i.length;g++){var j=i[g],k=d.tree_widget.getNodeById(j);k?k.is_loading||(k.load_on_demand?h(k):d.tree_widget._openNode(k,!1,null)):a.push(j)}f=a,d._selectInitialNodes(b)&&d.tree_widget._refreshElements(null),0===e&&c()},h=function(a){e+=1,d.tree_widget._openNode(a,!1,function(){e-=1,g()})};g()},a.prototype.getKeyName=function(){return"string"==typeof this.tree_widget.options.saveState?this.tree_widget.options.saveState:"tree"},a.prototype.supportsLocalStorage=function(){return null==this._supportsLocalStorage&&(this._supportsLocalStorage=function(){if(null==localStorage)return!1;try{var a="_storage_test";sessionStorage.setItem(a,"value"),sessionStorage.removeItem(a)}catch(a){return!1}return!0}()),this._supportsLocalStorage},a}();b.default=e},function(a,b,c){b.__esModule=!0;var d=function(){function a(a){this.tree_widget=a,this.previous_top=-1,this.is_initialized=!1}return a.prototype.checkScrolling=function(){if(this._ensureInit(),this.tree_widget.dnd_handler){var a=this.tree_widget.dnd_handler.hovered_area;a&&a.top!==this.previous_top&&(this.previous_top=a.top,this.$scroll_parent?this._handleScrollingWithScrollParent(a):this._handleScrollingWithDocument(a))}},a.prototype.scrollTo=function(a){if(this._ensureInit(),this.$scroll_parent)this.$scroll_parent[0].scrollTop=a;else{var b=this.tree_widget.$el.offset().top;$(document).scrollTop(a+b)}},a.prototype.isScrolledIntoView=function(a){this._ensureInit();var b,c,d,e;return this.$scroll_parent?(e=0,c=this.$scroll_parent.height(),d=a.offset().top-this.scroll_parent_top,b=d+a.height()):(e=$(window).scrollTop(),c=e+$(window).height(),d=a.offset().top,b=d+a.height()),b<=c&&d>=e},a.prototype._initScrollParent=function(){var a=this,b=function(){a.scroll_parent_top=0,a.$scroll_parent=null};"fixed"===this.tree_widget.$el.css("position")&&b();var c=function(){var b=["overflow","overflow-y"],c=function(a){for(var c=0,d=b;c<d.length;c++){var e=d[c],f=a.css(e);if("auto"===f||"scroll"===f)return!0}return!1};if(c(a.tree_widget.$el))return a.tree_widget.$el;for(var d=0,e=a.tree_widget.$el.parents().get();d<e.length;d++){var f=e[d],g=$(f);if(c(g))return g}return null}();c&&c.length&&"HTML"!==c[0].tagName?(this.$scroll_parent=c,this.scroll_parent_top=this.$scroll_parent.offset().top):b(),this.is_initialized=!0},a.prototype._ensureInit=function(){this.is_initialized||this._initScrollParent()},a.prototype._handleScrollingWithScrollParent=function(a){if(this.$scroll_parent){this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-a.bottom<20?(this.$scroll_parent[0].scrollTop+=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1):a.top-this.scroll_parent_top<20&&(this.$scroll_parent[0].scrollTop-=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1)}},a.prototype._handleScrollingWithDocument=function(a){a.top-$(document).scrollTop()<20?$(document).scrollTop($(document).scrollTop()-20):$(window).height()-(a.bottom-$(document).scrollTop())<20&&$(document).scrollTop($(document).scrollTop()+20)},a}();b.default=d},function(a,b,c){b.__esModule=!0;var d=function(){function a(a){this.tree_widget=a,this.clear()}return a.prototype.getSelectedNode=function(){var a=this.getSelectedNodes();return!!a.length&&a[0]},a.prototype.getSelectedNodes=function(){if(this.selected_single_node)return[this.selected_single_node];var a=[];for(var b in this.selected_nodes)if(this.selected_nodes.hasOwnProperty(b)){var c=this.tree_widget.getNodeById(b);c&&a.push(c)}return a},a.prototype.getSelectedNodesUnder=function(a){if(this.selected_single_node)return a.isParentOf(this.selected_single_node)?[this.selected_single_node]:[];var b=[];for(var c in this.selected_nodes)if(this.selected_nodes.hasOwnProperty(c)){var d=this.tree_widget.getNodeById(c);d&&a.isParentOf(d)&&b.push(d)}return b},a.prototype.isNodeSelected=function(a){return!!a&&(null!=a.id?!!this.selected_nodes[a.id]:!!this.selected_single_node&&this.selected_single_node.element===a.element)},a.prototype.clear=function(){this.selected_nodes={},this.selected_single_node=null},a.prototype.removeFromSelection=function(a,b){var c=this;void 0===b&&(b=!1),null==a.id?this.selected_single_node&&a.element===this.selected_single_node.element&&(this.selected_single_node=null):(delete this.selected_nodes[a.id],b&&a.iterate(function(){return delete c.selected_nodes[a.id],!0}))},a.prototype.addToSelection=function(a){null!=a.id?this.selected_nodes[a.id]=!0:this.selected_single_node=a},a}();b.default=d},function(a,b,c){b.__esModule=!0;b.default="1.4.1"},,,,,,,function(a,b,c){a.exports=c(3)}])}.apply(a,arguments)})}(this),define("mockup-patterns-tree",["jquery","pat-base","mockup-utils","jqtree"],function(a,b,c){"use strict";return b.extend({name:"tree",trigger:".pat-tree",parser:"mockup",defaults:{dragAndDrop:!1,autoOpen:!1,selectable:!0,keyboardSupport:!0,onLoad:null},init:function(){var b=this;for(var d in b.options){var e=b.defaults[d];void 0!==e&&"boolean"==typeof e&&(b.options[d]=c.bool(b.options[d]))}if(b.options.dragAndDrop&&void 0===b.options.onCanMoveTo&&(b.options.onCanMoveTo=function(a,b,c){return void 0===b.folder||!0===b.folder}),b.options.data&&"string"==typeof b.options.data&&(b.options.data=a.parseJSON(b.options.data)),null!==b.options.onLoad){var f=a.extend({},b.options);a.getJSON(f.dataUrl,function(a){f.data=a,delete f.dataUrl,b.tree=b.$el.tree(f),b.options.onLoad(b)})}else b.tree=b.$el.tree(b.options)}})}),function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.4",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in").attr("aria-hidden",!1),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a('<div class="modal-backdrop '+e+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),define("castle-url/libs/bootstrap/js/modal",function(){}),define("castle-url/components/modal",["jquery","castle-url/libs/react/react.min","mockup-patterns-modal","mockup-utils","castle-url/libs/bootstrap/js/modal"],function(a,b,c,d){"use strict";c&&void 0===c.prototype._hide&&(c.prototype._hide=c.prototype.hide,c.prototype.hide=function(){var b=this.$modal.closest(".plone-modal-wrapper"),d=parseInt(b.css("zIndex")),e=a(".plone-modal-wrapper:visible,.modal-open .castle-modal-wrapper .modal:visible");if(e.size()>1&&a.mosaic&&a.mosaic.overlay&&a.mosaic.overlay.app){var f=0;if(e.each(function(){var b=parseInt(a(this).css("zIndex"));b>f&&(f=b)}),f>d)return}c.prototype._hide.apply(this,[])}),a(document).keyup(function(b){if(27==b.keyCode){d.loading.hide();var c,e=0;if(a(".plone-modal-wrapper:visible,.modal-open .castle-modal-wrapper .modal:visible").each(function(){var b=parseInt(a(this).css("zIndex"))+0;b>e&&(e=b,c=a(this))}),c)if(c.hasClass("plone-modal-wrapper"))if(c.hasClass("mosaic-overlay"))a.mosaic.overlay.close();else{var f=c.find(".plone-modal").data("pattern-plone-modal");f&&f.hide()}else a("button.close",c).trigger("click")}});var e=b.DOM,f=e.div,g=e.button,h=e.span;return{getInitialState:function(){return{zIndex:3e3,shown:!1,preventClose:!1}},show:function(){a(this.refs.modal.getDOMNode()).modal("show")},hide:function(b){b&&b.preventDefault(),a(this.refs.modal.getDOMNode()).modal("hide")},getModalEl:function(){return a(this.refs.modal.getDOMNode())},componentDidMount:function(){var b=this,c=b.getModalEl();c.on("shown.bs.modal",function(a){b.props.onShown&&b.props.onShown(a,b)}),c.on("show.bs.modal",function(){b.state.shown=!0}),c.modal(this.props.modalOptions),c.on("hide.bs.modal",function(a){if(b.state.preventClose)return void a.preventDefault();b.state.shown=!1}),c.on("hidden.bs.modal",function(c){b.props.onHidden&&b.props.onHidden(c,b);var d=a(b.getDOMNode());0===a(".castle-modal-wrapper,.plone-modal-wrapper").size()&&a(".plone-modal-backdrop").remove(),a(".modal:visible").size()>0&&a("body").addClass("modal-open"),setTimeout(function(){d.remove()},1e3)});var d=3001;a(".plone-modal-wrapper,.plone-modal-backdrop,.modal-open .castle-modal-wrapper .modal").each(function(){d=Math.max(d,parseInt(a(this).css("zIndex"))+1||3001)}),b.state.zIndex=d,b.setModalZIndex()},componentDidUpdate:function(){this.setModalZIndex()},setModalZIndex:function(){a(this.refs.modal.getDOMNode()).css({"z-index":this.state.zIndex})},getId:function(){return this.props.id},getTitle:function(){return this.props.title},render:function(){var a={ref:"modal",className:"modal fade"},b=this.getId();b&&(a.id=b);var c={};return this.props.width&&(c.width=this.props.width),f({className:"castle-modal-wrapper",ref:"container"},f(a,[f({className:"modal-dialog",style:c},this.renderContentContainer())]))},renderContentContainer:function(){return f({className:"modal-content"},[f({className:"modal-header"},this.renderHeader()),f({className:"modal-body"},this.renderContent()),f({className:"modal-footer"},this.renderFooter())])},renderHeader:function(){return[g({type:"button",className:"close",onClick:this.hide},[f({className:"close-button"}),h({"aria-hidden":"true"},"")]),e.h4({},this.getTitle())]},renderContent:function(){return f({})},renderFooter:function(){return""},getDefaultProps:function(){return{id:null,title:"Modal title",modalOptions:{backdrop:"static",show:!0},onHidden:function(){},onShown:function(){},width:null}}}}),define("mockup-ui-url/views/base",["jquery","underscore","backbone","translate"],function(a,b,c,d){"use strict";return c.View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(a){this.options=a;for(var b in this.options)this[b]=this.options[b];this.options._t=d},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){if(null!==this.template){var c=a.extend({_t:d},this.options,this.serializedModel()),e=this.template;"string"==typeof e&&(e=b.template(e)),this.$el.html(e(c))}},propagateEvent:function(a){if(a.indexOf(":")>0){var b=a.split(":")[0];if(""!==this.eventPrefix&&(b===this.eventPrefix||b===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(a){var b=[].slice.call(arguments,0);""!==this.eventPrefix&&(b[0]=this.eventPrefix+":"+a,c.View.prototype.trigger.apply(this,b),this.id&&(b[0]=this.eventPrefix+"."+this.id+":"+a,c.View.prototype.trigger.apply(this,b)))}})}),define("mockup-ui-url/views/container",["jquery","underscore","mockup-ui-url/views/base"],function(a,b,c){"use strict";return c.extend({id:"",items:[],itemContainer:null,isOffsetParent:!0,idPrefix:"container-",render:function(){return this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this.applyTemplate(),this.renderItems(),this.bindEvents(),this.isOffsetParent&&this.$el.addClass("ui-offset-parent"),this.trigger("render",this),this.afterRender(),this.$el.data("component",this),this},renderItems:function(){var c;if(null!==this.itemContainer){if(c=a(this.itemContainer,this.$el),0===c.length)throw"Item Container element not found."}else c=this.$el;b.each(this.items,function(a){!0===a.appendInContainer?c.append(a.render().$el):a.render()},this)},bindEvents:function(){var a=this;b.each(this.items,function(b){b.on("all",function(){var b,c=[].slice,d=arguments[0],e=""!==a.id?a.id+"."+d:d;if(arguments.length>1&&(b=arguments[1]),e!==d){var f=c.call(arguments,0);f[0]=e,a.trigger.apply(a,f)}void 0!==b&&!0===b.isUIView&&!0===b.propagateEvent(d)&&a.trigger.apply(a,arguments)})})},get:function(a){return b.findWhere(this.items,{id:a})},add:function(a){if(void 0!==a.id&&this.get(a.id))throw"Another item with the same `id` already exists.";this.items.push(a)}})}),define("text",["module"],function(a){"use strict";var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;b<3;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(a){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return!i||(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e))},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;if(0===h.indexOf("empty:"))return void d();!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)})},write:function(a,c,d,e){if(n.hasOwnProperty(c)){var f=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+f+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(c){var d=function(a){return e(j,a)};d.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,d,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("\ufeff")&&(e=e.substring(1)),b(e)}catch(a){d&&d(a)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(b){var e,f;4===g.readyState&&(e=g.status||0,e>399&&e<600?(f=new Error(a+" HTTP status: "+e),f.xhr=g,d&&d(f)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e=new java.io.File(a),f=java.lang.System.getProperty("line.separator"),g=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),h="";try{for(c=new java.lang.StringBuffer,d=g.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=g.readLine());)c.append(f),c.append(d);h=String(c.toString())}finally{g.close()}b(h)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(a){throw new Error((h&&h.path||"")+": "+a)}}),b}),define("text!mockup-ui-url/templates/popover.xml",[],function(){return'<div class="arrow"></div>\n<div class="popover-title">\n</div>\n<div class="items popover-content">\n</div>\n\n'}),define("mockup-ui-url/views/popover",["jquery","underscore","mockup-ui-url/views/container","mockup-patterns-backdrop","text!mockup-ui-url/templates/popover.xml"],function(a,b,c,d,e){"use strict";return c.extend({tagName:"div",className:"popover",eventPrefix:"popover",template:e,content:null,title:null,triggerView:null,idPrefix:"popover-",triggerEvents:{"button:click":"toggle"},placement:"bottom",events:{},opened:!1,closeOnOutClick:!0,appendInContainer:!0,backdrop:void 0,$backdrop:null,useBackdrop:!0,backdropOptions:{zIndex:"1009",opacity:"0.4",className:"backdrop backdrop-popover",classActiveName:"backdrop-active",closeOnEsc:!1,closeOnClick:!0},initialize:function(a){c.prototype.initialize.apply(this,[a]),this.bindTriggerEvents(),this.on("render",function(){this.$el.attr("role","tooltip").attr("aria-hidden","false"),this.renderTitle(),this.renderContent()},this)},afterRender:function(){},getTemplateOptions:function(){return this.options},renderTitle:function(){var a=this.title;"function"==typeof a&&(a=a(this.getTemplateOptions())),this.$(".popover-title").empty().append(a)},renderContent:function(){this.$(".popover-content").empty().append(this.content(this.getTemplateOptions()))},bindTriggerEvents:function(){this.triggerView&&b.each(this.triggerEvents,function(b,c){var d=this[b];d||a.error("Function not found."),this.stopListening(this.triggerView,c),this.listenTo(this.triggerView,c,d)},this)},getPosition:function(){var b=this.triggerView.$el;return a.extend({},{width:b[0].offsetWidth,height:b[0].offsetHeight},b.offset())},getBodyClassName:function(){var a="popover-";return this.options.id&&(a+=this.options.id+"-"),a+="active"},show:function(){a(".popover:visible").each(function(){var b=a(this).data("component");b&&b.hide()}),this.position(),this.setBackdrop(),!0===this.useBackdrop&&this.backdrop.show(),this.opened=!0,this.triggerView&&this.triggerView.$el.addClass("active"),this.uiEventTrigger("show",this),this.$el.attr("aria-hidden","false"),a("body").addClass(this.getBodyClassName())},position:function(){var a,b,c,d,e=this.getPosition(),f=this.$el;switch(b=this.placement,f.css({top:0,left:0}).addClass("active"),c=f[0].offsetWidth,d=f[0].offsetHeight,b){case"bottom":a={top:e.top+e.height,left:e.left+e.width/2-c/2};break;case"top":a={top:e.top-d,left:e.left+e.width/2-c/2};break;case"left":a={top:e.top+e.height/2-d/2,left:e.left-c};break;case"right":a={top:e.top+e.height/2-d/2,left:e.left+e.width}}this.applyPlacement(a,b)},applyPlacement:function(a,b){var c,d,e,f,g=this.$el,h=this.$el,i=h[0].offsetWidth,j=h[0].offsetHeight;g.removeClass(b),g.offset(a).addClass(b).addClass("active"),c=h[0].offsetWidth,d=h[0].offsetHeight,"top"===b&&d!==j&&(a.top=a.top+j-d,f=!0),"bottom"===b||"top"===b?(e=0,a.left<0&&(e=-2*a.left,a.left=0,g.removeClass(b),g.offset(a).addClass(b),c=h[0].offsetWidth,d=h[0].offsetHeight),this.positionArrow(e-i+c,c,"left")):this.positionArrow(d-j,d,"top"),f&&g.offset(a)},positionArrow:function(a,b,c){this.$(".arrow").css(c,a?50*(1-a/b)+"%":"")},hide:function(){this.opened=!1,this.$el.removeClass("active"),this.triggerView&&(this.triggerView.$el.removeClass("active"),this.triggerView.$el.attr("aria-hidden","true")),this.uiEventTrigger("hide",this),this.$el.attr("aria-hidden","true"),a("body").removeClass(this.getBodyClassName())},toggle:function(a,b){this.opened?this.hide():this.show()},setBackdrop:function(){if(!0===this.useBackdrop&&void 0===this.backdrop){var b=this;this.$backdrop=this.$el.closest(".ui-backdrop-element"),0===this.$backdrop.length&&(this.$backdrop=a("body")),this.backdrop=new d(this.$backdrop,this.backdropOptions),this.backdrop.$el.on("hidden.backdrop.patterns",function(a){"backdrop.patterns"===a.namespace&&(a.stopPropagation(),!0===b.opened&&b.hide())}),this.on("popover:hide",function(){this.backdrop.hide()},this)}}})}),define("castle-url/components/content-browser",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils","mockup-ui-url/views/popover","mockup-patterns-querystring"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=d.DOM,k=d.createClass({allSelected:function(){for(var a=this,b=a.props.parent.state.items,c=this.getAllSelected(),d=0;d<b.length;d++){var e=b[d];if(-1===c.indexOf(e.UID))return!1}return!0},getAllSelected:function(){var a=this,b=[];return a.props.parent.state.selected.forEach(function(a){b.push(a.UID)}),b},selectAllClicked:function(a){for(var b=this,c=b.props.parent.state.items,d=this.getAllSelected(),e=0;e<c.length;e++){var f=c[e];-1===d.indexOf(f.UID)&&b.props.onItemSelected.bind(b.props.parent,f)(a)}},render:function(){var a=this,b=a.props,d=b.parent,e=d.state.items,f="";return d.props.multiple&&(f=j.input({type:"checkbox",checked:a.allSelected(),onClick:a.selectAllClicked})),j.table({className:"contents table"},[j.thead({},j.tr({},[j.th({},f),j.th({},"Title"),j.th({},"Type"),j.th({},"State")])),j.tbody({},e.map(function(a){var e="contenttype-document contenttype-"+a.portal_type.toLowerCase();"Folder"===a.portal_type&&(e="contenttype-folder");var f=j.span({className:e,key:a.UID+"-icon"}),g=!1;c.each(d.state.selected,function(b){b.UID===a.UID&&(g=!0)});var h="",i=b.onItemSelected.bind(d,a);g&&(h+=" active","Remove",i=b.onItemRemoved.bind(d,a));var k=[f,j.span({className:"content-title"},a.Title)];a.is_folderish&&(k=j.a({className:"folderBox",href:"#2",onClick:b.onFolderSelected.bind(d,a)},k)),h+="state-"+a.review_state;var l="";return null!==d.props.selectableTypes&&-1===d.props.selectableTypes.indexOf(a.portal_type)||(l=j.input({type:"checkbox",checked:g,onClick:i})),j.tr({key:a.UID,className:h},[j.td({},l),j.td({},k),j.td({},a.portal_type),j.td({},a.review_state)])}))])},getDefaultProps:function(){return{parent:null,onItemSelected:function(){},onItemRemoved:function(){},onFolderSelected:function(){}}}}),l=d.createClass({render:function(){var b=this,c=b.props,d=c.parent,e=d.state.items,f=a("body").attr("data-portal-url")+"/++plone++castle/images/placeholder-image.png",g=a("body").attr("data-portal-url")+"/++plone++castle/images/placeholder-folder.png";return j.div({className:"row images-container"},e.map(function(a){var b=f;a.hasImage&&(b=a.getURL+"/@@images/image/preview"),!a.hasImage&&a.is_folderish&&(b=g);var e=j.div({className:"image-responsive",style:{"background-image":'url("'+b+'")'}});e=a.is_folderish?j.a({href:"#",onClick:c.onFolderSelected.bind(d,a)},e):j.a({href:"#",onClick:c.onItemSelected.bind(d,a)},e);var h=!1;return d.state.selected.forEach(function(b){b.UID===a.UID&&(h=!0)}),j.div({className:"col-md-3 image-item",key:a.UID},j.div({className:"image-wrapper"},[e,j.p({className:"image-title"},[j.label({htmlFor:a.UID+"-imageselect"},[j.input({type:"checkbox",checked:h,onClick:c.onItemSelected.bind(d,a),id:a.UID+"-imageselect"}),a.Title])])]))}))}});return g.Class([f],{getInitialState:function(){return{error:!1,items:[],page:1,total:0,filter:"",selected:[],sort_on:"modified",sort_order:"reverse",view:"table",showQuery:!1,criterias:[]}},componentDidMount:function(){var b=this;f.componentDidMount.apply(this);var d=a("body").attr("data-base-path");"/"!==b.props.query.currentPath&&"/"!==b.props.query.pattern.currentPath||!d||b.setPath(d),b.load();var e=b.refs.query_btn.getDOMNode(),g=a(e),j=b.refs.query_popover.getDOMNode(),k=a(j);b.props.query_popover=new h({id:"content-browser-query",title:"Query",useBackdrop:!1,content:c.template('<input class="pat-querystring" />'),placement:"left"}),b.props.query_popover.getPosition=function(){return a.extend({},{width:e.offsetWidth,height:e.offsetHeight},g.offset())},k.append(b.props.query_popover.render().el),b.props.query_popover.$el.addClass("query")
;var l=b.props.query_popover.$("input.pat-querystring"),m=new i(l,{indexOptionsUrl:a("body").attr("data-portal-url")+"/@@qsOptions",showPreviews:!1});m.$el.on("change",function(){b._qsTimeout&&clearTimeout(b._qsTimeout),b._qsTimeout=setTimeout(function(){var c=a.parseJSON(l.val());b.setStateReload({criterias:c,page:1})},200)}),m.$el.on("initialized",function(){m.$sortOn.on("change",function(){b.setStateReload({sort_on:m.$sortOn.val(),page:1})}),m.$sortOrder.change(function(){var a="ascending";m.$sortOrder[0].checked&&(a="reverse"),b.setStateReload({sort_order:a,page:1})}),m.component.props.storage.dispatcher.handleViewAction({actionType:"update",data:{sortOn:b.state.sort_on,reversed:"reverse"===b.state.sort_order}}),m.component.setState({sortOn:b.state.sort_on,reversed:"reverse"===b.state.sort_order})})},load:function(){var b=this;e.loading.show(),a.ajax({url:b.getQueryUrl(),dataType:"json"}).done(function(a){b.setState({items:a.results,total:a.total})}).fail(function(){b.setState({error:!0,items:[],total:0})}).always(function(){e.loading.hide()})},getQueryUrl:function(){var b=this,c=b.props.query;-1===c.options.attributes.indexOf("getURL")&&c.options.attributes.push("getURL"),-1===c.options.attributes.indexOf("hasImage")&&c.options.attributes.push("hasImage"),-1===c.options.attributes.indexOf("is_folderish")&&c.options.attributes.push("is_folderish"),c.options.sort_on=this.state.sort_on,c.options.sort_order=this.state.sort_order,c.options.useBaseCriteria=!0;var d=this.props.baseCriteria.slice();c.options.baseCriteria=d.concat(b.state.criterias.slice()),b.state.filter&&c.options.baseCriteria.push({i:"Title",o:"plone.app.querystring.operation.string.contains",v:b.state.filter}),c.options.sort_on||(c.options.sort_on="getObjPositionInParent");var e=c.getQueryData();e.batch=JSON.stringify(c.getBatch(b.state.page));var f=c.options.vocabularyUrl;return-1===f.indexOf("?")?f+="?":f+="&",f+a.param(e)},itemSelected:function(a,b){var c=this;if("INPUT"!==b.target.nodeName&&b.preventDefault(),c.props.multiple){var d=c.state.selected,e=!1;c.state.selected.forEach(function(b){b.UID===a.UID&&(e=!0)}),e?this.removeSelected(a):(d.push(a),c.setState({selected:d}))}else c.props.onSelectItem(a),c.hide()},removeSelected:function(a){var b=[];c.each(this.state.selected,function(c){c.UID!==a.UID&&b.push(c)}),this.setState({selected:b})},folderSelected:function(a,b){b.preventDefault();var c=this;c.setPath(a.path),c.state.filter="",c.state.page=1,c.load()},setPath:function(a){var b=this;b.props.query.currentPath=a,b.props.query.pattern&&(b.props.query.pattern.currentPath=a)},renderItems:function(){return"table"===this.state.view?d.createElement(k,{parent:this,onItemSelected:this.itemSelected,onItemRemoved:this.removeSelected,onFolderSelected:this.folderSelected}):"image"===this.state.view?d.createElement(l,{parent:this,onItemSelected:this.itemSelected,onItemRemoved:this.removeSelected,onFolderSelected:this.folderSelected}):[]},crumbClicked:function(a,b){b.preventDefault(),this.setPath(a),this.state.filter="",this.state.page=1,this.load()},renderBreadcrumbs:function(){var a=this,b=a.props.query.getCurrentPath().split("/");b[0]="/";var d="",e=[];return c.each(b,function(c,f){if(""!==c){var g=c,h="/";"/"===c?g="Home":(d=d+"/"+c,h=d),f<b.length-1?e.push(j.li({},j.a({href:"#",onClick:a.crumbClicked.bind(a,h)},g))):e.push(j.li({},g))}}),j.ol({className:"breadcrumb"},e)},filterChanged:function(a){this.setStateReload({filter:a.target.value,page:1})},setStateReload:function(a){var b=this;b.setState(a,function(){b._timeout&&clearTimeout(b._timeout),b._timeout=setTimeout(b.load,300)})},queryClicked:function(a){var b=this;a.preventDefault(),this.setState({showQuery:!this.state.showQuery},function(){b.props.query_popover.toggle()})},renderFilter:function(){var a={display:"block"};this.state.showQuery||(a.display="none");var b="castle-filter-container";return(this.state.criterias.length>0||this.state.filter.length>0)&&(b+=" active-filter"),j.div({className:b},[j.div({className:"input-group input-group-sm filter-group"},[j.input({type:"text",className:"form-control",placeholder:"Filter",onChange:this.filterChanged,value:this.state.filter}),j.span({className:"input-group-btn"},[j.a({href:"#",className:"btn btn-default",id:"castle-query-filter",ref:"query_btn",onClick:this.queryClicked},[j.span({className:"glyphicon glyphicon-search"}),"Query"])])]),j.div({className:"castle-content-browser-filter-popover",ref:"query_popover",style:a})])},renderContent:function(){var a=this;return j.div({className:"castle-content-browser"},[j.div({className:"row top"},[j.div({className:"col-md-5 castle-breadcrumbs-container"},a.renderBreadcrumbs()),j.div({className:"listing-type-selector col-md-3 col-md-offset-1"},a.renderViewSelection()),j.div({className:"col-md-3"},a.renderFilter())]),a.renderItems(),a.renderPaging()])},pageClicked:function(a,b){b.preventDefault(),this.state.page=a,this.load()},changeView:function(a,b){b.preventDefault(),this.setState({view:a})},renderViewSelection:function(){return[j.span({className:"label"},"View as:"),j.button({className:"plone-btn plone-btn-default",disabled:"table"===this.state.view,onClick:this.changeView.bind(this,"table")},j.span({className:"glyphicon glyphicon-list"})),j.button({className:"plone-btn plone-btn-default",disabled:"image"===this.state.view,onClick:this.changeView.bind(this,"image")},j.span({className:"glyphicon glyphicon-th-large"}))]},renderPaging:function(){var a=this;if(a.state.total<=a.props.query.options.batchSize)return"";var b=Math.ceil(a.state.total/a.props.query.options.batchSize);return j.div({className:"pagination-centered"},j.ul({className:"castle-pagination pagination-sm pagination-centered"},c.range(b).map(function(b){var c="";return b+=1,b===a.state.page&&(c="current"),j.li({key:"page"+b,className:c},j.a({href:"#",onClick:a.pageClicked.bind(a,b)},b))})))},doneClicked:function(a){a.preventDefault(),this.props.onSelectItems(this.state.selected),this.hide()},renderFooter:function(){var a=[j.button({type:"button",className:"btn btn-default btn-danger",onClick:this.hide},"Done")];return this.props.multiple&&a.push(j.button({type:"button",className:"btn btn-default btn-primary",onClick:this.doneClicked},"Select ("+this.state.selected.length+")")),j.div({},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"content-browser-modal",title:"Select content",multiple:!1,selectableTypes:null,onSelectItem:function(){},onSelectItems:function(){},baseCriteria:[]})}})}),function(a){"function"==typeof define&&define.amd?define("castle-url/libs/cropper/dist/cropper.min",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(a){return"number"==typeof a&&!isNaN(a)}function c(a){return void 0===a}function d(a,c){var d=[];return b(c)&&d.push(c),d.slice.apply(a,d)}function e(a,b){var c=d(arguments,2);return function(){return a.apply(b,c.concat(d(arguments)))}}function f(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==o.protocol||b[2]!==o.hostname||b[3]!==o.port)}function g(a){var b="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+b}function h(a){var b,c=a.naturalWidth,d=a.naturalHeight;return c||(b=new Image,b.src=a.src,c=b.width,d=b.height),{naturalWidth:c,naturalHeight:d,aspectRatio:c/d}}function i(a){var c=[],d=a.rotate,e=a.scaleX,f=a.scaleY;return b(d)&&c.push("rotate("+d+"deg)"),b(e)&&b(f)&&c.push("scale("+e+","+f+")"),c.length?c.join(" "):"none"}function j(a,b){var c,d,e=Z(a.degree)%180,f=(e>90?180-e:e)*Math.PI/180,g=$(f),h=_(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function k(c,d){var e,f,g,h=a("<canvas>")[0],i=h.getContext("2d"),k=0,l=0,m=d.naturalWidth,n=d.naturalHeight,o=d.rotate,p=d.scaleX,q=d.scaleY,r=b(p)&&b(q)&&(1!==p||1!==q),s=b(o)&&0!==o,t=s||r,u=m,v=n;return r&&(e=m/2,f=n/2),s&&(g=j({width:m,height:n,degree:o}),u=g.width,v=g.height,e=g.width/2,f=g.height/2),h.width=u,h.height=v,t&&(k=-m/2,l=-n/2,i.save(),i.translate(e,f)),s&&i.rotate(o*Math.PI/180),r&&i.scale(p,q),i.drawImage(c,k,l,m,n),t&&i.restore(),h}function l(b,c){this.$element=a(b),this.options=a.extend({},l.DEFAULTS,a.isPlainObject(c)&&c),this.ready=!1,this.built=!1,this.complete=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var m=a(window),n=a(document),o=window.location,p="cropper",q="preview."+p,r="cropper-modal",s="cropper-hide",t="cropper-hidden",u="cropper-move",v="cropper-crop",w="cropper-disabled",x="mousedown touchstart pointerdown MSPointerDown",y="mousemove touchmove pointermove MSPointerMove",z="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",A="wheel mousewheel DOMMouseScroll",B="dblclick",C="load."+p,D="resize."+p,E="build."+p,F="built."+p,G="cropstart."+p,H="cropmove."+p,I="cropend."+p,J="crop."+p,K="zoom."+p,L=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,M="se",N="sw",O="ne",P="nw",Q="all",R="crop",S="move",T="zoom",U="none",V=a.isFunction(a("<canvas>")[0].getContext),W=Math.sqrt,X=Math.min,Y=Math.max,Z=Math.abs,$=Math.sin,_=Math.cos,aa=parseFloat,ba={};a.extend(ba,{init:function(){var a,b=this.$element;if(b.is("img")){if(this.isImg=!0,this.originalUrl=a=b.attr("src"),!a)return;a=b.prop("src")}else b.is("canvas")&&V&&(a=b[0].toDataURL());this.load(a)},trigger:function(b,c){var d=a.Event(b,c);return this.$element.trigger(d),d.isDefaultPrevented()},load:function(b){var c,d,e=this.options,h=this.$element,i="";b&&(this.url=b,h.one(E,e.build),this.trigger(E)||(e.checkImageOrigin&&f(b)&&(i=' crossOrigin="anonymous"',h.prop("crossOrigin")||(c=g(b))),this.$clone=d=a("<img"+i+' src="'+(c||b)+'">'),this.isImg?h[0].complete?this.start():h.one(C,a.proxy(this.start,this)):d.one(C,a.proxy(this.start,this)).one("error.cropper",a.proxy(this.stop,this)).addClass(s).insertAfter(h)))},start:function(){this.image=h(this.isImg?this.$element[0]:this.$clone[0]),this.ready=!0,this.build()},stop:function(){this.$clone.remove(),this.$clone=null}}),a.extend(ba,{build:function(){var b,c,d,e=this.options,f=this.$element,g=this.$clone;this.ready&&(this.built&&this.unbuild(),this.$container=f.parent(),this.$cropper=b=a(l.TEMPLATE),this.$canvas=b.find(".cropper-canvas").append(g),this.$dragBox=b.find(".cropper-drag-box"),this.$cropBox=c=b.find(".cropper-crop-box"),this.$viewBox=b.find(".cropper-view-box"),this.$face=d=c.find(".cropper-face"),f.addClass(t).after(b),this.isImg||g.removeClass(s),this.initPreview(),this.bind(),e.aspectRatio=aa(e.aspectRatio)||NaN,e.autoCrop?(this.cropped=!0,e.modal&&this.$dragBox.addClass(r)):c.addClass(t),e.guides||c.find(".cropper-dashed").addClass(t),e.center||c.find(".cropper-center").addClass(t),e.cropBoxMovable&&d.addClass(u).data("action",Q),e.highlight||d.addClass("cropper-invisible"),e.background&&b.addClass("cropper-bg"),e.cropBoxResizable||c.find(".cropper-line, .cropper-point").addClass(t),this.setDragMode(e.dragCrop?R:e.movable?S:U),this.render(),this.built=!0,this.setData(e.data),f.one(F,e.built),setTimeout(a.proxy(function(){this.trigger(F),this.complete=!0},this),0))},unbuild:function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}}),a.extend(ba,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.options,b=this.$element,c=this.$container,d=this.$cropper;d.addClass(t),b.removeClass(t),d.css(this.container={width:Y(c.width(),aa(a.minContainerWidth)||200),height:Y(c.height(),aa(a.minContainerHeight)||100)}),b.addClass(t),d.removeClass(t)},initCanvas:function(){var b=this.container,c=b.width,d=b.height,e=this.image,f=e.aspectRatio,g={aspectRatio:f,width:c,height:d};d*f>c?g.height=c/f:g.width=d*f,g.oldLeft=g.left=(c-g.width)/2,g.oldTop=g.top=(d-g.height)/2,this.canvas=g,this.limitCanvas(!0,!0),this.initialImage=a.extend({},e),this.initialCanvas=a.extend({},g)},limitCanvas:function(b,c){var d,e,f=this.options,g=f.strict,h=this.container,i=h.width,j=h.height,k=this.canvas,l=k.aspectRatio,m=this.cropBox,n=this.cropped&&m,o=this.initialCanvas||k,p=o.width,q=o.height;b&&(d=aa(f.minCanvasWidth)||0,e=aa(f.minCanvasHeight)||0,d?(g&&(d=Y(n?m.width:p,d)),e=d/l):e?(g&&(e=Y(n?m.height:q,e)),d=e*l):g&&(n?(d=m.width,e=m.height,e*l>d?d=e*l:e=d/l):(d=p,e=q)),a.extend(k,{minWidth:d,minHeight:e,maxWidth:1/0,maxHeight:1/0})),c&&(g?n?(k.minLeft=X(m.left,m.left+m.width-k.width),k.minTop=X(m.top,m.top+m.height-k.height),k.maxLeft=m.left,k.maxTop=m.top):(k.minLeft=X(0,i-k.width),k.minTop=X(0,j-k.height),k.maxLeft=Y(0,i-k.width),k.maxTop=Y(0,j-k.height)):(k.minLeft=-k.width,k.minTop=-k.height,k.maxLeft=i,k.maxTop=j))},renderCanvas:function(a){var b,c,d=this.options,e=this.canvas,f=this.image;this.rotated&&(this.rotated=!1,c=j({width:f.width,height:f.height,degree:f.rotate}),(b=c.width/c.height)!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,this.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=X(Y(e.width,e.minWidth),e.maxWidth),e.height=X(Y(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.oldLeft=e.left=X(Y(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=X(Y(e.top,e.minTop),e.maxTop),this.$canvas.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.renderImage(),this.cropped&&d.strict&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(b){var c,d=this.canvas,e=this.image;e.rotate&&(c=j({width:d.width,height:d.height,degree:e.rotate,aspectRatio:e.aspectRatio},!0)),a.extend(e,c?{width:c.width,height:c.height,left:(d.width-c.width)/2,top:(d.height-c.height)/2}:{width:d.width,height:d.height,left:0,top:0}),this.$clone.css({width:e.width,height:e.height,marginLeft:e.left,marginTop:e.top,transform:i(e)}),b&&this.output()},initCropBox:function(){var b=this.options,c=this.canvas,d=b.aspectRatio,e=aa(b.autoCropArea)||.8,f={width:c.width,height:c.height};d&&(c.height*d>c.width?f.height=f.width/d:f.width=f.height*d),this.cropBox=f,this.limitCropBox(!0,!0),f.width=X(Y(f.width,f.minWidth),f.maxWidth),f.height=X(Y(f.height,f.minHeight),f.maxHeight),f.width=Y(f.minWidth,f.width*e),f.height=Y(f.minHeight,f.height*e),f.oldLeft=f.left=c.left+(c.width-f.width)/2,f.oldTop=f.top=c.top+(c.height-f.height)/2,this.initialCropBox=a.extend({},f)},limitCropBox:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=this.cropBox,l=e.aspectRatio;a&&(c=aa(e.minCropBoxWidth)||0,d=aa(e.minCropBoxHeight)||0,k.minWidth=X(h,c),k.minHeight=X(i,d),k.maxWidth=X(h,f?j.width:h),k.maxHeight=X(i,f?j.height:i),l&&(k.maxHeight*l>k.maxWidth?(k.minHeight=k.minWidth/l,k.maxHeight=k.maxWidth/l):(k.minWidth=k.minHeight*l,k.maxWidth=k.maxHeight*l)),k.minWidth=X(k.maxWidth,k.minWidth),k.minHeight=X(k.maxHeight,k.minHeight)),b&&(f?(k.minLeft=Y(0,j.left),k.minTop=Y(0,j.top),k.maxLeft=X(h,j.left+j.width)-k.width,k.maxTop=X(i,j.top+j.height)-k.height):(k.minLeft=0,k.minTop=0,k.maxLeft=h-k.width,k.maxTop=i-k.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.cropBox;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=X(Y(e.width,e.minWidth),e.maxWidth),e.height=X(Y(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.oldLeft=e.left=X(Y(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=X(Y(e.top,e.minTop),e.maxTop),a.movable&&a.cropBoxMovable&&this.$face.data("action",e.width===c&&e.height===d?S:Q),this.$cropBox.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.cropped&&a.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.complete?this.trigger(J,this.getData()):this.built||this.$element.one(F,a.proxy(function(){this.trigger(J,this.getData())},this))}}),a.extend(ba,{initPreview:function(){var b=this.url;this.$preview=a(this.options.preview),this.$viewBox.html('<img src="'+b+'">'),this.$preview.each(function(){var c=a(this);c.data(q,{width:c.width(),height:c.height(),original:c.html()}),c.html('<img src="'+b+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important">')})},resetPreview:function(){this.$preview.each(function(){var b=a(this);b.html(b.data(q).original).removeData(q)})},preview:function(){var b=this.image,c=this.canvas,d=this.cropBox,e=b.width,f=b.height,g=d.left-c.left-b.left,h=d.top-c.top-b.top;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:e,height:f,marginLeft:-g,marginTop:-h,transform:i(b)}),this.$preview.each(function(){var c=a(this),j=c.data(q),k=j.width/d.width,l=j.width,m=d.height*k;m>j.height&&(k=j.height/d.height,l=d.width*k,m=j.height),c.width(l).height(m).find("img").css({width:e*k,height:f*k,marginLeft:-g*k,marginTop:-h*k,transform:i(b)})}))}}),a.extend(ba,{bind:function(){var b=this.options,c=this.$element,d=this.$cropper;a.isFunction(b.cropstart)&&c.on(G,b.cropstart),a.isFunction(b.cropmove)&&c.on(H,b.cropmove),a.isFunction(b.cropend)&&c.on(I,b.cropend),a.isFunction(b.crop)&&c.on(J,b.crop),a.isFunction(b.zoom)&&c.on(K,b.zoom),d.on(x,a.proxy(this.cropStart,this)),b.zoomable&&b.mouseWheelZoom&&d.on(A,a.proxy(this.wheel,this)),b.doubleClickToggle&&d.on(B,a.proxy(this.dblclick,this)),n.on(y,this._cropMove=e(this.cropMove,this)).on(z,this._cropEnd=e(this.cropEnd,this)),b.responsive&&m.on(D,this._resize=e(this.resize,this))},unbind:function(){var b=this.options,c=this.$element,d=this.$cropper;a.isFunction(b.cropstart)&&c.off(G,b.cropstart),a.isFunction(b.cropmove)&&c.off(H,b.cropmove),a.isFunction(b.cropend)&&c.off(I,b.cropend),a.isFunction(b.crop)&&c.off(J,b.crop),a.isFunction(b.zoom)&&c.off(K,b.zoom),d.off(x,this.cropStart),b.zoomable&&b.mouseWheelZoom&&d.off(A,this.wheel),b.doubleClickToggle&&d.off(B,this.dblclick),n.off(y,this._cropMove).off(z,this._cropEnd),b.responsive&&m.off(D,this._resize)}}),a.extend(ba,{resize:function(){var b,c,d,e=this.$container,f=this.container;!this.disabled&&f&&(1!==(d=e.width()/f.width)||e.height()!==f.height)&&(b=this.getCanvasData(),c=this.getCropBoxData(),this.render(),this.setCanvasData(a.each(b,function(a,c){b[a]=c*d})),this.setCropBoxData(a.each(c,function(a,b){c[a]=b*d})))},dblclick:function(){this.disabled||this.setDragMode(this.$dragBox.hasClass(v)?S:R)},wheel:function(a){var b=a.originalEvent,c=b,d=aa(this.options.wheelZoomRatio)||.1,e=1;this.disabled||(a.preventDefault(),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),this.zoom(-e*d,b))},cropStart:function(b){var c,d,e=this.options,f=b.originalEvent,g=f&&f.touches,h=b;if(!this.disabled){if(g){if((c=g.length)>1){if(!e.zoomable||!e.touchDragZoom||2!==c)return;h=g[1],this.startX2=h.pageX,this.startY2=h.pageY,d=T}h=g[0]}if(d=d||a(h.target).data("action"),L.test(d)){if(this.trigger(G,{originalEvent:f,action:d}))return;b.preventDefault(),this.action=d,this.cropping=!1,this.startX=h.pageX||f&&f.pageX,this.startY=h.pageY||f&&f.pageY,d===R&&(this.cropping=!0,this.$dragBox.addClass(r))}}},cropMove:function(a){var b,c=this.options,d=a.originalEvent,e=d&&d.touches,f=a,g=this.action;if(!this.disabled){if(e){if((b=e.length)>1){if(!c.zoomable||!c.touchDragZoom||2!==b)return;f=e[1],this.endX2=f.pageX,this.endY2=f.pageY}f=e[0]}if(g){if(this.trigger(H,{originalEvent:d,action:g}))return;a.preventDefault(),this.endX=f.pageX||d&&d.pageX,this.endY=f.pageY||d&&d.pageY,this.change(f.shiftKey,g===T?d:null)}}},cropEnd:function(a){var b=a.originalEvent,c=this.action;this.disabled||c&&(a.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(r,this.cropped&&this.options.modal)),this.action="",this.trigger(I,{originalEvent:b,action:c}))}}),a.extend(ba,{change:function(a,b){var c,d,e=this.options,f=e.aspectRatio,g=this.action,h=this.container,i=this.canvas,j=this.cropBox,k=j.width,l=j.height,m=j.left,n=j.top,o=m+k,p=n+l,q=0,r=0,s=h.width,u=h.height,v=!0;switch(!f&&a&&(f=k&&l?k/l:1),e.strict&&(q=j.minLeft,r=j.minTop,s=q+X(h.width,i.width),u=r+X(h.height,i.height)),d={x:this.endX-this.startX,y:this.endY-this.startY},f&&(d.X=d.y*f,d.Y=d.x/f),g){case Q:m+=d.x,n+=d.y;break;case"e":if(d.x>=0&&(o>=s||f&&(r>=n||p>=u))){v=!1;break}k+=d.x,f&&(l=k/f,n-=d.Y/2),0>k&&(g="w",k=0);break;case"n":if(d.y<=0&&(r>=n||f&&(q>=m||o>=s))){v=!1;break}l-=d.y,n+=d.y,f&&(k=l*f,m+=d.X/2),0>l&&(g="s",l=0);break;case"w":if(d.x<=0&&(q>=m||f&&(r>=n||p>=u))){v=!1;break}k-=d.x,m+=d.x,f&&(l=k/f,n+=d.Y/2),0>k&&(g="e",k=0);break;case"s":if(d.y>=0&&(p>=u||f&&(q>=m||o>=s))){v=!1;break}l+=d.y,f&&(k=l*f,m-=d.X/2),0>l&&(g="n",l=0);break;case O:if(f){if(d.y<=0&&(r>=n||o>=s)){v=!1;break}l-=d.y,n+=d.y,k=l*f}else d.x>=0?s>o?k+=d.x:d.y<=0&&r>=n&&(v=!1):k+=d.x,d.y<=0?n>r&&(l-=d.y,n+=d.y):(l-=d.y,n+=d.y);0>k&&0>l?(g=N,l=0,k=0):0>k?(g=P,k=0):0>l&&(g=M,l=0);break;case P:if(f){if(d.y<=0&&(r>=n||q>=m)){v=!1;break}l-=d.y,n+=d.y,k=l*f,m+=d.X}else d.x<=0?m>q?(k-=d.x,m+=d.x):d.y<=0&&r>=n&&(v=!1):(k-=d.x,m+=d.x),d.y<=0?n>r&&(l-=d.y,n+=d.y):(l-=d.y,n+=d.y);0>k&&0>l?(g=M,l=0,k=0):0>k?(g=O,k=0):0>l&&(g=N,l=0);break;case N:if(f){if(d.x<=0&&(q>=m||p>=u)){v=!1;break}k-=d.x,m+=d.x,l=k/f}else d.x<=0?m>q?(k-=d.x,m+=d.x):d.y>=0&&p>=u&&(v=!1):(k-=d.x,m+=d.x),d.y>=0?u>p&&(l+=d.y):l+=d.y;0>k&&0>l?(g=O,l=0,k=0):0>k?(g=M,k=0):0>l&&(g=P,l=0);break;case M:if(f){if(d.x>=0&&(o>=s||p>=u)){v=!1;break}k+=d.x,l=k/f}else d.x>=0?s>o?k+=d.x:d.y>=0&&p>=u&&(v=!1):k+=d.x,d.y>=0?u>p&&(l+=d.y):l+=d.y;0>k&&0>l?(g=P,l=0,k=0):0>k?(g=N,k=0):0>l&&(g=O,l=0);break;case S:i.left+=d.x,i.top+=d.y,this.renderCanvas(!0),v=!1;break;case T:this.zoom(function(a,b,c,d){var e=W(a*a+b*b);return(W(c*c+d*d)-e)/e}(Z(this.startX-this.startX2),Z(this.startY-this.startY2),Z(this.endX-this.endX2),Z(this.endY-this.endY2)),b),this.startX2=this.endX2,this.startY2=this.endY2,v=!1;break;case R:d.x&&d.y&&(c=this.$cropper.offset(),m=this.startX-c.left,n=this.startY-c.top,k=j.minWidth,l=j.minHeight,d.x>0?d.y>0?g=M:(g=O,n-=l):d.y>0?(g=N,m-=k):(g=P,m-=k,n-=l),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(t)))}v&&(j.width=k,j.height=l,j.left=m,j.top=n,this.action=g,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),a.extend(ba,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(r),this.$cropBox.removeClass(t)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=a.extend({},this.initialImage),this.canvas=a.extend({},this.initialCanvas),this.cropBox=a.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(a.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(r),this.$cropBox.addClass(t))},replace:function(a){!this.disabled&&a&&(this.isImg&&this.$element.attr("src",a),this.options.data=null,this.load(a))},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(w))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(w))},destroy:function(){var a=this.$element;this.ready?(this.isImg&&a.attr("src",this.originalUrl),this.unbuild(),a.removeClass(t)):this.isImg?a.off(C,this.start):this.$clone&&this.$clone.remove(),a.removeData(p)},move:function(a,d){var e=this.canvas;c(d)&&(d=a),a=aa(a),d=aa(d),this.built&&!this.disabled&&this.options.movable&&(e.left+=b(a)?a:0,e.top+=b(d)?d:0,this.renderCanvas(!0))},zoom:function(a,b){var c,d,e=this.canvas;if((a=aa(a))&&this.built&&!this.disabled&&this.options.zoomable){if(this.trigger(K,{originalEvent:b,ratio:a}))return;a=0>a?1/(1-a):1+a,c=e.width*a,d=e.height*a,e.left-=(c-e.width)/2,e.top-=(d-e.height)/2,e.width=c,e.height=d,this.renderCanvas(!0),this.setDragMode(S)}},rotate:function(a){var b=this.image,c=b.rotate||0;a=aa(a)||0,this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(c+a)%360,this.rotated=!0,this.renderCanvas(!0))},scale:function(a,d){var e=this.image;c(d)&&(d=a),a=aa(a),d=aa(d),this.built&&!this.disabled&&this.options.scalable&&(e.scaleX=b(a)?a:1,e.scaleY=b(d)?d:1,this.renderImage(!0))},getData:function(b){var c,d,e=this.options,f=this.image,g=this.canvas,h=this.cropBox;return this.built&&this.cropped?(d={x:h.left-g.left,y:h.top-g.top,width:h.width,height:h.height},c=f.width/f.naturalWidth,a.each(d,function(a,e){e/=c,d[a]=b?Math.round(e):e})):d={x:0,y:0,width:0,height:0},e.rotatable&&(d.rotate=f.rotate||0),e.scalable&&(d.scaleX=f.scaleX||1,d.scaleY=f.scaleY||1),d},setData:function(c){var d,e=this.image,f=this.canvas,g={};a.isFunction(c)&&(c=c.call(this.$element)),this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.rotate)&&c.rotate!==e.rotate&&this.options.rotatable&&(e.rotate=c.rotate,this.rotated=!0,this.renderCanvas(!0)),d=e.width/e.naturalWidth,b(c.x)&&(g.left=c.x*d+f.left),b(c.y)&&(g.top=c.y*d+f.top),b(c.width)&&(g.width=c.width*d),b(c.height)&&(g.height=c.height*d),this.setCropBoxData(g))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a,b=this.canvas;return this.built&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCanvasData:function(c){var d=this.canvas,e=d.aspectRatio;a.isFunction(c)&&(c=c.call(this.$element)),this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)?(d.width=c.width,d.height=c.width/e):b(c.height)&&(d.height=c.height,d.width=c.height*e),this.renderCanvas(!0))},getCropBoxData:function(){var a,b=this.cropBox;return this.built&&this.cropped&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCropBoxData:function(c){var d,e,f=this.cropBox,g=this.options.aspectRatio;a.isFunction(c)&&(c=c.call(this.$element)),this.built&&this.cropped&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(f.left=c.left),b(c.top)&&(f.top=c.top),b(c.width)&&c.width!==f.width&&(d=!0,f.width=c.width),b(c.height)&&c.height!==f.height&&(e=!0,f.height=c.height),g&&(d?f.height=f.width/g:e&&(f.width=f.height*g)),this.renderCropBox())},getCroppedCanvas:function(b){var c,d,e,f,g,h,i,j,l,m,n;return this.built&&this.cropped&&V?(a.isPlainObject(b)||(b={}),n=this.getData(),c=n.width,d=n.height,j=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/j,i=g/c):h&&(g=h*j,i=h/d)),e=g||c,f=h||d,l=a("<canvas>")[0],l.width=e,l.height=f,m=l.getContext("2d"),b.fillColor&&(m.fillStyle=b.fillColor,m.fillRect(0,0,e,f)),m.drawImage.apply(m,function(){var a,b,e,f,g,h,j=k(this.$clone[0],this.image),l=j.width,m=j.height,o=[j],p=n.x,q=n.y;return-c>=p||p>l?p=a=e=g=0:0>=p?(e=-p,p=0,a=g=X(l,c+p)):l>=p&&(e=0,a=g=X(c,l-p)),0>=a||-d>=q||q>m?q=b=f=h=0:0>=q?(f=-q,q=0,b=h=X(m,d+q)):m>=q&&(f=0,b=h=X(d,m-q)),o.push(p,q,a,b),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&o.push(e,f,g,h),o}.call(this)),l):void 0},setAspectRatio:function(a){var b=this.options;this.disabled||c(a)||(b.aspectRatio=aa(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var b,c,d=this.options;this.ready&&!this.disabled&&(b=d.dragCrop&&a===R,c=d.movable&&a===S,a=b||c?a:U,this.$dragBox.data("action",a).toggleClass(v,b).toggleClass(u,c),d.cropBoxMovable||this.$face.data("action",a).toggleClass(v,b).toggleClass(u,c))}}),a.extend(l.prototype,ba),l.DEFAULTS={aspectRatio:NaN,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,dragCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,mouseWheelZoom:!0,wheelZoomRatio:.1,touchDragZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},l.setDefaults=function(b){a.extend(l.DEFAULTS,b)},l.TEMPLATE='<div class="cropper-container"><div class="cropper-canvas"></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',l.other=a.fn.cropper,a.fn.cropper=function(b){var e,f=d(arguments,1);return this.each(function(){var c,d=a(this),g=d.data(p);if(!g){if(/destroy/.test(b))return;d.data(p,g=new l(this,b))}"string"==typeof b&&a.isFunction(c=g[b])&&(e=c.apply(g,f))}),c(e)?this:e},a.fn.cropper.Constructor=l,a.fn.cropper.setDefaults=l.setDefaults,a.fn.cropper.noConflict=function(){return a.fn.cropper=l.other,this}}),define("castle-url/components/image-editor",["jquery","castle-url/libs/react/react.min","mockup-utils","castle-url/libs/cropper/dist/cropper.min"],function(a,b,c){"use strict";var d=b.DOM,e=b.createClass({componentDidMount:function(){a(this.refs.img.getDOMNode()).cropper(this.props.cropperOptions)},render:function(){return d.img({src:this.props.image,ref:"img"})},getDefaultProps:function(){return{cropperOptions:{zoomOnWheel:!1}}}});return b.createClass({getInitialState:function(){return{image:null}},componentDidMount:function(){var a=this,b=new mOxie.Image;c.loading.show(),b.onload=function(){c.loading.hide(),a.setState({image:b.getAsDataURL("image/png")})},b.load(a.props.file)},cancelClicked:function(a){a.preventDefault(),this.props.onCancel()},saveClicked:function(b){var d=this;b.preventDefault(),c.loading.show();var e=a(this.refs.cropper.refs.img.getDOMNode()).cropper("getCroppedCanvas"),f=e.toDataURL(),g=new mOxie.Image;g.onload=function(){c.loading.hide();var a=g.getAsBlob("image/png");d.props.onSave(a,g)},g.load(f)},rotateLeft:function(b){b.preventDefault(),a(this.refs.cropper.refs.img.getDOMNode()).cropper("rotate",-90)},rotateRight:function(b){b.preventDefault(),a(this.refs.cropper.refs.img.getDOMNode()).cropper("rotate",90)},render:function(){var a="";return this.state.image&&(a=b.createElement(e,{image:this.state.image,ref:"cropper"})),d.div({className:"castle-cropper-container",ref:"container"},[a,d.div({className:"plone-btn-group"},[d.button({className:"plone-btn plone-btn-default castle-btn-rotate-left",onClick:this.rotateLeft},"Rotate Left"),d.button({className:"plone-btn plone-btn-default castle-btn-rotate-right",onClick:this.rotateRight},"Rotate Right"),d.button({className:"plone-btn plone-btn-default castle-btn-cancel",onClick:this.cancelClicked},"Cancel"),d.button({className:"plone-btn plone-btn-default castle-btn-save",onClick:this.saveClicked},"Save")])])},getDefaultProps:function(){return{onCancel:function(){},onSave:function(){}}}})}),
define("castle-url/components/image-focal-point-selector",["jquery","castle-url/libs/react/react.min"],function(a,b){"use strict";var c=b.DOM;return b.createClass({getDefaultProps:function(){return{enabled:!0,readOnly:!1,url:null,width:"",fullWidth:"",height:"",fullHeight:"",focalPoint:[0,0],pointerOffsetX:12,pointerOffsetY:12,onFocalSet:function(){}}},previewClicked:function(b){var c=a(this.refs.previewImage.getDOMNode()).offset(),d=(b.pageX-c.left)/(this.props.width/this.props.fullWidth);d=Math.min(this.props.fullWidth,Math.max(d,0));var e=(b.pageY-c.top)/(this.props.height/this.props.fullHeight);e=Math.min(this.props.fullHeight,Math.max(e,0)),this.props.onFocalSet([d,e])},render:function(){var a="";return this.props.enabled&&(a=c.div({className:"focalpoint-image-center"+(this.props.readOnly?" focalpoint-disabled":""),style:{left:this.props.width/this.props.fullWidth*this.props.focalPoint[0]-this.props.pointerOffsetX,top:this.props.height/this.props.fullHeight*this.props.focalPoint[1]-this.props.pointerOffsetY}})),c.div({className:"focalpoint-image-container",onClick:this.previewClicked},[a,c.img({src:this.props.url,ref:"previewImage"})])}})});var MXI_DEBUG=!0;!function(a,b){"use strict";function c(a,b){for(var c,d=[],g=0;g<a.length;++g){if(!(c=f[a[g]]||e(a[g])))throw"module definition dependecy not found: "+a[g];d.push(c)}b.apply(null,d)}function d(a,d,e){if("string"!=typeof a)throw"invalid module definition, module id must be defined and be a string";if(d===b)throw"invalid module definition, dependencies must be specified";if(e===b)throw"invalid module definition, definition function must be specified";c(d,function(){f[a]=e.apply(null,arguments)})}function e(b){for(var c=a,d=b.split(/[.\/]/),e=0;e<d.length;++e){if(!c[d[e]])return;c=c[d[e]]}return c}var f={};d("moxie/core/utils/Basic",[],function(){var a=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(d){return c(arguments,function(e,f){f>0&&c(e,function(c,e){void 0!==c&&(a(d[e])===a(c)&&~g(a(c),["array","object"])?b(d[e],c):d[e]=c)})}),d},c=function(b,c){var d,e,f;if(b)if("number"===a(b.length)){for(f=0,d=b.length;f<d;f++)if(!1===c(b[f],f))return}else if("object"===a(b))for(e in b)if(b.hasOwnProperty(e)&&!1===c(b[e],e))return},d=function(b){var c;if(!b||"object"!==a(b))return!0;for(c in b)return!1;return!0},e=function(b,c){function d(f){"function"===a(b[f])&&b[f](function(a){++f<e&&!a?d(f):c(a)})}var e=b.length;"function"!==a(c)&&(c=function(){}),b&&b.length||c(),d(0)},f=function(a,b){var d=0,e=a.length,f=new Array(e);c(a,function(a,c){a(function(a){if(a)return b(a);var g=[].slice.call(arguments);g.shift(),f[c]=g,++d===e&&(f.unshift(null),b.apply(this,f))})})},g=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c}return-1},h=function(b,c){var d=[];"array"!==a(b)&&(b=[b]),"array"!==a(c)&&(c=[c]);for(var e in b)-1===g(b[e],c)&&d.push(b[e]);return!!d.length&&d},i=function(a,b){var d=[];return c(a,function(a){-1!==g(a,b)&&d.push(a)}),d.length?d:null},j=function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},k=function(){var a=0;return function(b){var c,d=(new Date).getTime().toString(32);for(c=0;c<5;c++)d+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+d+(a++).toString(32)}}(),l=function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},m=function(a){if("string"!=typeof a)return a;var b,c={t:1099511627776,g:1073741824,m:1048576,k:1024};return a=/^([0-9\.]+)([tmgk]?)$/.exec(a.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),b=a[2],a=+a[1],c.hasOwnProperty(b)&&(a*=c[b]),Math.floor(a)};return{guid:k,typeOf:a,extend:b,each:c,isEmptyObj:d,inSeries:e,inParallel:f,inArray:g,arrayDiff:h,arrayIntersect:i,toArray:j,trim:l,sprintf:function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return"undefined"!==a(b)?b:""})},parseSizeStr:m}}),d("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(a){function b(a,b,c){var d=0,e=0,f=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},h=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]},i=function(a){return a?isNaN(a)?g[a]||-7:parseInt(a,10):0};for(a=h(a),b=h(b),e=Math.max(a.length,b.length),d=0;d<e;d++)if(a[d]!=b[d]){if(a[d]=i(a[d]),b[d]=i(b[d]),a[d]<b[d]){f=-1;break}if(a[d]>b[d]){f=1;break}}if(!c)return f;switch(c){case">":case"gt":return f>0;case">=":case"ge":return f>=0;case"<=":case"le":return f<=0;case"==":case"=":case"eq":return 0===f;case"<>":case"!=":case"ne":return 0!==f;case"":case"<":case"lt":return f<0;default:return null}}var c=function(a){var b="name",c="version",d={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},e={rgx:function(){for(var a,b,c,d,e,f,g,h=0,i=arguments;h<i.length;h+=2){var j=i[h],k=i[h+1];if(void 0===a){a={};for(d in k)e=k[d],"object"==typeof e?a[e[0]]=void 0:a[e]=void 0}for(b=c=0;b<j.length;b++)if(f=j[b].exec(this.getUA())){for(d=0;d<k.length;d++)g=f[++c],e=k[d],"object"==typeof e&&e.length>0?2==e.length?"function"==typeof e[1]?a[e[0]]=e[1].call(this,g):a[e[0]]=e[1]:3==e.length?"function"!=typeof e[1]||e[1].exec&&e[1].test?a[e[0]]=g?g.replace(e[1],e[2]):void 0:a[e[0]]=g?e[1].call(this,g,e[2]):void 0:4==e.length&&(a[e[0]]=g?e[3].call(this,g.replace(e[1],e[2])):void 0):a[e]=g||void 0;break}if(f)break}return a},str:function(a,b){for(var c in b)if("object"==typeof b[c]&&b[c].length>0){for(var e=0;e<b[c].length;e++)if(d.has(b[c][e],a))return"?"===c?void 0:c}else if(d.has(b[c],a))return"?"===c?void 0:c;return a}},f={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},g={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[b,c],[/\s(opr)\/([\w\.]+)/i],[[b,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[b,c],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[b,"IE"],c],[/(edge)\/((\d+)?[\w\.]+)/i],[b,c],[/(yabrowser)\/([\w\.]+)/i],[[b,"Yandex"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[b,/_/g," "],c],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[b,c],[/(dolfin)\/([\w\.]+)/i],[[b,"Dolphin"],c],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[b,"Chrome"],c],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[c,[b,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[c,[b,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[c,[b,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[c,[b,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[c,b],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[b,[c,e.str,f.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[b,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[b,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[b,c]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[b,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[b,c],[/rv\:([\w\.]+).*(gecko)/i],[c,b]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[b,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[b,[c,e.str,f.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[b,"Windows"],[c,e.str,f.os.windows.version]],[/\((bb)(10);/i],[[b,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[b,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[b,"Symbian"],c],[/\((series40);/i],[b],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[b,"Firefox OS"],c],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[b,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[b,"Chromium OS"],c],[/(sunos)\s?([\w\.]+\d)*/i],[[b,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[b,c],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[b,"iOS"],[c,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[b,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[b,c]]};return function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return e.rgx.apply(this,g.browser)},this.getEngine=function(){return e.rgx.apply(this,g.engine)},this.getOS=function(){return e.rgx.apply(this,g.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return b},this.setUA=function(a){return b=a,this},this.setUA(b)}}(),d=function(){var b={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(b){try{if(-1!==a.inArray(b,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;if(c.open("get","/"),"responseType"in c)return c.responseType=b,c.responseType===b}}catch(a){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){b.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==f.browser||f.version>=9)},use_data_uri_of:function(a){return b.use_data_uri&&a<33e3||b.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(c){var d=[].slice.call(arguments);return d.shift(),"function"===a.typeOf(b[c])?b[c].apply(this,d):!!b[c]}}(),e=(new c).getResult(),f={can:d,uaParser:c,browser:e.browser.name,version:e.browser.version,os:e.os.name,osVersion:e.os.version,verComp:b,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return f.OS=f.os,MXI_DEBUG&&(f.debug={runtime:!0,events:!1},f.log=function(){var b=arguments[0];if("string"===a.typeOf(b)&&(b=a.sprintf.apply(this,arguments)),window&&window.console&&window.console.log)window.console.log(b);else if(document){var c=document.getElementById("moxie-console");c||(c=document.createElement("pre"),c.id="moxie-console",document.body.appendChild(c)),-1!==a.inArray(a.typeOf(b),["object","array"])?function(a){c.appendChild(document.createTextNode(a+"\n"))}(b):c.appendChild(document.createTextNode(b+"\n"))}}),f}),d("moxie/core/I18n",["moxie/core/utils/Basic"],function(a){var b={};return{addI18n:function(c){return a.extend(b,c)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return"undefined"!==a.typeOf(b)?b:""})}}}),d("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(a,b){var c={mimes:{},extensions:{},addMimeType:function(a){var b,c,d,e=a.split(/,/);for(b=0;b<e.length;b+=2){for(d=e[b+1].split(/ /),c=0;c<d.length;c++)this.mimes[d[c]]=e[b];this.extensions[e[b]]=d}},extList2mimes:function(b,c){var d,e,f,g,h=this,i=[];for(e=0;e<b.length;e++)for(d=b[e].extensions.split(/\s*,\s*/),f=0;f<d.length;f++){if("*"===d[f])return[];if(g=h.mimes[d[f]],g&&-1===a.inArray(g,i)&&i.push(g),c&&/^\w+$/.test(d[f]))i.push("."+d[f]);else if(!g)return[]}return i},mimes2exts:function(b){var c=this,d=[];return a.each(b,function(b){if("*"===b)return d=[],!1;var e=b.match(/^(\w+)\/(\*|\w+)$/);e&&("*"===e[2]?a.each(c.extensions,function(a,b){new RegExp("^"+e[1]+"/").test(b)&&[].push.apply(d,c.extensions[b])}):c.extensions[b]&&[].push.apply(d,c.extensions[b]))}),d},mimes2extList:function(c){var d=[],e=[];return"string"===a.typeOf(c)&&(c=a.trim(c).split(/\s*,\s*/)),e=this.mimes2exts(c),d.push({title:b.translate("Files"),extensions:e.length?e.join(","):"*"}),d.mimes=c,d},getFileExtension:function(a){var b=a&&a.match(/\.([^.]+)$/);return b?b[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return c.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),c}),d("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(a){var b=function(a){return"string"!=typeof a?a:document.getElementById(a)},c=function(a,b){return!!a.className&&new RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)};return{get:b,hasClass:c,addClass:function(a,b){c(a,b)||(a.className=a.className?a.className.replace(/\s+$/,"")+" "+b:b)},removeClass:function(a,b){if(a.className){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(a,b,c){return" "===b&&" "===c?" ":""})}},getStyle:function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null)[b]:void 0},getPos:function(b,c){function d(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===j.compatMode?j.documentElement:j.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var e,f,g,h=0,i=0,j=document;if(b=b,c=c||j.body,b&&b.getBoundingClientRect&&"IE"===a.browser&&(!j.documentMode||j.documentMode<8))return f=d(b),g=d(c),{x:f.x-g.x,y:f.y-g.y};for(e=b;e&&e!=c&&e.nodeType;)h+=e.offsetLeft||0,i+=e.offsetTop||0,e=e.offsetParent;for(e=b.parentNode;e&&e!=c&&e.nodeType;)h-=e.scrollLeft||0,i-=e.scrollTop||0,e=e.parentNode;return{x:h,y:i}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}}}}),d("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(a){function b(a,b){var c;for(c in a)if(a[c]===b)return c;return null}return{RuntimeError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": RuntimeError "+this.code}var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return a.extend(c,d),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function b(a){this.code=a,this.name="OperationNotAllowedException"}return a.extend(b,{NOT_ALLOWED_ERR:1}),b.prototype=Error.prototype,b}(),ImageError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": ImageError "+this.code}var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return a.extend(c,d),c.prototype=Error.prototype,c}(),FileException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": FileException "+this.code}var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return a.extend(c,d),c.prototype=Error.prototype,c}(),DOMException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": DOMException "+this.code}var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return a.extend(c,d),c.prototype=Error.prototype,c}(),EventException:function(){function b(a){this.code=a,this.name="EventException"}return a.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0}),b.prototype=Error.prototype,b}()}}),d("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(a,b,c){function d(){var d={};c.extend(this,{uid:null,init:function(){this.uid||(this.uid=c.guid("uid_"))},addEventListener:function(a,b,e,f){var g,h=this;if(this.hasOwnProperty("uid")||(this.uid=c.guid("uid_")),a=c.trim(a),/\s/.test(a))return void c.each(a.split(/\s+/),function(a){h.addEventListener(a,b,e,f)});a=a.toLowerCase(),e=parseInt(e,10)||0,g=d[this.uid]&&d[this.uid][a]||[],g.push({fn:b,priority:e,scope:f||this}),d[this.uid]||(d[this.uid]={}),d[this.uid][a]=g},hasEventListener:function(a){var b=a?d[this.uid]&&d[this.uid][a]:d[this.uid];return b||!1},removeEventListener:function(a,b){a=a.toLowerCase();var e,f=d[this.uid]&&d[this.uid][a];if(f){if(b){for(e=f.length-1;e>=0;e--)if(f[e].fn===b){f.splice(e,1);break}}else f=[];f.length||(delete d[this.uid][a],c.isEmptyObj(d[this.uid])&&delete d[this.uid])}},removeAllEventListeners:function(){d[this.uid]&&delete d[this.uid]},dispatchEvent:function(e){var f,g,h,i,j={},k=!0;if("string"!==c.typeOf(e)){if(i=e,"string"!==c.typeOf(i.type))throw new b.EventException(b.EventException.UNSPECIFIED_EVENT_TYPE_ERR);e=i.type,void 0!==i.total&&void 0!==i.loaded&&(j.total=i.total,j.loaded=i.loaded),j.async=i.async||!1}if(-1!==e.indexOf("::")?function(a){f=a[0],e=a[1]}(e.split("::")):f=this.uid,e=e.toLowerCase(),g=d[f]&&d[f][e]){g.sort(function(a,b){return b.priority-a.priority}),h=[].slice.call(arguments),h.shift(),j.type=e,h.unshift(j),MXI_DEBUG&&a.debug.events&&a.log("Event '%s' fired on %u",j.type,f);var l=[];c.each(g,function(a){h[0].target=a.scope,j.async?l.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,h))},1)}):l.push(function(b){b(!1===a.fn.apply(a.scope,h))})}),l.length&&c.inSeries(l,function(a){k=!a})}return k},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(a){var b=this;this.bind(a.join(" "),function(a){var b="on"+a.type.toLowerCase();"function"===c.typeOf(this[b])&&this[b].apply(this,arguments)}),c.each(a,function(a){a="on"+a.toLowerCase(a),"undefined"===c.typeOf(b[a])&&(b[a]=null)})}})}return d.instance=new d,d}),d("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(a,b,c,d){function e(d,f,h,i,j){var k,l=this,m=b.guid(f+"_"),n=j||"browser";d=d||{},g[m]=this,h=b.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},h),d.preferred_caps&&(n=e.getMode(i,d.preferred_caps,n)),MXI_DEBUG&&a.debug.runtime&&a.log("\tdefault mode: %s",n),k=function(){var a={};return{exec:function(b,c,d,e){if(k[c]&&(a[b]||(a[b]={context:this,instance:new k[c]}),a[b].instance[d]))return a[b].instance[d].apply(this,e)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var c=this;b.each(a,function(a,d){"function"===b.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context),c.removeInstance(d)})}}}(),b.extend(this,{initialized:!1,uid:m,type:f,mode:e.getMode(i,d.required_caps,n),shimid:m+"_container",clients:0,options:d,can:function(a,c){var d=arguments[2]||h;if("string"===b.typeOf(a)&&"undefined"===b.typeOf(c)&&(a=e.parseCaps(a)),"object"===b.typeOf(a)){for(var f in a)if(!this.can(f,a[f],d))return!1;return!0}return"function"===b.typeOf(d[a])?d[a].call(this,c):c===d[a]},getShimContainer:function(){var a,d=c.get(this.shimid);return d||(a=this.options.container?c.get(this.options.container):document.body,d=document.createElement("div"),d.id=this.shimid,d.className="moxie-shim moxie-shim-"+this.type,b.extend(d.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(d),a=null),d},getShim:function(){return k},shimExec:function(a,b){var c=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return l[a]&&l[a][b]?l[a][b].apply(this,c):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var a=c.get(this.shimid);a&&a.parentNode.removeChild(a),k&&k.removeAllInstances(),this.unbindAll(),delete g[this.uid],this.uid=null,m=l=k=a=null}}}),this.mode&&d.required_caps&&!this.can(d.required_caps)&&(this.mode=!1)}var f={},g={};return e.order="html5,flash,silverlight,html4",e.getRuntime=function(a){return!!g[a]&&g[a]},e.addConstructor=function(a,b){b.prototype=d.instance,f[a]=b},e.getConstructor=function(a){return f[a]||null},e.getInfo=function(a){var b=e.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null},e.parseCaps=function(a){var c={};return"string"!==b.typeOf(a)?a||{}:(b.each(a.split(","),function(a){c[a]=!0}),c)},e.can=function(a,b){var c,d,f=e.getConstructor(a);return!!f&&(c=new f({required_caps:b}),d=c.mode,c.destroy(),!!d)},e.thatCan=function(a,b){var c=(b||e.order).split(/\s*,\s*/);for(var d in c)if(e.can(c[d],a))return c[d];return null},e.getMode=function(c,d,e){var f=null;if("undefined"===b.typeOf(e)&&(e="browser"),d&&!b.isEmptyObj(c)){if(b.each(d,function(d,e){if(c.hasOwnProperty(e)){var g=c[e](d);if("string"==typeof g&&(g=[g]),f){if(!(f=b.arrayIntersect(f,g)))return MXI_DEBUG&&a.debug.runtime&&a.log("\t\t%c: %v (conflicting mode requested: %s)",e,d,g),f=!1}else f=g}MXI_DEBUG&&a.debug.runtime&&a.log("\t\t%c: %v (compatible modes: %s)",e,d,f)}),f)return-1!==b.inArray(e,f)?e:f[0];if(!1===f)return!1}return e},e.capTrue=function(){return!0},e.capFalse=function(){return!1},e.capTest=function(a){return function(){return!!a}},e}),d("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(a,b,c,d){return function(){var e;c.extend(this,{connectRuntime:function(f){function g(c){var h,j;return c.length?(h=c.shift().toLowerCase(),(j=d.getConstructor(h))?(MXI_DEBUG&&a.debug.runtime&&(a.log("Trying runtime: %s",h),a.log(f)),e=new j(f),e.bind("Init",function(){e.initialized=!0,MXI_DEBUG&&a.debug.runtime&&a.log("Runtime '%s' initialized",e.type),setTimeout(function(){e.clients++,i.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){MXI_DEBUG&&a.debug.runtime&&a.log("Runtime '%s' failed to initialize",e.type),e.destroy(),g(c)}),MXI_DEBUG&&a.debug.runtime&&a.log("\tselected mode: %s",e.mode),e.mode?void e.init():void e.trigger("Error")):void g(c)):(i.trigger("RuntimeError",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)),void(e=null))}var h,i=this;if("string"===c.typeOf(f)?h=f:"string"===c.typeOf(f.ruid)&&(h=f.ruid),h){if(e=d.getRuntime(h))return e.clients++,e;throw new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)}g((f.runtime_order||d.order).split(/\s*,\s*/))},disconnectRuntime:function(){e&&--e.clients<=0&&e.destroy(),e=null},getRuntime:function(){return e&&e.uid?e:e=null},exec:function(){return e?e.exec.apply(this,arguments):null}})}}),d("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(a,b,c,d,e,f,g,h,i){function j(f){MXI_DEBUG&&b.log("Instantiating FileInput...");var j,l,m,n=this;if(-1!==a.inArray(a.typeOf(f),["string","node"])&&(f={browse_button:f}),!(l=d.get(f.browse_button)))throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);m={accept:[{title:g.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:l.parentNode||document.body},f=a.extend({},m,f),"string"==typeof f.required_caps&&(f.required_caps=h.parseCaps(f.required_caps)),"string"==typeof f.accept&&(f.accept=c.mimes2extList(f.accept)),j=d.get(f.container),j||(j=document.body),"static"===d.getStyle(j,"position")&&(j.style.position="relative"),j=l=null,i.call(n),a.extend(n,{uid:a.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){n.bind("RuntimeInit",function(b,c){n.ruid=c.uid,n.shimid=c.shimid,n.bind("Ready",function(){n.trigger("Refresh")},999),n.bind("Refresh",function(){var b,e,g,h;g=d.get(f.browse_button),h=d.get(c.shimid),g&&(b=d.getPos(g,d.get(f.container)),e=d.getSize(g),h&&a.extend(h.style,{top:b.y+"px",left:b.x+"px",width:e.w+"px",height:e.h+"px"})),h=g=null}),c.exec.call(n,"FileInput","init",f)}),n.connectRuntime(a.extend({},f,{required_caps:{select_file:!0}}))},disable:function(b){var c=this.getRuntime();c&&c.exec.call(this,"FileInput","disable","undefined"===a.typeOf(b)||b)},refresh:function(){n.trigger("Refresh")},destroy:function(){var b=this.getRuntime();b&&(b.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(k)}var k=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return j.prototype=f.instance,j}),d("moxie/core/utils/Encode",[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))};return{utf8_encode:a,utf8_decode:b,atob:function(a,c){if("function"==typeof window.atob)return c?b(window.atob(a)):window.atob(a);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!a)return a;a+="";do{g=l.indexOf(a.charAt(m++)),h=l.indexOf(a.charAt(m++)),i=l.indexOf(a.charAt(m++)),j=l.indexOf(a.charAt(m++)),k=g<<18|h<<12|i<<6|j,d=k>>16&255,e=k>>8&255,f=255&k,p[n++]=64==i?String.fromCharCode(d):64==j?String.fromCharCode(d,e):String.fromCharCode(d,e,f)}while(m<a.length);return o=p.join(""),c?b(o):o},btoa:function(b,c){if(c&&(b=a(b)),"function"==typeof window.btoa)return window.btoa(b);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!b)return b;do{d=b.charCodeAt(m++),e=b.charCodeAt(m++),f=b.charCodeAt(m++),k=d<<16|e<<8|f,g=k>>18&63,h=k>>12&63,i=k>>6&63,j=63&k,p[n++]=l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j)}while(m<b.length);o=p.join("");var q=b.length%3;return(q?o.slice(0,q-3):o)+"===".slice(q||3)}}}),d("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(a,b,c){function d(f,g){function h(b,c,f){var g,h=e[this.uid];return"string"===a.typeOf(h)&&h.length?(g=new d(null,{type:f,size:c-b}),g.detach(h.substr(b,g.size)),g):null}c.call(this),f&&this.connectRuntime(f),g?"string"===a.typeOf(g)&&(g={data:g}):g={},a.extend(this,{uid:g.uid||a.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(a,b,c){return this.isDetached()?h.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(a){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),a=a||"","data:"==a.substr(0,5)){var c=a.indexOf(";base64,");this.type=a.substring(5,c),a=b.atob(a.substring(c+8))}this.size=a.length,e[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===a.typeOf(e[this.uid])},destroy:function(){this.detach(),delete e[this.uid]}}),g.data?this.detach(g.data):e[this.uid]=g}var e={};return d}),d("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(a,b,c){function d(d,e){e||(e={}),c.apply(this,arguments),this.type||(this.type=b.getFileMime(e.name));var f;if(e.name)f=e.name.replace(/\\/g,"/"),f=f.substr(f.lastIndexOf("/")+1);else if(this.type){var g=this.type.split("/")[0];f=a.guid((""!==g?g:"file")+"_"),b.extensions[this.type]&&(f+="."+b.extensions[this.type][0])}a.extend(this,{name:f||a.guid("file_"),relativePath:"",lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString()})}return d.prototype=c.prototype,d}),d("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(a,b,c,d,e,f,g,h,i){function j(c){MXI_DEBUG&&e.log("Instantiating FileDrop...");var f,h=this;"string"==typeof c&&(c={drop_zone:c}),f={accept:[{title:a.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},c="object"==typeof c?d.extend({},f,c):f,c.container=b.get(c.drop_zone)||document.body,"static"===b.getStyle(c.container,"position")&&(c.container.style.position="relative"),"string"==typeof c.accept&&(c.accept=i.mimes2extList(c.accept)),g.call(h),d.extend(h,{uid:d.guid("uid_"),ruid:null,files:null,init:function(){h.bind("RuntimeInit",function(a,b){h.ruid=b.uid,b.exec.call(h,"FileDrop","init",c),h.dispatchEvent("ready")}),h.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),
this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(k)}var k=["ready","dragenter","dragleave","drop","error"];return j.prototype=h.instance,j}),d("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(a,b,c,d,e,f){function g(){function d(a,d){if(this.trigger("loadstart"),this.readyState===g.LOADING)return this.trigger("error",new c.DOMException(c.DOMException.INVALID_STATE_ERR)),void this.trigger("loadend");if(!(d instanceof e))return this.trigger("error",new c.DOMException(c.DOMException.NOT_FOUND_ERR)),void this.trigger("loadend");if(this.result=null,this.readyState=g.LOADING,d.isDetached()){var f=d.getSource();switch(a){case"readAsText":case"readAsBinaryString":this.result=f;break;case"readAsDataURL":this.result="data:"+d.type+";base64,"+b.btoa(f)}this.readyState=g.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(d.ruid),this.exec("FileReader","read",a,d)}f.call(this),a.extend(this,{uid:a.guid("uid_"),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(a){d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){d.call(this,"readAsDataURL",a)},readAsText:function(a){d.call(this,"readAsText",a)},abort:function(){this.result=null,-1===a.inArray(this.readyState,[g.EMPTY,g.DONE])&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(h),this.bind("Error",function(a,b){this.readyState=g.DONE,this.error=b},999),this.bind("Load",function(a){this.readyState=g.DONE},999)}var h=["loadstart","progress","load","abort","error","loadend"];return g.EMPTY=0,g.LOADING=1,g.DONE=2,g.prototype=d.instance,g}),d("moxie/core/utils/Url",[],function(){var a=function(b,c){for(var d=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],e=d.length,f={http:80,https:443},g={},h=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,i=h.exec(b||"");e--;)i[e]&&(g[d[e]]=i[e]);if(!g.scheme){c&&"string"!=typeof c||(c=a(c||document.location.href)),g.scheme=c.scheme,g.host=c.host,g.port=c.port;var j="";/^[^\/]/.test(g.path)&&(j=c.path,j=/\/[^\/]*\.[^\/]*$/.test(j)?j.replace(/\/[^\/]+$/,"/"):j.replace(/\/?$/,"/")),g.path=j+(g.path||"")}return g.port||(g.port=f[g.scheme]||80),g.port=parseInt(g.port,10),g.path||(g.path="/"),delete g.source,g};return{parseUrl:a,resolveUrl:function(b){var c={http:80,https:443},d="object"==typeof b?b:a(b);return d.scheme+"://"+d.host+(d.port!==c[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")},hasSameOrigin:function(b){function c(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof b&&(b=a(b)),c(a())===c(b)}}}),d("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c){function d(){this.uid=a.guid("uid_"),b.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return d.prototype=c.instance,d}),d("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(a,b,c){return function(){function d(a,b){if(!b.isDetached()){var d=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b);return this.disconnectRuntime(),d}var e=b.getSource();switch(a){case"readAsBinaryString":return e;case"readAsDataURL":return"data:"+b.type+";base64,"+c.btoa(e);case"readAsText":for(var f="",g=0,h=e.length;g<h;g++)f+=String.fromCharCode(e[g]);return f}}b.call(this),a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(a){return d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return d.call(this,"readAsDataURL",a)},readAsText:function(a){return d.call(this,"readAsText",a)}})}}),d("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(a,b,c){function d(){var a,d=[];b.extend(this,{append:function(e,f){var g=this,h=b.typeOf(f);f instanceof c?a={name:e,value:f}:"array"===h?(e+="[]",b.each(f,function(a){g.append(e,a)})):"object"===h?b.each(f,function(a,b){g.append(e+"["+b+"]",a)}):"null"===h||"undefined"===h||"number"===h&&isNaN(f)?g.append(e,"false"):d.push({name:e,value:f.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){b.each(d,function(a){c(a.value,a.name)}),a&&c(a.value,a.name)},destroy:function(){a=null,d=[]}})}return d}),d("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){this.uid=a.guid("uid_")}function n(){function c(a,b){if(A.hasOwnProperty(a))return 1===arguments.length?k.can("define_property")?A[a]:z[a]:void(k.can("define_property")?A[a]=b:z[a]=b)}function i(b){function d(){x&&(x.destroy(),x=null),h.dispatchEvent("loadend"),h=null}function e(e){x.bind("LoadStart",function(a){c("readyState",n.LOADING),h.dispatchEvent("readystatechange"),h.dispatchEvent(a),H&&h.upload.dispatchEvent(a)}),x.bind("Progress",function(a){c("readyState")!==n.LOADING&&(c("readyState",n.LOADING),h.dispatchEvent("readystatechange")),h.dispatchEvent(a)}),x.bind("UploadProgress",function(a){H&&h.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})}),x.bind("Load",function(b){c("readyState",n.DONE),c("status",Number(e.exec.call(x,"XMLHttpRequest","getStatus")||0)),c("statusText",o[c("status")]||""),c("response",e.exec.call(x,"XMLHttpRequest","getResponse",c("responseType"))),~a.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",c("response")),O=e.exec.call(x,"XMLHttpRequest","getAllResponseHeaders"),h.dispatchEvent("readystatechange"),c("status")>0?(H&&h.upload.dispatchEvent(b),h.dispatchEvent(b)):(J=!0,h.dispatchEvent("error")),d()}),x.bind("Abort",function(a){h.dispatchEvent(a),d()}),x.bind("Error",function(a){J=!0,c("readyState",n.DONE),h.dispatchEvent("readystatechange"),I=!0,h.dispatchEvent(a),d()}),e.exec.call(x,"XMLHttpRequest","send",{url:r,method:s,async:B,user:t,password:u,headers:C,mimeType:E,encoding:D,responseType:h.responseType,withCredentials:h.withCredentials,options:N},b)}var h=this;v=(new Date).getTime(),x=new g,"string"==typeof N.required_caps&&(N.required_caps=f.parseCaps(N.required_caps)),N.required_caps=a.extend({},N.required_caps,{return_response_type:h.responseType}),b instanceof j&&(N.required_caps.send_multipart=!0),a.isEmptyObj(C)||(N.required_caps.send_custom_headers=!0),K||(N.required_caps.do_cors=!0),N.ruid?e(x.connectRuntime(N)):(x.bind("RuntimeInit",function(a,b){e(b)}),x.bind("RuntimeError",function(a,b){h.dispatchEvent("RuntimeError",b)}),x.connectRuntime(N))}function q(){c("responseText",""),c("responseXML",null),c("response",null),c("status",0),c("statusText",""),v=w=null}var r,s,t,u,v,w,x,y,z=this,A={timeout:0,readyState:n.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},B=!0,C={},D=null,E=null,F=!1,G=!1,H=!1,I=!1,J=!1,K=!1,L=null,M=null,N={},O="";a.extend(this,A,{uid:a.guid("uid_"),upload:new m,open:function(f,g,h,i,j){var k;if(!f||!g)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(f)||d.utf8_encode(f)!==f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(~a.inArray(f.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(s=f.toUpperCase()),~a.inArray(s,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(g=d.utf8_encode(g),k=e.parseUrl(g),K=e.hasSameOrigin(k),r=e.resolveUrl(g),(i||j)&&!K)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(t=i||k.user,u=j||k.pass,!1===(B=h||!0)&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);F=!B,G=!1,C={},q.call(this),c("readyState",n.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(e,f){var g=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(c("readyState")!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(e)||d.utf8_encode(e)!==e)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return e=a.trim(e).toLowerCase(),!~a.inArray(e,g)&&!/^(proxy\-|sec\-)/.test(e)&&(C[e]?C[e]+=", "+f:C[e]=f,!0)},getAllResponseHeaders:function(){return O||""},getResponseHeader:function(b){return b=b.toLowerCase(),J||~a.inArray(b,["set-cookie","set-cookie2"])?null:O&&""!==O&&(y||(y={},a.each(O.split(/\r\n/),function(b){var c=b.split(/:\s+/);2===c.length&&(c[0]=a.trim(c[0]),y[c[0].toLowerCase()]={header:c[0],value:a.trim(c[1])})})),y.hasOwnProperty(b))?y[b].header+": "+y[b].value:null},overrideMimeType:function(d){var e,f;if(~a.inArray(c("readyState"),[n.LOADING,n.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(d=a.trim(d.toLowerCase()),/;/.test(d)&&(e=d.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(d=e[1],e[2]&&(f=e[2])),!l.mimes[d])throw new b.DOMException(b.DOMException.SYNTAX_ERR);L=d,M=f},send:function(c,e){if(N="string"===a.typeOf(e)?{ruid:e}:e||{},this.readyState!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof h)N.ruid=c.ruid,E=c.type||"application/octet-stream";else if(c instanceof j){if(c.hasBlob()){var f=c.getBlob();N.ruid=f.ruid,E=f.type||"application/octet-stream"}}else"string"==typeof c&&(D="UTF-8",E="text/plain;charset=UTF-8",c=d.utf8_encode(c));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&!K),H=!F&&this.upload.hasEventListener(),J=!1,I=!c,F||(G=!0),i.call(this,c)},abort:function(){if(J=!0,F=!1,~a.inArray(c("readyState"),[n.UNSENT,n.OPENED,n.DONE]))c("readyState",n.UNSENT);else{if(c("readyState",n.DONE),G=!1,!x)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);x.getRuntime().exec.call(x,"XMLHttpRequest","abort",I),I=!0}},destroy:function(){x&&("function"===a.typeOf(x.destroy)&&x.destroy(),x=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(p.concat(["readystatechange"])),this.upload.handleEventProps(p)}var o={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};m.prototype=c.instance;var p=["loadstart","progress","abort","error","load","timeout","loadend"];return n.UNSENT=0,n.OPENED=1,n.HEADERS_RECEIVED=2,n.LOADING=3,n.DONE=4,n.prototype=c.instance,n}),d("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c,d){function e(){function d(){k=l=0,j=this.result=null}function f(b,c){var d=this;i=c,d.bind("TransportingProgress",function(b){(l=b.loaded)<k&&-1===a.inArray(d.state,[e.IDLE,e.DONE])&&g.call(d)},999),d.bind("TransportingComplete",function(){l=k,d.state=e.DONE,j=null,d.result=i.exec.call(d,"Transporter","getAsBlob",b||"")},999),d.state=e.BUSY,d.trigger("TransportingStarted"),g.call(d)}function g(){var a,c=this,d=k-l;m>d&&(m=d),a=b.btoa(j.substr(l,m)),i.exec.call(c,"Transporter","receive",a,k)}var h,i,j,k,l,m;c.call(this),a.extend(this,{uid:a.guid("uid_"),state:e.IDLE,result:null,transport:function(b,c,e){var g=this;if(e=a.extend({chunk_size:204798},e),(h=e.chunk_size%3)&&(e.chunk_size+=3-h),m=e.chunk_size,d.call(this),j=b,k=b.length,"string"===a.typeOf(e)||e.ruid)f.call(g,c,this.connectRuntime(e));else{var i=function(a,b){g.unbind("RuntimeInit",i),f.call(g,c,b)};this.bind("RuntimeInit",i),this.connectRuntime(e)}},abort:function(){var a=this;a.state=e.IDLE,i&&(i.exec.call(a,"Transporter","clear"),a.trigger("TransportingAborted")),d.call(a)},destroy:function(){this.unbindAll(),i=null,this.disconnectRuntime(),d.call(this)}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=d.instance,e}),d("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function d(a){a||(a=this.exec("Image","getInfo")),this.size=a.size,this.width=a.width,this.height=a.height,this.type=a.type,this.meta=a.meta,""===this.name&&(this.name=a.name)}function j(b){var d=a.typeOf(b);try{if(b instanceof n){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(b instanceof k){if(!~a.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);q.apply(this,arguments)}else if(-1!==a.inArray(d,["blob","file"]))j.call(this,new l(null,b),arguments[1]);else if("string"===d)"data:"===b.substr(0,5)?j.call(this,new k(null,{data:b}),arguments[1]):r.apply(this,arguments);else{if("node"!==d||"img"!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);j.call(this,b.src,arguments[1])}}catch(a){this.trigger("error",a.code)}}function p(b,c){var d=this.connectRuntime(b.ruid);this.ruid=d.uid,d.exec.call(this,"Image","loadFromImage",b,"undefined"===a.typeOf(c)||c)}function q(b,c){function d(a){e.ruid=a.uid,a.exec.call(e,"Image","loadFromBlob",b)}var e=this;e.name=b.name||"",b.isDetached()?(this.bind("RuntimeInit",function(a,b){d(b)}),c&&"string"==typeof c.required_caps&&(c.required_caps=f.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):d(this.connectRuntime(b.ruid))}function r(a,b){var c,d=this;c=new e,c.open("get",a),c.responseType="blob",c.onprogress=function(a){d.trigger(a)},c.onload=function(){q.call(d,c.response,!0)},c.onerror=function(a){d.trigger(a)},c.onloadend=function(){c.destroy()},c.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",b)}),c.send(null,b)}g.call(this),a.extend(this,{uid:a.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){j.apply(this,arguments)},downsize:function(b){var d={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,preserveHeaders:!0,resample:!1};b="object"==typeof b?a.extend(d,b):a.extend(d,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>n.MAX_RESIZE_WIDTH||this.height>n.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);this.exec("Image","downsize",b.width,b.height,b.crop,b.preserveHeaders)}catch(a){this.trigger("error",a.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!i.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",a||"image/jpeg",b||90)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",a||"image/jpeg",b||90)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return m.atob(c.substring(c.indexOf("base64,")+7))},embed:function(d,e){function f(b,e){var f=this;if(i.can("create_canvas")){var k=f.getAsCanvas();if(k)return d.appendChild(k),k=null,f.destroy(),void j.trigger("embedded")}var l=f.getAsDataURL(b,e);if(!l)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(i.can("use_data_uri_of",l.length))d.innerHTML='<img src="'+l+'" width="'+f.width+'" height="'+f.height+'" />',f.destroy(),j.trigger("embedded");else{var n=new h;n.bind("TransportingComplete",function(){g=j.connectRuntime(this.result.ruid),j.bind("Embedded",function(){a.extend(g.getShimContainer().style,{top:"0px",left:"0px",width:f.width+"px",height:f.height+"px"}),g=null},999),g.exec.call(j,"ImageView","display",this.result.uid,width,height),f.destroy()}),n.transport(m.atob(l.substring(l.indexOf("base64,")+7)),b,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:d})}}var g,j=this;e=a.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90},e||{});try{if(!(d=b.get(d)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);this.width>n.MAX_RESIZE_WIDTH||(this.height,n.MAX_RESIZE_HEIGHT);var k=new n;return k.bind("Resize",function(){f.call(this,e.type,e.quality)}),k.bind("Load",function(){k.downsize(e)}),this.meta.thumb&&this.meta.thumb.width>=e.width&&this.meta.thumb.height>=e.height?k.load(this.meta.thumb.data):k.clone(this,!1),k}catch(a){this.trigger("error",a.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}}),this.handleEventProps(o),this.bind("Load Resize",function(){d.call(this)},999)}var o=["progress","load","error","resize","embedded"];return n.MAX_RESIZE_WIDTH=8192,n.MAX_RESIZE_HEIGHT=8192,n.prototype=j.instance,n}),d("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue,j=a.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return e.can("access_binary")&&!!g.Image},display_media:h(d.can("create_canvas")||d.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==d.browser||d.verComp(d.version,9,">"))}()),filter_by_extension:h(function(){return!("Chrome"===d.browser&&d.verComp(d.version,28,"<")||"IE"===d.browser&&d.verComp(d.version,10,"<")||"Safari"===d.browser&&d.verComp(d.version,7,"<")||"Firefox"===d.browser&&d.verComp(d.version,37,"<"))}()),return_response_headers:i,return_response_type:function(a){return!("json"!==a||!window.JSON)||d.can("return_response_type",a)},return_status_code:i,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return e.can("access_binary")&&d.can("create_canvas")},select_file:function(){return d.can("use_fileinput")&&window.File},select_folder:function(){return e.can("select_file")&&"Chrome"===d.browser&&d.verComp(d.version,21,">=")},select_multiple:function(){return e.can("select_file")&&!("Safari"===d.browser&&"Windows"===d.os)&&!("iOS"===d.os&&d.verComp(d.osVersion,"7.0.0",">")&&d.verComp(d.osVersion,"8.0.0","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||e.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return e.can("slice_blob")&&e.can("send_multipart")},summon_file_dialog:function(){return e.can("select_file")&&("Firefox"===d.browser&&d.verComp(d.version,4,">=")||"Opera"===d.browser&&d.verComp(d.version,12,">=")||"IE"===d.browser&&d.verComp(d.version,10,">=")||!!~a.inArray(d.browser,["Chrome","Safari"]))},upload_filesize:i},arguments[2]);c.call(this,b,arguments[1]||f,j),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html5",g={};return c.addConstructor(f,e),g}),d("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(a){function b(){this.returnValue=!1}function c(){this.cancelBubble=!0}var d={},e="moxie_"+a.guid(),f=function(f,g,h,i){var j,k;g=g.toLowerCase(),f.addEventListener?(j=h,f.addEventListener(g,j,!1)):f.attachEvent&&(j=function(){var a=window.event;a.target||(a.target=a.srcElement),a.preventDefault=b,a.stopPropagation=c,h(a)},f.attachEvent("on"+g,j)),f[e]||(f[e]=a.guid()),d.hasOwnProperty(f[e])||(d[f[e]]={}),k=d[f[e]],k.hasOwnProperty(g)||(k[g]=[]),k[g].push({func:j,orig:h,key:i})},g=function(b,c,f){var g;if(c=c.toLowerCase(),b[e]&&d[b[e]]&&d[b[e]][c]){g=d[b[e]][c];for(var h=g.length-1;h>=0&&(g[h].orig!==f&&g[h].key!==f||(b.removeEventListener?b.removeEventListener(c,g[h].func,!1):b.detachEvent&&b.detachEvent("on"+c,g[h].func),g[h].orig=null,g[h].func=null,g.splice(h,1),void 0===f));h--);if(g.length||delete d[b[e]][c],a.isEmptyObj(d[b[e]])){delete d[b[e]];try{delete b[e]}catch(a){b[e]=void 0}}}};return{addEvent:f,removeEvent:g,removeAllEvents:function(b,c){b&&b[e]&&a.each(d[b[e]],function(a,d){g(b,d,c)})}}}),d("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f,g){function h(){var a;c.extend(this,{init:function(h){var i,j,k,l,m,n,o=this,p=o.getRuntime();a=h,k=a.accept.mimes||f.extList2mimes(a.accept,p.can("filter_by_extension")),j=p.getShimContainer(),j.innerHTML='<input id="'+p.uid+'" type="file" style="font-size:999px;opacity:0;"'+(a.multiple&&p.can("select_multiple")?"multiple":"")+(a.directory&&p.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />",i=d.get(p.uid),c.extend(i.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),l=d.get(a.browse_button),p.can("summon_file_dialog")&&("static"===d.getStyle(l,"position")&&(l.style.position="relative"),m=parseInt(d.getStyle(l,"z-index"),10)||1,l.style.zIndex=m,j.style.zIndex=m-1,e.addEvent(l,"click",function(a){var b=d.get(p.uid);b&&!b.disabled&&b.click(),a.preventDefault()},o.uid)),n=p.can("summon_file_dialog")?l:j,e.addEvent(n,"mouseover",function(){o.trigger("mouseenter")},o.uid),e.addEvent(n,"mouseout",function(){o.trigger("mouseleave")},o.uid),e.addEvent(n,"mousedown",function(){o.trigger("mousedown")},o.uid),e.addEvent(d.get(a.container),"mouseup",function(){o.trigger("mouseup")},o.uid),i.onchange=function d(e){if(o.files=[],c.each(this.files,function(c){var d="";if(a.directory&&"."==c.name)return!0;c.webkitRelativePath&&(d="/"+c.webkitRelativePath.replace(/^\//,"")),c=new b(p.uid,c),c.relativePath=d,o.files.push(c)}),"IE"!==g.browser&&"IEMobile"!==g.browser)this.value="";else{var f=this.cloneNode(!0);this.parentNode.replaceChild(f,this),f.onchange=d}o.files.length&&o.trigger("change")},o.trigger({type:"ready",async:!0}),j=null},disable:function(a){var b,c=this.getRuntime();(b=d.get(c.uid))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),c=b.getShim(),f=b.getShimContainer();e.removeAllEvents(f,this.uid),e.removeAllEvents(a&&d.get(a.container),this.uid),e.removeAllEvents(a&&d.get(a.browse_button),this.uid),f&&(f.innerHTML=""),c.removeInstance(this.uid),a=f=c=null}})}return a.FileInput=h}),d("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(a,b){function c(){function a(a,b,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(d){return a.slice(b,c-b)}}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}return a.Blob=c}),d("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(a,b,c,d,e,f){function g(){function a(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;var b=c.toArray(a.dataTransfer.types||[]);return-1!==c.inArray("Files",b)||-1!==c.inArray("public.file-url",b)||-1!==c.inArray("application/x-moz-file",b)}function g(a,c){if(i(a)){var d=new b(o,a);d.relativePath=c||"",p.push(d)}}function h(a){for(var b=[],d=0;d<a.length;d++)[].push.apply(b,a[d].extensions.split(/\s*,\s*/));return-1===c.inArray("*",b)?b:[]}function i(a){if(!q.length)return!0;var b=f.getFileExtension(a.name);return!b||-1!==c.inArray(b,q)}function j(a,b){var d=[];c.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?g(a.getAsFile(),b.fullPath):d.push(b))}),d.length?k(d,b):b()}function k(a,b){var d=[];c.each(a,function(a){d.push(function(b){l(a,b)})}),c.inSeries(d,function(){b()})}function l(a,b){a.isFile?a.file(function(c){g(c,a.fullPath),b()},function(){b()}):a.isDirectory?m(a,b):b()}function m(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){k(d,b)})}var n,o,p=[],q=[];c.extend(this,{init:function(b){var d,f=this;n=b,o=f.ruid,q=h(n.accept),d=n.container,e.addEvent(d,"dragover",function(b){a(b)&&(b.preventDefault(),b.dataTransfer.dropEffect="copy")},f.uid),e.addEvent(d,"drop",function(b){a(b)&&(b.preventDefault(),p=[],b.dataTransfer.items&&b.dataTransfer.items[0].webkitGetAsEntry?j(b.dataTransfer.items,function(){f.files=p,f.trigger("drop")}):(c.each(b.dataTransfer.files,function(a){g(a)}),f.files=p,f.trigger("drop")))},f.uid),e.addEvent(d,"dragenter",function(a){f.trigger("dragenter")},f.uid),e.addEvent(d,"dragleave",function(a){f.trigger("dragleave")},f.uid)},destroy:function(){e.removeAllEvents(n&&d.get(n.container),this.uid),o=p=q=n=null}})}return a.FileDrop=g}),d("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(a,b,c){function d(){function a(a){return b.atob(a.substring(a.indexOf("base64,")+7))}var d,e=!1;c.extend(this,{read:function(b,f){var g=this;g.result="",d=new window.FileReader,d.addEventListener("progress",function(a){g.trigger(a)}),d.addEventListener("load",function(b){g.result=e?a(d.result):d.result,g.trigger(b)}),d.addEventListener("error",function(a){g.trigger(a,d.error)}),d.addEventListener("loadend",function(a){d=null,g.trigger(a)}),"function"===c.typeOf(d[b])?(e=!1,d[b](f.getSource())):"readAsBinaryString"===b&&(e=!0,d.readAsDataURL(f.getSource()))},abort:function(){d&&d.abort()},destroy:function(){d=null}})}return a.FileReader=d}),d("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(a,b,c,d,e,f,g,h,i){function j(){function a(a,b){var c,d,e=this;c=b.getBlob().getSource(),d=new window.FileReader,d.onload=function(){b.append(b.getBlobName(),new f(null,{type:c.type,data:d.result})),o.send.call(e,a,b)},d.readAsBinaryString(c)}function j(){return!window.XMLHttpRequest||"IE"===i.browser&&i.verComp(i.version,8,"<")?function(){for(var a=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(a){}}():new window.XMLHttpRequest}function k(a){var b=a.responseXML,c=a.responseText;return"IE"===i.browser&&c&&b&&!b.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(a.getResponseHeader("Content-Type"))&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(c)),b&&("IE"===i.browser&&0!==b.parseError||!b.documentElement||"parsererror"===b.documentElement.tagName)?null:b}function l(a){var b="----moxieboundary"+(new Date).getTime(),c="\r\n",d="";if(!this.getRuntime().can("send_binary_string"))throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,e){d+=a instanceof f?"--"+b+c+'Content-Disposition: form-data; name="'+e+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"'+c+"Content-Type: "+(a.type||"application/octet-stream")+c+c+a.getSource()+c:"--"+b+c+'Content-Disposition: form-data; name="'+e+'"'+c+c+unescape(encodeURIComponent(a))+c}),d+="--"+b+"--"+c}var m,n,o=this;b.extend(this,{send:function(c,e){var h=this,k="Mozilla"===i.browser&&i.verComp(i.version,4,">=")&&i.verComp(i.version,7,"<"),o="Android Browser"===i.browser,p=!1;if(n=c.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),m=j(),m.open(c.method,c.url,c.async,c.user,c.password),e instanceof f)e.isDetached()&&(p=!0),e=e.getSource();else if(e instanceof g){if(e.hasBlob())if(e.getBlob().isDetached())e=l.call(h,e),p=!0;else if((k||o)&&"blob"===b.typeOf(e.getBlob().getSource())&&window.FileReader)return void a.call(h,c,e);if(e instanceof g){var q=new window.FormData;e.each(function(a,b){a instanceof f?q.append(b,a.getSource()):q.append(b,a)}),e=q}}m.upload?(c.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){h.trigger(a)}),m.addEventListener("error",function(a){h.trigger(a)}),m.addEventListener("progress",function(a){h.trigger(a)}),m.upload.addEventListener("progress",function(a){h.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 1:case 2:break;case 3:var a,b;try{d.hasSameOrigin(c.url)&&(a=m.getResponseHeader("Content-Length")||0),m.responseText&&(b=m.responseText.length)}catch(c){a=b=0}h.trigger({type:"progress",lengthComputable:!!a,total:parseInt(a,10),loaded:b});break;case 4:m.onreadystatechange=function(){},0===m.status?h.trigger("error"):h.trigger("load")}},b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){m.setRequestHeader(b,a)}),""!==c.responseType&&"responseType"in m&&("json"!==c.responseType||i.can("return_response_type","json")?m.responseType=c.responseType:m.responseType="text"),p?m.sendAsBinary?m.sendAsBinary(e):function(){for(var a=new Uint8Array(e.length),b=0;b<e.length;b++)a[b]=255&e.charCodeAt(b);m.send(a.buffer)}():m.send(e),h.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case"blob":var d=new e(b.uid,m.response),f=m.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(n=g[2])}return d.name=n,d.type||(d.type=c.getFileMime(n)),d;case"json":
return i.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case"document":return k(m);default:return""!==m.responseText?m.responseText:null}}catch(a){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},abort:function(){m&&m.abort()},destroy:function(){o=n=null}})}return a.XMLHttpRequest=j}),d("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(a){function b(a){a instanceof ArrayBuffer?c.apply(this,arguments):d.apply(this,arguments)}function c(b){var c=new DataView(b);a.extend(this,{readByteAt:function(a){return c.getUint8(a)},writeByteAt:function(a,b){c.setUint8(a,b)},SEGMENT:function(a,d,e){switch(arguments.length){case 2:return b.slice(a,a+d);case 1:return b.slice(a);case 3:if(null===e&&(e=new ArrayBuffer),e instanceof ArrayBuffer){var f=new Uint8Array(this.length()-d+e.byteLength);a>0&&f.set(new Uint8Array(b.slice(0,a)),0),f.set(new Uint8Array(e),a),f.set(new Uint8Array(b.slice(a+d)),a+e.byteLength),this.clear(),b=f.buffer,c=new DataView(b);break}default:return b}},length:function(){return b?b.byteLength:0},clear:function(){c=b=null}})}function d(b){function c(a,c,d){d=3===arguments.length?d:b.length-c-1,b=b.substr(0,c)+a+b.substr(d+c)}a.extend(this,{readByteAt:function(a){return b.charCodeAt(a)},writeByteAt:function(a,b){c(String.fromCharCode(b),a,1)},SEGMENT:function(a,d,e){switch(arguments.length){case 1:return b.substr(a);case 2:return b.substr(a,d);case 3:c(null!==e?e:"",a,d);break;default:return b}},length:function(){return b?b.length:0},clear:function(){b=null}})}return a.extend(b.prototype,{littleEndian:!1,read:function(a,b){var c,d,e;if(a+b>this.length())throw new Error("You are trying to read outside the source boundaries.");for(d=this.littleEndian?0:-8*(b-1),e=0,c=0;e<b;e++)c|=this.readByteAt(a+e)<<Math.abs(d+8*e);return c},write:function(a,b,c){var d,e;if(a>this.length())throw new Error("You are trying to write outside the source boundaries.");for(d=this.littleEndian?0:-8*(c-1),e=0;e<c;e++)this.writeByteAt(a+e,b>>Math.abs(d+8*e)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){var b=this.read(a,4);return b>2147483647?b-4294967296:b},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,b){return this.asArray("CHAR",a,b).join("")},asArray:function(a,b,c){for(var d=[],e=0;e<c;e++)d[e]=this[a](b+e);return d}}),b}),d("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(a,b){return function c(d){var e,f,g,h=[],i=0;if(e=new a(d),65496!==e.SHORT(0))throw e.clear(),new b.ImageError(b.ImageError.WRONG_FORMAT);for(f=2;f<=e.length();)if((g=e.SHORT(f))>=65488&&g<=65495)f+=2;else{if(65498===g||65497===g)break;i=e.SHORT(f+2)+2,g>=65505&&g<=65519&&h.push({hex:g,name:"APP"+(15&g),start:f,length:i,segment:e.SEGMENT(f,i)}),f+=i}return e.clear(),{headers:h,restore:function(b){var c,d,e;for(e=new a(b),f=65504==e.SHORT(2)?4+e.SHORT(4):2,d=0,c=h.length;d<c;d++)e.SEGMENT(f,0,h[d].segment),f+=h[d].length;return b=e.SEGMENT(),e.clear(),b},strip:function(b){var d,e,f,g;for(f=new c(b),e=f.headers,f.purge(),d=new a(b),g=e.length;g--;)d.SEGMENT(e[g].start,e[g].length,"");return b=d.SEGMENT(),d.clear(),b},get:function(a){for(var b=[],c=0,d=h.length;c<d;c++)h[c].name===a.toUpperCase()&&b.push(h[c].segment);return b},set:function(a,b){var c,d,e,f=[];for("string"==typeof b?f.push(b):f=b,c=d=0,e=h.length;c<e&&(h[c].name===a.toUpperCase()&&(h[c].segment=f[d],h[c].length=f[d].length,d++),!(d>=f.length));c++);},purge:function(){this.headers=h=[]}}}}),d("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(a,c,d){function e(f){function g(c,e){var f,g,h,i,j,m,n,o,p=this,q=[],r={},s={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},t={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(f=p.SHORT(c),g=0;g<f;g++)if(q=[],n=c+2+12*g,(h=e[p.SHORT(n)])!==b){if(i=s[p.SHORT(n+=2)],j=p.LONG(n+=2),!(m=t[i]))throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(n+=4,m*j>4&&(n=p.LONG(n)+l.tiffHeader),n+m*j>=this.length())throw new d.ImageError(d.ImageError.INVALID_META_ERR);"ASCII"!==i?(q=p.asArray(i,n,j),o=1==j?q[0]:q,k.hasOwnProperty(h)&&"object"!=typeof o?r[h]=k[h][o]:r[h]=o):r[h]=a.trim(p.STRING(n,j).replace(/\0$/,""))}return r}function h(a,b,c){var d,e,f,g=0;if("string"==typeof b){var h=j[a.toLowerCase()];for(var i in h)if(h[i]===b){b=i;break}}d=l[a.toLowerCase()+"IFD"],e=this.SHORT(d);for(var k=0;k<e;k++)if(f=d+12*k+2,this.SHORT(f)==b){g=f+8;break}if(!g)return!1;try{this.write(g,c,4)}catch(a){return!1}return!0}var i,j,k,l,m,n;if(c.call(this,f),j={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},k={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},l={tiffHeader:10},m=l.tiffHeader,i={clear:this.clear},a.extend(this,{read:function(){try{return e.prototype.read.apply(this,arguments)}catch(a){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},write:function(){try{return e.prototype.write.apply(this,arguments)}catch(a){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(a){return this.LONG(a)/this.LONG(a+4)},SRATIONAL:function(a){return this.SLONG(a)/this.SLONG(a+4)},ASCII:function(a){return this.CHAR(a)},TIFF:function(){return n||null},EXIF:function(){var b=null;if(l.exifIFD){try{b=g.call(this,l.exifIFD,j.exif)}catch(a){return null}if(b.ExifVersion&&"array"===a.typeOf(b.ExifVersion)){for(var c=0,d="";c<b.ExifVersion.length;c++)d+=String.fromCharCode(b.ExifVersion[c]);b.ExifVersion=d}}return b},GPS:function(){var b=null;if(l.gpsIFD){try{b=g.call(this,l.gpsIFD,j.gps)}catch(a){return null}b.GPSVersionID&&"array"===a.typeOf(b.GPSVersionID)&&(b.GPSVersionID=b.GPSVersionID.join("."))}return b},thumb:function(){if(l.IFD1)try{var a=g.call(this,l.IFD1,j.thumb);if("JPEGInterchangeFormat"in a)return this.SEGMENT(l.tiffHeader+a.JPEGInterchangeFormat,a.JPEGInterchangeFormatLength)}catch(a){}return null},setExif:function(a,b){return("PixelXDimension"===a||"PixelYDimension"===a)&&h.call(this,"exif",a,b)},clear:function(){i.clear(),f=j=k=n=l=i=null}}),65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(m),42!==this.SHORT(m+=2))throw new d.ImageError(d.ImageError.INVALID_META_ERR);l.IFD0=l.tiffHeader+this.LONG(m+=2),n=g.call(this,l.IFD0,j.tiff),"ExifIFDPointer"in n&&(l.exifIFD=l.tiffHeader+n.ExifIFDPointer,delete n.ExifIFDPointer),"GPSInfoIFDPointer"in n&&(l.gpsIFD=l.tiffHeader+n.GPSInfoIFDPointer,delete n.GPSInfoIFDPointer),a.isEmptyObj(n)&&(n=null);var o=this.LONG(l.IFD0+12*this.SHORT(l.IFD0)+2);o&&(l.IFD1=l.tiffHeader+o)}return e.prototype=c.prototype,e}),d("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(a,b,c,d,e){function f(f){function g(a){var b,c,d=0;for(a||(a=i);d<=a.length();){if((b=a.SHORT(d+=2))>=65472&&b<=65475)return d+=5,{height:a.SHORT(d),width:a.SHORT(d+=2)};c=a.SHORT(d+=2),d+=c-2}return null}function h(){k&&j&&i&&(k.clear(),j.purge(),i.clear(),l=j=k=i=null)}var i,j,k,l;if(i=new d(f),65496!==i.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);j=new c(f);try{k=new e(j.get("app1")[0])}catch(a){}l=g.call(this),a.extend(this,{type:"image/jpeg",size:i.length(),width:l&&l.width||0,height:l&&l.height||0,setExif:function(b,c){if(!k)return!1;"object"===a.typeOf(b)?a.each(b,function(a,b){k.setExif(b,a)}):k.setExif(b,c),j.set("app1",k.SEGMENT())},writeHeaders:function(){return arguments.length?j.restore(arguments[0]):j.restore(f)},stripHeaders:function(a){return j.strip(a)},purge:function(){h.call(this)}}),k&&(this.meta={tiff:k.TIFF(),exif:k.EXIF(),gps:k.GPS(),thumb:function(){var a,b,c=k.thumb();return c&&(a=new d(c),b=g(a),a.clear(),b)?(b.data=c,b):null}()})}return f}),d("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(a,b,c){function d(d){function e(){var a,b;return a=g.call(this,8),"IHDR"==a.type?(b=a.start,{width:h.LONG(b),height:h.LONG(b+=4)}):null}function f(){h&&(h.clear(),d=k=i=j=h=null)}function g(a){var b,c,d,e;return b=h.LONG(a),c=h.STRING(a+=4,4),d=a+=4,e=h.LONG(a+b),{length:b,type:c,start:d,CRC:e}}var h,i,j,k;h=new c(d),function(){var b=0,c=0,d=[35152,20039,3338,6666];for(c=0;c<d.length;c++,b+=2)if(d[c]!=h.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT)}(),k=e.call(this),b.extend(this,{type:"image/png",size:h.length(),width:k.width,height:k.height,purge:function(){f.call(this)}}),f.call(this)}return d}),d("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(a,b,c,d){return function(e){var f,g=[c,d];f=function(){for(var a=0;a<g.length;a++)try{return new g[a](e)}catch(a){}throw new b.ImageError(b.ImageError.WRONG_FORMAT)}(),a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){e=null}}),a.extend(this,f),this.purge=function(){f.purge(),f=null}}}),d("moxie/runtime/html5/image/MegaPixel",[],function(){function a(a,d,e){var f=a.naturalWidth,g=a.naturalHeight,h=e.width,i=e.height,j=e.x||0,k=e.y||0,l=d.getContext("2d");b(a)&&(f/=2,g/=2);var m=1024,n=document.createElement("canvas");n.width=n.height=m;for(var o=n.getContext("2d"),p=c(a,f,g),q=0;q<g;){for(var r=q+m>g?g-q:m,s=0;s<f;){var t=s+m>f?f-s:m;o.clearRect(0,0,m,m),o.drawImage(a,-s,-q);var u=s*h/f+j<<0,v=Math.ceil(t*h/f),w=q*i/g/p+k<<0,x=Math.ceil(r*i/g/p);l.drawImage(n,0,0,t,r,u,w,v,x),s+=m}q+=m}n=o=null}function b(a){var b=a.naturalWidth;if(b*a.naturalHeight>1048576){var c=document.createElement("canvas");c.width=c.height=1;var d=c.getContext("2d");return d.drawImage(a,1-b,0),0===d.getImageData(0,0,1,1).data[3]}return!1}function c(a,b,c){var d=document.createElement("canvas");d.width=1,d.height=c;var e=d.getContext("2d");e.drawImage(a,0,0);for(var f=e.getImageData(0,0,1,c).data,g=0,h=c,i=c;i>g;){0===f[4*(i-1)+3]?h=i:g=i,i=h+g>>1}d=null;var j=i/c;return 0===j?1:j}return{isSubsampled:b,renderTo:a}}),d("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f,g,h,i,j){function k(){function a(){if(!u&&!s)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return u||s}function k(a){return d.atob(a.substring(a.indexOf("base64,")+7))}function l(a,b){return"data:"+(b||"")+";base64,"+d.btoa(a)}function m(a){var b=this;s=new Image,s.onerror=function(){r.call(this),b.trigger("error",c.ImageError.WRONG_FORMAT)},s.onload=function(){b.trigger("load")},s.src="data:"==a.substr(0,5)?a:l(a,w.type)}function n(a,b){var d,e=this;if(!window.FileReader)return b(a.getAsDataURL());d=new FileReader,d.onload=function(){b(this.result)},d.onerror=function(){e.trigger("error",c.ImageError.WRONG_FORMAT)},d.readAsDataURL(a)}function o(c,d,e,f){var g,h,i,j,k,l=this,m=0,n=0;if(z=f,k=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==b.inArray(k,[5,6,7,8])){var o=c;c=d,d=o}if(h=a(),e?(c=Math.min(c,h.width),d=Math.min(d,h.height),g=Math.max(c/h.width,d/h.height)):g=Math.min(c/h.width,d/h.height),g>1&&!e&&f)return void this.trigger("Resize");u||(u=document.createElement("canvas")),i=Math.round(h.width*g),j=Math.round(h.height*g),e?(u.width=c,u.height=d,i>c&&(m=Math.round((i-c)/2)),j>d&&(n=Math.round((j-d)/2))):(u.width=i,u.height=j),z||q(u.width,u.height,k),p.call(this,h,u,-m,-n,i,j),this.width=u.width,this.height=u.height,y=!0,l.trigger("Resize")}function p(a,b,c,d,e,f){if("iOS"===j.OS)h.renderTo(a,b,{width:e,height:f,x:c,y:d});else{b.getContext("2d").drawImage(a,c,d,e,f)}}function q(a,b,c){switch(c){case 5:case 6:case 7:case 8:u.width=b,u.height=a;break;default:u.width=a,u.height=b}var d=u.getContext("2d");switch(c){case 2:d.translate(a,0),d.scale(-1,1);break;case 3:d.translate(a,b),d.rotate(Math.PI);break;case 4:d.translate(0,b),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-b);break;case 7:d.rotate(.5*Math.PI),d.translate(a,-b),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-a,0)}}function r(){t&&(t.purge(),t=null),v=s=u=w=null,y=!1}var s,t,u,v,w,x=this,y=!1,z=!0;b.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=!(arguments.length>1)||arguments[1];if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);if(w=a,a.isDetached())return v=a.getSource(),void m.call(this,v);n.call(this,a.getSource(),function(a){e&&(v=k(a)),m.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta,w=new f(null,{name:a.name,size:a.size,type:a.type}),m.call(this,b?v=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b,c=this.getRuntime();return!t&&v&&c.can("access_image_binary")&&(t=new g(v)),b={width:a().width||0,height:a().height||0,type:w.type||i.getFileMime(w.name),size:v&&v.length||w.size||0,name:w.name||"",meta:t&&t.meta||this.meta||{}},!b.meta||!b.meta.thumb||b.meta.thumb.data instanceof e||(b.meta.thumb.data=new e(null,{type:"image/jpeg",data:b.meta.thumb.data})),b},downsize:function(){o.apply(this,arguments)},getAsCanvas:function(){return u&&(u.id=this.uid+"_canvas"),u},getAsBlob:function(a,b){return a!==this.type&&o.call(this,this.width,this.height,!1),new f(null,{name:w.name||"",type:a,data:x.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a){var b=arguments[1]||90;if(!y)return s.src;if("image/jpeg"!==a)return u.toDataURL("image/png");try{return u.toDataURL("image/jpeg",b/100)}catch(a){return u.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!y)return v||(v=k(x.getAsDataURL(a,b))),v;if("image/jpeg"!==a)v=k(x.getAsDataURL(a,b));else{var c;b||(b=90);try{c=u.toDataURL("image/jpeg",b/100)}catch(a){c=u.toDataURL("image/jpeg")}v=k(c),t&&(v=t.stripHeaders(v),z&&(t.meta&&t.meta.exif&&t.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),v=t.writeHeaders(v)),t.purge(),t=null)}return y=!1,v},destroy:function(){x=null,r.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return a.Image=k}),d("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,e){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}function g(a){var d=c.get(a);d&&"OBJECT"==d.nodeName&&("IE"===b.browser?(d.style.display="none",function b(){4==d.readyState?h(a):setTimeout(b,10)}()):d.parentNode.removeChild(d))}function h(a){var b=c.get(a);if(b){for(var d in b)"function"==typeof b[d]&&(b[d]=null);b.parentNode.removeChild(b)}}function i(h){var i,l=this;h=a.extend({swf_url:b.swf_url},h),e.call(this,h,j,{access_binary:function(a){return a&&"browser"===l.mode},access_image_binary:function(a){return a&&"browser"===l.mode},display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(b){return!("json"!==b||!window.JSON)||(!a.arrayDiff(b,["","text","document"])||"browser"===l.mode)},return_status_code:function(b){return"browser"===l.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:function(a){return a&&"browser"===l.mode},send_browser_cookies:function(a){return a&&"browser"===l.mode},send_custom_headers:function(a){return a&&"browser"===l.mode},send_multipart:e.capTrue,slice_blob:function(a){return a&&"browser"===l.mode},stream_upload:function(a){return a&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(b){return a.parseSizeStr(b)<=2097152||"client"===l.mode},use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(b){return a.arrayDiff(b,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(b){return a.parseSizeStr(b)>=2097152?"client":"browser"}},"client"),f()<11.3&&(MXI_DEBUG&&b.debug.runtime&&b.log("\tFlash didn't meet minimal version requirement (11.3)."),this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return l.getShim().exec(this.uid,a,b,c)},init:function(){var c,e,f;f=this.getShimContainer(),a.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+h.swf_url+'" ',"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+h.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===b.browser?(e=document.createElement("div"),f.appendChild(e),e.outerHTML=c,e=f=null):f.innerHTML=c,i=setTimeout(function(){l&&!l.initialized&&(l.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&b.debug.runtime&&b.log("\tFlash failed to initialize within a specified period of time (typically 5s)."))},5e3)},destroy:function(a){return function(){g(l.uid),a.call(l),clearTimeout(i),h=i=a=l=null}}(this.destroy)},k)}var j="flash",k={};return e.addConstructor(j,i),k}),d("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(a,b,c){var d={init:function(a){var d=this,e=this.getRuntime();this.bind("Change",function(){var a=e.shimExec.call(d,"FileInput","getFiles");d.files=[],c.each(a,function(a){d.files.push(new b(e.uid,a))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple}),this.trigger("ready")}};return a.FileInput=d}),d("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){var c={slice:function(a,c,d,e){var f=this.getRuntime();return c<0?c=Math.max(a.size+c,0):c>0&&(c=Math.min(c,a.size)),d<0?d=Math.max(a.size+d,0):d>0&&(d=Math.min(d,a.size)),a=f.shimExec.call(this,"Blob","slice",c,d,e||""),a&&(a=new b(f.uid,a)),a}};return a.Blob=c}),d("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d={read:function(a,b){var d=this;return d.result="","readAsDataURL"===a&&(d.result="data:"+(b.type||"")+";base64,"),d.bind("Progress",function(b,e){e&&(d.result+=c(e,a))},999),d.getRuntime().shimExec.call(this,"FileReader","readAsBase64",b.uid)}};return a.FileReader=d}),d("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d={read:function(a,b){var d;return(d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d),c(d,a,b.type)):null}};return a.FileReaderSync=d}),d("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(a,b,c,d,e,f,g){var h={send:function(a,d){function e(){a.transport=k.mode,k.shimExec.call(j,"XMLHttpRequest","send",a,d)}function h(a,b){k.shimExec.call(j,"XMLHttpRequest","appendBlob",a,b.uid),d=null,e()}function i(a,b){var c=new g;c.bind("TransportingComplete",function(){b(this.result)}),c.transport(a.getSource(),a.type,{ruid:k.uid})}var j=this,k=j.getRuntime();if(b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){k.shimExec.call(j,"XMLHttpRequest","setRequestHeader",b,a.toString())}),d instanceof f){var l;if(d.each(function(a,b){a instanceof c?l=b:k.shimExec.call(j,"XMLHttpRequest","append",b,a)}),d.hasBlob()){var m=d.getBlob();m.isDetached()?i(m,function(a){m.destroy(),h(l,a)}):h(l,m)}else d=null,e()}else d instanceof c?d.isDetached()?i(d,function(a){d.destroy(),d=a.uid,e()}):(d=d.uid,e()):e()},getResponse:function(a){var c,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new d(g.uid,f),"blob"===a)return f;try{if(c=new e,~b.inArray(a,["","text"]))return c.readAsText(f);if("json"===a&&window.JSON)return JSON.parse(c.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return a.XMLHttpRequest=h}),d("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){var c={getAsBlob:function(a){var c=this.getRuntime(),d=c.shimExec.call(this,"Transporter","getAsBlob",a);return d?new b(c.uid,d):null}};return a.Transporter=c}),d("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(a,b,c,d,e){var f={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid),d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var f=new c;f.bind("TransportingComplete",function(){b(f.result.getSource())}),f.transport(a.getSource(),a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getInfo:function(){var a=this.getRuntime(),b=a.shimExec.call(this,"Image","getInfo");return!b.meta||!b.meta.thumb||b.meta.thumb.data instanceof d||(b.meta.thumb.data=new d(a.uid,b.meta.thumb.data)),b},getAsBlob:function(a,b){var c=this.getRuntime(),e=c.shimExec.call(this,"Image","getAsBlob",a,b);return e?new d(c.uid,e):null},getAsDataURL:function(){var a,b=this.getRuntime(),c=b.Image.getAsBlob.apply(this,arguments);return c?(a=new e,a.readAsDataURL(c)):null}};return a.Image=f}),d("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,e){function f(a){var b,c,d,e,f,g=!1,h=null,i=0;try{try{h=new ActiveXObject("AgControl.AgControl"),h.IsVersionSupported(a)&&(g=!0),h=null}catch(h){var j=navigator.plugins["Silverlight Plug-In"];if(j){for(b=j.description,"1.0.30226.2"===b&&(b="2.0.30226.2"),c=b.split(".");c.length>3;)c.pop();for(;c.length<4;)c.push(0);for(d=a.split(".");d.length>4;)d.pop();do{e=parseInt(d[i],10),f=parseInt(c[i],10),i++}while(i<d.length&&e===f);e<=f&&!isNaN(e)&&(g=!0)}}}catch(a){g=!1}return g}function g(g){var j,k=this;g=a.extend({xap_url:b.xap_url},g),e.call(this,g,h,{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a||!!window.JSON},return_status_code:function(b){return"client"===k.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(b){return"client"===k.mode||!a.arrayDiff(b,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(b){return a.arrayDiff(b,["GET","POST"])?"client":["client","browser"]}}),f("2.0.31005.0")&&"Opera"!==b.browser||(MXI_DEBUG&&b.debug.runtime&&b.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely)."),this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var a;a=this.getShimContainer(),a.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>',j=setTimeout(function(){k&&!k.initialized&&(k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&b.debug.runtime&&b.log("Silverlight failed to initialize within a specified period of time (5-10s)."))},"Windows"!==b.OS?1e4:5e3)},destroy:function(a){return function(){a.call(k),clearTimeout(j),g=j=a=k=null}}(this.destroy)},i)}var h="silverlight",i={};return e.addConstructor(h,g),i}),d("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Basic"],function(a,b,c){var d={init:function(a){var d=this,e=this.getRuntime();this.bind("Change",function(){var a=e.shimExec.call(d,"FileInput","getFiles");d.files=[],c.each(a,function(a){d.files.push(new b(e.uid,a))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",function(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(a.accept),a.name,a.multiple),this.trigger("ready")}};return a.FileInput=d}),d("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(a,b,c){return a.Blob=b.extend({},c)}),d("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(a,b,c){var d={init:function(){var a,d=this,e=d.getRuntime();return a=e.getShimContainer(),c.addEvent(a,"dragover",function(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer.dropEffect="copy"},d.uid),c.addEvent(a,"dragenter",function(a){a.preventDefault(),b.get(e.uid).dragEnter(a)&&a.stopPropagation()},d.uid),c.addEvent(a,"drop",function(a){a.preventDefault(),b.get(e.uid).dragDrop(a)&&a.stopPropagation()},d.uid),e.shimExec.call(this,"FileDrop","init")}};return a.FileDrop=d}),d("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(a,b,c){return a.FileReader=b.extend({},c)}),d("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(a,b,c){return a.FileReaderSync=b.extend({},c)}),d("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(a,b,c){return a.XMLHttpRequest=b.extend({},c)}),d("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(a,b,c){return a.Transporter=b.extend({},c)}),d("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(a,b,c,d){return a.Image=b.extend({},d,{getInfo:function(){var a=this.getRuntime(),d=["tiff","exif","gps","thumb"],e={meta:{}},f=a.shimExec.call(this,"Image","getInfo")
;return f.meta&&(b.each(d,function(a){var b,c,d,g,h=f.meta[a];if(h&&h.keys)for(e.meta[a]={},c=0,d=h.keys.length;c<d;c++)b=h.keys[c],(g=h[b])&&(/^(\d|[1-9]\d+)$/.test(g)?g=parseInt(g,10):/^\d*\.\d+$/.test(g)&&(g=parseFloat(g)),e.meta[a][b]=g)}),!e.meta||!e.meta.thumb||e.meta.thumb.data instanceof c||(e.meta.thumb.data=new c(a.uid,e.meta.thumb.data))),e.width=parseInt(f.width,10),e.height=parseInt(f.height,10),e.size=parseInt(f.size,10),e.type=f.type,e.name=f.name,e}})}),d("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue;c.call(this,b,f,{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:h(g.Image&&(d.can("create_canvas")||d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:h(function(){return!("Chrome"===d.browser&&d.verComp(d.version,28,"<")||"IE"===d.browser&&d.verComp(d.version,10,"<")||"Safari"===d.browser&&d.verComp(d.version,7,"<")||"Firefox"===d.browser&&d.verComp(d.version,37,"<"))}()),resize_image:function(){return g.Image&&e.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return!("json"!==b||!window.JSON)||!!~a.inArray(b,["text","document",""])},return_status_code:function(b){return!a.arrayDiff(b,[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:function(){return e.can("select_file")&&("Firefox"===d.browser&&d.verComp(d.version,4,">=")||"Opera"===d.browser&&d.verComp(d.version,12,">=")||"IE"===d.browser&&d.verComp(d.version,10,">=")||!!~a.inArray(d.browser,["Chrome","Safari"]))},upload_filesize:i,use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}}),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html4",g={};return c.addConstructor(f,e),g}),d("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(a,b,c,d,e,f,g){function h(){function a(){var f,k,l,m,n,o,p=this,q=p.getRuntime();o=c.guid("uid_"),f=q.getShimContainer(),h&&(l=d.get(h+"_form"))&&c.extend(l.style,{top:"100%"}),m=document.createElement("form"),m.setAttribute("id",o+"_form"),m.setAttribute("method","post"),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),c.extend(m.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),n=document.createElement("input"),n.setAttribute("id",o),n.setAttribute("type","file"),n.setAttribute("name",i.name||"Filedata"),n.setAttribute("accept",j.join(",")),c.extend(n.style,{fontSize:"999px",opacity:0}),m.appendChild(n),f.appendChild(m),c.extend(n.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===g.browser&&g.verComp(g.version,10,"<")&&c.extend(n.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),n.onchange=function(){var c;if(this.value){if(this.files){if(c=this.files[0],0===c.size)return void m.parentNode.removeChild(m)}else c={name:this.value};c=new b(q.uid,c),this.onchange=function(){},a.call(p),p.files=[c],n.setAttribute("id",c.uid),m.setAttribute("id",c.uid+"_form"),p.trigger("change"),n=m=null}},q.can("summon_file_dialog")&&(k=d.get(i.browse_button),e.removeEvent(k,"click",p.uid),e.addEvent(k,"click",function(a){n&&!n.disabled&&n.click(),a.preventDefault()},p.uid)),h=o,f=l=k=null}var h,i,j=[];c.extend(this,{init:function(b){var c,g=this,h=g.getRuntime();i=b,j=b.accept.mimes||f.extList2mimes(b.accept,h.can("filter_by_extension")),c=h.getShimContainer(),function(){var a,f,i;a=d.get(b.browse_button),h.can("summon_file_dialog")&&("static"===d.getStyle(a,"position")&&(a.style.position="relative"),f=parseInt(d.getStyle(a,"z-index"),10)||1,a.style.zIndex=f,c.style.zIndex=f-1),i=h.can("summon_file_dialog")?a:c,e.addEvent(i,"mouseover",function(){g.trigger("mouseenter")},g.uid),e.addEvent(i,"mouseout",function(){g.trigger("mouseleave")},g.uid),e.addEvent(i,"mousedown",function(){g.trigger("mousedown")},g.uid),e.addEvent(d.get(b.container),"mouseup",function(){g.trigger("mouseup")},g.uid),a=null}(),a.call(this),c=null,g.trigger({type:"ready",async:!0})},disable:function(a){var b;(b=d.get(h))&&(b.disabled=!!a)},destroy:function(){var a=this.getRuntime(),b=a.getShim(),c=a.getShimContainer();e.removeAllEvents(c,this.uid),e.removeAllEvents(i&&d.get(i.container),this.uid),e.removeAllEvents(i&&d.get(i.browse_button),this.uid),c&&(c.innerHTML=""),b.removeInstance(this.uid),h=j=i=c=b=null}})}return a.FileInput=h}),d("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(a,b){return a.FileReader=b}),d("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(a,b,c,d,e,f,g,h){function i(){function a(a){var b,d,e,g,h=this,i=!1;if(k){if(b=k.id.replace(/_iframe$/,""),d=c.get(b+"_form")){for(e=d.getElementsByTagName("input"),g=e.length;g--;)switch(e[g].getAttribute("type")){case"hidden":e[g].parentNode.removeChild(e[g]);break;case"file":i=!0}e=[],i||d.parentNode.removeChild(d),d=null}setTimeout(function(){f.removeEvent(k,"load",h.uid),k.parentNode&&k.parentNode.removeChild(k);var b=h.getRuntime().getShimContainer();b.children.length||b.parentNode.removeChild(b),b=k=null,a()},1)}}var i,j,k;b.extend(this,{send:function(l,m){var n,o,p,q,r=this,s=r.getRuntime();if(i=j=null,m instanceof h&&m.hasBlob()){if(q=m.getBlob(),n=q.uid,p=c.get(n),!(o=c.get(n+"_form")))throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else n=b.guid("uid_"),o=document.createElement("form"),o.setAttribute("id",n+"_form"),o.setAttribute("method",l.method),o.setAttribute("enctype","multipart/form-data"),o.setAttribute("encoding","multipart/form-data"),s.getShimContainer().appendChild(o);o.setAttribute("target",n+"_iframe"),m instanceof h&&m.each(function(a,c){if(a instanceof g)p&&p.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a}),p?o.insertBefore(d,p):o.appendChild(d)}}),o.setAttribute("action",l.url),function(){var c=s.getShimContainer()||document.body,e=document.createElement("div");e.innerHTML='<iframe id="'+n+'_iframe" name="'+n+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',k=e.firstChild,c.appendChild(k),f.addEvent(k,"load",function(){var c;try{c=k.contentWindow.document||k.contentDocument||window.frames[k.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title)?i=c.title.replace(/^(\d+).*$/,"$1"):(i=200,j=b.trim(c.body.innerHTML),r.trigger({type:"progress",loaded:j.length,total:j.length}),q&&r.trigger({type:"uploadprogress",loaded:q.size||1025,total:q.size||1025}))}catch(b){if(!d.hasSameOrigin(l.url))return void a.call(r,function(){r.trigger("error")});i=404}a.call(r,function(){r.trigger("load")})},r.uid)}(),o.submit(),r.trigger("loadstart")},getStatus:function(){return i},getResponse:function(a){if("json"===a&&"string"===b.typeOf(j)&&window.JSON)try{return JSON.parse(j.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(a){return null}return j},abort:function(){var b=this;k&&k.contentWindow&&(k.contentWindow.stop?k.contentWindow.stop():k.contentWindow.document.execCommand?k.contentWindow.document.execCommand("Stop"):k.src="about:blank"),a.call(this,function(){b.dispatchEvent("abort")})}})}return a.XMLHttpRequest=i}),d("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(a,b){return a.Image=b}),function(c){for(var d=0;d<c.length;d++){for(var e=a,g=c[d],h=g.split(/[.\/]/),i=0;i<h.length-1;++i)e[h[i]]===b&&(e[h[i]]={}),e=e[h[i]];e[h[h.length-1]]=f[g]}}(["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/FileInput","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])}(this),function(a){"use strict";var b={},c=a.moxie.core.utils.Basic.inArray;(function a(d){var e,f;for(e in d)f=typeof d[e],"object"!==f||~c(e,["Exceptions","Env","Mime"])?"function"===f&&(b[e]=d[e]):a(d[e])})(a.moxie),b.Env=a.moxie.core.utils.Env,b.Mime=a.moxie.core.utils.Mime,b.Exceptions=a.moxie.core.Exceptions,a.mOxie=b,a.o||(a.o=b)}(this),define("castle-url/libs/moxie/bin/js/moxie",function(){}),define("castle-url/components/upload",["jquery","castle-url/libs/react/react.min","castle-url/components/utils","mockup-utils","castle-url/components/image-editor","castle-url/components/image-focal-point-selector","underscore","mockup-patterns-select2","castle-url/components/content-browser","castle-url/libs/moxie/bin/js/moxie"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=b.DOM,k=b.createClass({getInitialState:function(){return{previewUrl:null,imageWidth:0,imageHeight:0,previewWidth:0,previewHeight:0,imageFocal:[0,0],title:"",description:"",youtube_url:"",tags:"",state:"review",progress:0,url:"",workflow_state:null,blob:null,duplicate:!1,readonlyFields:[],youtubeEnabled:"true"===a("body").attr("data-youtube-enabled")}},componentDidMount:function(){!this.state.previewUrl&&this.isImage()&&this.loadImage(),this.setupTagsWidget()},componentDidUpdate:function(){this.setupTagsWidget()},setupTagsWidget:function(){var b=this;if(b.refs.select2){var c={vocabularyUrl:a("body").attr("data-portal-url")+"/@@getVocabulary?name=plone.app.vocabularies.Keywords&field=subjects",orderable:!0,allowNewItems:!0,separator:";",width:"100%"},d=a(b.refs.select2.getDOMNode());new h(d,c);d.off("change").on("change",function(a){b.setState({tags:a.target.value})})}},loadImage:function(){var a,b,c=this,d=c.state.blob||c.props.file,e=new mOxie.Image;e.onload=function(){a=e.width,b=e.height,e.downsize({width:300})},e.load(d),e.onresize=function(){c.setState({previewUrl:e.getAsDataURL("image/png"),imageWidth:a,imageHeight:b,imageFocal:[a/2,b/2],previewWidth:e.width,previewHeight:e.height})}},valueChanged:function(a,b,c){if("checkbox"==b){if(this.state[a]=c.target.checked,"upload_to_youtube"===a)if(c.target.checked)this.state.youtube_url="",-1===this.state.readonlyFields.indexOf("youtube_url")&&this.state.readonlyFields.push("youtube_url");else{var d=this.state.readonlyFields.indexOf("youtube_url");-1!==d&&this.state.readonlyFields.splice(d)}}else this.state[a]=c.target.value;this.forceUpdate()},render:function(){var a,c=this,d=this.props.file,g="file-container",h=j.h5({},d.name+" ("+this.bytesToSize()+")"),i=j.span({className:"glyphicon glyphicon-file"}),k="col-md-2",l="col-md-10";if(this.state.previewUrl){i=b.createElement(f,{enabled:"review"===this.state.state,url:this.state.previewUrl,key:this.props.file.uid+"-image",width:this.state.previewWidth,fullWidth:this.state.imageWidth,height:this.state.previewHeight,fullHeight:this.state.imageHeight,focalPoint:this.state.imageFocal,onFocalSet:function(a){c.setState({imageFocal:a})}}),k="col-md-6",l="col-md-6"}var m=[];return"uploading"===this.state.state?m.push(this.renderProgress()):"review"===this.state.state?(m.push(this.renderButtons()),g+=" active",a=this.props.parent.state.update?j.div({},[]):j.div({},[this.renderForm()])):"finished"===this.state.state?m.push(this.renderFinished()):"error"===this.state.state?m.push(j.p({className:"error-msg"},"There was an error uploading")):"editimage"===this.state.state&&(a=b.createElement(e,{file:this.props.file,onSave:function(a){c.setState({state:"review",blob:a}),c.loadImage()},onCancel:function(){c.setState({state:"review"})}})),j.li({id:d.uid,className:g,key:d.uid+"-li"},[j.div({className:"row"},[j.div({className:"col-xs-12"},h)]),j.div({className:"row"},[j.div({className:"preview-container "+k},i),j.div({className:l},a)]),j.div({className:"bottom-container"},m)])},publishClicked:function(b){b.preventDefault();var c=this;d.loading.show(),a.ajax({url:this.state.base_url+"/@@publish-content",data:{_authenticator:d.getAuthenticator()}}).done(function(){c.setState({workflow_state:"published"})}).fail(function(){alert("There was an error publishing content")}).always(function(){d.loading.hide()})},renderFinished:function(){var a=[];"published"!==this.state.workflow_state&&(a=["This file is currently not published. ",j.a({className:"content-publish",href:"#",onClick:this.publishClicked},"Publish immediately")]);var b="Finished uploading ";return this.state.duplicate&&(b=j.span({},[j.b({},"Duplicate detected"),j.span({},": Using file already uploaded: ")])),j.div({className:"finished-container"},[j.p({},[b,j.a({className:"content-link",href:this.state.base_url+"/view",target:"_blank"},this.state.title),". "].concat(a))])},renderProgress:function(){var a=this;return j.div({className:"castle-progress-container"},[j.div({className:"castle-progress"},j.span({className:"castle-progress-inner",style:{width:a.state.progress+"%"}})),j.p({},"Uploading "+a.state.progress+"%")])},createField:function(a){var b=a.name,c=void 0;-1!==this.state.readonlyFields.indexOf(b)&&(c=!0);var d;if("checkbox"==a.widget)d=j.input({id:g,type:"checkbox",checked:this.state[b],readOnly:c,onChange:this.valueChanged.bind(this,b,"checkbox")});else{var e=j.input;"textarea"===a.widget&&(e=j.textarea),d=e({className:"form-control",value:this.state[b],id:g,readOnly:c,onChange:this.valueChanged.bind(this,b,"text")})}var f="col-sm-4 control-label";a.required&&(f+=" required");var g="castle-upload-field-"+b;return j.div({className:"form-group upload-field-"+b},[j.label({className:f,for_:g},a.label),j.div({className:"col-sm-8"},d)])},createTagsField:function(a){var b="col-sm-4 control-label";return a.required&&(b+=" required"),j.div({className:"field"},[j.label({className:b},a.label||"Tags"),j.div({className:"col-sm-8"},j.input({className:"pat-select2",type:"text",ref:"select2",value:this.state.tags}))])},renderForm:function(){var a=[],b=this;return this.props.uploadFields.forEach(function(c){if(c["for-file-types"]&&"*"!==c["for-file-types"]){if(-1===c["for-file-types"].split(",").indexOf(b.getType()))return}("upload_to_youtube"!==c.name||b.state.youtubeEnabled)&&("tags"===c.widget?a.push(b.createTagsField(c)):a.push(b.createField(c)))}),j.form({className:"form-horizontal",key:this.props.file.uid+"-form"},a)},editImageClicked:function(a){a.preventDefault(),this.setState({state:"editimage"})},renderButtons:function(){var a=this,b=[],c=!0;return a.props.parent.state.update||g.each(this.props.requiredFields,function(b){a.state[b]||(c=!1)}),this.isImage()&&b.push(j.button({className:"btn btn-default castle-btn-edit",onClick:a.editImageClicked},"Edit Image")),b.push(j.button({className:"plone-btn plone-btn-default castle-btn-remove",onClick:a.removeClicked},j.span({className:"icon-remove"}))),b.push(j.button({className:"plone-btn plone-btn-default castle-btn-upload",onClick:a.approveClicked,disabled:!c},j.span({className:"icon-ok"}))),j.div({className:"row"},j.div({className:"col-md-4 col-md-offset-8"},b))},uploadChunk:function(b,c){var e=this,f=2097152*(b-1),g=f+2097152,h=e.state.blob||e.props.file,i=h.slice(f,g);if(0===i.size)return void d.loading.hide();d.loading.show();var j=new mOxie.XMLHttpRequest,k=new mOxie.FormData;j.open("post",a("body").attr("data-portal-url")+"/@@content-creator"),j.responseType="json",k.append("chunk",b),k.append("action","chunk-upload"),k.append("file",i),k.append("name",e.props.file.name),e.props.parent.props.location&&k.append("location",e.props.parent.props.location),e.state.imageFocal&&(k.append("focalX",e.state.imageFocal[0]),k.append("focalY",e.state.imageFocal[1])),e.props.uploadFields.forEach(function(a){e.state[a.name]&&k.append(a.name,e.state[a.name])}),k.append("totalSize",h.size),k.append("chunkSize",2097152),k.append("_authenticator",d.getAuthenticator()),void 0!==c&&k.append("id",c),e.props.parent.state.update&&(k.append("content",e.props.parent.state.content),k.append("field",e.props.parent.state.field));var l=Math.round((f-1)/h.size*100);e.setState({state:"uploading",progress:l}),j.onload=function(){if(j.response&&j.response.success)if(g<h.size)e.uploadChunk(b+1,j.response.id);else{d.loading.hide();var c=a.extend({},!0,{state:"finished",progress:100},j.response);e.setState(c),e.props.parent.removeUpload(e.props.file.uid)}else e.setState({state:"error"}),e.props.parent.removeUpload(e.props.file.uid),d.loading.hide()},j.bind("error runtimeerror",function(){d.loading.hide(),e.setState({state:"error"}),e.props.parent.removeUpload(e.props.file.uid),d.loading.hide()}),j.send(k,{runtime_order:"html5,flash,html4",required_caps:{send_multipart:!0}})},approveClicked:function(a){a.preventDefault();var b=this;b.setState({state:"uploading",progress:0}),b.props.parent.addUpload(b.props.file.uid)},removeClicked:function(a){a.preventDefault(),this.props.parent.removeFile(this.props.idx)},isImage:function(){return"image"==this.props.file.type.substring(0,5)},getType:function(){var a=this.props.file.type;return a.substring(0,a.indexOf("/"))},bytesToSize:function(){var a=["Bytes","KB","MB","GB","TB"],b=this.state.blob||this.props.file;if(0===b.size)return"0 Byte";var c=parseInt(Math.floor(Math.log(b.size)/Math.log(1024)));return Math.round(b.size/Math.pow(1024,c),2)+" "+a[c]},getDefaultProps:function(){return{_id:null,parent:null,file:null,idx:null}}}),l={getInitialState:function(){return{files:[],dragging:!1,uploadQueue:[],zIndex:3e3,shown:!1,preventClose:!1,autoUpload:!1}},addUpload:function(a){this.state.uploadQueue.push(a),1===this.state.uploadQueue.length&&this.refs[a].uploadChunk(1),this.state.preventClose=!0},removeUpload:function(a){var b=this.state.uploadQueue,c=b.indexOf(a),d=b[c];if(this.props.onUploadFinished(d,this),b.splice(c,1),this.state.uploadQueue=b,b.length>0){var e=this.refs[b[0]];e?e.uploadChunk(1):this.removeUpload(b[0])}else this.state.preventClose=!1},afterFilesAdded:function(a){var b=this;b.state.autoUpload&&a.forEach(function(a){b.addUpload(a.uid)})},componentDidMount:function(){var b=this;b.props.update?b.setState({update:b.props.update,content:b.props.content,field:b.props.field,autoUpload:b.props.autoUpload}):b.setState({update:!1});var c=a("body").attr("data-portal-url");mOxie.Env.swf_url=c+"/++plone++castle/libs/moxie/bin/flash/Moxie.min.swf",mOxie.Env.xap_url=c+"/++plone++castle/libs/moxie/bin/silverlight/Moxie.min.xap";var d=new mOxie.FileInput({browse_button:b.refs.upload_btn.getDOMNode(),runtime_order:"html5,flash,html4",multiple:!0});d.onchange=function(a){b.setState({files:b.state.files.concat(a.target.files)},function(){b.afterFilesAdded(a.target.files)})},d.init();var e=this.refs.droparea.getDOMNode(),f=new mOxie.FileDrop({drop_zone:e});f.ondrop=function(){var a=this.files;b.setState({files:b.state.files.concat(a)},function(){b.afterFilesAdded(a)}),e.style.background=""},f.ondragenter=function(){b.setState({dragging:!0})},f.ondragleave=function(){b.setState({dragging:!1})},f.init()},renderAutoApprove:function(){var a=this;return this.getRequiredFields().length>0?"":j.label({className:"checkbox pull-right"},[j.input({type:"checkbox",checked:this.state.autoUpload,onClick:function(b){a.setState({autoUpload:b.target.checked})}}),"Auto upload"])},renderContent:function(){var a=this,b="castle-upload-container";a.state.dragging&&(b+=" dragging");var c="";a.hasDnd()&&(b+=" dnd-enabled",c=j.div({className:"droptext-container"},[j.p({className:"upload-text"},"Drop files here"),j.p({className:"upload-text"},"or")])),a.state.files.length>0&&(b+=" has-files");var d=[j.div({ref:"droparea",className:"droparea"},[c,j.button({ref:"upload_btn",className:"btn btn-default castle-btn-select-files"},"Select files"),j.p({className:"upload-text drop-msg"},"Files will be uploaded to central repositories unless you choose folder")]),a.renderAutoApprove(),a.renderFileList()],e=[this.props.parent.renderTabItem("upload")];a.state.update||(d.splice(1,0,a.renderUploadLocation()),e.splice(0,0,this.props.parent.renderTabItem("add")));var f=j.div({className:b},d);return j.div({className:"pat-autotoc autotabs fullsize"},[j.nav({className:"autotoc-nav"},e),f])},browsing:!0,selectFolderClicked:function(){var b=this,e=new d.QueryHelper({vocabularyUrl:a("body").attr("data-portal-url")+"/@@getVocabulary?name=plone.app.vocabularies.Catalog",batchSize:18,pattern:this,sort_on:"getObjPositionInParent",sort_order:"ascending",attributes:["UID","Title","portal_type","path","review_state","is_folderish"],baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.list.contains",v:["Folder"]}]});e.currentPath=b.props.location,c.BindComponentFactoryRoot(i,function(){return{onSelectItem:function(a){b.props.location=a.path,b.forceUpdate()},query:e}},"content-browser-react-container")({})},renderUploadLocation:function(){var b=this;return b.props.location?j.div({className:"pick-location"},[j.div({className:"pick-location-folder"},j.a({className:"contenttype-folder",href:"#",onClick:function(a){a.preventDefault(),b.selectFolderClicked()}}," ")),j.div({className:"pick-location-location"},["Upload to: ",b.props.location]),j.div({className:"pick-location-remove"},j.button({className:"remove",onClick:function(a){a.preventDefault(),b.props.location=null,b.forceUpdate()}},"x"))]):j.div({className:"no-location"},[j.a({className:"btn btn-default castle-btn-select-files drop-link",href:"#",onClick:function(c){c.preventDefault();var d=a("body").attr("data-portal-url"),e=a("body").attr("data-folder-url");b.props.location=e.replace(d,"")||"/",b.forceUpdate(),b.selectFolderClicked()}},"Choose Folder")])},renderHeader:function(){return[j.button({type:"button",className:"close","data-dismiss":"modal"},[j.div({className:"close-button"}),j.span({"aria-hidden":"true"},"")]),j.h4({},"Upload")]},renderFooter:function(){var a=[j.button({type:"button",className:"plone-btn plone-btn-primary","data-dismiss":"modal"},"Done")];return j.div({className:"btn-container"},a)},render:function(){return j.div({className:"modal-content"},[j.div({className:"modal-header"},this.renderHeader()),j.div({className:"modal-body"},this.renderContent()),j.div({className:"modal-footer"},this.renderFooter())])},removeFile:function(a){this.state.files.splice(a,1),this.setState({files:this.state.files})},renderFileList:function(){var a=this;return 0===a.state.files.length?"":j.div({className:"file-list"},[j.h3({},"Files"),j.ul({},a.state.files.map(function(c,d){return b.createElement(k,{file:c,ref:c.uid,key:c.uid,idx:d,parent:a,uploadFields:a.getUploadFields()})}))])},hasDnd:function(){return"draggable"in document.createElement("span")&&void 0!==window.FileReader},getUploadFields:function(){var b=a("body").attr("data-file-upload-fields");return b=b?a.parseJSON(b):[]},getRequiredFields:function(){var a=[];return this.getUploadFields().forEach(function(b){b.required&&a.push(b.name)}),a},getDefaultProps:function(){return{id:"upload-content-modal",title:"Upload",location:null,onUploadFinished:function(){}}},getModalEl:function(){return this.props.parent.getModalEl()}};return{component:b.createClass(l),klass:l}}),define("castle-url/components/add-content-modal",["jquery","castle-url/libs/react/react.min","castle-url/components/modal","castle-url/components/upload","castle-url/components/utils","mockup-utils","castle-url/components/content-browser","underscore"],function(a,b,c,d,e,f,g,h){"use strict";var i=b.DOM,j=["plone-contentmenu-settings","plone-contentmenu-more"],k=0,l=b.createClass({getInitialState:function(){return{selectedType:null,valid:!1,basePath:"/",id:"",title:"",status:null,stateInfo:null,transitionTo:null,createdContent:[],zIndex:3e3,shown:!1,preventClose:!1}},contentTypeClicked:function(b,c){if(-1===j.indexOf(b.id)){var d=this;c.preventDefault(),d.props.title="Add "+b.title,d.setState({selectedType:b,basePath:b.folderPath||"/"},function(){a(d.refs.contentTitle.getDOMNode()).focus(),d.props.parent.forceUpdate()})}},createAndEditClicked:function(a){this.createClicked(a,function(a){a.valid&&(window.location=a.edit_url)})},createClicked:function(b,c){b.preventDefault();var d=this;f.loading.show(),a.ajax({method:"POST",url:a("body").attr("data-portal-url")+"/@@content-creator",data:a.extend({},!0,d.state,{action:"create",_authenticator:f.getAuthenticator()}),dataType:"json"}).done(function(a){d.setState(a),c&&"function"==typeof c?c(a,d):d.props.afterCreationCallback(a,d)}).fail(function(){d.setState({status:"Error validating with server. This should not happen. Contact support",valid:!1})}).always(function(){f.loading.hide()})},locationChanged:function(a){this.setState({basePath:a.target.value||"/",valid:!1}),this.check()},titleChanged:function(a){this.setState({title:a.target.value,id:a.target.value.replace(/ /g,"-").replace(/[^\w\s-]/gi,"").toLowerCase(),valid:!1}),this.check()},idChanged:function(a){this.setState({id:a.target.value,valid:!1}),this.check()},getFullPath:function(){var a=this.state.basePath;return"/"!==a[a.length-1]&&(a+="/"),a+this.state.id},check:function(){var b=this;clearTimeout(k),k=setTimeout(function(){b.state.id&&b.state.title&&(f.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+"/@@content-creator",data:a.extend({},!0,b.state,{action:"check"}),dataType:"json"}).done(function(a){b.setState(a)}).fail(function(){b.setState({status:"Error validating with server. This should not happen. Contact support",valid:!1})}).always(function(){f.loading.hide()}))},500)},browsing:!0,selectFolderClicked:function(b){b.preventDefault();var c=this,d=new f.QueryHelper({vocabularyUrl:a("body").attr("data-portal-url")+"/@@getVocabulary?name=plone.app.vocabularies.Catalog",batchSize:18,pattern:this,sort_on:"getObjPositionInParent",sort_order:"ascending",attributes:["UID","Title","portal_type","path","review_state","is_folderish"],baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.list.contains",v:["Folder"]}]});d.currentPath="/",e.BindComponentFactoryRoot(g,function(){return{onSelectItem:function(a){c.setState({basePath:a.path,valid:!1}),c.check()},query:d}},"content-browser-react-container")({})},renderSelectionContent:function(){var a=this,b="";return this.props.canConstrainTypes&&(b=i.div({className:"castle-constrain-types"},[i.a({href:this.props.constrainUrl,className:"plone-btn plone-btn-default "},"Constrain allowed types")])),i.div({className:"wrapper"},[i.ul({className:"select-type"},this.props.types.map(function(b){return i.li({className:"contenttype-"+b.safeId+"-container"},i.a({className:"contenttype-"+b.safeId,onClick:a.contentTypeClicked.bind(a,b)},b.title))})),b])},renderAddContent:function(){var a=this,b="";this.state.status&&(b=i.div({className:"portalMessage warning"},[i.strong({},"Warning"),this.state.status]));var c=[i.option({},"Private")];return null!==this.state.stateInfo&&(c=[i.option({},this.state.stateInfo.initial.title)],h.each(h.keys(a.state.stateInfo.possible_states),function(b){var d=a.state.stateInfo.possible_states[b];c.push(i.option({value:d.transition},d.title))})),i.div({className:"wrapper"},[i.div({className:"input-group"},[i.label({className:"input-group-addon",for_:"contentTitle"},"Title"),i.input({type:"text",className:"form-control",id:"contentTitle",placeholder:"Title of content",value:this.state.title,ref:"contentTitle",onChange:this.titleChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon",for_:"contentId"},"ID"),i.input({type:"text",className:"form-control",id:"contentId",placeholder:"ID of the content",value:this.state.id,onChange:this.idChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},["Folder ",i.a({href:"#",className:"contenttype-folder",onClick:this.selectFolderClicked})]),i.input({type:"text",className:"form-control",id:"contentLocation",placeholder:"Where on the site?",value:this.state.basePath,onChange:this.locationChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},"Url"),i.input({type:"text",className:"form-control",value:this.getFullPath(),disabled:!0})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},"State"),i.select({className:"form-control",onChange:a.stateSelected,value:a.state.transitionTo,id:"contentState"},c)]),b])},addAnotherClicked:function(a){this.setState({addAnother:"add"===a.target.value})},stateSelected:function(a){this.setState({transitionTo:a.target.value})},renderHeader:function(){var a="Add";return this.state.selectedType&&(a+=" "+this.state.selectedType.title),[i.button({type:"button",className:"close","data-dismiss":"modal"},[i.div({className:"close-button"}),i.span({"aria-hidden":"true"},"")]),i.h4({},a)]},render:function(){return i.div({className:"modal-content"},[i.div({className:"modal-header"},this.renderHeader()),i.div({className:"modal-body"},this.renderContent()),i.div({className:"modal-footer"},this.renderFooter())])},renderContent:function(){var a,b=this;return a=null===b.state.selectedType?b.renderSelectionContent():b.renderAddContent(),i.div({className:"pat-autotoc autotabs fullsize"},[i.nav({className:"autotoc-nav"},[this.props.parent.renderTabItem("add"),this.props.parent.renderTabItem("upload"),this.props.parent.renderTabItem("templates")]),a])},renderFooter:function(){var a=[];if(null!==this.state.selectedType){a.push(i.button({type:"button",className:"plone-btn plone-btn-default",onClick:this.goBack},"Cancel"));var b=!1;this.state.valid||(b=!0),a.push(i.button({type:"button",className:"plone-btn btn-default",onClick:this.createClicked,disabled:b},"Create")),this.props.allowEditAfterCreation&&a.push(i.button({type:"button",className:"plone-btn plone-btn-primary",onClick:this.createAndEditClicked,disabled:b},"Create and Edit"))}else a.push(i.button({type:"button",className:"plone-btn plone-btn-primary","data-dismiss":"modal"},"Done"));var c="";return this.state.createdContent.length>0&&(c=i.div({className:"content-list"},[i.h4({},"Created content"),i.ul({},this.state.createdContent.map(function(a){return i.li({},[a.title+" | ",i.a({href:a.url,target:"_blank"},"View")," | ",i.a({href:a.edit_url,target:"_blank"},"Edit")])})),i.hr({})])),i.div({},[c,i.div({className:"btn-container"},a)])},goBack:function(a){a.preventDefault(),this.setState({valid:!1,id:"",title:"",selectedType:null,status:null,stateInfo:null,transitionTo:null})},getDefaultProps:function(){return{types:[],allowEditAfterCreation:!0,afterCreationCallback:function(a,b){b.state.createdContent.push(a),b.setState({valid:!1,id:"",title:"",selectedType:null,status:null,stateInfo:null,transitionTo:null})}}},getModalEl:function(){return this.props.parent.getModalEl()}}),m=b.createClass({getInitialState:function(){return{selectedType:null,valid:!1,basePath:"/",id:"",title:"",status:null,stateInfo:null,transitionTo:null,createdContent:[],zIndex:3e3,shown:!1,preventClose:!1}},contentTypeClicked:function(b,c){if(-1===j.indexOf(b.id)){var d=this;c.preventDefault(),d.props.title="Add "+b.title,d.setState({selectedType:b,basePath:b.folderPath||"/"},function(){a(d.refs.contentTitle.getDOMNode()).focus(),d.props.parent.forceUpdate()})}},createAndEditClicked:function(a){this.createClicked(a,function(a){a.valid&&(window.location=a.edit_url)})},createClicked:function(b,c){b.preventDefault();var d=this;f.loading.show(),a.ajax({method:"POST",
url:a("body").attr("data-portal-url")+"/@@content-creator",data:a.extend({},!0,d.state,{action:"create-from-template",_authenticator:f.getAuthenticator()}),dataType:"json"}).done(function(a){d.setState(a),c&&"function"==typeof c?c(a,d):d.props.afterCreationCallback(a,d)}).fail(function(){d.setState({status:"Error validating with server. This should not happen. Contact support",valid:!1})}).always(function(){f.loading.hide()})},locationChanged:function(a){this.setState({basePath:a.target.value||"/",valid:!1}),this.check()},titleChanged:function(a){this.setState({title:a.target.value,id:a.target.value.replace(/ /g,"-").replace(/[^\w\s-]/gi,"").toLowerCase(),valid:!1}),this.check()},idChanged:function(a){this.setState({id:a.target.value,valid:!1}),this.check()},getFullPath:function(){var a=this.state.basePath;return"/"!==a[a.length-1]&&(a+="/"),a+this.state.id},check:function(){var b=this;clearTimeout(k),k=setTimeout(function(){b.state.id&&b.state.title&&(f.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+"/@@content-creator",data:a.extend({},!0,b.state,{action:"check"}),dataType:"json"}).done(function(a){b.setState(a)}).fail(function(){b.setState({status:"Error validating with server. This should not happen. Contact support",valid:!1})}).always(function(){f.loading.hide()}))},500)},browsing:!0,selectFolderClicked:function(b){b.preventDefault();var c=this,d=new f.QueryHelper({vocabularyUrl:a("body").attr("data-portal-url")+"/@@getVocabulary?name=plone.app.vocabularies.Catalog",batchSize:18,pattern:this,sort_on:"getObjPositionInParent",sort_order:"ascending",attributes:["UID","Title","portal_type","path","review_state","is_folderish"],baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.list.contains",v:["Folder"]}]});d.currentPath="/",e.BindComponentFactoryRoot(g,function(){return{onSelectItem:function(a){c.setState({basePath:a.path,valid:!1}),c.check()},query:d}},"content-browser-react-container")({})},renderSelectionContent:function(){var a=this,b="";return this.props.canConstrainTypes&&(b=i.div({className:"castle-constrain-types"},[i.a({href:this.props.constrainUrl,className:"plone-btn plone-btn-default "},"Constrain allowed types")])),i.div({className:"wrapper"},[i.ul({className:"select-type"},this.props.templates.map(function(b){return i.li({className:"contenttype-"+b.safeId+"-container"},i.a({className:"contenttype-"+b.safeId,onClick:a.contentTypeClicked.bind(a,b)},b.title))})),b])},renderTemplateContent:function(){var a=this,b="";this.state.status&&(b=i.div({className:"portalMessage warning"},[i.strong({},"Warning"),this.state.status]));var c=[i.option({},"Private")];return null!==this.state.stateInfo&&(c=[i.option({},this.state.stateInfo.initial.title)],h.each(h.keys(a.state.stateInfo.possible_states),function(b){var d=a.state.stateInfo.possible_states[b];c.push(i.option({value:d.transition},d.title))})),i.div({className:"wrapper"},[i.div({className:"input-group"},[i.label({className:"input-group-addon",for_:"contentTitle"},"Title"),i.input({type:"text",className:"form-control",id:"contentTitle",placeholder:"Title of content",value:this.state.title,ref:"contentTitle",onChange:this.titleChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon",for_:"contentId"},"ID"),i.input({type:"text",className:"form-control",id:"contentId",placeholder:"ID of the content",value:this.state.id,onChange:this.idChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},["Folder ",i.a({href:"#",className:"contenttype-folder",onClick:this.selectFolderClicked})]),i.input({type:"text",className:"form-control",id:"contentLocation",placeholder:"Where on the site?",value:this.state.basePath,onChange:this.locationChanged})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},"Url"),i.input({type:"text",className:"form-control",value:this.getFullPath(),disabled:!0})]),i.div({className:"input-group"},[i.label({className:"input-group-addon"},"State"),i.select({className:"form-control",onChange:a.stateSelected,value:a.state.transitionTo,id:"contentState"},c)]),b])},addAnotherClicked:function(a){this.setState({addAnother:"add"===a.target.value})},stateSelected:function(a){this.setState({transitionTo:a.target.value})},renderHeader:function(){var a="Add";return this.state.selectedType&&(a+=" "+this.state.selectedType.title),[i.button({type:"button",className:"close","data-dismiss":"modal"},[i.div({className:"close-button"}),i.span({"aria-hidden":"true"},"")]),i.h4({},a)]},render:function(){return i.div({className:"modal-content"},[i.div({className:"modal-header"},this.renderHeader()),i.div({className:"modal-body"},this.renderContent()),i.div({className:"modal-footer"},this.renderFooter())])},renderContent:function(){var a,b=this;return a=null===b.state.selectedType?b.renderSelectionContent():b.renderTemplateContent(),i.div({className:"pat-autotoc autotabs fullsize"},[i.nav({className:"autotoc-nav"},[this.props.parent.renderTabItem("add"),this.props.parent.renderTabItem("upload"),this.props.parent.renderTabItem("templates")]),a])},renderFooter:function(){var a=[];if(null!==this.state.selectedType){a.push(i.button({type:"button",className:"plone-btn plone-btn-default",onClick:this.goBack},"Cancel"));var b=!1;this.state.valid||(b=!0),a.push(i.button({type:"button",className:"plone-btn btn-default",onClick:this.createClicked,disabled:b},"Create")),this.props.allowEditAfterCreation&&a.push(i.button({type:"button",className:"plone-btn plone-btn-primary",onClick:this.createAndEditClicked,disabled:b},"Create and Edit"))}else a.push(i.button({type:"button",className:"plone-btn plone-btn-primary","data-dismiss":"modal"},"Done"));var c="";return this.state.createdContent.length>0&&(c=i.div({className:"content-list"},[i.h4({},"Created content"),i.ul({},this.state.createdContent.map(function(a){return i.li({},[a.title+" | ",i.a({href:a.url,target:"_blank"},"View")," | ",i.a({href:a.edit_url,target:"_blank"},"Edit")])})),i.hr({})])),i.div({},[c,i.div({className:"btn-container"},a)])},goBack:function(a){a.preventDefault(),this.setState({valid:!1,id:"",title:"",selectedType:null,status:null,stateInfo:null,transitionTo:null})},getDefaultProps:function(){return{templates:[],allowEditAfterCreation:!0,afterCreationCallback:function(a,b){b.state.createdContent.push(a),b.setState({valid:!1,id:"",title:"",selectedType:null,status:null,stateInfo:null,transitionTo:null})}}},getModalEl:function(){return this.props.parent.getModalEl()}});return e.Class([c],{tabs:{add:{Component:l,id:"add-content-modal",title:"Add content",tabLabel:"Add"},upload:{Component:d.component,id:"upload-content-modal",title:"Upload",tabLabel:"Upload"},templates:{Component:m,id:"add-template-modal",title:"Templates",tabLabel:"Templates"}},getDefaultProps:function(){return{update:!1}},getId:function(){return this.getTab().id},getTitle:function(){return this.getTab().title},getTab:function(){return this.tabs[this.state.selected]},getInitialState:function(){var a="add";return this.props.update&&(a="upload"),e.extend(c.getInitialState.apply(this),{selected:a})},renderTabItem:function(a){var b=this.tabs[a],c="autotoc-level-"+a,d=b.tabLabel;return this.state.selected===a&&(c+=" active","add"===a&&this.refs.tab&&this.refs.tab.state.selectedType&&(d=d+=" "+this.refs.tab.state.selectedType.title)),i.a({href:"#"+a,className:c,onClick:this.tabClicked.bind(this,a)},d)},tabClicked:function(a,b){b.preventDefault(),this.setState({selected:a})},renderContentContainer:function(){return b.createElement(this.getTab().Component,e.extend(this.props,{ref:"tab",parent:this}))}})}),define("mockup-patterns-relateditems",["jquery","castle-url/libs/react/react.min","underscore","pat-base","mockup-patterns-select2","mockup-utils","mockup-patterns-tree","translate","castle-url/components/content-browser","castle-url/components/add-content-modal","castle-url/components/utils"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=b.DOM,m=c.template('<div class="pattern-relateditems-result  <% if (selected) { %>pattern-relateditems-active<% } %>">  <a href="#" class=" pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">    <% if (typeof getIcon !== "undefined" && getIcon) { %><img src="<%- getURL %>/@@images/image/icon "> <% } %>    <span class="pattern-relateditems-result-title  <% if (typeof review_state !== "undefined") { %> state-<%- review_state %> <% } %>  " /span>    <span class="pattern-relateditems contenttype-<%- portal_type.toLowerCase() %>"><%- Title %></span>    <span class="pattern-relateditems-result-path"><%- path %></span>  </a></div>'),n=b.createClass({getInitialState:function(){return{selected:this.props.initial_selection,items:[]}},getDefaultProps:function(){return{initial_selection:[],allowAdd:!0,noItemsSelectedText:"No items selected",portal_url:a("body").attr("data-portal-url")}},getQueryHelper:function(){return new f.QueryHelper({vocabularyUrl:this.props.vocabularyUrl,batchSize:30,pattern:this.props.parent,sort_on:"getObjPositionInParent",sort_order:"ascending",baseCriteria:this.props.baseCriteria.slice(),attributes:["UID","Title","portal_type","path","review_state","is_folderish"]})},selectionUpdated:function(){this.props.updateValue(this.state.selected),this.load()},componentDidMount:function(){this.load(),this.setupSelect2()},setupSelect2:function(){var b=this,d=new f.QueryHelper({vocabularyUrl:this.props.vocabularyUrl,batchSize:15,attributes:["UID","Title","portal_type","path","review_state","is_folderish"]}),e=d.selectAjax();e.data=function(a,b){var c={query:JSON.stringify({criteria:d.getCriterias(a)}),attributes:JSON.stringify(d.options.attributes)};return b&&(c.batch=JSON.stringify(d.getBatch(b))),c},e.quietMillis=300,a(b.refs.select2.getDOMNode()).select2({placeholder:"Type to search",minimumInputLength:3,ajax:e,multiple:!0,width:b.props.widget||400,formatResult:function(d){d.selected=-1!==b.state.selected.indexOf(d.UID),null===b.props.selectableTypes?d.selectable=!0:d.selectable=c.indexOf(b.props.selectableTypes,d.portal_type)>-1;var e=a(m(d));return e.on("click",function(){b.addSelection([d.UID])}),e}})},addSelection:function(a){var b=this,c=[];a.forEach(function(a){-1===b.state.selected.indexOf(a)&&c.push(a)}),1===b.props.maximumSelectionSize?c.length>0&&(b.state.selected=[c[0]]):b.state.selected=b.state.selected.concat(c),b.selectionUpdated()},load:function(){var b=this;if(0===this.state.selected.length)return void this.setState({items:[]});f.loading.show();var d=[{i:"UID",o:"plone.app.querystring.operation.list.contains",v:b.state.selected}],e="GET";b.state.selected.length>60&&(e="POST"),a.ajax({url:b.props.vocabularyUrl,dataType:"JSON",type:e,data:{query:JSON.stringify({criteria:d}),attributes:JSON.stringify(["Title","getURL","UID","id","path","portal_type","review_state","is_folderish"]),batch:JSON.stringify({page:1,size:500})}}).done(function(d){var e=c.sortBy(d.results,function(a){return b.state.selected.indexOf(a.UID)});b.setState({items:e}),b.props.input&&a(b.props.input).trigger("loaded")}).always(function(){f.loading.hide()}).fail(function(){alert("error loading selection data")})},browseClicked:function(a){var b=this;a.preventDefault();var c=!1;this.props.multiple&&1!==this.props.maximumSelectionSize&&(c=!0);var d,e=b.getQueryHelper(),f=k.BindComponentFactoryRoot(i,function(){return{onSelectItem:function(a){b.addSelection([a.UID])},onSelectItems:function(a){var c=[];a.forEach(function(a){c.push(a.UID)}),b.addSelection(c)},baseCriteria:e.options.baseCriteria,query:e,multiple:c,selectableTypes:b.props.selectableTypes}},"content-browser-react-container"),g=f({});b.props.selectableTypes&&1===b.props.selectableTypes.length&&("Image"===b.props.selectableTypes[0]&&(d="/image-repository"),"File"===b.props.selectableTypes[0]&&(d="/file-repository"),"Video"===b.props.selectableTypes[0]&&(d="/video-repository"),"Audio"===b.props.selectableTypes[0]&&(d="/audio-repository")),d&&(g.setPath(d),g.load())},addClicked:function(a){var b=this;a.preventDefault();var d=k.getToolbarSettings(),e=k.createModalComponent(j,"add-modal-react-container",{types:d.add.types,allowEditAfterCreation:!1,afterCreationCallback:function(a,c){b.addSelection([a.uid]),c.getModalEl().modal("hide")},onHidden:function(a,d){var e=d.refs.tab;if(e&&e.state.files){var f=[];c.each(e.state.files,function(a){var b=e.refs[a.uid];"finished"===b.state.state&&f.push(b.state.uid)}),b.addSelection(f)}}});!b.props.selectableTypes||-1===b.props.selectableTypes.indexOf("Image")&&-1===b.props.selectableTypes.indexOf("File")||e.setState({selected:"upload"})},removeClicked:function(a,b){var c=this;b.preventDefault();var d=c.state.selected.indexOf(a.UID);-1!==d&&c.state.selected.splice(d,1),c.selectionUpdated()},move:function(a,b,c){var d=this;c.preventDefault();var e=d.state.selected.indexOf(a.UID);if(-1!==e){var f=d.state.selected[e];d.state.selected[e]=d.state.selected[e+b],d.state.selected[e+b]=f}d.selectionUpdated()},renderSelected:function(){var a,b=this;if(0===this.state.items.length)a=l.p({className:"castle-relateditems-empty"},this.props.noItemsSelectedText);else{var c=[];b.state.items.forEach(function(a,d){var e="contenttype-document contenttype-"+a.portal_type.toLowerCase();"Folder"===a.portal_type&&(e="contenttype-folder");var f=l.span({className:e,key:a.UID+"-icon"}),g=[l.button({className:"icon-trash plone-btn plone-btn-default",onClick:b.removeClicked.bind(b,a)},"Remove")];0!==d&&g.push(l.button({className:"icon-move-up plone-btn plone-btn-default",onClick:b.move.bind(b,a,-1)},"Up")),d<b.state.items.length-1&&g.push(l.button({className:"icon-move-down plone-btn plone-btn-default",onClick:b.move.bind(b,a,1)},"Down")),c.push(l.tr({},[l.td({},[f,a.Title]),l.td({},l.a({href:b.props.portal_url+a.path+"/view",target:"_blank"},a.path)),l.td({},g)]))}),a=l.table({className:"contents table"},[l.thead({},l.tr({},[l.th({},"Title"),l.th({},"Path"),l.th({},"Actions")])),l.tbody({},c)])}return l.div({className:"castle-relateditems-selected"},a)},render:function(){var a=[l.button({className:"plone-btn plone-btn-default castle-btn-browse",onClick:this.browseClicked},"Browse")];return this.props.allowAdd&&a.push(l.button({className:"plone-btn plone-btn-default castle-btn-add",onClick:this.addClicked},"Add")),l.div({className:"castle-relateditems-container"},[l.div({className:"castle-relateditems-selectors row"},[l.div({className:"col-xs-12 col-md-3 castle-re-select"},a),l.div({className:"col-xs-12 col-md-9 castle-re-search"},[l.label({className:"visually-hidden",htmlFor:"reSearch"},"Search"),l.input({id:"reSearch",ref:"select2"})])]),this.renderSelected()])}}),o=d.extend({browsing:!0,name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:"/",defaults:{vocabularyUrl:null,width:"100%",multiple:!0,tokenSeparators:[","," "],separator:",",selectableTypes:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],maximumSelectionSize:-1,initialPath:null,baseCriteria:[],allowAdd:!0,setupAjax:function(){var a=this;return a.query.valid?a.query.selectAjax():{}}},init:function(){var a=this;a.options.initialPath&&(a.currentPath=a.options.initialPath);var c=k.extend(this.options,{parent:this,input:this.$el[0],updateValue:function(b){a.$el.attr("value",b.join(a.options.separator)),a.$el.trigger("change")}}),d=document.createElement("div");this.$el.parent().append(d),this.$el.hide(),this.$el.parent().find("#reSearch").remove();var e=a.$el.attr("value");a.component=b.render(b.createElement(n,c),d),this.$el[0].component=a.component;var f;f=e?e.split(a.options.separator):[],a.component.setState({selected:f}),a.component.load()}});return o.Component=n,o}),function(a){define("tinymce",[],function(){return function(){return function(){!function(){"use strict";function a(){function a(c,d){return b.push(c+" ")>cc.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function b(a){return a[tc]=!0,a}function c(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||Cc)-(~a.sourceIndex||Cc);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function d(a){return b(function(c){return c=+c,b(function(b,d){for(var e,f=a([],b.length,c),g=f.length;g--;)b[e=f[g]]&&(b[e]=!(d[e]=b[e]))})})}function e(a){return a&&typeof a.getElementsByTagName!==Bc&&a}function f(){}function g(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function h(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=wc++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[vc,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[tc]||(b[tc]={}),(h=i[d])&&h[0]===vc&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function i(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function j(a,b,c){for(var d=0,e=b.length;d<e;d++)bd(a,b[d],c);return c}function k(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function l(a,c,d,e,f,g){return e&&!e[tc]&&(e=l(e)),f&&!f[tc]&&(f=l(f,g)),b(function(b,g,h,i){var l,m,n,o=[],p=[],q=g.length,r=b||j(c||"*",h.nodeType?[h]:h,[]),s=!a||!b&&c?r:k(r,o,a,h,i),t=d?f||(b?a:q||e)?[]:g:s;if(d&&d(s,t,h,i),e)for(l=k(t,p),e(l,[],h,i),m=l.length;m--;)(n=l[m])&&(t[p[m]]=!(s[p[m]]=n));if(b){if(f||a){if(f){for(l=[],m=t.length;m--;)(n=t[m])&&l.push(s[m]=n);f(null,t=[],l,i)}for(m=t.length;m--;)(n=t[m])&&(l=f?Jc.call(b,n):o[m])>-1&&(b[l]=!(g[l]=n))}}else t=k(t===g?t.splice(q,t.length):t),f?f(null,g,t,i):Hc.apply(g,t)})}function m(a){for(var b,c,d,e=a.length,f=cc.relative[a[0].type],j=f||cc.relative[" "],k=f?1:0,n=h(function(a){return a===b},j,!0),o=h(function(a){return Jc.call(b,a)>-1},j,!0),p=[function(a,c,d){return!f&&(d||c!==ic)||((b=c).nodeType?n(a,c,d):o(a,c,d))}];k<e;k++)if(c=cc.relative[a[k].type])p=[h(i(p),c)];else{if(c=cc.filter[a[k].type].apply(null,a[k].matches),c[tc]){for(d=++k;d<e&&!cc.relative[a[d].type];d++);return l(k>1&&i(p),k>1&&g(a.slice(0,k-1).concat({value:" "===a[k-2].type?"*":""})).replace(Oc,"$1"),c,k<d&&m(a.slice(k,d)),d<e&&m(a=a.slice(d)),d<e&&g(a))}p.push(c)}return i(p)}function n(a,c){var d=c.length>0,e=a.length>0,f=function(b,f,g,h,i){var j,l,m,n=0,o="0",p=b&&[],q=[],r=ic,s=b||e&&cc.find.TAG("*",i),t=vc+=null==r?1:Math.random()||.1,u=s.length;for(i&&(ic=f!==mc&&f);o!==u&&null!=(j=s[o]);o++){if(e&&j){for(l=0;m=a[l++];)if(m(j,f,g)){h.push(j);break}i&&(vc=t)}d&&((j=!m&&j)&&n--,b&&p.push(j))}if(n+=o,d&&o!==n){for(l=0;m=c[l++];)m(p,q,f,g);if(b){if(n>0)for(;o--;)p[o]||q[o]||(q[o]=Fc.call(h));q=k(q)}Hc.apply(h,q),i&&!b&&q.length>0&&n+c.length>1&&bd.uniqueSort(h)}return i&&(vc=t,ic=r),p};return d?b(f):f}function o(a,b,c){var d=a.isiOS()&&!0===/ipad/i.test(c),e=a.isiOS()&&!d,f=a.isAndroid()&&3===a.version.major,g=a.isAndroid()&&4===a.version.major,h=d||f||g&&!0===/mobile/i.test(c),i=a.isiOS()||a.isAndroid(),j=i&&!h,k=b.isSafari()&&a.isiOS()&&!1===/safari/i.test(c);return{isiPad:Aa.constant(d),isiPhone:Aa.constant(e),isTablet:Aa.constant(h),isPhone:Aa.constant(j),isTouch:Aa.constant(i),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:Aa.constant(k)}}function p(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];if(a.length!==b.length)throw new Error('Wrong number of arguments to struct. Expected "['+a.length+']", got '+b.length+" arguments");var d={};return ob.each(a,function(a,c){d[a]=Aa.constant(b[c])}),d}}function q(a,b){var c=a.concat(b);if(0===c.length)throw new Error("You must specify at least one required or optional field.");return rg.validateStrArr("required",a),rg.validateStrArr("optional",b),rg.checkDupes(c),function(d){var e=Ef.keys(d);ob.forall(a,function(a){return ob.contains(e,a)})||rg.reqMessage(a,e);var f=ob.filter(e,function(a){return!ob.contains(c,a)});f.length>0&&rg.unsuppMessage(f);var g={};return ob.each(a,function(a){g[a]=Aa.constant(d[a])}),ob.each(b,function(a){g[a]=Aa.constant(Object.prototype.hasOwnProperty.call(d,a)?Ha.some(d[a]):Ha.none())}),g}}function r(a,b){var c,d=0,e={};b=b||{},c=b.maxLoadTime||5e3;var f=function(b){a.getElementsByTagName("head")[0].appendChild(b)},g=function(b,g,h){var i,j,k,l,m=function(){for(var a=l.passed,b=a.length;b--;)a[b]();l.status=2,l.passed=[],l.failed=[]},n=function(){for(var a=l.failed,b=a.length;b--;)a[b]();l.status=3,l.passed=[],l.failed=[]},o=function(a,b){a()||((new Date).getTime()-k<c?Qb.setTimeout(b):n())},p=function(){o(function(){for(var b,c,d=a.styleSheets,e=d.length;e--;)if(b=d[e],(c=b.ownerNode?b.ownerNode:b.owningElement)&&c.id===i.id)return m(),!0},p)},q=function(){o(function(){try{var a=j.sheet.cssRules;return m(),!!a}catch(a){}},q)};if(b=zd._addCacheSuffix(b),e[b]?l=e[b]:(l={passed:[],failed:[]},e[b]=l),g&&l.passed.push(g),h&&l.failed.push(h),1!==l.status){if(2===l.status)return void m();if(3===l.status)return void n();if(l.status=1,i=a.createElement("link"),i.rel="stylesheet",i.type="text/css",i.id="u"+d++,i.async=!1,i.defer=!1,k=(new Date).getTime(),"onload"in i&&!function(){var a=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(a&&parseInt(a[1],10)<536)}())i.onload=p,i.onerror=n;else{if(navigator.userAgent.indexOf("Firefox")>0)return j=a.createElement("style"),j.textContent='@import "'+b+'"',q(),void f(j);p()}f(i),i.href=b}},h=function(a){return uh.nu(function(b){g(a,Aa.compose(b,Aa.constant(Dh.value(a))),Aa.compose(b,Aa.constant(Dh.error(a))))})},i=function(a){return a.fold(Aa.identity,Aa.identity)};return{load:g,loadAll:function(a,b,c){Ah.par(ob.map(a,h)).get(function(a){var d=ob.partition(a,function(a){return a.isValue()});d.fail.length>0?c(d.fail.map(i)):b(d.pass.map(i))})}}}function s(a,b){var c=a,d=function(a,c,d,e){var f,g;if(a){if(!e&&a[c])return a[c];if(a!==b){if(f=a[d])return f;for(g=a.parentNode;g&&g!==b;g=g.parentNode)if(f=g[d])return f}}},e=function(a,c,d,e){var f,g,h;if(a){if(f=a[d],b&&f===b)return;if(f){if(!e)for(h=f[c];h;h=h[c])if(!h[c])return h;return f}if((g=a.parentNode)&&g!==b)return g}};this.current=function(){return c},this.next=function(a){return c=d(c,"firstChild","nextSibling",a)},this.prev=function(a){return c=d(c,"lastChild","previousSibling",a)},this.prev2=function(a){return c=e(c,"lastChild","previousSibling",a)}}function t(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o={},p={},q=[],r={},s={},t=function(b,c,d){var e=a[b];return e?e=Ki(e,/[, ]/,Ki(e.toUpperCase(),/[, ]/)):(e=Ii[b])||(e=Ki(c," ",Ki(c.toUpperCase()," ")),e=Mi(e,d),Ii[b]=e),e};a=a||{},d=Qi(a.schema),!1===a.verify_html&&(a.valid_elements="*[*]"),b=Ri(a.valid_styles),c=Ri(a.invalid_styles,"map"),i=Ri(a.valid_classes,"map"),e=t("whitespace_elements","pre script noscript style textarea video audio iframe object code"),f=t("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),g=t("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=t("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),k=t("non_empty_elements","td th iframe video audio object script pre code",g),l=t("move_caret_before_on_enter_elements","table",k),m=t("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),j=t("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",m),n=t("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),Li((a.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(a){s[a]=new RegExp("</"+a+"[^>]*>","gi")});var u=function(a){return new RegExp("^"+a.replace(/([?+*])/g,".$1")+"$")},v=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,p,r,s,t,v,w,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,y=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,z=/[*?+]/;if(a)for(a=Pi(a,","),o["@"]&&(s=o["@"].attributes,t=o["@"].attributesOrder),b=0,c=a.length;b<c;b++)if(f=x.exec(a[b])){if(p=f[1],j=f[2],r=f[3],i=f[5],m={},n=[],g={attributes:m,attributesOrder:n},"#"===p&&(g.paddEmpty=!0),"-"===p&&(g.removeEmpty=!0),"!"===f[4]&&(g.removeEmptyAttrs=!0),s){for(v in s)m[v]=s[v];n.push.apply(n,t)}if(i)for(i=Pi(i,"|"),d=0,e=i.length;d<e;d++)if(f=y.exec(i[d])){if(h={},l=f[1],k=f[2].replace(/[\\:]:/g,":"),p=f[3],w=f[4],"!"===l&&(g.attributesRequired=g.attributesRequired||[],g.attributesRequired.push(k),h.required=!0),"-"===l){delete m[k],n.splice(Oi(n,k),1);continue}p&&("="===p&&(g.attributesDefault=g.attributesDefault||[],g.attributesDefault.push({name:k,value:w}),h.defaultValue=w),":"===p&&(g.attributesForced=g.attributesForced||[],g.attributesForced.push({name:k,value:w}),h.forcedValue=w),"<"===p&&(h.validValues=Ki(w,"?"))),z.test(k)?(g.attributePatterns=g.attributePatterns||[],h.pattern=u(k),g.attributePatterns.push(h)):(m[k]||n.push(k),m[k]=h)}s||"@"!==j||(s=m,t=n),r&&(g.outputName=j,o[r]=g),z.test(j)?(g.pattern=u(j),q.push(g)):o[j]=g}},w=function(a){o={},q=[],v(a),Li(d,function(a,b){p[b]=a.children})},x=function(a){var b=/^(~)?(.+)$/;a&&(Ii.text_block_elements=Ii.block_elements=null,Li(Pi(a,","),function(a){var c=b.exec(a),d="~"===c[1],e=d?"span":"div",f=c[2];if(p[f]=p[e],r[f]=e,d||(j[f.toUpperCase()]={},j[f]={}),!o[f]){var g=o[e];g=Mi({},g),delete g.removeEmptyAttrs,delete g.removeEmpty,o[f]=g}Li(p,function(a,b){a[e]&&(p[b]=a=Mi({},p[b]),a[f]=a[e])})}))},y=function(b){var c=/^([+\-]?)(\w+)\[([^\]]+)\]$/;Ii[a.schema]=null,b&&Li(Pi(b,","),function(a){var b,d,e=c.exec(a);e&&(d=e[1],b=d?p[e[2]]:p[e[2]]={"#comment":{}},b=p[e[2]],Li(Pi(e[3],"|"),function(a){"-"===d?delete b[a]:b[a]={}}))})},z=function(a){var b,c=o[a];if(c)return c;for(b=q.length;b--;)if(c=q[b],c.pattern.test(a))return c};a.valid_elements?w(a.valid_elements):(Li(d,function(a,b){o[b]={attributes:a.attributes,attributesOrder:a.attributesOrder},p[b]=a.children}),"html5"!==a.schema&&Li(Pi("strong/b em/i"),function(a){a=Pi(a,"/"),o[a[1]].outputName=a[0]}),Li(Pi("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(a){o[a]&&(o[a].removeEmpty=!0)}),Li(Pi("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(a){o[a].paddEmpty=!0}),Li(Pi("span"),function(a){o[a].removeEmptyAttrs=!0})),x(a.custom_elements),y(a.valid_children),v(a.extended_valid_elements),y("+ol[ul|ol],+ul[ul|ol]"),Li({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(a,b){o[b]&&(o[b].parentsRequired=Pi(a))}),a.invalid_elements&&Li(Ni(a.invalid_elements),function(a){o[a]&&delete o[a]}),z("span")||v("span[!data-mce-type|*]");var A=function(){return b},B=function(){return c},C=function(){return i},D=function(){return h},E=function(){return j},F=function(){return m},G=function(){return n};return{children:p,elements:o,getValidStyles:A,getValidClasses:C,getBlockElements:E,getInvalidStyles:B,getShortEndedElements:function(){return g},getTextBlockElements:F,getTextInlineElements:G,getBoolAttrs:D,getElementRule:z,getSelfClosingElements:function(){return f},getNonEmptyElements:function(){return k},getMoveCaretBeforeOnEnterElements:function(){return l},getWhiteSpaceElements:function(){return e},getSpecialElements:function(){return s},isValidChild:function(a,b){var c=p[a.toLowerCase()];return!(!c||!c[b.toLowerCase()])},isValid:function(a,b){var c,d,e=z(a);if(e){if(!b)return!0;if(e.attributes[b])return!0;if(c=e.attributePatterns)for(d=c.length;d--;)if(c[d].pattern.test(a))return!0}return!1},getCustomElements:function(){return r},addValidElements:v,setValidElements:w,addCustomElements:x,addValidChildren:y}}function u(a,b){var c,d,e,f,g=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,h=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,i=/\s*([^:]+):\s*([^;]+);?/g,j=/\s+$/,k={};for(a=a||{},b&&(e=b.getValidStyles(),f=b.getInvalidStyles()),d="\\\" \\' \\; \\: ; : \ufeff".split(" "),c=0;c<d.length;c++)k[d[c]]="\ufeff"+c,k["\ufeff"+c]=d[c];return{toHex:function(a){return a.replace(g,Si)},parse:function(b){var d,e,f,l,m={},n=a.url_converter,o=a.url_converter_scope||this,p=function(a,b,d){var e,f,g,h;if((e=m[a+"-top"+b])&&(f=m[a+"-right"+b])&&(g=m[a+"-bottom"+b])&&(h=m[a+"-left"+b])){var i=[e,f,g,h];for(c=i.length-1;c--&&i[c]===i[c+1];);c>-1&&d||(m[a+b]=-1===c?i[0]:i.join(" "),delete m[a+"-top"+b],delete m[a+"-right"+b],delete m[a+"-bottom"+b],delete m[a+"-left"+b])}},q=function(a){var b,c=m[a];if(c){for(c=c.split(" "),b=c.length;b--;)if(c[b]!==c[0])return!1;return m[a]=c[0],!0}},r=function(a){return l=!0,k[a]},s=function(a,b){return l&&(a=a.replace(/\uFEFF[0-9]/g,function(a){return k[a]})),b||(a=a.replace(/\\([\'\";:])/g,"$1")),a},t=function(a){return String.fromCharCode(parseInt(a.slice(1),16))},u=function(a){return a.replace(/\\[0-9a-f]+/gi,t)},v=function(b,c,d,e,f,g){if(f=f||g)return f=s(f),"'"+f.replace(/\'/g,"\\'")+"'";if(c=s(c||d||e),!a.allow_script_urls){var h=c.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(h))return"";if(!a.allow_svg_data_urls&&/^data:image\/svg/i.test(h))return""}return n&&(c=n.call(o,c,"style")),"url('"+c.replace(/\'/g,"\\'")+"')"};if(b){for(b=b.replace(/[\u0000-\u001F]/g,""),b=b.replace(/\\[\"\';:\uFEFF]/g,r).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(a){return a.replace(/[;:]/g,r)});d=i.exec(b);)if(i.lastIndex=d.index+d[0].length,e=d[1].replace(j,"").toLowerCase(),f=d[2].replace(j,""),e&&f){if(e=u(e),f=u(f),-1!==e.indexOf("\ufeff")||-1!==e.indexOf('"'))continue;if(!a.allow_script_urls&&("behavior"===e||/expression\s*\(|\/\*|\*\//.test(f)))continue;"font-weight"===e&&"700"===f?f="bold":"color"!==e&&"background-color"!==e||(f=f.toLowerCase()),f=f.replace(g,Si),f=f.replace(h,v),m[e]=l?s(f,!0):f}p("border","",!0),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),function(a,b,c,d){q(b)&&q(c)&&q(d)&&(m[a]=m[b]+" "+m[c]+" "+m[d],delete m[b],delete m[c],delete m[d])}("border","border-width","border-style","border-color"),"medium none"===m.border&&delete m.border,"none"===m["border-image"]&&delete m["border-image"]}return m},serialize:function(a,b){var c,d,g="",h=function(b){var c,d,f,h;if(c=e[b])for(d=0,f=c.length;d<f;d++)b=c[d],(h=a[b])&&(g+=(g.length>0?" ":"")+b+": "+h+";")};if(b&&e)h("*"),h(b);else for(c in a)!(d=a[c])||f&&!function(a,b){var c;return(!(c=f["*"])||!c[a])&&(!(c=f[b])||!c[a])}(c,b)||(g+=(g.length>0?" ":"")+c+": "+d+";");return g}}}function v(a,b){var c=this;void 0===b&&(b={});var d,e={},f=window,g={},h=0,i=r(a),j=[],k=b.schema?b.schema:t({}),l=u({url_converter:b.url_converter,url_converter_scope:b.url_converter_scope},b.schema),m=b.ownEvents?new _b(b.proxy):_b.Event,n=k.getBlockElements(),o=Td.overrideDefaults(function(){return{context:a,element:Da.getRoot()}}),p=function(a){if("string"==typeof a)return!!n[a];if(a){var b=a.nodeType;if(b)return!(1!==b||!n[a.nodeName])}return!1},q=function(b){if(b&&a&&"string"==typeof b){var c=a.getElementById(b);return c&&c.id!==b?a.getElementsByName(b)[1]:c}return b},w=function(a){return"string"==typeof a&&(a=q(a)),o(a)},x=function(a,b,c){var e,f,g=w(a);return g.length&&(e=d[b],f=e&&e.get?e.get(g,b):g.attr(b)),void 0===f&&(f=c||""),f},y=function(a){var b=q(a);return b?b.attributes:[]},z=function(a,c,e){var f,g;""===e&&(e=null);var h=w(a);f=h.attr(c),h.length&&(g=d[c],g&&g.set?g.set(h,e,c):h.attr(c,e),f!==e&&b.onSetAttrib&&b.onSetAttrib({attrElm:h,attrName:c,attrValue:e}))},A=function(b,c){if(!Vi||1!==b.nodeType||c)return b.cloneNode(c);if(!c){var d=a.createElement(b.nodeName);return Ti(y(b),function(a){z(d,a.nodeName,x(b,a.nodeName))}),d}return null},B=function(){return b.root_element||a.body},C=function(a){var b=a||f,c=b.document,d=c.documentElement
;return{x:b.pageXOffset||d.scrollLeft,y:b.pageYOffset||d.scrollTop,w:b.innerWidth||d.clientWidth,h:b.innerHeight||d.clientHeight}},D=function(b,c){return mh.getPos(a.body,q(b),c)},E=function(a,c,d){var e=w(a).css(c,d);b.update_styles&&Zi(l,e)},F=function(a,c){var d=w(a).css(c);b.update_styles&&Zi(l,d)},G=function(a,b,c){var d=w(a);return c?d.css(b):(b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"float"===b&&(b=Ib.ie&&Ib.ie<12?"styleFloat":"cssFloat"),d[0]&&d[0].style?d[0].style[b]:void 0)},H=function(a){var b,c;return a=q(a),b=G(a,"width"),c=G(a,"height"),-1===b.indexOf("px")&&(b=0),-1===c.indexOf("px")&&(c=0),{w:parseInt(b,10)||a.offsetWidth||a.clientWidth,h:parseInt(c,10)||a.offsetHeight||a.clientHeight}},I=function(a){var b,c;return a=q(a),b=D(a),c=H(a),{x:b.x,y:b.y,w:c.w,h:c.h}},J=function(a,b){var c;if(!a)return!1;if(!Array.isArray(a)){if("*"===b)return 1===a.nodeType;if(Wi.test(b)){var d=b.toLowerCase().split(/,/),e=a.nodeName.toLowerCase();for(c=d.length-1;c>=0;c--)if(d[c]===e)return!0;return!1}if(a.nodeType&&1!==a.nodeType)return!1}var f=Array.isArray(a)?a:[a];return bd(b,f[0].ownerDocument||f[0],null,f).length>0},K=function(a,b,c,d){var e,f=[],g=q(a);for(d=void 0===d,c=c||("BODY"!==B().nodeName?B().parentNode:null),zd.is(b,"string")&&(e=b,b="*"===b?function(a){return 1===a.nodeType}:function(a){return J(a,e)});g&&g!==c&&g.nodeType&&9!==g.nodeType;){if(!b||"function"==typeof b&&b(g)){if(!d)return[g];f.push(g)}g=g.parentNode}return d?f:null},L=function(a,b,c){var d=K(a,b,c,!1);return d&&d.length>0?d[0]:null},M=function(a,b,c){var d=b;if(a)for("string"==typeof b&&(d=function(a){return J(a,b)}),a=a[c];a;a=a[c])if("function"==typeof d&&d(a))return a;return null},N=function(a,b){return M(a,b,"nextSibling")},O=function(a,b){return M(a,b,"previousSibling")},P=function(c,d){return bd(c,q(d)||b.root_element||a,[])},Q=function(a,b,d){var e,f="string"==typeof a?q(a):a;if(!f)return!1;if(zd.isArray(f)&&(f.length||0===f.length))return e=[],Ti(f,function(a,c){a&&("string"==typeof a&&(a=q(a)),e.push(b.call(d,a,c)))}),e;var g=d||c;return b.call(g,f)},R=function(a,b){w(a).each(function(a,c){Ti(b,function(a,b){z(c,b,a)})})},S=function(a,b){var c=w(a);Vi?c.each(function(a,c){if(!1!==c.canHaveHTML){for(;c.firstChild;)c.removeChild(c.firstChild);try{c.innerHTML="<br>"+b,c.removeChild(c.firstChild)}catch(a){Td("<div></div>").html("<br>"+b).contents().slice(1).appendTo(c)}return b}}):c.html(b)},T=function(b,c,d,e,f){return Q(b,function(b){var g="string"==typeof c?a.createElement(c):c;return R(g,d),e&&("string"!=typeof e&&e.nodeType?g.appendChild(e):"string"==typeof e&&S(g,e)),f?g:b.appendChild(g)})},U=function(b,c,d){return T(a.createElement(b),b,c,d,!0)},V=Hi.decode,W=Hi.encodeAllRaw,X=function(a,b,c){var d,e="";e+="<"+a;for(d in b)b.hasOwnProperty(d)&&null!==b[d]&&void 0!==b[d]&&(e+=" "+d+'="'+W(b[d])+'"');return void 0!==c?e+">"+c+"</"+a+">":e+" />"},Y=function(b){var c,d=a.createElement("div"),e=a.createDocumentFragment();for(b&&(d.innerHTML=b);c=d.firstChild;)e.appendChild(c);return e},Z=function(a,b){var c=w(a);return b?c.each(function(){for(var a;a=this.firstChild;)3===a.nodeType&&0===a.data.length?this.removeChild(a):this.parentNode.insertBefore(a,this)}).remove():c.remove(),c.length>1?c.toArray():c[0]},$=function(a){return Q(a,function(a){var b,c=a.attributes;for(b=c.length-1;b>=0;b--)a.removeAttributeNode(c.item(b))})},_=function(a){return l.parse(a)},aa=function(a,b){return l.serialize(a,b)},ba=function(b){var c,d;if(Da!==v.DOM&&a===document){if(e[b])return;e[b]=!0}d=a.getElementById("mceDefaultStyles"),d||(d=a.createElement("style"),d.id="mceDefaultStyles",d.type="text/css",c=a.getElementsByTagName("head")[0],c.firstChild?c.insertBefore(d,c.firstChild):c.appendChild(d)),d.styleSheet?d.styleSheet.cssText+=b:d.appendChild(a.createTextNode(b))},ca=function(b){var c;if(Da!==v.DOM&&a===document)return void v.DOM.loadCSS(b);b||(b=""),c=a.getElementsByTagName("head")[0],Ti(b.split(","),function(a){var b;a=zd._addCacheSuffix(a),g[a]||(g[a]=!0,b=U("link",{rel:"stylesheet",href:a}),c.appendChild(b))})},da=function(a,b,c){w(a).toggleClass(b,c).each(function(){""===this.className&&Td(this).attr("class",null)})},ea=function(a,b){w(a).addClass(b)},fa=function(a,b){da(a,b,!1)},ga=function(a,b){return w(a).hasClass(b)},ha=function(a){w(a).show()},ia=function(a){w(a).hide()},ja=function(a){return"none"===w(a).css("display")},ka=function(a){return(a||"mce_")+h++},la=function(a){var b="string"==typeof a?q(a):a;return oi.isElement(b)?b.outerHTML:Td("<div></div>").append(Td(b).clone()).html()},ma=function(a,b){w(a).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=b)}catch(a){}Z(Td(this).html(b),!0)})},na=function(a,b){var c=q(b);return Q(a,function(a){var b,d;return b=c.parentNode,d=c.nextSibling,d?b.insertBefore(a,d):b.appendChild(a),a})},oa=function(a,b,c){return Q(b,function(b){return zd.is(b,"array")&&(a=a.cloneNode(!0)),c&&Ti(Ui(b.childNodes),function(b){a.appendChild(b)}),b.parentNode.replaceChild(a,b)})},pa=function(a,b){var c;return a.nodeName!==b.toUpperCase()&&(c=U(b),Ti(y(a),function(b){z(c,b.nodeName,x(a,b.nodeName))}),oa(c,a,!0)),c||a},qa=function(a,b){for(var c,d=a;d;){for(c=b;c&&d!==c;)c=c.parentNode;if(d===c)break;d=d.parentNode}return!d&&a.ownerDocument?a.ownerDocument.documentElement:d},ra=function(a){return l.toHex(zd.trim(a))},sa=function(a,b){var c,d,e,f,g,h,i=0;if(a=a.firstChild){g=new s(a,a.parentNode),b=b||(k?k.getNonEmptyElements():null),f=k?k.getWhiteSpaceElements():{};do{if(e=a.nodeType,oi.isElement(a)){var j=a.getAttribute("data-mce-bogus");if(j){a=g.next("all"===j);continue}if(h=a.nodeName.toLowerCase(),b&&b[h]){if("br"===h){i++,a=g.next();continue}return!1}for(d=y(a),c=d.length;c--;)if("name"===(h=d[c].nodeName)||"data-mce-bookmark"===h)return!1}if(8===e)return!1;if(3===e&&!Xi.test(a.nodeValue))return!1;if(3===e&&a.parentNode&&f[a.parentNode.nodeName]&&Xi.test(a.nodeValue))return!1;a=g.next()}while(a)}return i<=1},ta=function(){return a.createRange()},ua=function(a,b,c){var d,e,f,g=ta();if(a&&b)return g.setStart(a.parentNode,$i(a)),g.setEnd(b.parentNode,$i(b)),d=g.extractContents(),g=ta(),g.setStart(b.parentNode,$i(b)+1),g.setEnd(a.parentNode,$i(a)+1),e=g.extractContents(),f=a.parentNode,f.insertBefore(si.trimNode(Da,d),a),c?f.insertBefore(c,a):f.insertBefore(b,a),f.insertBefore(si.trimNode(Da,e),a),Z(a),c||b},va=function(c,d,e,g){if(zd.isArray(c)){for(var h=c.length;h--;)c[h]=va(c[h],d,e,g);return c}return!b.collect||c!==a&&c!==f||j.push([c,d,e,g]),m.bind(c,d,e,g||Da)},wa=function(b,c,d){var e;if(zd.isArray(b)){for(e=b.length;e--;)b[e]=wa(b[e],c,d);return b}if(j&&(b===a||b===f))for(e=j.length;e--;){var g=j[e];b!==g[0]||c&&c!==g[1]||d&&d!==g[2]||m.unbind(g[0],g[1],g[2])}return m.unbind(b,c,d)},xa=function(a,b,c){return m.fire(a,b,c)},ya=function(a){if(a&&oi.isElement(a)){var b=a.getAttribute("data-mce-contenteditable");return b&&"inherit"!==b?b:"inherit"!==a.contentEditable?a.contentEditable:null}return null},za=function(a){for(var b=B(),c=null;a&&a!==b&&null===(c=ya(a));a=a.parentNode);return c},Aa=function(){if(j)for(var a=j.length;a--;){var b=j[a];m.unbind(b[0],b[1],b[2])}bd.setDocument&&bd.setDocument()},Ba=function(a,b){for(;a;){if(b===a)return!0;a=a.parentNode}return!1},Ca=function(a){return"startContainer: "+a.startContainer.nodeName+", startOffset: "+a.startOffset+", endContainer: "+a.endContainer.nodeName+", endOffset: "+a.endOffset},Da={doc:a,settings:b,win:f,files:g,stdMode:!0,boxModel:!0,styleSheetLoader:i,boundEvents:j,styles:l,schema:k,events:m,isBlock:p,$:o,$$:w,root:null,clone:A,getRoot:B,getViewPort:C,getRect:I,getSize:H,getParent:L,getParents:K,get:q,getNext:N,getPrev:O,select:P,is:J,add:T,create:U,createHTML:X,createFragment:Y,remove:Z,setStyle:E,getStyle:G,setStyles:F,removeAllAttribs:$,setAttrib:z,setAttribs:R,getAttrib:x,getPos:D,parseStyle:_,serializeStyle:aa,addStyle:ba,loadCSS:ca,addClass:ea,removeClass:fa,hasClass:ga,toggleClass:da,show:ha,hide:ia,isHidden:ja,uniqueId:ka,setHTML:S,getOuterHTML:la,setOuterHTML:ma,decode:V,encode:W,insertAfter:na,replace:oa,rename:pa,findCommonAncestor:qa,toHex:ra,run:Q,getAttribs:y,isEmpty:sa,createRng:ta,nodeIndex:$i,split:ua,bind:va,unbind:wa,fire:xa,getContentEditable:ya,getContentEditableParent:za,destroy:Aa,isChildOf:Ba,dumpRng:Ca};return d=Yi(l,b,function(){return Da}),Da}function w(){var a=this,b=[],c={},d={},e=[],f=function(a){if(d[a])return d[a].instance},g=function(a){var b;return d[a]&&(b=d[a].dependencies),b||[]},h=function(a,b){var d=w.language;if(d&&!1!==w.languageLoad){if(b)if(b=","+b+",",-1!==b.indexOf(","+d.substr(0,2)+","))d=d.substr(0,2);else if(-1===b.indexOf(","+d+","))return;ej.ScriptLoader.add(c[a]+"/langs/"+d+".js")}},i=function(a,c,f){b.push(c),d[a]={instance:c,dependencies:f};var g=ob.partition(e,function(b){return b.name===a});return e=g.fail,fj(g.pass,function(a){a.callback()}),c},j=function(a){delete c[a],delete d[a]},k=function(a,b){return"object"==typeof b?b:"string"==typeof a?{prefix:"",resource:b,suffix:""}:{prefix:a.prefix,resource:b,suffix:a.suffix}},l=function(b,c){var d=a.urls[b];fj(c,function(a){ej.ScriptLoader.add(d+"/"+a)})},m=function(a,b,c){var d=g(name);fj(d,function(b){var c=k(a,b);n(c.resource,c,void 0,void 0)}),b&&(c?b.call(c):b.call(ej))},n=function(a,b,e,f,g){if(!c[a]){var h="string"==typeof b?b:b.prefix+b.resource+b.suffix;0!==h.indexOf("/")&&-1===h.indexOf("://")&&(h=w.baseURL+"/"+h),c[a]=h.substring(0,h.lastIndexOf("/")),d[a]?m(b,e,f):ej.ScriptLoader.add(h,function(){return m(b,e,f)},f,g)}};return{items:b,urls:c,lookup:d,_listeners:e,get:f,dependencies:g,requireLangPack:h,add:i,remove:j,createUrl:k,addComponents:l,load:n,waitFor:function(a,b){d.hasOwnProperty(a)?b():e.push({name:a,callback:b})}}}function x(a,b,c){var d=function(){return uk(a),0===b},e=function(){return uk(a)?b>=a.data.length:b>=a.childNodes.length},f=function(){var c;return c=yk(a.ownerDocument),c.setStart(a,b),c.setEnd(a,b),c},g=function(){return c||(c=Hk(x(a,b))),c},h=function(){return g().length>0},i=function(c){return c&&a===c.container()&&b===c.offset()},j=function(c){return xk(a,c?b-1:b)};return{container:jk.constant(a),offset:jk.constant(b),toRange:f,getClientRects:g,isVisible:h,isAtStart:d,isAtEnd:e,isEqual:i,getNode:j}}function y(a){var b,c,d,e,f,g=[];return a=a||{},b=a.indent,c=Jp(a.indent_before||""),d=Jp(a.indent_after||""),e=Hi.getEncodeFunc(a.entity_encoding||"raw",a.entities),f="html"===a.element_format,{start:function(a,h,i){var j,k,l,m;if(b&&c[a]&&g.length>0&&(m=g[g.length-1],m.length>0&&"\n"!==m&&g.push("\n")),g.push("<",a),h)for(j=0,k=h.length;j<k;j++)l=h[j],g.push(" ",l.name,'="',e(l.value,!0),'"');g[g.length]=!i||f?">":" />",i&&b&&d[a]&&g.length>0&&(m=g[g.length-1],m.length>0&&"\n"!==m&&g.push("\n"))},end:function(a){var c;g.push("</",a,">"),b&&d[a]&&g.length>0&&(c=g[g.length-1],c.length>0&&"\n"!==c&&g.push("\n"))},text:function(a,b){a.length>0&&(g[g.length]=b?a:e(a))},cdata:function(a){g.push("<![CDATA[",a,"]]>")},comment:function(a){g.push("\x3c!--",a,"--\x3e")},pi:function(a,c){c?g.push("<?",a," ",e(c),"?>"):g.push("<?",a,"?>"),b&&g.push("\n")},doctype:function(a){g.push("<!DOCTYPE",a,">",b?"\n":"")},reset:function(){g.length=0},getContent:function(){return g.join("").replace(/\n$/,"")}}}function z(a,b){void 0===b&&(b=t());var c=y(a);return a=a||{},a.validate=!("validate"in a)||a.validate,{serialize:function(d){var e,f;f=a.validate,e={3:function(a){c.text(a.value,a.raw)},8:function(a){c.comment(a.value)},7:function(a){c.pi(a.name,a.value)},10:function(a){c.doctype(a.value)},4:function(a){c.cdata(a.value)},11:function(a){if(a=a.firstChild)do{g(a)}while(a=a.next)}},c.reset();var g=function(a){var d,h,i,j,k,l,m,n,o,p=e[a.type];if(p)p(a);else{if(d=a.name,h=a.shortEnded,i=a.attributes,f&&i&&i.length>1&&(l=[],l.map={},o=b.getElementRule(a.name))){for(m=0,n=o.attributesOrder.length;m<n;m++)(j=o.attributesOrder[m])in i.map&&(k=i.map[j],l.map[j]=k,l.push({name:j,value:k}));for(m=0,n=i.length;m<n;m++)(j=i[m].name)in l.map||(k=i.map[j],l.map[j]=k,l.push({name:j,value:k}));i=l}if(c.start(a.name,i,h),!h){if(a=a.firstChild)do{g(a)}while(a=a.next);c.end(d)}}};return 1!==d.type||a.inner?e[11](d):g(d),c.getContent()}}}function A(a,b,c,d,e){return a(c,d)?Ha.some(c):Ka.isFunction(e)&&e(c)?Ha.none():b(c,d,e)}function B(a){var b,c,d,e,f={state:{},exec:{},value:{}},g=a.settings;a.on("PreInit",function(){b=a.dom,c=a.selection,g=a.settings,d=a.formatter});var h=function(b,c,d,e){var g,h,i=!1;if(!a.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(b)||e&&e.skip_focus?aw.restore(a):a.focus(),e=a.fire("BeforeExecCommand",{command:b,ui:c,value:d}),e.isDefaultPrevented())return!1;if(h=b.toLowerCase(),g=f.exec[h])return g(h,c,d),a.fire("ExecCommand",{command:b,ui:c,value:d}),!0;if(dw(a.plugins,function(e){if(e.execCommand&&e.execCommand(b,c,d))return a.fire("ExecCommand",{command:b,ui:c,value:d}),i=!0,!1}),i)return i;if(a.theme&&a.theme.execCommand&&a.theme.execCommand(b,c,d))return a.fire("ExecCommand",{command:b,ui:c,value:d}),!0;try{i=a.getDoc().execCommand(b,c,d)}catch(a){}return!!i&&(a.fire("ExecCommand",{command:b,ui:c,value:d}),!0)}},i=function(b){var c;if(!a.quirks.isHidden()&&!a.removed){if(b=b.toLowerCase(),c=f.state[b])return c(b);try{return a.getDoc().queryCommandState(b)}catch(a){}return!1}},j=function(b){var c;if(!a.quirks.isHidden()&&!a.removed){if(b=b.toLowerCase(),c=f.value[b])return c(b);try{return a.getDoc().queryCommandValue(b)}catch(a){}}},k=function(a,b){b=b||"exec",dw(a,function(a,c){dw(c.toLowerCase().split(","),function(c){f[b][c]=a})})},l=function(b,c,d){b=b.toLowerCase(),f.exec[b]=function(b,e,f,g){return c.call(d||a,e,f,g)}},m=function(b){if(b=b.toLowerCase(),f.exec[b])return!0;try{return a.getDoc().queryCommandSupported(b)}catch(a){}return!1},n=function(b,c,d){b=b.toLowerCase(),f.state[b]=function(){return c.call(d||a)}},o=function(b,c,d){b=b.toLowerCase(),f.value[b]=function(){return c.call(d||a)}};ew(this,{execCommand:h,queryCommandState:i,queryCommandValue:j,queryCommandSupported:m,addCommands:k,addCommand:l,addQueryStateHandler:n,addQueryValueHandler:o,hasCustomCommand:function(a){return a=a.toLowerCase(),!!f.exec[a]}});var p=function(b,c,d){return void 0===c&&(c=!1),void 0===d&&(d=null),a.getDoc().execCommand(b,c,d)},q=function(a){return d.match(a)},r=function(b,c){d.toggle(b,c?{value:c}:void 0),a.nodeChanged()},s=function(a){e=c.getBookmark(a)},t=function(){c.moveToBookmark(e)};k({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){a.undoManager.add()},"Cut,Copy,Paste":function(b){var c,d=a.getDoc();try{p(b)}catch(a){c=!0}if("paste"!==b||d.queryCommandEnabled(b)||(c=!0),c||!d.queryCommandSupported(b)){var e=a.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");Ib.mac&&(e=e.replace(/Ctrl\+/g,"+")),a.notificationManager.open({text:e,type:"error"})}},unlink:function(){if(c.isCollapsed()){var b=a.dom.getParent(a.selection.getStart(),"a");return void(b&&a.dom.remove(b,!0))}d.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(a){var b=a.substring(7);"full"===b&&(b="justify"),dw("left,center,right,justify".split(","),function(a){b!==a&&d.remove("align"+a)}),"none"!==b&&r("align"+b)},"InsertUnorderedList,InsertOrderedList":function(a){var d,e;p(a),(d=b.getParent(c.getNode(),"ol,ul"))&&(e=d.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(e.nodeName)&&(s(),b.split(e,d),t()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){r(a)},"ForeColor,HiliteColor":function(a,b,c){r(a,c)},FontName:function(b,c,d){Yu(a,d)},FontSize:function(b,c,d){$u(a,d)},RemoveFormat:function(a){d.remove(a)},mceBlockQuote:function(){r("blockquote")},FormatBlock:function(a,b,c){return r(c||"p")},mceCleanup:function(){var b=c.getBookmark();a.setContent(a.getContent()),c.moveToBookmark(b)},mceRemoveNode:function(b,d,e){var f=e||c.getNode();f!==a.getBody()&&(s(),a.dom.remove(f,!0),t())},mceSelectNodeDepth:function(d,e,f){var g=0;b.getParent(c.getNode(),function(a){if(1===a.nodeType&&g++===f)return c.select(a),!1},a.getBody())},mceSelectNode:function(a,b,d){c.select(d)},mceInsertContent:function(b,c,d){Up.insertAtCaret(a,d)},mceInsertRawHTML:function(b,d,e){var f=a.getContent();c.setContent("tiny_mce_marker"),a.setContent(f.replace(/tiny_mce_marker/g,function(){return e}))},mceToggleFormat:function(a,b,c){r(c)},mceSetContent:function(b,c,d){a.setContent(d)},"Indent,Outdent":function(b){cw(a,b)},mceRepaint:function(){},InsertHorizontalRule:function(){a.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){a.hasVisual=!a.hasVisual,a.addVisual()},mceReplaceContent:function(b,d,e){a.execCommand("mceInsertContent",!1,e.replace(/\{\$selection\}/g,c.getContent({format:"text"})))},mceInsertLink:function(a,e,f){var g;"string"==typeof f&&(f={href:f}),g=b.getParent(c.getNode(),"a"),f.href=f.href.replace(" ","%20"),g&&f.href||d.remove("link"),f.href&&d.apply("link",f,g)},selectAll:function(){var a=b.getParent(c.getStart(),oi.isContentEditableTrue);if(a){var d=b.createRng();d.selectNodeContents(a),c.setRng(d)}},delete:function(){Mu.deleteCommand(a)},forwardDelete:function(){Mu.forwardDeleteCommand(a)},mceNewDocument:function(){a.setContent("")},InsertLineBreak:function(b,c,d){return Cv.insert(a,d),!0}});var u=function(a){return function(){var e=c.isCollapsed()?[b.getParent(c.getNode(),b.isBlock)]:c.getSelectedBlocks(),f=fw(e,function(b){return!!d.matchNode(b,a)});return-1!==gw(f,!0)}};k({JustifyLeft:u("alignleft"),JustifyCenter:u("aligncenter"),JustifyRight:u("alignright"),JustifyFull:u("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){return q(a)},mceBlockQuote:function(){return q("blockquote")},Outdent:function(){var a;if(g.inline_styles){if((a=b.getParent(c.getStart(),b.isBlock))&&parseInt(a.style.paddingLeft,10)>0)return!0;if((a=b.getParent(c.getEnd(),b.isBlock))&&parseInt(a.style.paddingLeft,10)>0)return!0}return i("InsertUnorderedList")||i("InsertOrderedList")||!g.inline_styles&&!!b.getParent(c.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(a){var d=b.getParent(c.getNode(),"ul,ol");return d&&("insertunorderedlist"===a&&"UL"===d.tagName||"insertorderedlist"===a&&"OL"===d.tagName)}},"state"),k({Undo:function(){a.undoManager.undo()},Redo:function(){a.undoManager.redo()}}),o("FontName",function(){return Zu(a)},this),o("FontSize",function(){return _u(a)},this)}function C(a,b,c){var d=c||!1,e=function(){b(),d=!0},f=function(){a(),d=!1};return{on:e,off:f,toggle:function(){(d?f:e)()},isOn:function(){return d}}}function D(a){var b=this,c={},d=[],e=function(a){var b,c,d={};Yw(Zw(a,"+"),function(a){a in _w?d[a]=!0:/^[0-9]{2,}$/.test(a)?d.keyCode=parseInt(a,10):(d.charCode=a.charCodeAt(0),d.keyCode=$w[a]||a.toUpperCase().charCodeAt(0))}),b=[d.keyCode];for(c in _w)d[c]?b.push(c):d[c]=!1;return d.id=b.join(","),d.access&&(d.alt=!0,Ib.mac?d.ctrl=!0:d.shift=!0),d.meta&&(Ib.mac?d.meta=!0:(d.ctrl=!0,d.meta=!1)),d},f=function(b,c,d,f){var g;return g=zd.map(Zw(b,">"),e),g[g.length-1]=zd.extend(g[g.length-1],{func:d,scope:f||a}),zd.extend(g[0],{desc:a.translate(c),subpatterns:g.slice(1)})},g=function(a){return a.altKey||a.ctrlKey||a.metaKey},h=function(a){return"keydown"===a.type&&a.keyCode>=112&&a.keyCode<=123},i=function(a,b){return!!b&&(b.ctrl===a.ctrlKey&&b.meta===a.metaKey&&(b.alt===a.altKey&&b.shift===a.shiftKey&&(!!(a.keyCode===b.keyCode||a.charCode&&a.charCode===b.charCode)&&(a.preventDefault(),!0))))},j=function(a){return a.func?a.func.call(a.scope):null};a.on("keyup keypress keydown",function(a){!g(a)&&!h(a)||a.isDefaultPrevented()||(Yw(c,function(b){if(i(a,b))return d=b.subpatterns.slice(0),"keydown"===a.type&&j(b),!0}),i(a,d[0])&&(1===d.length&&"keydown"===a.type&&j(d[0]),d.shift()))}),b.add=function(b,d,e,g){var h;return h=e,"string"==typeof e?e=function(){a.execCommand(h,!1,null)}:zd.isArray(h)&&(e=function(){a.execCommand(h[0],h[1],h[2])}),Yw(Zw(zd.trim(b.toLowerCase())),function(a){var b=f(a,d,e,g);c[b.id]=b}),!0},b.remove=function(a){var b=f(a);return!!c[b.id]&&(delete c[b.id],!0)}}function E(){var a=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:a,close:a,reposition:a,getArgs:a}}function F(a){var b=[],c=function(){var b=a.theme;return b&&b.getNotificationManagerImpl?b.getNotificationManagerImpl():E()},d=function(){return Ha.from(b[0])},e=function(a,b){return!(a.type!==b.type||a.text!==b.text||a.progressBar||a.timeout||b.progressBar||b.timeout)},f=function(){b.length>0&&c().reposition(b)},g=function(a){b.push(a)},h=function(a){ob.findIndex(b,function(b){return b===a}).each(function(a){b.splice(a,1)})},i=function(d){if(!a.removed&&Nx.isEditorAttachedToDom(a))return ob.find(b,function(a){return e(c().getArgs(a),d)}).getOrThunk(function(){a.editorManager.setActive(a);var b=c().open(d,function(){h(b),f()});return g(b),f(),b})},j=function(){d().each(function(a){c().close(a),h(a),f()})},k=function(){return b};return function(a){a.on("SkinLoaded",function(){var b=a.settings.service_message;b&&i({text:b,type:"warning",timeout:0,icon:""})}),a.on("ResizeEditor ResizeWindow",function(){Qb.requestAnimationFrame(f)}),a.on("remove",function(){ob.each(b,function(a){c().close(a)})})}(a),{open:i,close:j,getNotifications:k}}function G(){var a=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:a,alert:a,confirm:a,close:a,getParams:a,setParams:a}}function H(a){var b=[],c=function(){var b=a.theme;return b&&b.getWindowManagerImpl?b.getWindowManagerImpl():G()},d=function(a,b){return function(){return b?b.apply(a,arguments):void 0}},e=function(b){a.fire("OpenWindow",{win:b})},f=function(b){a.fire("CloseWindow",{win:b})},g=function(a){b.push(a),e(a)},h=function(c){ob.findIndex(b,function(a){return a===c}).each(function(d){b.splice(d,1),f(c),0===b.length&&a.focus()})},i=function(){return Ha.from(b[b.length-1])},j=function(b,d){a.editorManager.setActive(a),aw.store(a);var e=c().open(b,d,h);return g(e),e},k=function(a,b,e){var f=c().alert(a,d(e||this,b),h);g(f)},l=function(a,b,e){var f=c().confirm(a,d(e||this,b),h);g(f)},m=function(){i().each(function(a){c().close(a),h(a)})},n=function(){return i().map(c().getParams).getOr(null)},o=function(a){i().each(function(b){c().setParams(b,a)})},p=function(){return b};return a.on("remove",function(){ob.each(b.slice(0),function(a){c().close(a)})}),{windows:b,open:j,alert:k,confirm:l,close:m,getParams:n,setParams:o,getWindows:p}}function I(){return new(yb.getOrDie("XMLHttpRequest"))}function J(a,b){var c={},d=function(a,b){return a?a.replace(/\/$/,"")+"/"+b.replace(/^\//,""):b},e=function(a,c,e,f){var g,h;g=new I,g.open("POST",b.url),g.withCredentials=b.credentials,g.upload.onprogress=function(a){f(a.loaded/a.total*100)},g.onerror=function(){e("Image upload failed due to a XHR Transport error. Code: "+g.status)},g.onload=function(){var a;return g.status<200||g.status>=300?void e("HTTP Error: "+g.status):(a=JSON.parse(g.responseText))&&"string"==typeof a.location?void c(d(b.basePath,a.location)):void e("Invalid JSON: "+g.responseText)},h=new FormData,h.append("file",a.blob(),a.filename()),g.send(h)},f=function(){return new Jb(function(a){a([])})},g=function(a,b){return{url:b,blobInfo:a,status:!0}},h=function(a,b){return{url:"",blobInfo:a,status:!1,error:b}},i=function(a,b){zd.each(c[a],function(a){a(b)}),delete c[a]},j=function(b,c,d){return a.markPending(b.blobUri()),new Jb(function(e){var f,j,k=function(){};try{var l=function(){f&&(f.close(),j=k)},m=function(c){l(),a.markUploaded(b.blobUri(),c),i(b.blobUri(),g(b,c)),e(g(b,c))},n=function(c){l(),a.removeFailed(b.blobUri()),i(b.blobUri(),h(b,c)),e(h(b,c))};j=function(a){a<0||a>100||(f||(f=d()),f.progressBar.value(a))},c(b,m,n,j)}catch(a){e(h(b,a.message))}})},k=function(a){return a===e},l=function(a){var b=a.blobUri();return new Jb(function(a){c[b]=c[b]||[],c[b].push(a)})},m=function(c,d){return c=zd.grep(c,function(b){return!a.isUploaded(b.blobUri())}),Jb.all(zd.map(c,function(c){return a.isPending(c.blobUri())?l(c):j(c,b.handler,d)}))},n=function(a,c){return!b.url&&k(b.handler)?f():m(a,c)};return b=zd.extend({credentials:!1,handler:e},b),{upload:n}}function K(a,b){return new(yb.getOrDie("Blob"))(a,b)}function L(){return new(yb.getOrDie("FileReader"))}function M(a){return new(yb.getOrDie("Uint8Array"))(a)}function N(a,b){var c={};return{findAll:function(d,e){var f;e||(e=jk.constant(!0)),f=md.filter(jy(d),function(b){var c=b.src;return!!Ib.fileApi&&(!b.hasAttribute("data-mce-bogus")&&(!b.hasAttribute("data-mce-placeholder")&&(!(!c||c===Ib.transparentSrc)&&(0===c.indexOf("blob:")?!a.isUploaded(c):0===c.indexOf("data:")&&e(b)))))});var g=md.map(f,function(a){if(c[a.src])return new Jb(function(b){c[a.src].then(function(c){if("string"==typeof c)return c;b({image:a,blobInfo:c.blobInfo})})});var d=new Jb(function(c,d){iy(b,a,c,d)}).then(function(a){return delete c[a.image.src],a}).catch(function(b){return delete c[a.src],b});return c[a.src]=d,d});return Jb.all(g)}}}function O(){var a=[],b=jk.constant,c=function(a){return{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[a.toLowerCase()]||"dat"},d=function(a,b,c,d){return e("object"==typeof a?a:{id:a,name:d,blob:b,base64:c})},e=function(a){var d,e;if(!a.blob||!a.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");return d=a.id||ny.uuid("blobid"),e=a.name||d,{id:b(d),name:b(e),filename:b(e+"."+c(a.blob.type)),blob:b(a.blob),base64:b(a.base64),blobUri:b(a.blobUri||Cb.createObjectURL(a.blob)),uri:b(a.uri)}},f=function(b){g(b.id())||a.push(b)},g=function(a){return h(function(b){return b.id()===a})},h=function(b){return md.filter(a,b)[0]};return{create:d,add:f,get:g,getByUri:function(a){return h(function(b){return b.blobUri()===a})},findFirst:h,removeByUri:function(b){a=md.filter(a,function(a){return a.blobUri()!==b||(Cb.revokeObjectURL(a.blobUri()),!1)})},destroy:function(){md.each(a,function(a){Cb.revokeObjectURL(a.blobUri())}),a=[]}}}function P(){var a={},b=function(a,b){return{status:a,resultUri:b}},c=function(b){return b in a};return{hasBlobUri:c,getResultUri:function(b){var c=a[b];return c?c.resultUri:null},isPending:function(b){return!!c(b)&&1===a[b].status},isUploaded:function(b){return!!c(b)&&2===a[b].status},markPending:function(c){a[c]=b(1,null)},markUploaded:function(c,d){a[c]=b(2,d)},removeFailed:function(b){delete a[b]},destroy:function(){a={}}}}function Q(a){var b,c,d=O(),e=a.settings,f=P(),g=function(b){return function(c){return a.selection?b(c):[]}},h=function(){return"?"+(new Date).getTime()},i=function(a,b,c){var d=0;do{-1!==(d=a.indexOf(b,d))&&(a=a.substring(0,d)+c+a.substr(d+b.length),d+=c.length-b.length+1)}while(-1!==d);return a},j=function(a,b,c){return a=i(a,'src="'+b+'"','src="'+c+'"'),a=i(a,'data-mce-src="'+b+'"','data-mce-src="'+c+'"')},k=function(b,c){md.each(a.undoManager.data,function(a){"fragmented"===a.type?a.fragments=md.map(a.fragments,function(a){return j(a,b,c)}):a.content=j(a.content,b,c)})},l=function(){return a.notificationManager.open({text:a.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},m=function(b,c){d.removeByUri(b.src),k(b.src,c),a.$(b).attr({src:e.images_reuse_filename?c+h():c,"data-mce-src":a.convertURL(c,"src")})},n=function(c){return b||(b=J(f,{url:e.images_upload_url,basePath:e.images_upload_base_path,credentials:e.images_upload_credentials,handler:e.images_upload_handler})),q().then(g(function(d){var e;return e=md.map(d,function(a){return a.blobInfo}),b.upload(e,l).then(g(function(b){var e=md.map(b,function(b,c){var e=d[c].image;return b.status&&!1!==a.settings.images_replace_blob_uris?m(e,b.url):b.error&&Wx.uploadError(a,b.error),{element:e,status:b.status}});return c&&c(e),e}))}))},o=function(a){if(!1!==e.automatic_uploads)return n(a)},p=function(a){return!e.images_dataimg_filter||e.images_dataimg_filter(a)},q=function(){return c||(c=N(f,d)),c.findAll(a.getBody(),p).then(g(function(b){return b=md.filter(b,function(b){return"string"!=typeof b||(Wx.displayError(a,b),!1)}),md.each(b,function(a){k(a.image.src,a.blobInfo.blobUri()),a.image.src=a.blobInfo.blobUri(),a.image.removeAttribute("data-mce-src")}),b}))},r=function(){d.destroy(),f.destroy(),c=b=null},s=function(b){return b.replace(/src="(blob:[^"]+)"/g,function(b,c){var e=f.getResultUri(c);if(e)return'src="'+e+'"';var g=d.getByUri(c);return g||(g=md.reduce(a.editorManager.get(),function(a,b){return a||b.editorUpload&&b.editorUpload.blobCache.getByUri(c)},null)),g?'src="data:'+g.blob().type+";base64,"+g.base64()+'"':b})};return a.on("setContent",function(){!1!==a.settings.automatic_uploads?o():q()}),a.on("RawSaveContent",function(a){a.content=s(a.content)}),a.on("getContent",function(a){a.source_view||"raw"===a.format||(a.content=s(a.content))}),a.on("PostRender",function(){a.parser.addNodeFilter("img",function(a){md.each(a,function(a){var b=a.attr("src");if(!d.getByUri(b)){var c=f.getResultUri(b);c&&a.attr("src",c)}})})}),{blobCache:d,uploadImages:n,uploadImagesAuto:o,scanForImages:q,destroy:r}}function R(a){var b,c=[],d=function(b){var d,e;if(e=a.$(b).parentsUntil(a.getBody()).add(b),e.length===c.length){for(d=e.length;d>=0&&e[d]===c[d];d--);if(-1===d)return c=e,!0}return c=e,!1};"onselectionchange"in a.getDoc()||a.on("NodeChange Click MouseUp KeyUp Focus",function(c){var d,e;d=a.selection.getRng(),e={startContainer:d.startContainer,startOffset:d.startOffset,endContainer:d.endContainer,endOffset:d.endOffset},"nodechange"!==c.type&&bv.isEq(e,b)||a.fire("SelectionChange"),b=e}),a.on("contextmenu",function(){a.fire("SelectionChange")}),a.on("SelectionChange",function(){var b=a.selection.getStart(!0);!b||!Ib.range&&a.selection.isCollapsed()||By(a)&&!d(b)&&a.dom.isChildOf(b,a.getBody())&&a.nodeChanged({selectionChange:!0})}),a.on("MouseUp",function(b){!b.isDefaultPrevented()&&By(a)&&("IMG"===a.selection.getNode().nodeName?Qb.setEditorTimeout(a,function(){a.nodeChanged()}):a.nodeChanged())}),this.nodeChanged=function(b){var c,d,e,f=a.selection;a.initialized&&f&&!a.settings.disable_nodechange&&!a.readonly&&(e=a.getBody(),c=f.getStart(!0)||e,c.ownerDocument===a.getDoc()&&a.dom.isChildOf(c,e)||(c=e),d=[],a.dom.getParent(c,function(a){if(a===e)return!0;d.push(a)}),b=b||{},b.element=c,b.parents=d,a.fire("NodeChange",b))}}function S(a,b){void 0===b&&(b=t());var c=function(){};a=a||{},!1!==a.fix_self_closing&&(a.fix_self_closing=!0);var d=a.comment?a.comment:c,e=a.cdata?a.cdata:c,f=a.text?a.text:c,g=a.start?a.start:c,h=a.end?a.end:c,i=a.pi?a.pi:c,j=a.doctype?a.doctype:c;return{parse:function(c){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=0,P=[],Q=0,R=Hi.decode,S=zd.makeMap("src,href,data,background,formaction,poster,xlink:href"),T=/((java|vb)script|mhtml):/i,U=function(a){var b,c;for(b=P.length;b--&&P[b].name!==a;);if(b>=0){for(c=P.length-1;c>=b;c--)a=P[c],a.valid&&h(a.name);P.length=b}},V=function(b,c,d,e,f){var g,h,i=/[\s\u0000-\u001F]+/g;if(c=c.toLowerCase(),d=c in u?c:R(d||e||f||""),w&&!r&&!1===Pz(c)){if(!(g=B[c])&&C){for(h=C.length;h--&&(g=C[h],!g.pattern.test(c)););-1===h&&(g=null)}if(!g)return;if(g.validValues&&!(d in g.validValues))return}if(S[c]&&!a.allow_script_urls){var j=d.replace(i,"");try{j=decodeURIComponent(j)}catch(a){j=unescape(j)}if(T.test(j))return;if(Rz(a,j))return}r&&(c in S||0===c.indexOf("on"))||(n.map[c]=d,n.push({name:c,value:d}))};for(J=new RegExp("<(?:(?:!--([\\w\\W]*?)--\x3e)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),K=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,t=b.getShortEndedElements(),I=a.self_closing_elements||b.getSelfClosingElements(),u=b.getBoolAttrs(),w=a.validate,s=a.remove_internals,
N=a.fix_self_closing,L=b.getSpecialElements(),G=c+">";k=J.exec(G);){if(O<k.index&&f(R(c.substr(O,k.index-O))),l=k[6])l=l.toLowerCase(),":"===l.charAt(0)&&(l=l.substr(1)),U(l);else if(l=k[7]){if(k.index+k[0].length>c.length){f(R(c.substr(k.index))),O=k.index+k[0].length;continue}if(l=l.toLowerCase(),":"===l.charAt(0)&&(l=l.substr(1)),v=l in t,N&&I[l]&&P.length>0&&P[P.length-1].name===l&&U(l),!w||(x=b.getElementRule(l))){if(y=!0,w&&(B=x.attributes,C=x.attributePatterns),(A=k[8])?(r=-1!==A.indexOf("data-mce-type"),r&&s&&(y=!1),n=[],n.map={},A.replace(K,V)):(n=[],n.map={}),w&&!r){if(D=x.attributesRequired,E=x.attributesDefault,F=x.attributesForced,H=x.removeEmptyAttrs,H&&!n.length&&(y=!1),F)for(o=F.length;o--;)z=F[o],q=z.name,M=z.value,"{$uid}"===M&&(M="mce_"+Q++),n.map[q]=M,n.push({name:q,value:M});if(E)for(o=E.length;o--;)z=E[o],(q=z.name)in n.map||(M=z.value,"{$uid}"===M&&(M="mce_"+Q++),n.map[q]=M,n.push({name:q,value:M}));if(D){for(o=D.length;o--&&!(D[o]in n.map););-1===o&&(y=!1)}if(z=n.map["data-mce-bogus"]){if("all"===z){O=Sz(b,c,J.lastIndex),J.lastIndex=O;continue}y=!1}}y&&g(l,n,v)}else y=!1;if(m=L[l]){m.lastIndex=O=k.index+k[0].length,(k=m.exec(c))?(y&&(p=c.substr(O,k.index-O)),O=k.index+k[0].length):(p=c.substr(O),O=c.length),y&&(p.length>0&&f(p,!0),h(l)),J.lastIndex=O;continue}v||(A&&A.indexOf("/")===A.length-1?y&&h(l):P.push({name:l,valid:y}))}else(l=k[1])?(">"===l.charAt(0)&&(l=" "+l),a.allow_conditional_comments||"[if"!==l.substr(0,3).toLowerCase()||(l=" "+l),d(l)):(l=k[2])?e(Qz(l)):(l=k[3])?j(l):(l=k[4])&&i(l,k[5]);O=k.index+k[0].length}for(O<c.length&&f(R(c.substr(O))),o=P.length-1;o>=0;o--)l=P[o],l.valid&&h(l.name)}}}function T(a){var b,c,d=this,e=0,f=[],g=0,h=function(){return 0===g},i=function(a){h()&&(d.typing=a)},j=function(b){a.setDirty(b)},k=function(a){i(!1),d.add({},a)},l=function(){d.typing&&(i(!1),d.add())};a.on("init",function(){d.add()}),a.on("BeforeExecCommand",function(a){var b=a.command;"Undo"!==b&&"Redo"!==b&&"mceRepaint"!==b&&(l(),d.beforeChange())}),a.on("ExecCommand",function(a){var b=a.command;"Undo"!==b&&"Redo"!==b&&"mceRepaint"!==b&&k(a)}),a.on("ObjectResizeStart Cut",function(){d.beforeChange()}),a.on("SaveContent ObjectResized blur",k),a.on("DragEnd",k),a.on("KeyUp",function(b){var e=b.keyCode;b.isDefaultPrevented()||((e>=33&&e<=36||e>=37&&e<=40||45===e||b.ctrlKey)&&(k(),a.nodeChanged()),46!==e&&8!==e||a.nodeChanged(),c&&d.typing&&!1===BA.isEq(BA.createFromEditor(a),f[0])&&(!1===a.isDirty()&&(j(!0),a.fire("change",{level:f[0],lastLevel:null})),a.fire("TypingUndo"),c=!1,a.nodeChanged()))}),a.on("KeyDown",function(a){var b=a.keyCode;if(!a.isDefaultPrevented()){if(b>=33&&b<=36||b>=37&&b<=40||45===b)return void(d.typing&&k(a));var e=a.ctrlKey&&!a.altKey||a.metaKey;!(b<16||b>20)||224===b||91===b||d.typing||e||(d.beforeChange(),i(!0),d.add({},a),c=!0)}}),a.on("MouseDown",function(a){d.typing&&k(a)});var m=function(a){return"insertReplacementText"===a.inputType},n=function(a){return"insertText"===a.inputType&&null===a.data};return a.on("input",function(a){a.inputType&&(m(a)||n(a))&&k(a)}),a.addShortcut("meta+z","","Undo"),a.addShortcut("meta+y,meta+shift+z","","Redo"),a.on("AddUndo Undo Redo ClearUndos",function(b){b.isDefaultPrevented()||a.nodeChanged()}),d={data:f,typing:!1,beforeChange:function(){h()&&(b=No.getUndoBookmark(a.selection))},add:function(c,d){var g,i,k,l=a.settings;if(k=BA.createFromEditor(a),c=c||{},c=zd.extend(c,k),!1===h()||a.removed)return null;if(i=f[e],a.fire("BeforeAddUndo",{level:c,lastLevel:i,originalEvent:d}).isDefaultPrevented())return null;if(i&&BA.isEq(i,c))return null;if(f[e]&&(f[e].beforeBookmark=b),l.custom_undo_redo_levels&&f.length>l.custom_undo_redo_levels){for(g=0;g<f.length-1;g++)f[g]=f[g+1];f.length--,e=f.length}c.bookmark=No.getUndoBookmark(a.selection),e<f.length-1&&(f.length=e+1),f.push(c),e=f.length-1;var m={level:c,lastLevel:i,originalEvent:d};return a.fire("AddUndo",m),e>0&&(j(!0),a.fire("change",m)),c},undo:function(){var b;return d.typing&&(d.add(),d.typing=!1,i(!1)),e>0&&(b=f[--e],BA.applyToEditor(a,b,!0),j(!0),a.fire("undo",{level:b})),b},redo:function(){var b;return e<f.length-1&&(b=f[++e],BA.applyToEditor(a,b,!1),j(!0),a.fire("redo",{level:b})),b},clear:function(){f=[],e=0,d.typing=!1,d.data=f,a.fire("ClearUndos")},hasUndo:function(){return e>0||d.typing&&f[0]&&!BA.isEq(BA.createFromEditor(a),f[0])},hasRedo:function(){return e<f.length-1&&!d.typing},transact:function(a){return l(),d.beforeChange(),d.ignore(a),d.add()},ignore:function(a){try{g++,a()}finally{g--}},extra:function(b,c){var g,h;d.transact(b)&&(h=f[e].bookmark,g=f[e-1],BA.applyToEditor(a,g,!0),d.transact(c)&&(f[e-1].beforeBookmark=h))}}}function U(a){var b={},c=function(a){return a?b[a]:b},d=function(a,c){a&&("string"!=typeof a?zd.each(a,function(a,b){d(b,a)}):(c=c.length?c:[c],zd.each(c,function(a){void 0===a.deep&&(a.deep=!a.selector),void 0===a.split&&(a.split=!a.selector||a.inline),void 0===a.remove&&a.selector&&!a.inline&&(a.remove="none"),a.selector&&a.inline&&(a.mixed=!0,a.block_expand=!0),"string"==typeof a.classes&&(a.classes=a.classes.split(/\s+/))}),b[a]=c))},e=function(a){return a&&b[a]&&delete b[a],b};return d(EC.get(a.dom)),d(a.settings.formats),{get:c,register:d,unregister:e}}function V(a){var b=U(a),c=Tm(null);return QC.setup(a),EB(a),{get:b.get,register:b.register,unregister:b.unregister,apply:Aa.curry(xC.applyFormat,a),remove:Aa.curry(cC.remove,a),toggle:Aa.curry(OC.toggle,a,b),match:Aa.curry(lB.match,a),matchAll:Aa.curry(lB.matchAll,a),matchNode:Aa.curry(lB.matchNode,a),canApply:Aa.curry(lB.canApply,a),formatChanged:Aa.curry(CC.formatChanged,a,c),getCssText:Aa.curry(MC.getCssText,a)}}function W(a,b){void 0===b&&(b=t());var c={},d=[],e={},f={};a=a||{},a.validate=!("validate"in a)||a.validate,a.root_name=a.root_name||"body";var g=function(a){var c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s;for(o=tD("tr,td,th,tbody,thead,tfoot,table"),m=b.getNonEmptyElements(),n=b.getWhiteSpaceElements(),p=b.getTextBlockElements(),q=b.getSpecialElements(),c=0;c<a.length;c++)if(d=a[c],d.parent&&!d.fixed)if(p[d.name]&&"li"===d.parent.name){for(r=d.next;r&&p[r.name];)r.name="li",r.fixed=!0,d.parent.insert(r,d.parent),r=r.next;d.unwrap(d)}else{for(f=[d],e=d.parent;e&&!b.isValidChild(e.name,d.name)&&!o[e.name];e=e.parent)f.push(e);if(e&&f.length>1){for(f.reverse(),g=i=h(f[0].clone()),l=0;l<f.length-1;l++){for(b.isValidChild(i.name,f[l].name)?(j=h(f[l].clone()),i.append(j)):j=i,k=f[l].firstChild;k&&k!==f[l+1];)s=k.next,j.append(k),k=s;i=j}qD(b,m,n,g)?e.insert(d,f[0],!0):(e.insert(g,f[0],!0),e.insert(d,g)),e=f[0],(qD(b,m,n,e)||oD(e,"br"))&&e.empty().remove()}else if(d.parent){if("li"===d.name){if((r=d.prev)&&("ul"===r.name||"ul"===r.name)){r.append(d);continue}if((r=d.next)&&("ul"===r.name||"ul"===r.name)){r.insert(d,r.firstChild,!0);continue}d.wrap(h(new lD("ul",1)));continue}b.isValidChild(d.parent.name,"div")&&b.isValidChild("div",d.name)?d.wrap(h(new lD("div",1))):q[d.name]?d.empty().remove():d.unwrap()}}},h=function(a){var b,g,h;g in c&&(h=e[g],h?h.push(a):e[g]=[a]),b=d.length;for(;b--;)(g=d[b].name)in a.attributes.map&&(h=f[g],h?h.push(a):f[g]=[a]);return a},i=function(a,b){uD(vD(a),function(a){var d=c[a];d||(c[a]=d=[]),d.push(b)})},j=function(){var a=[];for(var b in c)c.hasOwnProperty(b)&&a.push({name:b,callbacks:c[b]});return a},k=function(a,b){uD(vD(a),function(a){var c;for(c=0;c<d.length;c++)if(d[c].name===a)return void d[c].callbacks.push(b);d.push({name:a,callbacks:[b]})})},l=function(){return[].concat(d)},m=function(h,i){var j,k,l,m,n,o,p,q,r,s,t,u=[];i=i||{},e={},f={},r=wD(tD("script,style,head,html,body,title,meta,param"),b.getBlockElements());var v=b.getNonEmptyElements(),w=b.children,x=a.validate,y="forced_root_block"in i?i.forced_root_block:a.forced_root_block,z=b.getWhiteSpaceElements(),A=/^[ \t\r\n]+/,B=/[ \t\r\n]+$/,C=/[ \t\r\n]+/g,D=/^[ \t\r\n]+$/;s=z.hasOwnProperty(i.context)||z.hasOwnProperty(a.root_name);var E=function(a,b){var d,f=new lD(a,b);return a in c&&(d=e[a],d?d.push(f):e[a]=[f]),f},F=function(a){var c,d,e,f,g=b.getBlockElements();for(c=a.prev;c&&3===c.type;){if(e=c.value.replace(B,""),e.length>0)return void(c.value=e);if(d=c.next){if(3===d.type&&d.value.length){c=c.prev;continue}if(!g[d.name]&&"script"!==d.name&&"style"!==d.name){c=c.prev;continue}}f=c.prev,c.remove(),c=f}};j=Tz({validate:x,allow_script_urls:a.allow_script_urls,allow_conditional_comments:a.allow_conditional_comments,self_closing_elements:function(a){var b,c={};for(b in a)"li"!==b&&"p"!==b&&(c[b]=a[b]);return c}(b.getSelfClosingElements()),cdata:function(a){t.append(E("#cdata",4)).value=a},text:function(a,b){var c;s||(a=a.replace(C," "),rD(t.lastChild,r)&&(a=a.replace(A,""))),0!==a.length&&(c=E("#text",3),c.raw=!!b,t.append(c).value=a)},comment:function(a){t.append(E("#comment",8)).value=a},pi:function(a,b){t.append(E(a,7)).value=b,F(t)},doctype:function(a){var b;b=t.append(E("#doctype",10)),b.value=a,F(t)},start:function(a,c,e){var g,h,i,j,k;if(i=x?b.getElementRule(a):{}){for(g=E(i.outputName||a,1),g.attributes=c,g.shortEnded=e,t.append(g),k=w[t.name],k&&w[g.name]&&!k[g.name]&&u.push(g),h=d.length;h--;)(j=d[h].name)in c.map&&(p=f[j],p?p.push(g):f[j]=[g]);r[a]&&F(g),e||(t=g),!s&&z[a]&&(s=!0)}},end:function(c){var d,e,f,g,h;if(e=x?b.getElementRule(c):{}){if(r[c]&&!s){if((d=t.firstChild)&&3===d.type)if(f=d.value.replace(A,""),f.length>0)d.value=f,d=d.next;else for(g=d.next,d.remove(),d=g;d&&3===d.type;)f=d.value,g=d.next,(0===f.length||D.test(f))&&(d.remove(),d=g),d=g;if((d=t.lastChild)&&3===d.type)if(f=d.value.replace(B,""),f.length>0)d.value=f,d=d.prev;else for(g=d.prev,d.remove(),d=g;d&&3===d.type;)f=d.value,g=d.prev,(0===f.length||D.test(f))&&(d.remove(),d=g),d=g}if(s&&z[c]&&(s=!1),e.removeEmpty&&qD(b,v,z,t)&&!t.attributes.map.name&&!t.attr("id"))return h=t.parent,r[t.name]?t.empty().remove():t.unwrap(),void(t=h);e.paddEmpty&&(nD(t)||qD(b,v,z,t))&&mD(a,i,r,t),t=t.parent}}},b);var G=t=new lD(i.context||a.root_name,11);if(j.parse(h),x&&u.length&&(i.context?i.invalid=!0:g(u)),y&&("body"===G.name||i.isRootContent)&&function(){var c,d,e=G.firstChild,f=function(a){a&&(e=a.firstChild,e&&3===e.type&&(e.value=e.value.replace(A,"")),(e=a.lastChild)&&3===e.type&&(e.value=e.value.replace(B,"")))};if(b.isValidChild(G.name,y.toLowerCase())){for(;e;)c=e.next,3===e.type||1===e.type&&"p"!==e.name&&!r[e.name]&&!e.attr("data-mce-type")?d?d.append(e):(d=E(y,1),d.attr(a.forced_root_block_attrs),G.insert(d,e),d.append(e)):(f(d),d=null),e=c;f(d)}}(),!i.invalid){for(q in e){for(p=c[q],k=e[q],n=k.length;n--;)k[n].parent||k.splice(n,1);for(l=0,m=p.length;l<m;l++)p[l](k,q,i)}for(l=0,m=d.length;l<m;l++)if(p=d[l],p.name in f){for(k=f[p.name],n=k.length;n--;)k[n].parent||k.splice(n,1);for(n=0,o=p.callbacks.length;n<o;n++)p.callbacks[n](k,p.name,i)}}return G},n={schema:b,addAttributeFilter:k,getAttributeFilters:l,addNodeFilter:i,getNodeFilters:j,filterNode:h,parse:m};return sD(n,a),hD.register(n,a),n}function X(a,b){var c,d,e,f=["data-mce-selected"];c=b&&b.dom?b.dom:_i.DOM,d=b&&b.schema?b.schema:t(a),a.entity_encoding=a.entity_encoding||"named",a.remove_trailing_brs=!("remove_trailing_brs"in a)||a.remove_trailing_brs,e=W(a,d),ZC.register(e,a,c);var g=function(f,g){var h=WC.merge({format:"html"},g||{}),i=bD.process(b,f,h),j=zD(c,i,h),k=AD(e,j,h);return"tree"===h.format?k:CD(b,a,d,k,h)};return{schema:d,addNodeFilter:e.addNodeFilter,addAttributeFilter:e.addAttributeFilter,serialize:g,addRules:function(a){d.addValidElements(a)},setRules:function(a){d.setValidElements(a)},addTempAttr:Aa.curry(xD,e,f),getTempAttrs:function(){return f}}}function Y(a,b){var c=X(a,b);return{schema:c.schema,addNodeFilter:c.addNodeFilter,addAttributeFilter:c.addAttributeFilter,serialize:c.serialize,addRules:c.addRules,setRules:c.setRules,addTempAttr:c.addTempAttr,getTempAttrs:c.getTempAttrs}}function Z(a){return{getBookmark:Aa.curry(lp.getBookmark,a),moveToBookmark:Aa.curry(lp.moveToBookmark,a)}}function $(a){var b=zd.each,c=Iz.BACKSPACE,d=Iz.DELETE,e=a.dom,f=a.selection,g=a.settings,h=a.parser,i=Ib.gecko,j=Ib.ie,k=Ib.webkit,l=j?"Text":"URL",m=function(b,c){try{a.getDoc().execCommand(b,!1,c)}catch(a){}},n=function(a){return a.isDefaultPrevented()},o=function(b){var c,d;b.dataTransfer&&(a.selection.isCollapsed()&&"IMG"===b.target.tagName&&f.select(b.target),c=a.selection.getContent(),c.length>0&&(d="data:text/mce-internal,"+escape(a.id)+","+escape(c),b.dataTransfer.setData(l,d)))},p=function(a){var b;return a.dataTransfer&&(b=a.dataTransfer.getData(l))&&b.indexOf("data:text/mce-internal,")>=0?(b=b.substr("data:text/mce-internal,".length).split(","),{id:unescape(b[0]),html:unescape(b[1])}):null},q=function(b,c){a.queryCommandSupported("mceInsertClipboardContent")?a.execCommand("mceInsertClipboardContent",!1,{content:b,internal:c}):a.execCommand("mceInsertContent",!1,b)},r=function(){a.shortcuts.add("meta+a",null,"SelectAll")},s=function(){a.on("keydown",function(a){if(!n(a)&&a.keyCode===c&&f.isCollapsed()&&0===f.getRng().startOffset){var b=f.getNode().previousSibling;if(b&&b.nodeName&&"table"===b.nodeName.toLowerCase())return a.preventDefault(),!1}})},t=function(){a.inline||(a.contentStyles.push("body {min-height: 150px}"),a.on("click",function(b){var c;if("HTML"===b.target.nodeName){if(Ib.ie>11)return void a.getBody().focus();c=a.selection.getRng(),a.getBody().focus(),a.selection.setRng(c),a.selection.normalize(),a.nodeChanged()}}))},u=function(){},v=function(){var b;return!i||a.removed?0:!(b=a.selection.getSel())||!b.rangeCount||0===b.rangeCount};return function(){a.on("keydown",function(b){var c,d,g,h,i;if(!n(b)&&b.keyCode===Iz.BACKSPACE&&(c=f.getRng(),d=c.startContainer,g=c.startOffset,h=e.getRoot(),i=d,c.collapsed&&0===g)){for(;i&&i.parentNode&&i.parentNode.firstChild===i&&i.parentNode!==h;)i=i.parentNode;"BLOCKQUOTE"===i.tagName&&(a.formatter.toggle("blockquote",null,i),c=e.createRng(),c.setStart(d,0),c.setEnd(d,0),f.setRng(c))}})}(),function(){var b=function(a){var b=e.create("body"),c=a.cloneContents();return b.appendChild(c),f.serializer.serialize(b,{format:"html"})},g=function(c){var d=b(c),f=e.createRng();return f.selectNode(a.getBody()),d===b(f)};a.on("keydown",function(b){var f,h,i=b.keyCode;if(!n(b)&&(i===d||i===c)){if(f=a.selection.isCollapsed(),h=a.getBody(),f&&!e.isEmpty(h))return;if(!f&&!g(a.selection.getRng()))return;b.preventDefault(),a.setContent(""),h.firstChild&&e.isBlock(h.firstChild)?a.selection.setCursorLocation(h.firstChild,0):a.selection.setCursorLocation(h,0),a.nodeChanged()}})}(),Ib.windowsPhone||function(){a.on("keyup focusin mouseup",function(a){Iz.modifierPressed(a)||f.normalize()},!0)}(),k&&(function(){a.settings.content_editable||e.bind(a.getDoc(),"mousedown mouseup",function(b){var c;if(b.target===a.getDoc().documentElement)if(c=f.getRng(),a.getBody().focus(),"mousedown"===b.type){if(nj(c.startContainer))return;f.placeCaretAt(b.clientX,b.clientY)}else f.setRng(c)})}(),function(){a.on("click",function(b){var c=b.target;/^(IMG|HR)$/.test(c.nodeName)&&"false"!==e.getContentEditableParent(c)&&(b.preventDefault(),a.selection.select(c),a.nodeChanged()),"A"===c.nodeName&&e.hasClass(c,"mce-item-anchor")&&(b.preventDefault(),f.select(c))})}(),function(){g.forced_root_block&&a.on("init",function(){m("DefaultParagraphSeparator",g.forced_root_block)})}(),function(){a.on("init",function(){a.dom.bind(a.getBody(),"submit",function(a){a.preventDefault()})})}(),s(),function(){h.addNodeFilter("br",function(a){for(var b=a.length;b--;)"Apple-interchange-newline"===a[b].attr("class")&&a[b].remove()})}(),Ib.iOS?(function(){a.inline||a.on("keydown",function(){document.activeElement===document.body&&a.getWin().focus()})}(),t(),function(){a.on("click",function(a){var b=a.target;do{if("A"===b.tagName)return void a.preventDefault()}while(b=b.parentNode)}),a.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")}()):r()),Ib.ie>=11&&(t(),s()),Ib.ie&&(r(),function(){m("AutoUrlDetect",!1)}(),function(){a.on("dragstart",function(a){o(a)}),a.on("drop",function(b){if(!n(b)){var c=p(b);if(c&&c.id!==a.id){b.preventDefault();var d=ND.fromPoint(b.x,b.y,a.getDoc());f.setRng(d),q(c.html,!0)}}})}()),i&&(!function(){a.on("keydown",function(b){if(!n(b)&&b.keyCode===c){if(!a.getBody().getElementsByTagName("hr").length)return;if(f.isCollapsed()&&0===f.getRng().startOffset){var d=f.getNode(),g=d.previousSibling;if("HR"===d.nodeName)return e.remove(d),void b.preventDefault();g&&g.nodeName&&"hr"===g.nodeName.toLowerCase()&&(e.remove(g),b.preventDefault())}}})}(),function(){Range.prototype.getClientRects||a.on("mousedown",function(b){if(!n(b)&&"HTML"===b.target.nodeName){var c=a.getBody();c.blur(),Qb.setEditorTimeout(a,function(){c.focus()})}})}(),function(){var c=function(){var c=e.getAttribs(f.getStart().cloneNode(!1));return function(){var d=f.getStart();d!==a.getBody()&&(e.setAttrib(d,"style",null),b(c,function(a){d.setAttributeNode(a.cloneNode(!0))}))}},d=function(){return!f.isCollapsed()&&e.getParent(f.getStart(),e.isBlock)!==e.getParent(f.getEnd(),e.isBlock)};a.on("keypress",function(b){var e;if(!n(b)&&(8===b.keyCode||46===b.keyCode)&&d())return e=c(),a.getDoc().execCommand("delete",!1,null),e(),b.preventDefault(),!1}),e.bind(a.getDoc(),"cut",function(b){var e;!n(b)&&d()&&(e=c(),Qb.setEditorTimeout(a,function(){e()}))})}(),function(){var b=function(){m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),g.object_resizing||m("enableObjectResizing",!1)};g.readonly||a.on("BeforeExecCommand MouseDown",b)}(),function(){var c=function(){b(e.select("a"),function(a){var b=a.parentNode,c=e.getRoot();if(b.lastChild===a){for(;b&&!e.isBlock(b);){if(b.parentNode.lastChild!==b||b===c)return;b=b.parentNode}e.add(b,"br",{"data-mce-bogus":1})}})};a.on("SetContent ExecCommand",function(a){"setcontent"!==a.type&&"mceInsertLink"!==a.command||c()})}(),function(){a.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}(),function(){Ib.mac&&a.on("keydown",function(b){!Iz.metaKeyPressed(b)||b.shiftKey||37!==b.keyCode&&39!==b.keyCode||(b.preventDefault(),a.selection.getSel().modify("move",37===b.keyCode?"backward":"forward","lineboundary"))})}(),s()),{refreshContentEditable:u,isHidden:v}}function _(a){return{walk:function(b,c){return PB.walk(a,b,c)},split:oB.split,normalize:function(b){return ov.normalize(a,b).fold(Aa.constant(!1),function(a){return b.setStart(a.startContainer,a.startOffset),b.setEnd(a.endContainer,a.endOffset),!0})}}}var aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},oa=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},pa=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},qa=function(a){return function(){return a}},ra=function(a){return a},sa=function(a,b){return a===b},ta=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},ua=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},va=function(a){return function(){throw new Error(a)}},wa=function(a){return a()},xa=function(a){a()},ya=qa(!1),za=qa(!0),Aa={noop:na,noarg:oa,compose:pa,constant:qa,identity:ra,tripleEquals:sa,curry:ta,not:ua,die:va,apply:wa,call:xa,never:ya,always:za},Ba=Aa.never,Ca=Aa.always,Da=function(){return Ea},Ea=function(){var a=function(a){return a.isNone()},b=function(a){return a()},c=function(a){return a},d=function(){},e={fold:function(a,b){return a()},is:Ba,isSome:Ba,isNone:Ca,getOr:c,getOrThunk:b,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:c,orThunk:b,map:Da,ap:Da,each:d,bind:Da,flatten:Da,exists:Ba,forall:Ca,filter:Da,equals:a,equals_:a,toArray:function(){return[]},toString:Aa.constant("none()")};return Object.freeze&&Object.freeze(e),e}(),Fa=function(a){var b=function(){return a},c=function(){return f},d=function(b){return Fa(b(a))},e=function(b){return b(a)},f={fold:function(b,c){return c(a)},is:function(b){return a===b},isSome:Ca,isNone:Ba,getOr:b,getOrThunk:b,getOrDie:b,or:c,orThunk:c,map:d,ap:function(b){return b.fold(Da,function(b){return Fa(b(a))})},each:function(b){b(a)},bind:e,flatten:b,exists:e,forall:e,filter:function(b){return b(a)?f:Ea},equals:function(b){return b.is(a)},equals_:function(b,c){return b.fold(Ba,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return f},Ga=function(a){return null===a||void 0===a?Ea:Fa(a)},Ha={some:Fa,none:Da,from:Ga},Ia=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&Array.prototype.isPrototypeOf(a)?"array":"object"===b&&String.prototype.isPrototypeOf(a)?"string":b},Ja=function(a){return function(b){return Ia(b)===a}},Ka={isString:Ja("string"),isObject:Ja("object"),isArray:Ja("array"),isNull:Ja("null"),isBoolean:Ja("boolean"),isUndefined:Ja("undefined"),isFunction:Ja("function"),isNumber:Ja("number")},La=function(){var a=Array.prototype.indexOf,b=function(b,c){return a.call(b,c)},c=function(a,b){return _a(a,b)};return void 0===a?c:b}(),Ma=function(a,b){var c=La(a,b);return-1===c?Ha.none():Ha.some(c)},Na=function(a,b){return La(a,b)>-1},Oa=function(a,b){return $a(a,b).isSome()},Pa=function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},Qa=function(a,b){for(var c=[],d=0;d<a.length;d+=b){var e=a.slice(d,d+b);c.push(e)}return c},Ra=function(a,b){for(var c=a.length,d=new Array(c),e=0;e<c;e++){var f=a[e];d[e]=b(f,e,a)}return d},Sa=function(a,b){for(var c=0,d=a.length;c<d;c++){b(a[c],c,a)}},Ta=function(a,b){for(var c=a.length-1;c>=0;c--){b(a[c],c,a)}},Ua=function(a,b){for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];(b(g,e,a)?c:d).push(g)}return{pass:c,fail:d}},Va=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d];b(f,d,a)&&c.push(f)}return c},Wa=function(a,b){if(0===a.length)return[];for(var c=b(a[0]),d=[],e=[],f=0,g=a.length;f<g;f++){var h=a[f],i=b(h);i!==c&&(d.push(e),e=[]),c=i,e.push(h)}return 0!==e.length&&d.push(e),d},Xa=function(a,b,c){return Ta(a,function(a){c=b(c,a)}),c},Ya=function(a,b,c){return Sa(a,function(a){c=b(c,a)}),c},Za=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e,c,a))return Ha.some(e)}return Ha.none()},$a=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b(a[c],c,a))return Ha.some(c)}return Ha.none()},_a=function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1},ab=Array.prototype.push,bb=function(a){for(var b=[],c=0,d=a.length;c<d;++c){if(!Array.prototype.isPrototypeOf(a[c]))throw new Error("Arr.flatten item "+c+" was not an array, input: "+a);ab.apply(b,a[c])}return b},cb=function(a,b){var c=Ra(a,b);return bb(c)},db=function(a,b){for(var c=0,d=a.length;c<d;++c){if(!0!==b(a[c],c,a))return!1}return!0},eb=function(a,b){return a.length===b.length&&db(a,function(a,c){return a===b[c]})},fb=Array.prototype.slice,gb=function(a){var b=fb.call(a,0);return b.reverse(),b},hb=function(a,b){return Va(a,function(a){return!Na(b,a)})},ib=function(a,b){for(var c={},d=0,e=a.length;d<e;d++){var f=a[d];c[String(f)]=b(f,d)}return c},jb=function(a){return[a]},kb=function(a,b){var c=fb.call(a,0);return c.sort(b),c},lb=function(a){return 0===a.length?Ha.none():Ha.some(a[0])},mb=function(a){return 0===a.length?Ha.none():Ha.some(a[a.length-1])},nb=Ka.isFunction(Array.from)?Array.from:function(a){return fb.call(a)},ob={map:Ra,each:Sa,eachr:Ta,partition:Ua,filter:Va,groupBy:Wa,indexOf:Ma,foldr:Xa,foldl:Ya,find:Za,findIndex:$a,flatten:bb,bind:cb,forall:db,exists:Oa,contains:Na,equal:eb,reverse:gb,chunk:Qa,difference:hb,mapToObject:ib,pure:jb,sort:kb,range:Pa,head:lb,last:mb,from:nb},pb="undefined"!=typeof window?window:Function("return this;")(),qb=function(a,b){for(var c=void 0!==b&&null!==b?b:pb,d=0;d<a.length&&void 0!==c&&null!==c;++d)c=c[a[d]];return c},rb=function(a,b){var c=a.split(".");return qb(c,b)},sb=function(a,b){return void 0!==a[b]&&null!==a[b]||(a[b]={}),a[b]},tb=function(a,b){for(var c=void 0!==b?b:pb,d=0;d<a.length;++d)c=sb(c,a[d]);return c},ub=function(a,b){var c=a.split(".");return tb(c,b)},vb={path:qb,resolve:rb,forge:tb,namespace:ub},wb=function(a,b){return vb.resolve(a,b)},xb=function(a,b){var c=wb(a,b);if(void 0===c||null===c)throw a+" not available on this browser";return c},yb={getOrDie:xb},zb=function(){return yb.getOrDie("URL")},Ab=function(a){return zb().createObjectURL(a)},Bb=function(a){zb().revokeObjectURL(a)},Cb={createObjectURL:Ab,revokeObjectURL:Bb},Db=navigator,Eb=Db.userAgent,Fb=function(a){return"matchMedia"in window&&matchMedia(a).matches};aa=!1,ia=/Android/.test(Eb),ba=/WebKit/.test(Eb),ca=!ba&&!aa&&/MSIE/gi.test(Eb)&&/Explorer/gi.test(Db.appName),ca=ca&&/MSIE (\w+)\./.exec(Eb)[1],da=-1!==Eb.indexOf("Trident/")&&(-1!==Eb.indexOf("rv:")||-1!==Db.appName.indexOf("Netscape"))&&11,ea=-1!==Eb.indexOf("Edge/")&&!ca&&!da&&12,ca=ca||da||ea,fa=!ba&&!da&&/Gecko/.test(Eb),ga=-1!==Eb.indexOf("Mac"),ha=/(iPad|iPhone)/.test(Eb),ja="FormData"in window&&"FileReader"in window&&"URL"in window&&!!Cb.createObjectURL,ka=Fb("only screen and (max-device-width: 480px)")&&(ia||ha),la=Fb("only screen and (min-width: 800px)")&&(ia||ha),ma=-1!==Eb.indexOf("Windows Phone"),ea&&(ba=!1);var Gb,Hb=!ha||ja||parseInt(Eb.match(/AppleWebKit\/(\d*)/)[1],10)>=534,Ib={opera:aa,webkit:ba,ie:ca,gecko:fa,mac:ga,iOS:ha,android:ia,contentEditable:Hb,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!==ca,range:window.getSelection&&"Range"in window,documentMode:ca&&!ea?document.documentMode||7:10,fileApi:ja,ceFalse:!1===ca||ca>8,cacheSuffix:null,container:null,overrideViewPort:null,experimentalShadowDom:!1,canHaveCSP:!1===ca||ca>11,desktop:!ka&&!la,windowsPhone:ma},Jb=window.Promise?window.Promise:function(){function a(a,b){return function(){a.apply(b,arguments)}}function b(a){var b=this;if(null===this._state)return void this._deferreds.push(a);j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(b){return void a.reject(b)}a.resolve(d)})}function c(b){try{if(b===this)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){var f=b.then;if("function"==typeof f)return void g(a(f,b),a(c,this),a(d,this))}this._state=!0,this._value=b,e.call(this)}catch(a){d.call(this,a)}}function d(a){this._state=!1,this._value=a,e.call(this)}function e(){for(var a=0,c=this._deferreds.length;a<c;a++)b.call(this,this._deferreds[a]);this._deferreds=null}function f(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function g(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(a){if(d)return;d=!0,c(a)}}var h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},i=function(b){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],g(b,a(c,this),a(d,this))},j=i.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)};return i.prototype.catch=function(a){return this.then(null,a)},i.prototype.then=function(a,c){var d=this;return new i(function(e,g){b.call(d,new f(a,c,e,g))})},i.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&h(arguments[0])?arguments[0]:arguments);return new i(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0==--e&&b(a)}catch(a){c(a)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},i.resolve=function(a){return a&&"object"==typeof a&&a.constructor===i?a:new i(function(b){b(a)})},i.reject=function(a){return new i(function(b,c){c(a)})},i.race=function(a){return new i(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})},i}(),Kb=function(a,b){var c,d=window.requestAnimationFrame,e=["ms","moz","webkit"],f=function(a){window.setTimeout(a,0)};for(c=0;c<e.length&&!d;c++)d=window[e[c]+"RequestAnimationFrame"];d||(d=f),d(a,b)},Lb=function(a,b){return"number"!=typeof b&&(b=0),setTimeout(a,b)},Mb=function(a,b){return"number"!=typeof b&&(b=1),setInterval(a,b)},Nb=function(a){return clearTimeout(a)},Ob=function(a){return clearInterval(a)},Pb=function(a,b){var c,d;return d=function(){var d=arguments;clearTimeout(c),c=Lb(function(){a.apply(this,d)},b)},d.stop=function(){clearTimeout(c)},d},Qb={requestAnimationFrame:function(a,b){if(Gb)return void Gb.then(a);Gb=new Jb(function(a){b||(b=document.body),Kb(a,b)}).then(a)},setTimeout:Lb,setInterval:Mb,setEditorTimeout:function(a,b,c){return Lb(function(){a.removed||b()},c)},setEditorInterval:function(a,b,c){var d;return d=Mb(function(){a.removed?clearInterval(d):b()},c)},debounce:Pb,throttle:Pb,clearInterval:Ob,clearTimeout:Nb},Rb=/^(?:mouse|contextmenu)|click/,Sb={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1},Tb=function(a){return a.isDefaultPrevented===Vb||a.isDefaultPrevented===Ub},Ub=function(){return!1},Vb=function(){return!0},Wb=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)},Xb=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d||!1):a.detachEvent&&a.detachEvent("on"+b,c)},Yb=function(a,b){var c,d=b;return c=a.path,c&&c.length>0&&(d=c[0]),a.composedPath&&(c=a.composedPath())&&c.length>0&&(d=c[0]),d},Zb=function(a,b){var c,d=b||{};for(c in a)Sb[c]||(d[c]=a[c]);if(d.target||(d.target=d.srcElement||document),Ib.experimentalShadowDom&&(d.target=Yb(a,d.target)),a&&Rb.test(a.type)&&void 0===a.pageX&&void 0!==a.clientX){var e=d.target.ownerDocument||document,f=e.documentElement,g=e.body;d.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),d.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}return d.preventDefault=function(){d.isDefaultPrevented=Vb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},d.stopPropagation=function(){d.isPropagationStopped=Vb,a&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0)},d.stopImmediatePropagation=function(){d.isImmediatePropagationStopped=Vb,d.stopPropagation()},!1===Tb(d)&&(d.isDefaultPrevented=Ub,d.isPropagationStopped=Ub,d.isImmediatePropagationStopped=Ub),void 0===d.metaKey&&(d.metaKey=!1),d},$b=function(a,b,c){var d=a.document,e={type:"ready"};if(c.domLoaded)return void b(e);var f=function(){return"complete"===d.readyState||"interactive"===d.readyState&&d.body},g=function(){c.domLoaded||(c.domLoaded=!0,b(e))},h=function(){f()&&(Xb(d,"readystatechange",h),g())},i=function(){try{d.documentElement.doScroll("left")}catch(a){return void Qb.setTimeout(i)}g()};!d.addEventListener||Ib.ie&&Ib.ie<11?(Wb(d,"readystatechange",h),d.documentElement.doScroll&&a.self===a.top&&i()):f()?g():Wb(a,"DOMContentLoaded",g),Wb(a,"load",g)},_b=function(){var a,b,c,d,e,f=this,g={};b="mce-data-"+(+new Date).toString(32),d="onmouseenter"in document.documentElement,c="onfocusin"in document.documentElement,e={mouseenter:"mouseover",mouseleave:"mouseout"},a=1,f.domLoaded=!1,f.events=g;var h=function(a,b){var c,d,e,f,h=g[b];if(c=h&&h[a.type])for(d=0,e=c.length;d<e;d++)if(f=c[d],f&&!1===f.func.call(f.scope,a)&&a.preventDefault(),a.isImmediatePropagationStopped())return};f.bind=function(i,j,k,l){var m,n,o,p,q,r,s,t=window,u=function(a){h(Zb(a||t.event),m)};if(i&&3!==i.nodeType&&8!==i.nodeType){for(i[b]?m=i[b]:(m=a++,i[b]=m,g[m]={}),l=l||i,j=j.split(" "),o=j.length;o--;)p=j[o],r=u,q=s=!1,
"DOMContentLoaded"===p&&(p="ready"),f.domLoaded&&"ready"===p&&"complete"===i.readyState?k.call(l,Zb({type:p})):(d||(q=e[p])&&(r=function(a){var b,c;if(b=a.currentTarget,(c=a.relatedTarget)&&b.contains)c=b.contains(c);else for(;c&&c!==b;)c=c.parentNode;c||(a=Zb(a||t.event),a.type="mouseout"===a.type?"mouseleave":"mouseenter",a.target=b,h(a,m))}),c||"focusin"!==p&&"focusout"!==p||(s=!0,q="focusin"===p?"focus":"blur",r=function(a){a=Zb(a||t.event),a.type="focus"===a.type?"focusin":"focusout",h(a,m)}),n=g[m][p],n?"ready"===p&&f.domLoaded?k({type:p}):n.push({func:k,scope:l}):(g[m][p]=n=[{func:k,scope:l}],n.fakeName=q,n.capture=s,n.nativeHandler=r,"ready"===p?$b(i,r,f):Wb(i,q||p,r,s)));return i=n=0,k}},f.unbind=function(a,c,d){var e,h,i,j,k,l;if(!a||3===a.nodeType||8===a.nodeType)return f;if(e=a[b]){if(l=g[e],c){for(c=c.split(" "),i=c.length;i--;)if(k=c[i],h=l[k]){if(d)for(j=h.length;j--;)if(h[j].func===d){var m=h.nativeHandler,n=h.fakeName,o=h.capture;h=h.slice(0,j).concat(h.slice(j+1)),h.nativeHandler=m,h.fakeName=n,h.capture=o,l[k]=h}d&&0!==h.length||(delete l[k],Xb(a,h.fakeName||k,h.nativeHandler,h.capture))}}else{for(k in l)h=l[k],Xb(a,h.fakeName||k,h.nativeHandler,h.capture);l={}}for(k in l)return f;delete g[e];try{delete a[b]}catch(c){a[b]=null}}return f},f.fire=function(a,c,d){var e;if(!a||3===a.nodeType||8===a.nodeType)return f;d=Zb(null,d),d.type=c,d.target=a;do{e=a[b],e&&h(d,e),a=a.parentNode||a.ownerDocument||a.defaultView||a.parentWindow}while(a&&!d.isPropagationStopped());return f},f.clean=function(a){var c,d,e=f.unbind;if(!a||3===a.nodeType||8===a.nodeType)return f;if(a[b]&&e(a),a.getElementsByTagName||(a=a.document),a&&a.getElementsByTagName)for(e(a),d=a.getElementsByTagName("*"),c=d.length;c--;)a=d[c],a[b]&&e(a);return f},f.destroy=function(){g={}},f.cancel=function(a){return a&&(a.preventDefault(),a.stopImmediatePropagation()),!1}};_b.Event=new _b,_b.Event.bind(window,"ready",function(){});var ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc="sizzle"+-new Date,uc=window.document,vc=0,wc=0,xc=a(),yc=a(),zc=a(),Ac=function(a,b){return a===b&&(kc=!0),0},Bc="undefined",Cc=1<<31,Dc={}.hasOwnProperty,Ec=[],Fc=Ec.pop,Gc=Ec.push,Hc=Ec.push,Ic=Ec.slice,Jc=Ec.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},Kc="[\\x20\\t\\r\\n\\f]",Lc="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Mc="\\["+Kc+"*("+Lc+")(?:"+Kc+"*([*^$|!~]?=)"+Kc+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Lc+"))|)"+Kc+"*\\]",Nc=":("+Lc+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Mc+")*)|.*)\\)|)",Oc=new RegExp("^"+Kc+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Kc+"+$","g"),Pc=new RegExp("^"+Kc+"*,"+Kc+"*"),Qc=new RegExp("^"+Kc+"*([>+~]|"+Kc+")"+Kc+"*"),Rc=new RegExp("="+Kc+"*([^\\]'\"]*?)"+Kc+"*\\]","g"),Sc=new RegExp(Nc),Tc=new RegExp("^"+Lc+"$"),Uc={ID:new RegExp("^#("+Lc+")"),CLASS:new RegExp("^\\.("+Lc+")"),TAG:new RegExp("^("+Lc+"|[*])"),ATTR:new RegExp("^"+Mc),PSEUDO:new RegExp("^"+Nc),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Kc+"*(even|odd|(([+-]|)(\\d*)n|)"+Kc+"*(?:([+-]|)"+Kc+"*(\\d+)|))"+Kc+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Kc+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Kc+"*((?:-\\d)?\\d*)"+Kc+"*\\)|)(?=[^-]|$)","i")},Vc=/^(?:input|select|textarea|button)$/i,Wc=/^h\d$/i,Xc=/^[^{]+\{\s*\[native \w/,Yc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Zc=/[+~]/,$c=/'|\\/g,_c=new RegExp("\\\\([\\da-f]{1,6}"+Kc+"?|("+Kc+")|.)","ig"),ad=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{Hc.apply(Ec=Ic.call(uc.childNodes),uc.childNodes),Ec[uc.childNodes.length].nodeType}catch(a){Hc={apply:Ec.length?function(a,b){Gc.apply(a,Ic.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}var bd=function(a,b,c,d){var f,h,i,j,k,l,m,n,o,p;if((b?b.ownerDocument||b:uc)!==mc&&lc(b),b=b||mc,c=c||[],!a||"string"!=typeof a)return c;if(1!==(j=b.nodeType)&&9!==j)return[];if(oc&&!d){if(f=Yc.exec(a))if(i=f[1]){if(9===j){if(!(h=b.getElementById(i))||!h.parentNode)return c;if(h.id===i)return c.push(h),c}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(i))&&sc(b,h)&&h.id===i)return c.push(h),c}else{if(f[2])return Hc.apply(c,b.getElementsByTagName(a)),c;if((i=f[3])&&bc.getElementsByClassName)return Hc.apply(c,b.getElementsByClassName(i)),c}if(bc.qsa&&(!pc||!pc.test(a))){if(n=m=tc,o=b,p=9===j&&a,1===j&&"object"!==b.nodeName.toLowerCase()){for(l=fc(a),(m=b.getAttribute("id"))?n=m.replace($c,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",k=l.length;k--;)l[k]=n+g(l[k]);o=Zc.test(a)&&e(b.parentNode)||b,p=l.join(",")}if(p)try{return Hc.apply(c,o.querySelectorAll(p)),c}catch(a){}finally{m||b.removeAttribute("id")}}}return hc(a.replace(Oc,"$1"),b,c,d)};bc=bd.support={},ec=bd.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},lc=bd.setDocument=function(a){var b,d=a?a.ownerDocument||a:uc,e=d.defaultView;return d!==mc&&9===d.nodeType&&d.documentElement?(mc=d,nc=d.documentElement,oc=!ec(d),e&&e!==function(a){try{return a.top}catch(a){}return null}(e)&&(e.addEventListener?e.addEventListener("unload",function(){lc()},!1):e.attachEvent&&e.attachEvent("onunload",function(){lc()})),bc.attributes=!0,bc.getElementsByTagName=!0,bc.getElementsByClassName=Xc.test(d.getElementsByClassName),bc.getById=!0,cc.find.ID=function(a,b){if(typeof b.getElementById!==Bc&&oc){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},cc.filter.ID=function(a){var b=a.replace(_c,ad);return function(a){return a.getAttribute("id")===b}},cc.find.TAG=bc.getElementsByTagName?function(a,b){if(typeof b.getElementsByTagName!==Bc)return b.getElementsByTagName(a)}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},cc.find.CLASS=bc.getElementsByClassName&&function(a,b){if(oc)return b.getElementsByClassName(a)},qc=[],pc=[],bc.disconnectedMatch=!0,pc=pc.length&&new RegExp(pc.join("|")),qc=qc.length&&new RegExp(qc.join("|")),b=Xc.test(nc.compareDocumentPosition),sc=b||Xc.test(nc.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},Ac=b?function(a,b){if(a===b)return kc=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!bc.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===uc&&sc(uc,a)?-1:b===d||b.ownerDocument===uc&&sc(uc,b)?1:jc?Jc.call(jc,a)-Jc.call(jc,b):0:4&c?-1:1)}:function(a,b){if(a===b)return kc=!0,0;var e,f=0,g=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!g||!h)return a===d?-1:b===d?1:g?-1:h?1:jc?Jc.call(jc,a)-Jc.call(jc,b):0;if(g===h)return c(a,b);for(e=a;e=e.parentNode;)i.unshift(e);for(e=b;e=e.parentNode;)j.unshift(e);for(;i[f]===j[f];)f++;return f?c(i[f],j[f]):i[f]===uc?-1:j[f]===uc?1:0},d):mc},bd.matches=function(a,b){return bd(a,null,null,b)},bd.matchesSelector=function(a,b){if((a.ownerDocument||a)!==mc&&lc(a),b=b.replace(Rc,"='$1']"),bc.matchesSelector&&oc&&(!qc||!qc.test(b))&&(!pc||!pc.test(b)))try{var c=rc.call(a,b);if(c||bc.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(a){}return bd(b,mc,null,[a]).length>0},bd.contains=function(a,b){return(a.ownerDocument||a)!==mc&&lc(a),sc(a,b)},bd.attr=function(a,b){(a.ownerDocument||a)!==mc&&lc(a);var c=cc.attrHandle[b.toLowerCase()],d=c&&Dc.call(cc.attrHandle,b.toLowerCase())?c(a,b,!oc):void 0;return void 0!==d?d:bc.attributes||!oc?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},bd.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},bd.uniqueSort=function(a){var b,c=[],d=0,e=0;if(kc=!bc.detectDuplicates,jc=!bc.sortStable&&a.slice(0),a.sort(Ac),kc){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return jc=null,a},dc=bd.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=dc(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=dc(b);return c},cc=bd.selectors={cacheLength:50,createPseudo:b,match:Uc,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_c,ad),a[3]=(a[3]||a[4]||a[5]||"").replace(_c,ad),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||bd.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&bd.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return Uc.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&Sc.test(c)&&(b=fc(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_c,ad).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=xc[a+" "];return b||(b=new RegExp("(^|"+Kc+")"+a+"("+Kc+"|$)"))&&xc(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==Bc&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=bd.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[tc]||(q[tc]={}),j=k[a]||[],n=j[0]===vc&&j[1],m=j[0]===vc&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[vc,n,m];break}}else if(s&&(j=(b[tc]||(b[tc]={}))[a])&&j[0]===vc)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[tc]||(l[tc]={}))[a]=[vc,m]),l!==b)););return(m-=e)===d||m%d==0&&m/d>=0}}},PSEUDO:function(a,c){var d,e=cc.pseudos[a]||cc.setFilters[a.toLowerCase()]||bd.error("unsupported pseudo: "+a);return e[tc]?e(c):e.length>1?(d=[a,a,"",c],cc.setFilters.hasOwnProperty(a.toLowerCase())?b(function(a,b){for(var d,f=e(a,c),g=f.length;g--;)d=Jc.call(a,f[g]),a[d]=!(b[d]=f[g])}):function(a){return e(a,0,d)}):e}},pseudos:{not:b(function(a){var c=[],d=[],e=gc(a.replace(Oc,"$1"));return e[tc]?b(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,b,f){return c[0]=a,e(c,null,f,d),!d.pop()}}),has:b(function(a){return function(b){return bd(a,b).length>0}}),contains:b(function(a){return a=a.replace(_c,ad),function(b){return(b.textContent||b.innerText||dc(b)).indexOf(a)>-1}}),lang:b(function(a){return Tc.test(a||"")||bd.error("unsupported lang: "+a),a=a.replace(_c,ad).toLowerCase(),function(b){var c;do{if(c=oc?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(a){var b=window.location&&window.location.hash;return b&&b.slice(1)===a.id},root:function(a){return a===nc},focus:function(a){return a===mc.activeElement&&(!mc.hasFocus||mc.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!cc.pseudos.empty(a)},header:function(a){return Wc.test(a.nodeName)},input:function(a){return Vc.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:d(function(){return[0]}),last:d(function(a,b){return[b-1]}),eq:d(function(a,b,c){return[c<0?c+b:c]}),even:d(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:d(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:d(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:d(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},cc.pseudos.nth=cc.pseudos.eq;for(ac in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})cc.pseudos[ac]=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}(ac);for(ac in{submit:!0,reset:!0})cc.pseudos[ac]=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}(ac);f.prototype=cc.filters=cc.pseudos,cc.setFilters=new f,fc=bd.tokenize=function(a,b){var c,d,e,f,g,h,i,j=yc[a+" "];if(j)return b?0:j.slice(0);for(g=a,h=[],i=cc.preFilter;g;){c&&!(d=Pc.exec(g))||(d&&(g=g.slice(d[0].length)||g),h.push(e=[])),c=!1,(d=Qc.exec(g))&&(c=d.shift(),e.push({value:c,type:d[0].replace(Oc," ")}),g=g.slice(c.length));for(f in cc.filter)!(d=Uc[f].exec(g))||i[f]&&!(d=i[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),g=g.slice(c.length));if(!c)break}return b?g.length:g?bd.error(a):yc(a,h).slice(0)},gc=bd.compile=function(a,b){var c,d=[],e=[],f=zc[a+" "];if(!f){for(b||(b=fc(a)),c=b.length;c--;)f=m(b[c]),f[tc]?d.push(f):e.push(f);f=zc(a,n(e,d)),f.selector=a}return f},hc=bd.select=function(a,b,c,d){var f,h,i,j,k,l="function"==typeof a&&a,m=!d&&fc(a=l.selector||a);if(c=c||[],1===m.length){if(h=m[0]=m[0].slice(0),h.length>2&&"ID"===(i=h[0]).type&&bc.getById&&9===b.nodeType&&oc&&cc.relative[h[1].type]){if(!(b=(cc.find.ID(i.matches[0].replace(_c,ad),b)||[])[0]))return c;l&&(b=b.parentNode),a=a.slice(h.shift().value.length)}for(f=Uc.needsContext.test(a)?0:h.length;f--&&(i=h[f],!cc.relative[j=i.type]);)if((k=cc.find[j])&&(d=k(i.matches[0].replace(_c,ad),Zc.test(h[0].type)&&e(b.parentNode)||b))){if(h.splice(f,1),!(a=d.length&&g(h)))return Hc.apply(c,d),c;break}}return(l||gc(a,m))(d,b,!oc,c,Zc.test(a)&&e(b.parentNode)||b),c},bc.sortStable=tc.split("").sort(Ac).join("")===tc,bc.detectDuplicates=!!kc,lc(),bc.sortDetached=!0;var cd=Array.isArray,dd=function(a){var b,c,d=a;if(!cd(a))for(d=[],b=0,c=a.length;b<c;b++)d[b]=a[b];return d},ed=function(a,b,c){var d,e;if(!a)return 0;if(c=c||a,void 0!==a.length){for(d=0,e=a.length;d<e;d++)if(!1===b.call(c,a[d],d,a))return 0}else for(d in a)if(a.hasOwnProperty(d)&&!1===b.call(c,a[d],d,a))return 0;return 1},fd=function(a,b){var c=[];return ed(a,function(d,e){c.push(b(d,e,a))}),c},gd=function(a,b){var c=[];return ed(a,function(d,e){b&&!b(d,e,a)||c.push(d)}),c},hd=function(a,b){var c,d;if(a)for(c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},id=function(a,b,c,d){var e=0;for(arguments.length<3&&(c=a[0]);e<a.length;e++)c=b.call(d,c,a[e],e);return c},jd=function(a,b,c){var d,e;for(d=0,e=a.length;d<e;d++)if(b.call(c,a[d],d,a))return d;return-1},kd=function(a,b,c){var d=jd(a,b,c);if(-1!==d)return a[d]},ld=function(a){return a[a.length-1]},md={isArray:cd,toArray:dd,each:ed,map:fd,filter:gd,indexOf:hd,reduce:id,findIndex:jd,find:kd,last:ld},nd=/^\s*|\s*$/g,od=function(a){return null===a||void 0===a?"":(""+a).replace(nd,"")},pd=function(a,b){return b?!("array"!==b||!md.isArray(a))||typeof a===b:void 0!==a},qd=function(a,b,c){var d;for(a=a||[],b=b||",","string"==typeof a&&(a=a.split(b)),c=c||{},d=a.length;d--;)c[a[d]]={};return c},rd=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},sd=function(a,b,c){var d,e,f,g,h,i=this,j=0;if(a=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(a),f=a[3].match(/(^|\.)(\w+)$/i)[2],e=i.createNS(a[3].replace(/\.\w+$/,""),c),!e[f]){if("static"===a[2])return e[f]=b,void(this.onCreate&&this.onCreate(a[2],a[3],e[f]));b[f]||(b[f]=function(){},j=1),e[f]=b[f],i.extend(e[f].prototype,b),a[5]&&(d=i.resolve(a[5]).prototype,g=a[5].match(/\.(\w+)$/i)[1],h=e[f],e[f]=j?function(){return d[g].apply(this,arguments)}:function(){return this.parent=d[g],h.apply(this,arguments)},e[f].prototype[f]=e[f],i.each(d,function(a,b){e[f].prototype[b]=d[b]}),i.each(b,function(a,b){d[b]?e[f].prototype[b]=function(){return this.parent=d[b],a.apply(this,arguments)}:b!==f&&(e[f].prototype[b]=a)})),i.each(b.static,function(a,b){e[f][b]=a})}},td=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];var e,f,g,h,i=arguments;for(e=1,f=i.length;e<f;e++){b=i[e];for(g in b)b.hasOwnProperty(g)&&void 0!==(h=b[g])&&(a[g]=h)}return a},ud=function(a,b,c,d){d=d||this,a&&(c&&(a=a[c]),md.each(a,function(a,e){if(!1===b.call(d,a,e,c))return!1;ud(a,b,c,d)}))},vd=function(a,b){var c,d;for(b=b||window,a=a.split("."),c=0;c<a.length;c++)d=a[c],b[d]||(b[d]={}),b=b[d];return b},wd=function(a,b){var c,d;for(b=b||window,a=a.split("."),c=0,d=a.length;c<d&&(b=b[a[c]]);c++);return b},xd=function(a,b){return!a||pd(a,"array")?a:md.map(a.split(b||","),od)},yd=function(a){var b=Ib.cacheSuffix;return b&&(a+=(-1===a.indexOf("?")?"?":"&")+b),a},zd={trim:od,isArray:md.isArray,is:pd,toArray:md.toArray,makeMap:qd,each:md.each,map:md.map,grep:md.filter,inArray:md.indexOf,hasOwn:rd,extend:td,create:sd,walk:ud,createNS:vd,resolve:wd,explode:xd,_addCacheSuffix:yd},Ad=document,Bd=Array.prototype.push,Cd=Array.prototype.slice,Dd=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ed=_b.Event,Fd=zd.makeMap("children,contents,next,prev"),Gd=function(a){return void 0!==a},Hd=function(a){return"string"==typeof a},Id=function(a){return a&&a===a.window},Jd=function(a,b){var c,d,e;for(b=b||Ad,e=b.createElement("div"),c=b.createDocumentFragment(),e.innerHTML=a;d=e.firstChild;)c.appendChild(d);return c},Kd=function(a,b,c,d){var e;if(Hd(b))b=Jd(b,Zd(a[0]));else if(b.length&&!b.nodeType){if(b=Td.makeArray(b),d)for(e=b.length-1;e>=0;e--)Kd(a,b[e],c,d);else for(e=0;e<b.length;e++)Kd(a,b[e],c,d);return a}if(b.nodeType)for(e=a.length;e--;)c.call(a[e],b);return a},Ld=function(a,b){return a&&b&&-1!==(" "+a.className+" ").indexOf(" "+b+" ")},Md=function(a,b,c){var d,e;return b=Td(b)[0],a.each(function(){var a=this;c&&d===a.parentNode?e.appendChild(a):(d=a.parentNode,e=b.cloneNode(!1),a.parentNode.insertBefore(e,a),e.appendChild(a))}),a},Nd=zd.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Od=zd.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Pd={for:"htmlFor",class:"className",readonly:"readOnly"},Qd={float:"cssFloat"},Rd={},Sd={},Td=function(a,b){return new Td.fn.init(a,b)},Ud=function(a,b){var c;if(b.indexOf)return b.indexOf(a);for(c=b.length;c--;)if(b[c]===a)return c;return-1},Vd=/^\s*|\s*$/g,Wd=function(a){return null===a||void 0===a?"":(""+a).replace(Vd,"")},Xd=function(a,b){var c,d,e,f;if(a)if(void 0===(c=a.length)){for(d in a)if(a.hasOwnProperty(d)&&(f=a[d],!1===b.call(f,d,f)))break}else for(e=0;e<c&&(f=a[e],!1!==b.call(f,e,f));e++);return a},Yd=function(a,b){var c=[];return Xd(a,function(a,d){b(d,a)&&c.push(d)}),c},Zd=function(a){return a?9===a.nodeType?a:a.ownerDocument:Ad};Td.fn=Td.prototype={constructor:Td,selector:"",context:null,length:0,init:function(a,b){var c,d,e=this;if(!a)return e;if(a.nodeType)return e.context=e[0]=a,e.length=1,e;if(b&&b.nodeType)e.context=b;else{if(b)return Td(a).attr(b);e.context=b=document}if(Hd(a)){if(e.selector=a,!(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:Dd.exec(a)))return Td(b).find(a);if(c[1])for(d=Jd(a,Zd(b)).firstChild;d;)Bd.call(e,d),d=d.nextSibling;else{if(!(d=Zd(b).getElementById(c[2])))return e;if(d.id!==c[2])return e.find(a);e.length=1,e[0]=d}}else this.add(a,!1);return e},toArray:function(){return zd.toArray(this)},add:function(a,b){var c,d,e=this;if(Hd(a))return e.add(Td(a));if(!1!==b)for(c=Td.unique(e.toArray().concat(Td.makeArray(a))),e.length=c.length,d=0;d<c.length;d++)e[d]=c[d];else Bd.apply(e,Td.makeArray(a));return e},attr:function(a,b){var c,d=this;if("object"==typeof a)Xd(a,function(a,b){d.attr(a,b)});else{if(!Gd(b)){if(d[0]&&1===d[0].nodeType){if((c=Rd[a])&&c.get)return c.get(d[0],a);if(Od[a])return d.prop(a)?a:void 0;b=d[0].getAttribute(a,2),null===b&&(b=void 0)}return b}this.each(function(){var c;if(1===this.nodeType){if((c=Rd[a])&&c.set)return void c.set(this,b);null===b?this.removeAttribute(a,2):this.setAttribute(a,b,2)}})}return d},removeAttr:function(a){return this.attr(a,null)},prop:function(a,b){var c=this;if("object"==typeof(a=Pd[a]||a))Xd(a,function(a,b){c.prop(a,b)});else{if(!Gd(b))return c[0]&&c[0].nodeType&&a in c[0]?c[0][a]:b;this.each(function(){1===this.nodeType&&(this[a]=b)})}return c},css:function(a,b){var c,d,e=this,f=function(a){return a.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})},g=function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a})};if("object"==typeof a)Xd(a,function(a,b){e.css(a,b)});else if(Gd(b))a=f(a),"number"!=typeof b||Nd[a]||(b=b.toString()+"px"),e.each(function(){var c=this.style;if((d=Sd[a])&&d.set)return void d.set(this,b);try{this.style[Qd[a]||a]=b}catch(a){}null!==b&&""!==b||(c.removeProperty?c.removeProperty(g(a)):c.removeAttribute(a))});else{if(c=e[0],(d=Sd[a])&&d.get)return d.get(c);if(!c.ownerDocument.defaultView)return c.currentStyle?c.currentStyle[f(a)]:"";try{return c.ownerDocument.defaultView.getComputedStyle(c,null).getPropertyValue(g(a))}catch(a){return}}return e},remove:function(){for(var a,b=this,c=this.length;c--;)a=b[c],Ed.clean(a),a.parentNode&&a.parentNode.removeChild(a);return this},empty:function(){for(var a,b=this,c=this.length;c--;)for(a=b[c];a.firstChild;)a.removeChild(a.firstChild);return this},html:function(a){var b,c=this;if(Gd(a)){b=c.length;try{for(;b--;)c[b].innerHTML=a}catch(d){Td(c[b]).empty().append(a)}return c}return c[0]?c[0].innerHTML:""},text:function(a){var b,c=this;if(Gd(a)){for(b=c.length;b--;)"innerText"in c[b]?c[b].innerText=a:c[0].textContent=a;return c}return c[0]?c[0].innerText||c[0].textContent:""},append:function(){return Kd(this,arguments,function(a){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(a)})},prepend:function(){return Kd(this,arguments,function(a){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(a,this.firstChild)},!0)},before:function(){var a=this;return a[0]&&a[0].parentNode?Kd(a,arguments,function(a){this.parentNode.insertBefore(a,this)}):a},after:function(){var a=this;return a[0]&&a[0].parentNode?Kd(a,arguments,function(a){this.parentNode.insertBefore(a,this.nextSibling)},!0):a},appendTo:function(a){return Td(a).append(this),this},prependTo:function(a){return Td(a).prepend(this),this},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return Md(this,a)},wrapAll:function(a){return Md(this,a,!0)},wrapInner:function(a){return this.each(function(){Td(this).contents().wrapAll(a)}),this},unwrap:function(){return this.parent().each(function(){Td(this).replaceWith(this.childNodes)})},clone:function(){var a=[];return this.each(function(){a.push(this.cloneNode(!0))}),Td(a)},addClass:function(a){return this.toggleClass(a,!0)},removeClass:function(a){return this.toggleClass(a,!1)},toggleClass:function(a,b){var c=this;return"string"!=typeof a?c:(-1!==a.indexOf(" ")?Xd(a.split(" "),function(){c.toggleClass(this,b)}):c.each(function(c,d){var e,f;(f=Ld(d,a))!==b&&(e=d.className,f?d.className=Wd((" "+e+" ").replace(" "+a+" "," ")):d.className+=e?" "+a:a)}),c)},hasClass:function(a){return Ld(this[0],a)},each:function(a){return Xd(this,a)},on:function(a,b){return this.each(function(){Ed.bind(this,a,b)})},off:function(a,b){return this.each(function(){Ed.unbind(this,a,b)})},trigger:function(a){return this.each(function(){"object"==typeof a?Ed.fire(this,a.type,a):Ed.fire(this,a)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new Td(Cd.apply(this,arguments))},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(a){var b,c,d=[];for(b=0,c=this.length;b<c;b++)Td.find(a,this[b],d);return Td(d)},filter:function(a){return Td("function"==typeof a?Yd(this.toArray(),function(b,c){return a(c,b)}):Td.filter(a,this.toArray()))},closest:function(a){var b=[];return a instanceof Td&&(a=a[0]),this.each(function(c,d){for(;d;){if("string"==typeof a&&Td(d).is(a)){b.push(d);break}if(d===a){b.push(d);break}d=d.parentNode}}),Td(b)},offset:function(a){var b,c,d,e,f=0,g=0;return a?this.css(a):(b=this[0],b&&(c=b.ownerDocument,d=c.documentElement,b.getBoundingClientRect&&(e=b.getBoundingClientRect(),f=e.left+(d.scrollLeft||c.body.scrollLeft)-d.clientLeft,g=e.top+(d.scrollTop||c.body.scrollTop)-d.clientTop)),{left:f,top:g})},push:Bd,sort:[].sort,splice:[].splice},zd.extend(Td,{extend:zd.extend,makeArray:function(a){return Id(a)||a.nodeType?[a]:zd.toArray(a)},inArray:Ud,isArray:zd.isArray,each:Xd,trim:Wd,grep:Yd,find:bd,expr:bd.selectors,unique:bd.uniqueSort,text:bd.getText,contains:bd.contains,filter:function(a,b,c){var d=b.length;for(c&&(a=":not("+a+")");d--;)1!==b[d].nodeType&&b.splice(d,1);return b=1===b.length?Td.find.matchesSelector(b[0],a)?[b[0]]:[]:Td.find.matches(a,b)}});var $d=function(a,b,c){var d=[],e=a[b];for("string"!=typeof c&&c instanceof Td&&(c=c[0]);e&&9!==e.nodeType;){if(void 0!==c){if(e===c)break;if("string"==typeof c&&Td(e).is(c))break}1===e.nodeType&&d.push(e),e=e[b]}return d},_d=function(a,b,c,d){var e=[];for(d instanceof Td&&(d=d[0]);a;a=a[b])if(!c||a.nodeType===c){if(void 0!==d){if(a===d)break;if("string"==typeof d&&Td(a).is(d))break}e.push(a)}return e},ae=function(a,b,c){for(a=a[b];a;a=a[b])if(a.nodeType===c)return a;return null};Xd({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return $d(a,"parentNode")},next:function(a){return ae(a,"nextSibling",1)},prev:function(a){return ae(a,"previousSibling",1)},children:function(a){return _d(a.firstChild,"nextSibling",1)},contents:function(a){return zd.toArray(("iframe"===a.nodeName?a.contentDocument||a.contentWindow.document:a).childNodes)}},function(a,b){Td.fn[a]=function(c){var d=this,e=[];return d.each(function(){var a=b.call(e,this,c,e);a&&(Td.isArray(a)?e.push.apply(e,a):e.push(a))}),this.length>1&&(Fd[a]||(e=Td.unique(e)),0===a.indexOf("parents")&&(e=e.reverse())),e=Td(e),c?e.filter(c):e}}),Xd({parentsUntil:function(a,b){return $d(a,"parentNode",b)},nextUntil:function(a,b){return _d(a,"nextSibling",1,b).slice(1)},prevUntil:function(a,b){return _d(a,"previousSibling",1,b).slice(1)}},function(a,b){Td.fn[a]=function(c,d){var e=this,f=[];return e.each(function(){var a=b.call(f,this,c,f);a&&(Td.isArray(a)?f.push.apply(f,a):f.push(a))}),this.length>1&&(f=Td.unique(f),0!==a.indexOf("parents")&&"prevUntil"!==a||(f=f.reverse())),f=Td(f),d?f.filter(d):f}}),Td.fn.is=function(a){return!!a&&this.filter(a).length>0},Td.fn.init.prototype=Td.fn,Td.overrideDefaults=function(a){var b,c=function(d,e){return b=b||a(),0===arguments.length&&(d=b.element),e||(e=b.context),new c.fn.init(d,e)};return Td.extend(c,this),c};var be=function(a,b,c){Xd(c,function(c,d){a[c]=a[c]||{},a[c][b]=d})};Ib.ie&&Ib.ie<8&&(be(Rd,"get",{maxlength:function(a){var b=a.maxLength;if(2147483647!==b)return b},size:function(a){var b=a.size;if(20!==b)return b},class:function(a){return a.className},style:function(a){var b=a.style.cssText;if(0!==b.length)return b}}),be(Rd,"set",{class:function(a,b){a.className=b},style:function(a,b){a.style.cssText=b}})),Ib.ie&&Ib.ie<9&&(Qd.float="styleFloat",be(Sd,"set",{opacity:function(a,b){var c=a.style;null===b||""===b?c.removeAttribute("filter"):(c.zoom=1,c.filter="alpha(opacity="+100*b+")")}})),Td.attrHooks=Rd,Td.cssHooks=Sd;var ce,de,ee,fe=function(a){var b,c=!1;return function(){return c||(c=!0,b=a.apply(null,arguments)),b}},ge={cached:fe},he=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.test(b))return d}},ie=function(a,b){var c=he(a,b);if(!c)return{major:0,minor:0};var d=function(a){return Number(b.replace(c,"$"+a))};return le(d(1),d(2))},je=function(a,b){var c=String(b).toLowerCase();return 0===a.length?ke():ie(a,c)},ke=function(){return le(0,0)},le=function(a,b){return{major:a,minor:b}},me={nu:le,detect:je,unknown:ke},ne=function(a,b){return function(){return b===a}},oe=function(){return pe({current:void 0,version:me.unknown()})},pe=function(a){var b=a.current;return{current:b,version:a.version,isEdge:ne("Edge",b),isChrome:ne("Chrome",b),isIE:ne("IE",b),isOpera:ne("Opera",b),isFirefox:ne("Firefox",b),isSafari:ne("Safari",b)}},qe={unknown:oe,nu:pe,edge:Aa.constant("Edge"),chrome:Aa.constant("Chrome"),ie:Aa.constant("IE"),opera:Aa.constant("Opera"),firefox:Aa.constant("Firefox"),safari:Aa.constant("Safari")},re=function(a,b){return function(){return b===a}},se=function(){return te({current:void 0,version:me.unknown()})},te=function(a){var b=a.current;return{current:b,version:a.version,isWindows:re("Windows",b),isiOS:re("iOS",b),isAndroid:re("Android",b),isOSX:re("OSX",b),isLinux:re("Linux",b),isSolaris:re("Solaris",b),isFreeBSD:re("FreeBSD",b)}},ue={unknown:se,nu:te,windows:Aa.constant("Windows"),ios:Aa.constant("iOS"),android:Aa.constant("Android"),linux:Aa.constant("Linux"),osx:Aa.constant("OSX"),solaris:Aa.constant("Solaris"),freebsd:Aa.constant("FreeBSD")},ve=function(a,b){var c=String(b).toLowerCase();return ob.find(a,function(a){return a.search(c)})},we=function(a,b){return ve(a,b).map(function(a){var c=me.detect(a.versionRegexes,b);return{current:a.name,version:c}})},xe=function(a,b){return ve(a,b).map(function(a){var c=me.detect(a.versionRegexes,b);return{current:a.name,version:c}})},ye={detectBrowser:we,detectOs:xe},ze=function(a,b){return b+a},Ae=function(a,b){return a+b},Be=function(a,b){return a.substring(b)},Ce=function(a,b){return a.substring(0,a.length-b)},De={addToStart:ze,addToEnd:Ae,removeFromStart:Be,removeFromEnd:Ce},Ee=function(a,b){return a.substr(0,b)},Fe=function(a,b){return a.substr(a.length-b,a.length)},Ge=function(a){return""===a?Ha.none():Ha.some(a.substr(0,1))},He=function(a){return""===a?Ha.none():Ha.some(a.substring(1))},Ie={first:Ee,last:Fe,head:Ge,tail:He},Je=function(a,b,c){return""===b||!(a.length<b.length)&&a.substr(c,c+b.length)===b},Ke=function(a,b){var c=function(a){var b=typeof a;return"string"===b||"number"===b};return a.replace(/\${([^{}]*)}/g,function(a,d){var e=b[d];return c(e)?e:a})},Le=function(a,b){return Re(a,b)?De.removeFromStart(a,b.length):a},Me=function(a,b){return Se(a,b)?De.removeFromEnd(a,b.length):a},Ne=function(a,b){return Re(a,b)?a:De.addToStart(a,b)},Oe=function(a,b){return Se(a,b)?a:De.addToEnd(a,b)},Pe=function(a,b){return-1!==a.indexOf(b)},Qe=function(a){return Ie.head(a).bind(function(b){return Ie.tail(a).map(function(a){return b.toUpperCase()+a})}).getOr(a)},Re=function(a,b){return Je(a,b,0)},Se=function(a,b){return Je(a,b,a.length-b.length)},Te=function(a){return a.replace(/^\s+|\s+$/g,"")},Ue=function(a){return a.replace(/^\s+/g,"")},Ve=function(a){return a.replace(/\s+$/g,"")},We={supplant:Ke,startsWith:Re,removeLeading:Le,removeTrailing:Me,ensureLeading:Ne,ensureTrailing:Oe,endsWith:Se,contains:Pe,trim:Te,lTrim:Ue,rTrim:Ve,capitalize:Qe
},Xe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ye=function(a){return function(b){return We.contains(b,a)}},Ze=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return We.contains(a,"edge/")&&We.contains(a,"chrome")&&We.contains(a,"safari")&&We.contains(a,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Xe],search:function(a){return We.contains(a,"chrome")&&!We.contains(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return We.contains(a,"msie")||We.contains(a,"trident")}},{name:"Opera",versionRegexes:[Xe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ye("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ye("firefox")},{name:"Safari",versionRegexes:[Xe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(We.contains(a,"safari")||We.contains(a,"mobile/"))&&We.contains(a,"applewebkit")}}],$e=[{name:"Windows",search:Ye("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return We.contains(a,"iphone")||We.contains(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ye("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ye("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ye("linux"),versionRegexes:[]},{name:"Solaris",search:Ye("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ye("freebsd"),versionRegexes:[]}],_e={browsers:Aa.constant(Ze),oses:Aa.constant($e)},af=function(a){var b=_e.browsers(),c=_e.oses(),d=ye.detectBrowser(b,a).fold(qe.unknown,qe.nu),e=ye.detectOs(c,a).fold(ue.unknown,ue.nu);return{browser:d,os:e,deviceType:o(e,d,a)}},bf={detect:af},cf=ge.cached(function(){var a=navigator.userAgent;return bf.detect(a)}),df={detect:cf},ef=function(a,b){var c=b||document,d=c.createElement("div");if(d.innerHTML=a,!d.hasChildNodes()||d.childNodes.length>1)throw console.error("HTML does not have a single root node",a),"HTML must have a single root node";return hf(d.childNodes[0])},ff=function(a,b){var c=b||document,d=c.createElement(a);return hf(d)},gf=function(a,b){var c=b||document,d=c.createTextNode(a);return hf(d)},hf=function(a){if(null===a||void 0===a)throw new Error("Node cannot be null or undefined");return{dom:Aa.constant(a)}},jf=function(a,b,c){return Ha.from(a.dom().elementFromPoint(b,c)).map(hf)},kf={fromHtml:ef,fromTag:ff,fromText:gf,fromDom:hf,fromPoint:jf},lf={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},mf=function(a){return a.dom().nodeName.toLowerCase()},nf=function(a){return a.dom().nodeType},of=function(a){return a.dom().nodeValue},pf=function(a){return function(b){return nf(b)===a}},qf=function(a){return nf(a)===lf.COMMENT||"#comment"===mf(a)},rf=pf(lf.ELEMENT),sf=pf(lf.TEXT),tf=pf(lf.DOCUMENT),uf={name:mf,type:nf,value:of,isElement:rf,isText:sf,isDocument:tf,isComment:qf},vf=function(){var a=Object.keys,b=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};return void 0===a?b:a}(),wf=function(a,b){for(var c=vf(a),d=0,e=c.length;d<e;d++){var f=c[d];b(a[f],f,a)}},xf=function(a,b){return yf(a,function(a,c,d){return{k:c,v:b(a,c,d)}})},yf=function(a,b){var c={};return wf(a,function(d,e){var f=b(d,e,a);c[f.k]=f.v}),c},zf=function(a,b){var c={},d={};return wf(a,function(a,e){(b(a,e)?c:d)[e]=a}),{t:c,f:d}},Af=function(a,b){var c=[];return wf(a,function(a,d){c.push(b(a,d))}),c},Bf=function(a,b){for(var c=vf(a),d=0,e=c.length;d<e;d++){var f=c[d],g=a[f];if(b(g,f,a))return Ha.some(g)}return Ha.none()},Cf=function(a){return Af(a,function(a){return a})},Df=function(a){return Cf(a).length},Ef={bifilter:zf,each:wf,map:xf,mapToArray:Af,tupleMap:yf,find:Bf,keys:vf,values:Cf,size:Df},Ff=function(a,b,c){if(!(Ka.isString(c)||Ka.isBoolean(c)||Ka.isNumber(c)))throw console.error("Invalid call to Attr.set. Key ",b,":: Value ",c,":: Element ",a),new Error("Attribute value was not simple");a.setAttribute(b,c+"")},Gf=function(a,b,c){Ff(a.dom(),b,c)},Hf=function(a,b){var c=a.dom();Ef.each(b,function(a,b){Ff(c,b,a)})},If=function(a,b){var c=a.dom().getAttribute(b);return null===c?void 0:c},Jf=function(a,b){var c=a.dom();return!(!c||!c.hasAttribute)&&c.hasAttribute(b)},Kf=function(a,b){a.dom().removeAttribute(b)},Lf=function(a){var b=a.dom().attributes;return void 0===b||null===b||0===b.length},Mf=function(a){return ob.foldl(a.dom().attributes,function(a,b){return a[b.name]=b.value,a},{})},Nf=function(a,b,c){Jf(a,c)&&!Jf(b,c)&&Gf(b,c,If(a,c))},Of=function(a,b,c){uf.isElement(a)&&uf.isElement(b)&&ob.each(c,function(c){Nf(a,b,c)})},Pf={clone:Mf,set:Gf,setAll:Hf,get:If,has:Jf,remove:Kf,hasNone:Lf,transfer:Of},Qf=function(a){var b=uf.isText(a)?a.dom().parentNode:a.dom();return void 0!==b&&null!==b&&b.ownerDocument.body.contains(b)},Rf=ge.cached(function(){return Sf(kf.fromDom(document))}),Sf=function(a){var b=a.dom().body;if(null===b||void 0===b)throw"Body is not available yet";return kf.fromDom(b)},Tf={body:Rf,getBody:Sf,inBody:Qf},Uf=function(a){return void 0!==a.style},Vf={isSupported:Uf},Wf=function(a,b,c){if(!Ka.isString(c))throw console.error("Invalid call to CSS.set. Property ",b,":: Value ",c,":: Element ",a),new Error("CSS value must be a string: "+c);Vf.isSupported(a)&&a.style.setProperty(b,c)},Xf=function(a,b){Vf.isSupported(a)&&a.style.removeProperty(b)},Yf=function(a,b,c){var d=a.dom();Wf(d,b,c)},Zf=function(a,b){var c=a.dom();Ef.each(b,function(a,b){Wf(c,b,a)})},$f=function(a,b){var c=a.dom();Ef.each(b,function(a,b){a.fold(function(){Xf(c,b)},function(a){Wf(c,b,a)})})},_f=function(a,b){var c=a.dom(),d=window.getComputedStyle(c),e=d.getPropertyValue(b),f=""!==e||Tf.inBody(a)?e:ag(c,b);return null===f?void 0:f},ag=function(a,b){return Vf.isSupported(a)?a.style.getPropertyValue(b):""},bg=function(a,b){var c=a.dom(),d=ag(c,b);return Ha.from(d).filter(function(a){return a.length>0})},cg=function(a){var b={},c=a.dom();if(Vf.isSupported(c))for(var d=0;d<c.style.length;d++){var e=c.style.item(d);b[e]=c.style[e]}return b},dg=function(a,b,c){var d=kf.fromTag(a);return Yf(d,b,c),bg(d,b).isSome()},eg=function(a,b){var c=a.dom();Xf(c,b),Pf.has(a,"style")&&""===We.trim(Pf.get(a,"style"))&&Pf.remove(a,"style")},fg=function(a,b){var c=Pf.get(a,"style"),d=b(a);return(void 0===c?Pf.remove:Pf.set)(a,"style",c),d},gg=function(a,b){var c=a.dom(),d=b.dom();Vf.isSupported(c)&&Vf.isSupported(d)&&(d.style.cssText=c.style.cssText)},hg=function(a){return a.dom().offsetWidth},ig=function(a,b,c){bg(a,c).each(function(a){bg(b,c).isNone()&&Yf(b,c,a)})},jg=function(a,b,c){uf.isElement(a)&&uf.isElement(b)&&ob.each(c,function(c){ig(a,b,c)})},kg={copy:gg,set:Yf,preserve:fg,setAll:Zf,setOptions:$f,remove:eg,get:_f,getRaw:bg,getAllRaw:cg,isValidValue:dg,reflow:hg,transfer:jg},lg=function(a){return a.slice(0).sort()},mg=function(a,b){throw new Error("All required keys ("+lg(a).join(", ")+") were not specified. Specified keys were: "+lg(b).join(", ")+".")},ng=function(a){throw new Error("Unsupported keys for object: "+lg(a).join(", "))},og=function(a,b){if(!Ka.isArray(b))throw new Error("The "+a+" fields must be an array. Was: "+b+".");ob.each(b,function(b){if(!Ka.isString(b))throw new Error("The value "+b+" in the "+a+" fields was not a string.")})},pg=function(a,b){throw new Error("All values need to be of type: "+b+". Keys ("+lg(a).join(", ")+") were not.")},qg=function(a){var b=lg(a);ob.find(b,function(a,c){return c<b.length-1&&a===b[c+1]}).each(function(a){throw new Error("The field: "+a+" occurs more than once in the combined fields: ["+b.join(", ")+"].")})},rg={sort:lg,reqMessage:mg,unsuppMessage:ng,validateStrArr:og,invalidTypeMessage:pg,checkDupes:qg},sg={immutable:p,immutableBag:q},tg=function(a,b){var c=[],d=function(a){return c.push(a),b(a)},e=b(a);do{e=e.bind(d)}while(e.isSome());return c},ug={toArray:tg},vg=function(){return yb.getOrDie("Node")},wg=function(a,b,c){return 0!=(a.compareDocumentPosition(b)&c)},xg=function(a,b){return wg(a,b,vg().DOCUMENT_POSITION_PRECEDING)},yg=function(a,b){return wg(a,b,vg().DOCUMENT_POSITION_CONTAINED_BY)},zg={documentPositionPreceding:xg,documentPositionContainedBy:yg},Ag=lf.ELEMENT,Bg=lf.DOCUMENT,Cg=function(a,b){var c=a.dom();if(c.nodeType!==Ag)return!1;if(void 0!==c.matches)return c.matches(b);if(void 0!==c.msMatchesSelector)return c.msMatchesSelector(b);if(void 0!==c.webkitMatchesSelector)return c.webkitMatchesSelector(b);if(void 0!==c.mozMatchesSelector)return c.mozMatchesSelector(b);throw new Error("Browser lacks native selectors")},Dg=function(a){return a.nodeType!==Ag&&a.nodeType!==Bg||0===a.childElementCount},Eg=function(a,b){var c=void 0===b?document:b.dom();return Dg(c)?[]:ob.map(c.querySelectorAll(a),kf.fromDom)},Fg=function(a,b){var c=void 0===b?document:b.dom();return Dg(c)?Ha.none():Ha.from(c.querySelector(a)).map(kf.fromDom)},Gg={all:Eg,is:Cg,one:Fg},Hg=function(a,b){return a.dom()===b.dom()},Ig=function(a,b){return a.dom().isEqualNode(b.dom())},Jg=function(a,b){return ob.exists(b,Aa.curry(Hg,a))},Kg=function(a,b){var c=a.dom(),d=b.dom();return c!==d&&c.contains(d)},Lg=function(a,b){return zg.documentPositionContainedBy(a.dom(),b.dom())},Mg=df.detect().browser,Ng=Mg.isIE()?Lg:Kg,Og={eq:Hg,isEqualNode:Ig,member:Jg,contains:Ng,is:Gg.is},Pg=function(a){return kf.fromDom(a.dom().ownerDocument)},Qg=function(a){var b=Pg(a);return kf.fromDom(b.dom().documentElement)},Rg=function(a){var b=a.dom(),c=b.ownerDocument.defaultView;return kf.fromDom(c)},Sg=function(a){var b=a.dom();return Ha.from(b.parentNode).map(kf.fromDom)},Tg=function(a){return Sg(a).bind(function(b){var c=_g(b);return ob.findIndex(c,function(b){return Og.eq(a,b)})})},Ug=function(a,b){for(var c=Ka.isFunction(b)?b:Aa.constant(!1),d=a.dom(),e=[];null!==d.parentNode&&void 0!==d.parentNode;){var f=d.parentNode,g=kf.fromDom(f);if(e.push(g),!0===c(g))break;d=f}return e},Vg=function(a){var b=function(b){return ob.filter(b,function(b){return!Og.eq(a,b)})};return Sg(a).map(_g).map(b).getOr([])},Wg=function(a){var b=a.dom();return Ha.from(b.offsetParent).map(kf.fromDom)},Xg=function(a){var b=a.dom();return Ha.from(b.previousSibling).map(kf.fromDom)},Yg=function(a){var b=a.dom();return Ha.from(b.nextSibling).map(kf.fromDom)},Zg=function(a){return ob.reverse(ug.toArray(a,Xg))},$g=function(a){return ug.toArray(a,Yg)},_g=function(a){var b=a.dom();return ob.map(b.childNodes,kf.fromDom)},ah=function(a,b){var c=a.dom().childNodes;return Ha.from(c[b]).map(kf.fromDom)},bh=function(a){return ah(a,0)},ch=function(a){return ah(a,a.dom().childNodes.length-1)},dh=function(a){return a.dom().childNodes.length},eh=function(a){return a.dom().hasChildNodes()},fh=sg.immutable("element","offset"),gh=function(a,b){var c=_g(a);return c.length>0&&b<c.length?fh(c[b],0):fh(a,b)},hh={owner:Pg,defaultView:Rg,documentElement:Qg,parent:Sg,findIndex:Tg,parents:Ug,siblings:Vg,prevSibling:Xg,offsetParent:Wg,prevSiblings:Zg,nextSibling:Yg,nextSiblings:$g,children:_g,child:ah,firstChild:bh,lastChild:ch,childNodesCount:dh,hasChildNodes:eh,leaf:gh},ih=df.detect().browser,jh=function(a){return ob.find(a,uf.isElement)},kh=function(a){return ih.isFirefox()&&"table"===uf.name(a)?jh(hh.children(a)).filter(function(a){return"caption"===uf.name(a)}).bind(function(a){return jh(hh.nextSiblings(a)).map(function(b){var c=b.dom().offsetTop,d=a.dom().offsetTop,e=a.dom().offsetHeight;return c<=d?-e:0})}).getOr(0):0},lh=function(a,b,c){var d,e,f=0,g=0,h=a.ownerDocument;if(c=c||a,b){if(c===a&&b.getBoundingClientRect&&"static"===kg.get(kf.fromDom(a),"position"))return e=b.getBoundingClientRect(),f=e.left+(h.documentElement.scrollLeft||a.scrollLeft)-h.documentElement.clientLeft,g=e.top+(h.documentElement.scrollTop||a.scrollTop)-h.documentElement.clientTop,{x:f,y:g};for(d=b;d&&d!==c&&d.nodeType;)f+=d.offsetLeft||0,g+=d.offsetTop||0,d=d.offsetParent;for(d=b.parentNode;d&&d!==c&&d.nodeType;)f-=d.scrollLeft||0,g-=d.scrollTop||0,d=d.parentNode;g+=kh(kf.fromDom(b))}return{x:f,y:g}},mh={getPos:lh},nh=function(a){var b=Ha.none(),c=[],d=function(a){return nh(function(b){e(function(c){b(a(c))})})},e=function(a){g()?i(a):c.push(a)},f=function(a){b=Ha.some(a),h(c),c=[]},g=function(){return b.isSome()},h=function(a){ob.each(a,i)},i=function(a){b.each(function(b){setTimeout(function(){a(b)},0)})};return a(f),{get:e,map:d,isReady:g}},oh=function(a){return nh(function(b){b(a)})},ph={nu:nh,pure:oh},qh=function(a){return function(){var b=Array.prototype.slice.call(arguments),c=this;setTimeout(function(){a.apply(c,b)},0)}},rh={bounce:qh},sh=function(a){var b=function(b){a(rh.bounce(b))};return{map:function(a){return sh(function(c){b(function(b){var d=a(b);c(d)})})},bind:function(a){return sh(function(c){b(function(b){a(b).get(c)})})},anonBind:function(a){return sh(function(c){b(function(b){a.get(c)})})},toLazy:function(){return ph.nu(b)},get:b}},th=function(a){return sh(function(b){b(a)})},uh={nu:sh,pure:th},vh=function(a,b){return b(function(b){var c=[],d=0,e=function(e){return function(f){c[e]=f,++d>=a.length&&b(c)}};0===a.length?b([]):ob.each(a,function(a,b){a.get(e(b))})})},wh={par:vh},xh=function(a){return wh.par(a,uh.nu)},yh=function(a,b){var c=ob.map(a,b);return xh(c)},zh=function(a,b){return function(c){return b(c).bind(a)}},Ah={par:xh,mapM:yh,compose:zh},Bh=function(a){var b=function(b){return a===b},c=function(b){return Bh(a)},d=function(b){return Bh(a)},e=function(b){return Bh(b(a))},f=function(b){b(a)},g=function(b){return b(a)},h=function(b,c){return c(a)},i=function(b){return b(a)},j=function(b){return b(a)},k=function(){return Ha.some(a)};return{is:b,isValue:Aa.always,isError:Aa.never,getOr:Aa.constant(a),getOrThunk:Aa.constant(a),getOrDie:Aa.constant(a),or:c,orThunk:d,fold:h,map:e,each:f,bind:g,exists:i,forall:j,toOption:k}},Ch=function(a){var b=function(a){return a()},c=function(){return Aa.die(String(a))()},d=function(a){return a},e=function(a){return a()},f=function(b){return Ch(a)},g=function(b){return Ch(a)},h=function(b,c){return b(a)};return{is:Aa.never,isValue:Aa.never,isError:Aa.always,getOr:Aa.identity,getOrThunk:b,getOrDie:c,or:d,orThunk:e,fold:h,map:f,each:Aa.noop,bind:g,exists:Aa.never,forall:Aa.always,toOption:Ha.none}},Dh={value:Bh,error:Ch},Eh=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],Fh=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"],Gh=["td","th"],Hh=["thead","tbody","tfoot"],Ih=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],Jh=["h1","h2","h3","h4","h5","h6"],Kh=["li","dd","dt"],Lh=["ul","ol","dl"],Mh=["pre","script","textarea","style"],Nh=function(a){var b;return function(c){return b=b||ob.mapToObject(a,Aa.constant(!0)),b.hasOwnProperty(uf.name(c))}},Oh=Nh(Jh),Ph=Nh(Eh),Qh=function(a){return uf.isElement(a)&&!Ph(a)},Rh=function(a){return uf.isElement(a)&&"br"===uf.name(a)},Sh=Nh(Ih),Th=Nh(Lh),Uh=Nh(Kh),Vh=Nh(Fh),Wh=Nh(Hh),Xh=Nh(Gh),Yh=Nh(Mh),Zh=function(a){return function(b){return!!b&&b.nodeType===a}},$h=Zh(1),_h=function(a){var b=a.toLowerCase().split(" ");return function(a){var c,d;if(a&&a.nodeType)for(d=a.nodeName.toLowerCase(),c=0;c<b.length;c++)if(d===b[c])return!0;return!1}},ai=function(a,b){var c=b.toLowerCase().split(" ");return function(b){var d;if($h(b))for(d=0;d<c.length;d++){var e=b.ownerDocument.defaultView.getComputedStyle(b,null);if((e?e.getPropertyValue(a):null)===c[d])return!0}return!1}},bi=function(a,b){return function(c){return $h(c)&&c[a]===b}},ci=function(a,b){return function(b){return $h(b)&&b.hasAttribute(a)}},di=function(a,b){return function(c){return $h(c)&&c.getAttribute(a)===b}},ei=function(a){return $h(a)&&a.hasAttribute("data-mce-bogus")},fi=function(a){return $h(a)&&"all"===a.getAttribute("data-mce-bogus")},gi=function(a){return $h(a)&&"TABLE"===a.tagName},hi=function(a){return function(b){if($h(b)){if(b.contentEditable===a)return!0;if(b.getAttribute("data-mce-contenteditable")===a)return!0}return!1}},ii=Zh(3),ji=Zh(8),ki=Zh(9),li=_h("br"),mi=hi("true"),ni=hi("false"),oi={isText:ii,isElement:$h,isComment:ji,isDocument:ki,isBr:li,isContentEditableTrue:mi,isContentEditableFalse:ni,matchNodeNames:_h,hasPropValue:bi,hasAttribute:ci,hasAttributeValue:di,matchStyleValues:ai,isBogus:ei,isBogusAll:fi,isTable:gi},pi=function(a){var b=a.previousSibling&&"SPAN"===a.previousSibling.nodeName,c=a.nextSibling&&"SPAN"===a.nextSibling.nodeName;return b&&c},qi=function(a){return a&&"SPAN"===a.tagName&&"bookmark"===a.getAttribute("data-mce-type")},ri=function(a,b){var c,d=b.childNodes;if(!oi.isElement(b)||!qi(b)){for(c=d.length-1;c>=0;c--)ri(a,d[c]);if(!1===oi.isDocument(b)){if(oi.isText(b)&&b.nodeValue.length>0){var e=zd.trim(b.nodeValue).length;if(a.isBlock(b.parentNode)||e>0)return;if(0===e&&pi(b))return}else if(oi.isElement(b)&&(d=b.childNodes,1===d.length&&qi(d[0])&&b.parentNode.insertBefore(d[0],b),d.length||Vh(kf.fromDom(b))))return;a.remove(b)}return b}},si={trimNode:ri},ti=zd.makeMap,ui=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,wi=/[<>&\"\']/g,xi=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,yi={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""};de={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ee={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var zi=function(a){var b;return b=kf.fromTag("div").dom(),b.innerHTML=a,b.textContent||b.innerText||a},Ai=function(a,b){var c,d,e,f={};if(a){for(a=a.split(","),b=b||10,c=0;c<a.length;c+=2)d=String.fromCharCode(parseInt(a[c],b)),de[d]||(e="&"+a[c+1]+";",f[d]=e,f[e]=d);return f}};ce=Ai("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Bi=function(a,b){return a.replace(b?ui:vi,function(a){return de[a]||a})},Ci=function(a){return(""+a).replace(wi,function(a){return de[a]||a})},Di=function(a,b){return a.replace(b?ui:vi,function(a){return a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":de[a]||"&#"+a.charCodeAt(0)+";"})},Ei=function(a,b,c){return c=c||ce,a.replace(b?ui:vi,function(a){return de[a]||c[a]||a})},Fi=function(a,b){var c=Ai(b)||ce,d=function(a,b){return a.replace(b?ui:vi,function(a){return void 0!==de[a]?de[a]:void 0!==c[a]?c[a]:a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":"&#"+a.charCodeAt(0)+";"})},e=function(a,b){return Ei(a,b,c)},f=ti(a.replace(/\+/g,","));return f.named&&f.numeric?d:f.named?b?e:Ei:f.numeric?Di:Bi},Gi=function(a){return a.replace(xi,function(a,b){return b?(b="x"===b.charAt(0).toLowerCase()?parseInt(b.substr(1),16):parseInt(b,10),b>65535?(b-=65536,String.fromCharCode(55296+(b>>10),56320+(1023&b))):yi[b]||String.fromCharCode(b)):ee[a]||ce[a]||zi(a)})},Hi={encodeRaw:Bi,encodeAllRaw:Ci,encodeNumeric:Di,encodeNamed:Ei,getEncodeFunc:Fi,decode:Gi},Ii={},Ji={},Ki=zd.makeMap,Li=zd.each,Mi=zd.extend,Ni=zd.explode,Oi=zd.inArray,Pi=function(a,b){return a=zd.trim(a),a?a.split(b||" "):[]},Qi=function(a){var b,c,d,e,f,g,h={},i=function(a,c,d){var e,f,g,i=function(a,b){var c,d,e={};for(c=0,d=a.length;c<d;c++)e[a[c]]=b||{};return e};for(d=d||[],c=c||"","string"==typeof d&&(d=Pi(d)),a=Pi(a),e=a.length;e--;)f=Pi([b,c].join(" ")),g={attributes:i(f),attributesOrder:f,children:i(d,Ji)},h[a[e]]=g},j=function(a,b){var c,d,e,f;for(a=Pi(a),c=a.length,b=Pi(b);c--;)for(d=h[a[c]],e=0,f=b.length;e<f;e++)d.attributes[b[e]]={},d.attributesOrder.push(b[e])};return Ii[a]?Ii[a]:(b="id accesskey class dir lang style tabindex title role",c="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",d="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==a&&(b+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",c+=" article aside details dialog figure header footer hgroup section nav",d+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==a&&(b+=" xml:lang",g="acronym applet basefont big font strike tt",d=[d,g].join(" "),Li(Pi(g),function(a){i(a,"",d)}),f="center dir isindex noframes",c=[c,f].join(" "),e=[c,d].join(" "),Li(Pi(f),function(a){i(a,"",e)})),e=e||[c,d].join(" "),i("html","manifest","head body"),i("head","","base command link meta noscript script style title"),i("title hr noscript br"),i("base","href target"),i("link","href rel media hreflang type sizes hreflang"),i("meta","name http-equiv content charset"),i("style","media type scoped"),i("script","src async defer type charset"),i("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",e),i("address dt dd div caption","",e),i("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",d),i("blockquote","cite",e),i("ol","reversed start type","li"),i("ul","","li"),i("li","value",e),i("dl","","dt dd"),i("a","href target rel media hreflang type",d),i("q","cite",d),i("ins del","cite datetime",e),i("img","src sizes srcset alt usemap ismap width height"),i("iframe","src name width height",e),i("embed","src type width height"),i("object","data type typemustmatch name usemap form width height",[e,"param"].join(" ")),i("param","name value"),i("map","name",[e,"area"].join(" ")),i("area","alt coords shape href target rel media hreflang type"),i("table","border","caption colgroup thead tfoot tbody tr"+("html4"===a?" col":"")),i("colgroup","span","col"),i("col","span"),i("tbody thead tfoot","","tr"),i("tr","","td th"),i("td","colspan rowspan headers",e),i("th","colspan rowspan headers scope abbr",e),i("form","accept-charset action autocomplete enctype method name novalidate target",e),i("fieldset","disabled form name",[e,"legend"].join(" ")),i("label","form for",d),i("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),i("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===a?e:d),i("select","disabled form multiple name required size","option optgroup"),i("optgroup","disabled label","option"),i("option","disabled label selected value"),i("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),i("menu","type label",[e,"li"].join(" ")),i("noscript","",e),"html4"!==a&&(i("wbr"),i("ruby","",[d,"rt rp"].join(" ")),i("figcaption","",e),i("mark rt rp summary bdi","",d),i("canvas","width height",e),i("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[e,"track source"].join(" ")),i("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[e,"track source"].join(" ")),i("picture","","img source"),i("source","src srcset type media sizes"),i("track","kind src srclang label default"),i("datalist","",[d,"option"].join(" ")),i("article section nav aside header footer","",e),i("hgroup","","h1 h2 h3 h4 h5 h6"),i("figure","",[e,"figcaption"].join(" ")),i("time","datetime",d),i("dialog","open",e),i("command","type label icon disabled checked radiogroup command"),i("output","for form name",d),i("progress","value max",d),i("meter","value min max low high optimum",d),i("details","open",[e,"summary"].join(" ")),i("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==a&&(j("script","language xml:space"),j("style","xml:space"),j("object","declare classid code codebase codetype archive standby align border hspace vspace"),j("embed","align name hspace vspace"),j("param","valuetype type"),j("a","charset name rev shape coords"),j("br","clear"),j("applet","codebase archive code object alt name width height align hspace vspace"),j("img","name longdesc align border hspace vspace"),j("iframe","longdesc frameborder marginwidth marginheight scrolling align"),j("font basefont","size color face"),j("input","usemap align"),j("select","onchange"),j("textarea"),j("h1 h2 h3 h4 h5 h6 div p legend caption","align"),j("ul","type compact"),j("li","type"),j("ol dl menu dir","compact"),j("pre","width xml:space"),j("hr","align noshade size width"),j("isindex","prompt"),j("table","summary width frame rules cellspacing cellpadding align bgcolor"),j("col","width align char charoff valign"),j("colgroup","width align char charoff valign"),j("thead","align char charoff valign"),j("tr","align char charoff valign bgcolor"),j("th","axis align char charoff valign nowrap bgcolor width height"),j("form","accept"),j("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),j("tfoot","align char charoff valign"),j("tbody","align char charoff valign"),j("area","nohref"),j("body","background bgcolor text link vlink alink")),"html4"!==a&&(j("input button select textarea","autofocus"),j("input textarea","placeholder"),j("a","download"),j("link script img","crossorigin"),j("iframe","sandbox seamless allowfullscreen")),Li(Pi("a form meter progress dfn"),function(a){h[a]&&delete h[a].children[a]}),delete h.caption.children.table,delete h.script,Ii[a]=h,h)},Ri=function(a,b){var c;return a&&(c={},"string"==typeof a&&(a={"*":a}),Li(a,function(a,d){c[d]=c[d.toUpperCase()]="map"===b?Ki(a,/[, ]/):Ni(a,/[, ]/)})),c},Si=function(a,b,c,d){var e=function(a){return a=parseInt(a,10).toString(16),a.length>1?a:"0"+a};return"#"+e(b)+e(c)+e(d)},Ti=zd.each,Ui=zd.grep,Vi=Ib.ie,Wi=/^([a-z0-9],?)+$/i,Xi=/^[ \t\r\n]*$/,Yi=function(a,b,c){var d={},e=b.keep_values,f={set:function(a,d,e){b.url_converter&&(d=b.url_converter.call(b.url_converter_scope||c(),d,e,a[0])),a.attr("data-mce-"+e,d).attr(e,d)},get:function(a,b){return a.attr("data-mce-"+b)||a.attr(b)}};return d={style:{set:function(a,b){if(null!==b&&"object"==typeof b)return void a.css(b);e&&a.attr("data-mce-style",b),a.attr("style",b)},get:function(b){var c=b.attr("data-mce-style")||b.attr("style");return c=a.serialize(a.parse(c),b[0].nodeName)}}},e&&(d.href=d.src=f),d},Zi=function(a,b){var c=b.attr("style"),d=a.serialize(a.parse(c),b[0].nodeName);d||(d=null),b.attr("data-mce-style",d)},$i=function(a,b){var c,d,e=0;if(a)for(c=a.nodeType,a=a.previousSibling;a;a=a.previousSibling)d=a.nodeType,(!b||3!==d||d!==c&&a.nodeValue.length)&&(e++,c=d);return e};!function(a){a.DOM=a(document),a.nodeIndex=$i}(v||(v={}));var _i=v,aj=_i.DOM,bj=zd.each,cj=zd.grep,dj=function(a){return"function"==typeof a},ej=function(){var a={},b=[],c={},d=[],e=0,f=function(a,b,c){var d,e,f=aj,g=function(){f.remove(e),d&&(d.onreadystatechange=d.onload=d=null),b()},h=function(){dj(c)?c():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+a)};e=f.uniqueId(),d=document.createElement("script"),d.id=e,d.type="text/javascript",d.src=zd._addCacheSuffix(a),"onreadystatechange"in d?d.onreadystatechange=function(){/loaded|complete/.test(d.readyState)&&g()}:d.onload=g,d.onerror=h,(document.getElementsByTagName("head")[0]||document.body).appendChild(d)};this.isDone=function(b){return 2===a[b]},this.markDone=function(b){a[b]=2},this.add=this.load=function(d,e,f,g){void 0===a[d]&&(b.push(d),a[d]=0),e&&(c[d]||(c[d]=[]),c[d].push({success:e,failure:g,scope:f||this}))},this.remove=function(b){delete a[b],delete c[b]},this.loadQueue=function(a,c,d){this.loadScripts(b,a,c,d)},this.loadScripts=function(b,g,h,i){var j,k=[],l=function(a,b){bj(c[b],function(b){dj(b[a])&&b[a].call(b.scope)}),c[b]=void 0};d.push({success:g,failure:i,scope:h||this}),(j=function(){var c=cj(b);if(b.length=0,bj(c,function(b){return 2===a[b]?void l("success",b):3===a[b]?void l("failure",b):void(1!==a[b]&&(a[b]=1,e++,f(b,function(){a[b]=2,e--,l("success",b),j()},function(){a[b]=3,e--,k.push(b),l("failure",b),j()})))}),!e){var g=d.slice(0);d.length=0,bj(g,function(a){0===k.length?dj(a.success)&&a.success.call(a.scope):dj(a.failure)&&a.failure.call(a.scope,k)})}})()}};ej.ScriptLoader=new ej;var fj=zd.each;!function(a){a.PluginManager=a(),a.ThemeManager=a()}(w||(w={}));var gj=function(a){return"\ufeff"===a},hj=function(a){return a.replace(new RegExp("\ufeff","g"),"")},ij={isZwsp:gj,ZWSP:"\ufeff",trim:hj},jj=oi.isElement,kj=oi.isText,lj=function(a){return kj(a)&&(a=a.parentNode),jj(a)&&a.hasAttribute("data-mce-caret")},mj=function(a){return kj(a)&&ij.isZwsp(a.data)},nj=function(a){return lj(a)||mj(a)},oj=function(a){return a.firstChild!==a.lastChild||!oi.isBr(a.firstChild)},pj=function(a,b){var c,d,e,f;if(c=a.ownerDocument,e=c.createTextNode(ij.ZWSP),f=a.parentNode,b){if(d=a.previousSibling,kj(d)){if(nj(d))return d;if(vj(d))return d.splitText(d.data.length-1)}f.insertBefore(e,a)}else{if(d=a.nextSibling,kj(d)){if(nj(d))return d;if(uj(d))return d.splitText(1),d}a.nextSibling?f.insertBefore(e,a.nextSibling):f.appendChild(e)}return e},qj=function(a){var b=a.container();return a&&oi.isText(b)&&b.data.charAt(a.offset())===ij.ZWSP},rj=function(a){var b=a.container()
;return a&&oi.isText(b)&&b.data.charAt(a.offset()-1)===ij.ZWSP},sj=function(){var a=document.createElement("br");return a.setAttribute("data-mce-bogus","1"),a},tj=function(a,b,c){var d,e,f;return d=b.ownerDocument,e=d.createElement(a),e.setAttribute("data-mce-caret",c?"before":"after"),e.setAttribute("data-mce-bogus","all"),e.appendChild(sj()),f=b.parentNode,c?f.insertBefore(e,b):b.nextSibling?f.insertBefore(e,b.nextSibling):f.appendChild(e),e},uj=function(a){return kj(a)&&a.data[0]===ij.ZWSP},vj=function(a){return kj(a)&&a.data[a.data.length-1]===ij.ZWSP},wj=function(a){var b=a.getElementsByTagName("br"),c=b[b.length-1];oi.isBogus(c)&&c.parentNode.removeChild(c)},xj=function(a){return a&&a.hasAttribute("data-mce-caret")?(wj(a),a.removeAttribute("data-mce-caret"),a.removeAttribute("data-mce-bogus"),a.removeAttribute("style"),a.removeAttribute("_moz_abspos"),a):null},yj=function(a){return lj(a.startContainer)},zj=oi.isContentEditableTrue,Aj=oi.isContentEditableFalse,Bj=oi.isBr,Cj=oi.isText,Dj=oi.matchNodeNames("script style textarea"),Ej=oi.matchNodeNames("img input textarea hr iframe video audio object"),Fj=oi.matchNodeNames("table"),Gj=nj,Hj=function(a){return!Gj(a)&&(Cj(a)?!Dj(a.parentNode):Ej(a)||Bj(a)||Fj(a)||Jj(a))},Ij=function(a){return oi.isElement(a)&&"true"===a.getAttribute("unselectable")},Jj=function(a){return!1===Ij(a)&&Aj(a)},Kj=function(a,b){for(a=a.parentNode;a&&a!==b;a=a.parentNode){if(Jj(a))return!1;if(zj(a))return!0}return!0},Lj=function(a){return!!Jj(a)&&!0!==md.reduce(a.getElementsByTagName("*"),function(a,b){return a||zj(b)},!1)},Mj=function(a){return Ej(a)||Lj(a)},Nj=function(a,b){return Hj(a)&&Kj(a,b)},Oj=Math.round,Pj=function(a){return a?{left:Oj(a.left),top:Oj(a.top),bottom:Oj(a.bottom),right:Oj(a.right),width:Oj(a.width),height:Oj(a.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Qj=function(a,b){return a=Pj(a),b?a.right=a.left:(a.left=a.left+a.width,a.right=a.left),a.width=0,a},Rj=function(a,b){return a.left===b.left&&a.top===b.top&&a.bottom===b.bottom&&a.right===b.right},Sj=function(a,b,c){return a>=0&&a<=Math.min(b.height,c.height)/2},Tj=function(a,b){return a.bottom-a.height/2<b.top||!(a.top>b.bottom)&&Sj(b.top-a.bottom,a,b)},Uj=function(a,b){return a.top>b.bottom||!(a.bottom<b.top)&&Sj(b.bottom-a.top,a,b)},Vj=function(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom},Wj=function(a,b){return b.left>a.left&&b.right<a.right?0:b.left<a.left?b.left-a.left:b.right-a.right},Xj=function(a,b){return b.top>a.top&&b.bottom<a.bottom?0:b.top<a.top?b.top-a.top:b.bottom-a.bottom},Yj=function(a,b){return{x:Wj(a,b),y:Xj(a,b)}},Zj=function(a){var b=a.startContainer,c=a.startOffset;return b.hasChildNodes()&&a.endOffset===c+1?b.childNodes[c]:null},$j=function(a,b){return 1===a.nodeType&&a.hasChildNodes()&&(b>=a.childNodes.length&&(b=a.childNodes.length-1),a=a.childNodes[b]),a},_j=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),ak=function(a){return"string"==typeof a&&a.charCodeAt(0)>=768&&_j.test(a)},bk=[].slice,ck=function(a){return function(){return a}},dk=function(a){return function(b){return!a(b)}},ek=function(a,b){return function(c){return a(b(c))}},fk=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=bk.call(arguments);return function(a){for(var b=0;b<c.length;b++)if(c[b](a))return!0;return!1}},gk=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=bk.call(arguments);return function(a){for(var b=0;b<c.length;b++)if(!c[b](a))return!1;return!0}},hk=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=bk.call(arguments);return d.length-1>=a.length?a.apply(this,d.slice(1)):function(){var a=d.concat([].slice.call(arguments));return hk.apply(this,a)}},ik=function(){},jk={constant:ck,negate:dk,and:gk,or:fk,curry:hk,compose:ek,noop:ik},kk=function(a){for(var b=[],c=function(a){b.push(a)},d=0;d<a.length;d++)a[d].each(c);return b},lk=function(a,b){for(var c=0;c<a.length;c++){var d=b(a[c],c);if(d.isSome())return d}return Ha.none()},mk=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];if(!e.isSome())return Ha.none();c.push(e.getOrDie())}return Ha.some(b.apply(null,c))},nk={cat:kk,findMap:lk,liftN:mk},ok=oi.isElement,pk=Hj,qk=oi.matchStyleValues("display","block table"),rk=oi.matchStyleValues("float","left right"),sk=jk.and(ok,pk,jk.negate(rk)),tk=jk.negate(oi.matchStyleValues("white-space","pre pre-line pre-wrap")),uk=oi.isText,vk=oi.isBr,wk=_i.nodeIndex,xk=$j,yk=function(a){return"createRange"in a?a.createRange():_i.DOM.createRng()},zk=function(a){return a&&/[\r\n\t ]/.test(a)},Ak=function(a){return!!a.setStart&&!!a.setEnd},Bk=function(a){var b,c=a.startContainer,d=a.startOffset;return!!(zk(a.toString())&&tk(c.parentNode)&&oi.isText(c)&&(b=c.data,zk(b[d-1])||zk(b[d+1])))},Ck=function(a){var b,c=a.ownerDocument,d=yk(c),e=c.createTextNode(""),f=a.parentNode;return f.insertBefore(e,a),d.setStart(e,0),d.setEnd(e,1),b=Pj(d.getBoundingClientRect()),f.removeChild(e),b},Dk=function(a){var b=a.startContainer,c=a.endContainer,d=a.startOffset,e=a.endOffset;if(b===c&&oi.isText(c)&&0===d&&1===e){var f=a.cloneRange();return f.setEndAfter(c),Fk(f)}return null},Ek=function(a){return 0===a.left&&0===a.right&&0===a.top&&0===a.bottom},Fk=function(a){var b,c;return c=a.getClientRects(),b=Pj(c.length>0?c[0]:a.getBoundingClientRect()),!Ak(a)&&vk(a)&&Ek(b)?Ck(a):Ek(b)&&Ak(a)?Dk(a):b},Gk=function(a,b){var c=Qj(a,b);return c.width=1,c.right=c.left+1,c},Hk=function(a){var b,c,d=[],e=function(a){0!==a.height&&(d.length>0&&Rj(a,d[d.length-1])||d.push(a))},f=function(a,b){var c=yk(a.ownerDocument);if(b<a.data.length){if(ak(a.data[b]))return d;if(ak(a.data[b-1])&&(c.setStart(a,b),c.setEnd(a,b+1),!Bk(c)))return e(Gk(Fk(c),!1)),d}b>0&&(c.setStart(a,b-1),c.setEnd(a,b),Bk(c)||e(Gk(Fk(c),!1))),b<a.data.length&&(c.setStart(a,b),c.setEnd(a,b+1),Bk(c)||e(Gk(Fk(c),!0)))};if(uk(a.container()))return f(a.container(),a.offset()),d;if(ok(a.container()))if(a.isAtEnd())c=xk(a.container(),a.offset()),uk(c)&&f(c,c.data.length),sk(c)&&!vk(c)&&e(Gk(Fk(c),!1));else{if(c=xk(a.container(),a.offset()),uk(c)&&f(c,0),sk(c)&&a.isAtEnd())return e(Gk(Fk(c),!1)),d;b=xk(a.container(),a.offset()-1),sk(b)&&!vk(b)&&(qk(b)||qk(c)||!sk(c))&&e(Gk(Fk(b),!1)),sk(c)&&e(Gk(Fk(c),!0))}return d};!function(a){a.fromRangeStart=function(b){return a(b.startContainer,b.startOffset)},a.fromRangeEnd=function(b){return a(b.endContainer,b.endOffset)},a.after=function(b){return a(b.parentNode,wk(b)+1)},a.before=function(b){return a(b.parentNode,wk(b))},a.isAbove=function(a,b){return nk.liftN([ob.head(b.getClientRects()),ob.last(a.getClientRects())],Tj).getOr(!1)},a.isBelow=function(a,b){return nk.liftN([ob.last(b.getClientRects()),ob.head(a.getClientRects())],Uj).getOr(!1)},a.isAtStart=function(a){return!!a&&a.isAtStart()},a.isAtEnd=function(a){return!!a&&a.isAtEnd()},a.isTextPosition=function(a){return!!a&&oi.isText(a.container())},a.isElementPosition=function(b){return!1===a.isTextPosition(b)}}(x||(x={}));var Ik,Jk=x,Kk=oi.isElement,Lk=oi.isText,Mk=function(a){var b=a.parentNode;b&&b.removeChild(a)},Nk=function(a){try{return a.nodeValue}catch(a){return""}},Ok=function(a,b){0===b.length?Mk(a):a.nodeValue=b},Pk=function(a){var b=ij.trim(a);return{count:a.length-b.length,text:b}},Qk=function(a,b){return Wk(a),b},Rk=function(a,b){var c=Pk(a.data.substr(0,b.offset())),d=Pk(a.data.substr(b.offset())),e=c.text+d.text;return e.length>0?(Ok(a,e),Jk(a,b.offset()-c.count)):b},Sk=function(a,b){var c=b.container(),d=ob.indexOf(ob.from(c.childNodes),a).map(function(a){return a<b.offset()?Jk(c,b.offset()-1):b}).getOr(b);return Wk(a),d},Tk=function(a,b){return Lk(a)&&b.container()===a?Rk(a,b):Qk(a,b)},Uk=function(a,b){return b.container()===a.parentNode?Sk(a,b):Qk(a,b)},Vk=function(a,b){return Jk.isTextPosition(b)?Tk(a,b):Uk(a,b)},Wk=function(a){if(Kk(a)&&nj(a)&&(oj(a)?a.removeAttribute("data-mce-caret"):Mk(a)),Lk(a)){var b=ij.trim(Nk(a));Ok(a,b)}},Xk={removeAndReposition:Vk,remove:Wk},Yk=function(a,b,c){var d=a?Jk.before(c):Jk.after(c);return dl(a,b,d)},Zk=function(a){return oi.isBr(a)?Jk.before(a):Jk.after(a)},$k=function(a){return Jk.isTextPosition(a)?0===a.offset():Hj(a.getNode())},_k=function(a){if(Jk.isTextPosition(a)){var b=a.container();return a.offset()===b.data.length}return Hj(a.getNode(!0))},al=function(a,b){return!Jk.isTextPosition(a)&&!Jk.isTextPosition(b)&&a.getNode()===b.getNode(!0)},bl=function(a){return!Jk.isTextPosition(a)&&oi.isBr(a.getNode())},cl=function(a,b,c){return a?!al(b,c)&&!bl(b)&&_k(b)&&$k(c):!al(c,b)&&$k(b)&&_k(c)},dl=function(a,b,c){var d=Nn(b);return Ha.from(a?d.next(c):d.prev(c))},el=function(a,b,c){return dl(a,b,c).bind(function(d){return ln(c,d,b)&&cl(a,c,d)?dl(a,b,d):Ha.some(d)})},fl=function(a,b){var c=a?b.firstChild:b.lastChild;return oi.isText(c)?Ha.some(Jk(c,a?0:c.data.length)):c?Hj(c)?Ha.some(a?Jk.before(c):Zk(c)):Yk(a,b,c):Ha.none()},gl={fromPosition:dl,nextPosition:Aa.curry(dl,!0),prevPosition:Aa.curry(dl,!1),navigate:el,positionIn:fl,firstPositionIn:Aa.curry(fl,!0),lastPositionIn:Aa.curry(fl,!1)},hl=oi.isContentEditableTrue,il=oi.isContentEditableFalse,jl=function(a,b,c,d,e){return b._selectionOverrides.showCaret(a,c,d,e)},kl=function(a){var b=a.ownerDocument.createRange();return b.selectNode(a),b},ll=function(a,b){return a.fire("BeforeObjectSelected",{target:b}).isDefaultPrevented()?null:kl(b)},ml=function(a,b,c){var d=sn(1,a.getBody(),b),e=Jk.fromRangeStart(d),f=e.getNode();if(il(f))return jl(1,a,f,!e.isAtEnd(),!1);var g=e.getNode(!0);if(il(g))return jl(1,a,g,!1,!1);var h=a.dom.getParent(e.getNode(),function(a){return il(a)||hl(a)});return il(h)?jl(1,a,h,!1,c):null},nl=function(a,b,c){if(!b||!b.collapsed)return b;var d=ml(a,b,c);return d||b};!function(a){a[a.Br=0]="Br",a[a.Block=1]="Block",a[a.Wrap=2]="Wrap",a[a.Eol=3]="Eol"}(Ik||(Ik={}));var ol,pl=function(a,b){return a===ol.Backwards?b.reverse():b},ql=function(a,b,c){return a===ol.Forwards?b.next(c):b.prev(c)},rl=function(a,b,c,d){return oi.isBr(d.getNode(b===ol.Forwards))?Ik.Br:!1===ln(c,d)?Ik.Block:Ik.Wrap},sl=function(a,b,c,d){for(var e,f=Nn(c),g=d,h=[];g&&(e=ql(b,f,g));){if(oi.isBr(e.getNode(!1)))return b===ol.Forwards?{positions:pl(b,h).concat([e]),breakType:Ik.Br,breakAt:Ha.some(e)}:{positions:pl(b,h),breakType:Ik.Br,breakAt:Ha.some(e)};if(e.isVisible()){if(a(g,e)){var i=rl(0,b,g,e);return{positions:pl(b,h),breakType:i,breakAt:Ha.some(e)}}h.push(e),g=e}else g=e}return{positions:pl(b,h),breakType:Ik.Eol,breakAt:Ha.none()}},tl=function(a,b,c,d){return b(c,d).breakAt.map(function(d){var e=b(c,d).positions;return a===ol.Backwards?e.concat(d):[d].concat(e)}).getOr([])},ul=function(a,b){return ob.foldl(a,function(a,c){return a.fold(function(){return Ha.some(c)},function(d){return nk.liftN([ob.head(d.getClientRects()),ob.head(c.getClientRects())],function(a,e){var f=Math.abs(b-a.left);return Math.abs(b-e.left)<=f?c:d}).or(a)})},Ha.none())},vl=function(a,b){return ob.head(b.getClientRects()).bind(function(b){return ul(a,b.left)})},wl=Aa.curry(sl,x.isAbove,-1),xl=Aa.curry(sl,x.isBelow,1),yl=Aa.curry(tl,-1,wl),zl=Aa.curry(tl,1,xl),Al=function(a){return gl.firstPositionIn(a).map(function(b){return[b].concat(xl(a,b).positions)}).getOr([])},Bl=function(a){return gl.lastPositionIn(a).map(function(b){return wl(a,b).positions.concat(b)}).getOr([])},Cl=function(a){return Gl(Tf.body(),a)},Dl=function(a,b,c){return ob.filter(hh.parents(a,c),b)},El=function(a,b){return ob.filter(hh.siblings(a),b)},Fl=function(a,b){return ob.filter(hh.children(a),b)},Gl=function(a,b){var c=[];return ob.each(hh.children(a),function(a){b(a)&&(c=c.concat([a])),c=c.concat(Gl(a,b))}),c},Hl={all:Cl,ancestors:Dl,siblings:El,children:Fl,descendants:Gl},Il=function(a){return Gg.all(a)},Jl=function(a,b,c){return Hl.ancestors(a,function(a){return Gg.is(a,b)},c)},Kl=function(a,b){return Hl.siblings(a,function(a){return Gg.is(a,b)})},Ll=function(a,b){return Hl.children(a,function(a){return Gg.is(a,b)})},Ml=function(a,b){return Gg.all(b,a)},Nl={all:Il,ancestors:Jl,siblings:Kl,children:Ll,descendants:Ml},Ol=function(a,b){return{left:a.left-b,top:a.top-b,right:a.right+2*b,bottom:a.bottom+2*b,width:a.width+b,height:a.height+b}},Pl=function(a,b){return ob.bind(b,function(b){var c=Ol(b.getBoundingClientRect(),-1);return[{x:c.left,y:a(c),cell:b},{x:c.right,y:a(c),cell:b}]})},Ql=function(a,b,c){return ob.foldl(a,function(a,d){return a.fold(function(){return Ha.some(d)},function(a){var e=Math.sqrt(Math.abs(a.x-b)+Math.abs(a.y-c)),f=Math.sqrt(Math.abs(d.x-b)+Math.abs(d.y-c));return Ha.some(f<e?d:a)})},Ha.none())},Rl=function(a,b,c,d,e){var f=Nl.descendants(kf.fromDom(c),"td,th").map(function(a){return a.dom()}),g=ob.filter(Pl(a,f),function(a){return b(a,e)});return Ql(g,d,e).map(function(a){return a.cell})},Sl=function(a){return a.bottom},Tl=function(a){return a.top},Ul=function(a,b){return a.y<b},Vl=function(a,b){return a.y>b},Wl=Aa.curry(Rl,Sl,Ul),Xl=Aa.curry(Rl,Tl,Vl),Yl=function(a,b){return ob.head(b.getClientRects()).bind(function(b){return Wl(a,b.left,b.top)}).bind(function(a){return vl(Bl(a),b)})},Zl=function(a,b){return ob.last(b.getClientRects()).bind(function(b){return Xl(a,b.left,b.top)}).bind(function(a){return vl(Al(a),b)})},$l=function(a){for(var b=0,c=0,d=a;d&&d.nodeType;)b+=d.offsetLeft||0,c+=d.offsetTop||0,d=d.offsetParent;return{x:b,y:c}},_l=function(a,b,c){var d={elm:b,alignToTop:c};return a.fire("scrollIntoView",d),d.isDefaultPrevented()},am=function(a,b,c){var d,e,f,g,h=a.dom,i=h.getRoot(),j=0;if(!_l(a,b,c)&&oi.isElement(b)){if(!1===c&&(j=b.offsetHeight),"BODY"!==i.nodeName){var k=a.selection.getScrollContainer();if(k)return d=$l(b).y-$l(k).y+j,g=k.clientHeight,f=k.scrollTop,void((d<f||d+25>f+g)&&(k.scrollTop=d<f?d:d-g+25))}e=h.getViewPort(a.getWin()),d=h.getPos(b).y+j,f=e.y,g=e.h,(d<e.y||d+25>f+g)&&a.getWin().scrollTo(0,d<f?d:d-g+25)}},bm=function(a){if(a.inline)return a.getBody().getBoundingClientRect();var b=a.getWin();return{left:0,right:b.innerWidth,top:0,bottom:b.innerHeight,width:b.innerWidth,height:b.innerHeight}},cm=function(a,b,c){a.inline?(a.getBody().scrollLeft+=b,a.getBody().scrollTop+=c):a.getWin().scrollBy(b,c)},dm=function(a,b){ob.head(x.fromRangeStart(b).getClientRects()).each(function(b){var c=bm(a),d=Yj(c,b),e=d.x>0?d.x+4:d.x-4,f=d.y>0?d.y+4:d.y-4;cm(a,0!==d.x?e:0,0!==d.y?f:0)})},em={scrollElementIntoView:am,scrollRangeIntoView:dm},fm=function(a,b,c){var d=a.getParam(b,c);if(-1!==d.indexOf("=")){var e=a.getParam(b,"","hash");return e.hasOwnProperty(a.id)?e[a.id]:c}return d},gm=function(a){return a.getParam("iframe_attrs",{})},hm=function(a){return a.getParam("doctype","<!DOCTYPE html>")},im=function(a){return a.getParam("document_base_url","")},jm=function(a){return fm(a,"body_id","tinymce")},km=function(a){return fm(a,"body_class","")},lm=function(a){return a.getParam("content_security_policy","")},mm=function(a){return a.getParam("br_in_pre",!0)},nm=function(a){if(a.getParam("force_p_newlines",!1))return"p";var b=a.getParam("forced_root_block","p");return!1===b?"":b},om=function(a){return a.getParam("forced_root_block_attrs",{})},pm=function(a){return a.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},qm=function(a){return a.getParam("no_newline_selector","")},rm=function(a){return a.getParam("keep_styles",!0)},sm=function(a){return a.getParam("end_container_on_empty_block",!1)},tm=function(a){return zd.explode(a.getParam("font_size_style_values",""))},um=function(a){return zd.explode(a.getParam("font_size_classes",""))},vm={getIframeAttrs:gm,getDocType:hm,getDocumentBaseUrl:im,getBodyId:jm,getBodyClass:km,getContentSecurityPolicy:lm,shouldPutBrInPre:mm,getForcedRootBlock:nm,getForcedRootBlockAttrs:om,getBrNewLineSelector:pm,getNoNewLineSelector:qm,shouldKeepStyles:rm,shouldEndContainerOnEmptyBlock:sm,getFontStyleValues:tm,getFontSizeClasses:um},wm=function(a,b){hh.parent(a).each(function(c){c.dom().insertBefore(b.dom(),a.dom())})},xm=function(a,b){hh.nextSibling(a).fold(function(){hh.parent(a).each(function(a){zm(a,b)})},function(a){wm(a,b)})},ym=function(a,b){hh.firstChild(a).fold(function(){zm(a,b)},function(c){a.dom().insertBefore(b.dom(),c.dom())})},zm=function(a,b){a.dom().appendChild(b.dom())},Am=function(a,b,c){hh.child(a,c).fold(function(){zm(a,b)},function(a){wm(a,b)})},Bm=function(a,b){wm(a,b),zm(b,a)},Cm={before:wm,after:xm,prepend:ym,append:zm,appendAt:Am,wrap:Bm},Dm=df.detect().browser,Em=function(){return Dm.isIE()||Dm.isEdge()||Dm.isFirefox()},Fm=function(a,b){a.selection.setRng(b),em.scrollRangeIntoView(a,b)},Gm=function(a,b,c){var d=a(b,c);return d.breakType===Ik.Wrap&&0===d.positions.length?d.breakAt.map(function(c){return a(b,c).breakAt.isNone()}).getOr(!0):d.breakAt.isNone()},Hm=jk.curry(Gm,wl),Im=jk.curry(Gm,xl),Jm=function(a,b,c){var d=Jk.fromRangeStart(b);return gl.positionIn(!a,c).map(function(a){return a.isEqual(d)}).getOr(!1)},Km=function(a,b,c,d){var e=a.selection.getRng(),f=b?1:-1;if(Em()&&Jm(b,e,c)){var g=jl(f,a,c,!b,!0);return Fm(a,g),!0}return!1},Lm=function(a,b,c){return Yl(b,c).orThunk(function(){return ob.head(c.getClientRects()).bind(function(c){return ul(yl(a,Jk.before(b)),c.left)})}).getOr(Jk.before(b))},Mm=function(a,b,c){return Zl(b,c).orThunk(function(){return ob.head(c.getClientRects()).bind(function(c){return ul(zl(a,Jk.after(b)),c.left)})}).getOr(Jk.after(b))},Nm=function(a,b){var c=b.getNode(a);return oi.isElement(c)&&"TABLE"===c.nodeName?Ha.some(c):Ha.none()},Om=function(a,b,c,d){var e=vm.getForcedRootBlock(b);e?b.undoManager.transact(function(){var d=kf.fromTag(e);Pf.setAll(d,vm.getForcedRootBlockAttrs(b)),Cm.append(d,kf.fromTag("br")),a?Cm.after(kf.fromDom(c),d):Cm.before(kf.fromDom(c),d);var f=b.dom.createRng();f.setStart(d.dom(),0),f.setEnd(d.dom(),0),Fm(b,f)}):Fm(b,d.toRange())},Pm=function(a,b,c){var d=!1===b;(b?Nm(!0,c):Nm(!1,c)).fold(function(){return Fm(a,c.toRange())},function(e){return gl.positionIn(d,a.getBody()).filter(function(a){return a.isEqual(c)}).fold(function(){return Fm(a,c.toRange())},function(d){return Om(b,a,e,c)})})},Qm=function(a,b,c,d){var e=a.selection.getRng(),f=Jk.fromRangeStart(e),g=a.getBody();if(!b&&Hm(d,f)){var h=Lm(g,c,f);return Pm(a,b,h),!0}if(b&&Im(d,f)){var h=Mm(g,c,f);return Pm(a,b,h),!0}return!1},Rm=function(a,b){return function(){return Ha.from(a.dom.getParent(a.selection.getNode(),"td,th")).bind(function(c){return Ha.from(a.dom.getParent(c,"table")).map(function(c){return Km(a,b,c)})}).getOr(!1)}},Sm=function(a,b){return function(){return Ha.from(a.dom.getParent(a.selection.getNode(),"td,th")).bind(function(c){return Ha.from(a.dom.getParent(c,"table")).map(function(d){return Qm(a,b,d,c)})}).getOr(!1)}},Tm=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return Tm(c())}}},Um=oi.isContentEditableFalse,Vm=function(a){return oi.isElement(a)&&/^(TD|TH)$/i.test(a.tagName)},Wm=function(a,b,c){var d,e,f,g,h,i=Qj(b.getBoundingClientRect(),c);return"BODY"===a.tagName?(d=a.ownerDocument.documentElement,e=a.scrollLeft||d.scrollLeft,f=a.scrollTop||d.scrollTop):(h=a.getBoundingClientRect(),e=a.scrollLeft-h.left,f=a.scrollTop-h.top),i.left+=e,i.right+=e,i.top+=f,i.bottom+=f,i.width=1,g=b.offsetWidth-b.clientWidth,g>0&&(c&&(g*=-1),i.left+=g,i.right+=g),i},Xm=function(a){var b,c,d,e,f;for(b=Td("*[contentEditable=false]",a),e=0;e<b.length;e++)c=b[e],d=c.previousSibling,vj(d)&&(f=d.data,1===f.length?d.parentNode.removeChild(d):d.deleteData(f.length-1,1)),d=c.nextSibling,uj(d)&&(f=d.data,1===f.length?d.parentNode.removeChild(d):d.deleteData(0,1))},Ym=function(a,b,c){var d,e,f=Tm(Ha.none()),g=function(c,d){var g,j;if(h(),Vm(d))return null;if(!b(d))return e=pj(d,c),j=d.ownerDocument.createRange(),Um(e.nextSibling)?(j.setStart(e,0),j.setEnd(e,0)):(j.setStart(e,1),j.setEnd(e,1)),j;e=tj("p",d,c),g=Wm(a,d,c),Td(e).css("top",g.top);var k=Td('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(g).appendTo(a)[0];return f.set(Ha.some({caret:k,element:d,before:c})),f.get().each(function(a){c&&Td(a.caret).addClass("mce-visual-caret-before")}),i(),j=d.ownerDocument.createRange(),j.setStart(e,0),j.setEnd(e,0),j},h=function(){Xm(a),e&&(Xk.remove(e),e=null),f.get().each(function(a){Td(a.caret).remove(),f.set(Ha.none())}),clearInterval(d)},i=function(){d=Qb.setInterval(function(){c()?Td("div.mce-visual-caret",a).toggleClass("mce-visual-caret-hidden"):Td("div.mce-visual-caret",a).addClass("mce-visual-caret-hidden")},500)},j=function(){f.get().each(function(b){var c=Wm(a,b.element,b.before);Td(b.caret).css(c)})},k=function(){return Qb.clearInterval(d)};return{show:g,hide:h,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:j,destroy:k}},Zm=function(a){return Um(a)||oi.isTable(a)&&Em()},$m=oi.isContentEditableFalse,_m=oi.matchStyleValues("display","block table table-cell table-caption list-item"),an=nj,bn=lj,cn=jk.curry,dn=oi.isElement,en=Hj,fn=function(a){return a>0},gn=function(a){return a<0},hn=function(a,b){for(var c;c=a(b);)if(!bn(c))return c;return null},jn=function(a,b,c,d,e){var f=new s(a,d);if(gn(b)){if(($m(a)||bn(a))&&(a=hn(f.prev,!0),c(a)))return a;for(;a=hn(f.prev,e);)if(c(a))return a}if(fn(b)){if(($m(a)||bn(a))&&(a=hn(f.next,!0),c(a)))return a;for(;a=hn(f.next,e);)if(c(a))return a}return null},kn=function(a,b){for(;a&&a!==b;){if(_m(a))return a;a=a.parentNode}return null},ln=function(a,b,c){return kn(a.container(),c)===kn(b.container(),c)},mn=function(a,b){var c,d;return b?(c=b.container(),d=b.offset(),dn(c)?c.childNodes[d+a]:null):null},nn=function(a,b){var c=b.ownerDocument.createRange();return a?(c.setStartBefore(b),c.setEndBefore(b)):(c.setStartAfter(b),c.setEndAfter(b)),c},on=function(a,b,c){return kn(b,a)===kn(c,a)},pn=function(a,b,c){var d,e;for(e=a?"previousSibling":"nextSibling";c&&c!==b;){if(d=c[e],an(d)&&(d=d[e]),$m(d)){if(on(b,d,c))return d;break}if(en(d))break;c=c.parentNode}return null},qn=cn(nn,!0),rn=cn(nn,!1),sn=function(a,b,c){var d,e,f,g,h=cn(pn,!0,b),i=cn(pn,!1,b);if(e=c.startContainer,f=c.startOffset,lj(e)){if(dn(e)||(e=e.parentNode),"before"===(g=e.getAttribute("data-mce-caret"))&&(d=e.nextSibling,Zm(d)))return qn(d);if("after"===g&&(d=e.previousSibling,Zm(d)))return rn(d)}if(!c.collapsed)return c;if(oi.isText(e)){if(an(e)){if(1===a){if(d=i(e))return qn(d);if(d=h(e))return rn(d)}if(-1===a){if(d=h(e))return rn(d);if(d=i(e))return qn(d)}return c}if(vj(e)&&f>=e.data.length-1)return 1===a&&(d=i(e))?qn(d):c;if(uj(e)&&f<=1)return-1===a&&(d=h(e))?rn(d):c;if(f===e.data.length)return d=i(e),d?qn(d):c;if(0===f)return d=h(e),d?rn(d):c}return c},tn=function(a,b){var c=mn(a,b);return $m(c)&&!oi.isBogusAll(c)},un=function(a,b){return oi.isTable(mn(a,b))},vn=function(a,b){return Ha.from(mn(a?0:-1,b)).filter($m)},wn=function(a,b,c){var d=sn(a,b,c);return-1===a?x.fromRangeStart(d):x.fromRangeEnd(d)},xn=cn(tn,0),yn=cn(tn,-1),zn=cn(un,0),An=cn(un,-1);!function(a){a[a.Backwards=-1]="Backwards",a[a.Forwards=1]="Forwards"}(ol||(ol={}));var Bn=oi.isContentEditableFalse,Cn=oi.isText,Dn=oi.isElement,En=oi.isBr,Fn=Hj,Gn=Mj,Hn=Nj,In=function(a,b){for(var c=[];a&&a!==b;)c.push(a),a=a.parentNode;return c},Jn=function(a,b){return a.hasChildNodes()&&b<a.childNodes.length?a.childNodes[b]:null},Kn=function(a,b){if(fn(a)){if(Fn(b.previousSibling)&&!Cn(b.previousSibling))return Jk.before(b);if(Cn(b))return Jk(b,0)}if(gn(a)){if(Fn(b.nextSibling)&&!Cn(b.nextSibling))return Jk.after(b);if(Cn(b))return Jk(b,b.data.length)}return gn(a)?En(b)?Jk.before(b):Jk.after(b):Jk.before(b)},Ln=function(a,b){var c;return!!oi.isBr(a)&&(!!(c=Mn(1,Jk.after(a),b))&&!ln(Jk.before(a),Jk.before(c),b))},Mn=function(a,b,c){var d,e,f,g,h;if(!Dn(c)||!b)return null;if(b.isEqual(Jk.after(c))&&c.lastChild){if(h=Jk.after(c.lastChild),gn(a)&&Fn(c.lastChild)&&Dn(c.lastChild))return En(c.lastChild)?Jk.before(c.lastChild):h}else h=b;var i=h.container(),j=h.offset();if(Cn(i)){if(gn(a)&&j>0)return Jk(i,--j);if(fn(a)&&j<i.length)return Jk(i,++j);d=i}else{if(gn(a)&&j>0&&(e=Jn(i,j-1),Fn(e)))return!Gn(e)&&(f=jn(e,a,Hn,e))?Cn(f)?Jk(f,f.data.length):Jk.after(f):Cn(e)?Jk(e,e.data.length):Jk.before(e);if(fn(a)&&j<i.childNodes.length&&(e=Jn(i,j),Fn(e)))return En(e)&&c.lastChild===e?null:Ln(e,c)?Mn(a,Jk.after(e),c):!Gn(e)&&(f=jn(e,a,Hn,e))?Cn(f)?Jk(f,0):Jk.before(f):Cn(e)?Jk(e,0):Jk.after(e);d=e||h.getNode()}return(fn(a)&&h.isAtEnd()||gn(a)&&h.isAtStart())&&(d=jn(d,a,jk.constant(!0),c,!0),Hn(d,c))?Kn(a,d):(e=jn(d,a,Hn,c),g=md.last(md.filter(In(i,c),Bn)),!g||e&&g.contains(e)?e?Kn(a,e):null:h=fn(a)?Jk.after(g):Jk.before(g))},Nn=function(a){return{next:function(b){return Mn(ol.Forwards,b,a)},prev:function(b){return Mn(ol.Backwards,b,a)}}},On=function(a){return a.firstChild&&a.firstChild===a.lastChild},Pn=function(a){return"br"===a.name||""===a.value},Qn=function(a,b){return a.getBlockElements()[b.name]&&On(b)&&Pn(b.firstChild)},Rn=function(a,b){var c=a.getNonEmptyElements();return b&&(b.isEmpty(c)||Qn(a,b))},Sn=function(a,b){var c=b.firstChild,d=b.lastChild;return c&&"meta"===c.name&&(c=c.next),d&&"mce_marker"===d.attr("id")&&(d=d.prev),Rn(a,d)&&(d=d.prev),!(!c||c!==d)&&("ul"===c.name||"ol"===c.name)},Tn=function(a){var b=a.firstChild,c=a.lastChild;return b&&"META"===b.nodeName&&b.parentNode.removeChild(b),c&&"mce_marker"===c.id&&c.parentNode.removeChild(c),a},Un=function(a,b,c){var d=b.serialize(c),e=a.createFragment(d);return Tn(e)},Vn=function(a){return zd.grep(a.childNodes,function(a){return"LI"===a.nodeName})},Wn=function(a){return""===a.data||oi.isBr(a)},Xn=function(a){return a&&a.firstChild&&a.firstChild===a.lastChild&&Wn(a.firstChild)},Yn=function(a){return!a.firstChild||Xn(a)},Zn=function(a){return a.length>0&&Yn(a[a.length-1])?a.slice(0,-1):a},$n=function(a,b){var c=a.getParent(b,a.isBlock);return c&&"LI"===c.nodeName?c:null},_n=function(a,b){return!!$n(a,b)},ao=function(a,b){var c=b.cloneRange(),d=b.cloneRange();return c.setStartBefore(a),d.setEndAfter(a),[c.cloneContents(),d.cloneContents()]},bo=function(a,b){var c=Jk.before(a),d=Nn(b),e=d.next(c);return e?e.toRange():null},co=function(a,b){var c=Jk.after(a),d=Nn(b),e=d.prev(c);return e?e.toRange():null},eo=function(a,b,c,d){var e=ao(a,d),f=a.parentNode;return f.insertBefore(e[0],a),zd.each(b,function(b){f.insertBefore(b,a)}),f.insertBefore(e[1],a),f.removeChild(a),co(b[b.length-1],c)},fo=function(a,b,c){var d=a.parentNode;return zd.each(b,function(b){d.insertBefore(b,a)}),bo(a,c)},go=function(a,b,c,d){return d.insertAfter(b.reverse(),a),co(b[0],c)},ho=function(a,b,c,d){var e=Un(b,a,d),f=$n(b,c.startContainer),g=Zn(Vn(e.firstChild)),h=b.getRoot(),i=function(a){var d=Jk.fromRangeStart(c),e=Nn(b.getRoot()),g=1===a?e.prev(d):e.next(d);return!g||$n(b,g.getNode())!==f};return i(1)?fo(f,g,h):i(2)?go(f,g,h,b):eo(f,g,h,c)},io={isListFragment:Sn,insertAtCaret:ho,isParentBlockLi:_n,trimListItems:Zn,listItems:Vn},jo=oi.isText,ko=oi.isBogus,lo=_i.nodeIndex,mo=function(a){var b=a.parentNode;return ko(b)?mo(b):b},no=function(a){return a?md.reduce(a.childNodes,function(a,b){return ko(b)&&"BR"!==b.nodeName?a=a.concat(no(b)):a.push(b),a},[]):[]},oo=function(a,b){for(;(a=a.previousSibling)&&jo(a);)b+=a.data.length;return b},po=function(a){return function(b){return a===b}},qo=function(a){var b,c,d;return b=no(mo(a)),c=md.findIndex(b,po(a),a),b=b.slice(0,c+1),d=md.reduce(b,function(a,c,d){return jo(c)&&jo(b[d-1])&&a++,a},0),b=md.filter(b,oi.matchNodeNames(a.nodeName)),(c=md.findIndex(b,po(a),a))-d},ro=function(a){return(jo(a)?"text()":a.nodeName.toLowerCase())+"["+qo(a)+"]"},so=function(a,b,c){var d=[];for(b=b.parentNode;b!==a&&(!c||!c(b));b=b.parentNode)d.push(b);return d},to=function(a,b){var c,d,e,f,g,h=[];return c=b.container(),d=b.offset(),jo(c)?e=oo(c,d):(f=c.childNodes,d>=f.length?(e="after",d=f.length-1):e="before",c=f[d]),h.push(ro(c)),g=so(a,c),g=md.filter(g,jk.negate(oi.isBogus)),h=h.concat(md.map(g,function(a){return ro(a)})),h.reverse().join("/")+","+e},uo=function(a,b,c){var d=no(a);return d=md.filter(d,function(a,b){return!jo(a)||!jo(d[b-1])}),d=md.filter(d,oi.matchNodeNames(b)),d[c]},vo=function(a,b){for(var c,d=a,e=0;jo(d);){if(c=d.data.length,b>=e&&b<=e+c){a=d,b-=e;break}if(!jo(d.nextSibling)){a=d,b=c;break}e+=c,d=d.nextSibling}return jo(a)&&b>a.data.length&&(b=a.data.length),Jk(a,b)},wo=function(a,b){var c,d,e;return b?(c=b.split(","),b=c[0].split("/"),e=c.length>1?c[1]:"before",d=md.reduce(b,function(a,b){return(b=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(b))?("text()"===b[1]&&(b[1]="#text"),uo(a,b[1],parseInt(b[2],10))):null},a),d?jo(d)?vo(d,parseInt(e,10)):(e="after"===e?lo(d)+1:lo(d),Jk(d.parentNode,e)):null):null},xo=oi.isContentEditableFalse,yo=function(a,b,c){var d,e;for(e=a(b.data.slice(0,c)).length,d=b.previousSibling;d&&oi.isText(d);d=d.previousSibling)e+=a(d.data).length;return e},zo=function(a,b,c,d,e){var f,g=d[e?"startContainer":"endContainer"],h=d[e?"startOffset":"endOffset"],i=[],j=0,k=a.getRoot();for(oi.isText(g)?i.push(c?yo(b,g,h):h):(f=g.childNodes,h>=f.length&&f.length&&(j=1,h=Math.max(0,f.length-1)),i.push(a.nodeIndex(f[h],c)+j));g&&g!==k;g=g.parentNode)i.push(a.nodeIndex(g,c));return i},Ao=function(a,b,c,d){var e=b.dom,f={};return f.start=zo(e,a,c,d,!0),b.isCollapsed()||(f.end=zo(e,a,c,d,!1)),f},Bo=function(a){oi.isText(a)&&0===a.data.length&&a.parentNode.removeChild(a)},Co=function(a,b,c){var d=0;return zd.each(a.select(b),function(a){if("all"!==a.getAttribute("data-mce-bogus"))return a!==c&&void d++}),d},Do=function(a,b){var c,d,e,f=b?"start":"end";c=a[f+"Container"],d=a[f+"Offset"],oi.isElement(c)&&"TR"===c.nodeName&&(e=c.childNodes,(c=e[Math.min(b?d:d-1,e.length-1)])&&(d=b?0:c.childNodes.length,a["set"+(b?"Start":"End")](c,d)))},Eo=function(a){return Do(a,!0),Do(a,!1),a},Fo=function(a,b){var c;if(oi.isElement(a)&&(a=$j(a,b),xo(a)))return a;if(nj(a)){if(oi.isText(a)&&lj(a)&&(a=a.parentNode),c=a.previousSibling,xo(c))return c;if(c=a.nextSibling,xo(c))return c}},Go=function(a){return Fo(a.startContainer,a.startOffset)||Fo(a.endContainer,a.endOffset)},Ho=function(a,b,c){var d=c.getNode(),e=d?d.nodeName:null,f=c.getRng();if(xo(d)||"IMG"===e)return{name:e,index:Co(c.dom,e,d)};var g=Go(f);return g?(e=g.tagName,{name:e,index:Co(c.dom,e,g)}):Ao(a,c,b,f)},Io=function(a){var b=a.getRng();return{start:to(a.dom.getRoot(),Jk.fromRangeStart(b)),end:to(a.dom.getRoot(),Jk.fromRangeEnd(b))}},Jo=function(a){return{rng:a.getRng()}},Ko=function(a,b,c){var d={"data-mce-type":"bookmark",id:b,style:"overflow:hidden;line-height:0px"};return c?a.create("span",d,"&#xFEFF;"):a.create("span",d)},Lo=function(a,b){var c=a.dom,d=a.getRng(),e=c.uniqueId(),f=a.isCollapsed(),g=a.getNode(),h=g.nodeName;if("IMG"===h)return{name:h,index:Co(c,h,g)};var i=Eo(d.cloneRange());if(!f){i.collapse(!1);var j=Ko(c,e+"_end",b);i.insertNode(j),Bo(j.nextSibling)}d=Eo(d),d.collapse(!0);var k=Ko(c,e+"_start",b);return d.insertNode(k),Bo(k.previousSibling),a.moveToBookmark({id:e,keep:1}),{id:e}},Mo=function(a,b,c){return 2===b?Ho(ij.trim,c,a):3===b?Io(a):b?Jo(a):Lo(a,!1)},No={getBookmark:Mo,getUndoBookmark:Aa.curry(Ho,Aa.identity,!0),getPersistentBookmark:Lo},Oo=function(a){return oi.isElement(a)&&"_mce_caret"===a.id},Po=function(a,b){for(;b&&b!==a;){if("_mce_caret"===b.id)return b;b=b.parentNode}return null},Qo=function(a){return"string"==typeof a.start},Ro=function(a){return a.hasOwnProperty("rng")},So=function(a){return a.hasOwnProperty("id")},To=function(a){return a.hasOwnProperty("name")},Uo=function(a){return zd.isArray(a.start)},Vo=function(a,b){
return!a.isBlock(b)||b.innerHTML||Ib.ie||(b.innerHTML='<br data-mce-bogus="1" />'),b},Wo=function(a,b){var c,d;return c=a.createRng(),d=wo(a.getRoot(),b.start),c.setStart(d.container(),d.offset()),d=wo(a.getRoot(),b.end),c.setEnd(d.container(),d.offset()),c},Xo=function(a,b){var c=a.ownerDocument.createTextNode(ij.ZWSP);a.appendChild(c),b.setStart(c,0),b.setEnd(c,0)},Yo=function(a){return!1===a.hasChildNodes()},Zo=function(a,b){return gl.lastPositionIn(a).fold(function(){return!1},function(a){return b.setStart(a.container(),a.offset()),b.setEnd(a.container(),a.offset()),!0})},$o=function(a,b,c){return!(!Yo(b)||!Po(a,b))&&(Xo(b,c),!0)},_o=function(a,b,c,d){var e,f,g,h,i=c[b?"start":"end"],j=a.getRoot();if(i){for(g=i[0],f=j,e=i.length-1;e>=1;e--){if(h=f.childNodes,$o(j,f,d))return!0;if(i[e]>h.length-1)return!!$o(j,f,d)||Zo(f,d);f=h[i[e]]}3===f.nodeType&&(g=Math.min(i[0],f.nodeValue.length)),1===f.nodeType&&(g=Math.min(i[0],f.childNodes.length)),b?d.setStart(f,g):d.setEnd(f,g)}return!0},ap=function(a){return oi.isText(a)&&a.data.length>0},bp=function(a,b,c){var d,e,f,g,h,i,j=a.get(c.id+"_"+b),k=c.keep;if(j){if(d=j.parentNode,"start"===b?(k?j.hasChildNodes()?(d=j.firstChild,e=1):ap(j.nextSibling)?(d=j.nextSibling,e=0):ap(j.previousSibling)?(d=j.previousSibling,e=j.previousSibling.data.length):(d=j.parentNode,e=a.nodeIndex(j)+1):e=a.nodeIndex(j),h=d,i=e):(k?j.hasChildNodes()?(d=j.firstChild,e=1):ap(j.previousSibling)?(d=j.previousSibling,e=j.previousSibling.data.length):(d=j.parentNode,e=a.nodeIndex(j)):e=a.nodeIndex(j),h=d,i=e),!k){for(g=j.previousSibling,f=j.nextSibling,zd.each(zd.grep(j.childNodes),function(a){oi.isText(a)&&(a.nodeValue=a.nodeValue.replace(/\uFEFF/g,""))});j=a.get(c.id+"_"+b);)a.remove(j,!0);g&&f&&g.nodeType===f.nodeType&&oi.isText(g)&&!Ib.opera&&(e=g.nodeValue.length,g.appendData(f.nodeValue),a.remove(f),h=g,i=e)}return Ha.some(Jk(h,i))}return Ha.none()},cp=function(a,b){return a.isSome()?a:b},dp=function(a,b){var c=a.createRng();return _o(a,!0,b,c)&&_o(a,!1,b,c)?Ha.some(c):Ha.none()},ep=function(a,b){var c=bp(a,"start",b),d=bp(a,"end",b);return nk.liftN([c,cp(d,c)],function(b,c){var d=a.createRng();return d.setStart(Vo(a,b.container()),b.offset()),d.setEnd(Vo(a,c.container()),c.offset()),d})},fp=function(a,b){return Ha.from(a.select(b.name)[b.index]).map(function(b){var c=a.createRng();return c.selectNode(b),c})},gp=function(a,b){var c=a.dom;if(b){if(Uo(b))return dp(c,b);if(Qo(b))return Ha.some(Wo(c,b));if(So(b))return ep(c,b);if(To(b))return fp(c,b);if(Ro(b))return Ha.some(b.rng)}return Ha.none()},hp={resolve:gp},ip=function(a,b,c){return No.getBookmark(a,b,c)},jp=function(a,b){hp.resolve(a,b).each(function(b){a.setRng(b)})},kp=function(a){return oi.isElement(a)&&"SPAN"===a.tagName&&"bookmark"===a.getAttribute("data-mce-type")},lp={getBookmark:ip,moveToBookmark:jp,isBookmarkNode:kp},mp=zd.each,np=function(a){this.compare=function(b,c){if(b.nodeName!==c.nodeName)return!1;var d=function(b){var c={};return mp(a.getAttribs(b),function(d){var e=d.nodeName.toLowerCase();0!==e.indexOf("_")&&"style"!==e&&0!==e.indexOf("data-")&&(c[e]=a.getAttrib(b,e))}),c},e=function(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)){if(void 0===(c=b[d]))return!1;if(a[d]!==c)return!1;delete b[d]}for(d in b)if(b.hasOwnProperty(d))return!1;return!0};return!!e(d(b),d(c))&&(!!e(a.parseStyle(a.getAttrib(b,"style")),a.parseStyle(a.getAttrib(c,"style")))&&(!lp.isBookmarkNode(b)&&!lp.isBookmarkNode(c)))}},op=function(a,b){ob.each(b,function(b){Cm.before(a,b)})},pp=function(a,b){ob.each(b,function(c,d){var e=0===d?a:b[d-1];Cm.after(e,c)})},qp=function(a,b){ob.each(b.slice().reverse(),function(b){Cm.prepend(a,b)})},rp=function(a,b){ob.each(b,function(b){Cm.append(a,b)})},sp={before:op,after:pp,prepend:qp,append:rp},tp=function(a){a.dom().textContent="",ob.each(hh.children(a),function(a){up(a)})},up=function(a){var b=a.dom();null!==b.parentNode&&b.parentNode.removeChild(b)},vp=function(a){var b=hh.children(a);b.length>0&&sp.before(a,b),up(a)},wp={empty:tp,remove:up,unwrap:vp},xp=function(a,b){var c=function(c){if(!a(c))throw new Error("Can only get "+b+" value of a "+b+" node");return g(c).getOr("")},d=function(a){try{return e(a)}catch(a){return Ha.none()}},e=function(b){return a(b)?Ha.from(b.dom().nodeValue):Ha.none()},f=df.detect().browser,g=f.isIE()&&10===f.version.major?d:e;return{get:c,getOption:g,set:function(c,d){if(!a(c))throw new Error("Can only set raw "+b+" value of a "+b+" node");c.dom().nodeValue=d}}}(uf.isText,"text"),yp=function(a){return xp.get(a)},zp=function(a){return xp.getOption(a)},Ap=function(a,b){xp.set(a,b)},Bp={get:yp,getOption:zp,set:Ap},Cp=function(a){for(var b=[],c=a.dom();c;)b.push(kf.fromDom(c)),c=c.lastChild;return b},Dp=function(a){var b=Nl.descendants(a,"br"),c=ob.filter(Cp(a).slice(-1),Rh);b.length===c.length&&ob.each(c,wp.remove)},Ep=function(a){wp.empty(a),Cm.append(a,kf.fromHtml('<br data-mce-bogus="1">'))},Fp=function(a){return uf.isText(a)?""===Bp.get(a):Rh(a)},Gp=function(a){return 1===ob.filter(hh.children(a),Fp).length},Hp=function(a){hh.lastChild(a).each(function(b){hh.prevSibling(b).each(function(c){Ph(a)&&Rh(b)&&Ph(c)&&wp.remove(b)})})},Ip={removeTrailingBr:Dp,fillWithPaddingBr:Ep,isPaddedElement:Gp,trimBlockTrailingBr:Hp},Jp=zd.makeMap,Kp=function(a,b,c,d){var e=document.createRange();return e.setStart(a,b),e.setEnd(c,d),e},Lp=function(a){var b=Jk.fromRangeStart(a),c=Jk.fromRangeEnd(a),d=a.commonAncestorContainer;return gl.fromPosition(!1,d,c).map(function(e){return!ln(b,c,d)&&ln(b,e,d)?Kp(b.container(),b.offset(),e.container(),e.offset()):a}).getOr(a)},Mp=function(a){return a.collapsed?a:Lp(a)},Np={normalize:Mp},Op=oi.matchNodeNames("td th"),Pp=function(a,b,c){if("all"===c.getAttribute("data-mce-bogus"))c.parentNode.insertBefore(a.dom.createFragment(b),c);else{var d=c.firstChild,e=c.lastChild;!d||d===e&&"BR"===d.nodeName?a.dom.setHTML(c,b):a.selection.setContent(b)}},Qp=function(a,b){Ha.from(a.getParent(b,"td,th")).map(kf.fromDom).each(Ip.trimBlockTrailingBr)},Rp=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=a.schema.getTextInlineElements(),q=a.selection,r=a.dom,s=function(a){return!!a.getAttribute("data-mce-fragment")};if(/^ | $/.test(b)&&(b=function(a){var b,c,d;b=q.getRng(),c=b.startContainer,d=b.startOffset;var e=function(a){return c[a]&&3===c[a].nodeType};return 3===c.nodeType&&(d>0?a=a.replace(/^&nbsp;/," "):e("previousSibling")||(a=a.replace(/^ /,"&nbsp;")),d<c.length?a=a.replace(/&nbsp;(<br>|)$/," "):e("nextSibling")||(a=a.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),a}(b)),d=a.parser,o=c.merge,e=z({validate:a.settings.validate},a.schema),n='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',i={content:b,format:"html",selection:!0,paste:c.paste},i=a.fire("BeforeSetContent",i),i.isDefaultPrevented())return void a.fire("SetContent",{content:i.content,format:"html",selection:!0,paste:c.paste});b=i.content,-1===b.indexOf("{$caret}")&&(b+="{$caret}"),b=b.replace(/\{\$caret\}/,n),k=q.getRng();var t=k.startContainer||(k.parentElement?k.parentElement():null),u=a.getBody();t===u&&q.isCollapsed()&&r.isBlock(u.firstChild)&&function(b){return b&&!a.schema.getShortEndedElements()[b.nodeName]}(u.firstChild)&&r.isEmpty(u.firstChild)&&(k=r.createRng(),k.setStart(u.firstChild,0),k.setEnd(u.firstChild,0),q.setRng(k)),q.isCollapsed()||(a.selection.setRng(Np.normalize(a.selection.getRng())),a.getDoc().execCommand("Delete",!1,null),function(){var a,c,d;a=q.getRng(),c=a.startContainer,d=a.startOffset,3===c.nodeType&&a.collapsed&&(""===c.data[d]?(c.deleteData(d,1),/[\u00a0| ]$/.test(b)||(b+=" ")):""===c.data[d-1]&&(c.deleteData(d-1,1),/[\u00a0| ]$/.test(b)||(b=" "+b)))}()),f=q.getNode();var v={context:f.nodeName.toLowerCase(),data:c.data,insert:!0};if(h=d.parse(b,v),!0===c.paste&&io.isListFragment(a.schema,h)&&io.isParentBlockLi(r,f))return k=io.insertAtCaret(e,r,a.selection.getRng(),h),a.selection.setRng(k),void a.fire("SetContent",i);if(function(a){for(var b=a;b=b.walk();)1===b.type&&b.attr("data-mce-fragment","1")}(h),l=h.lastChild,"mce_marker"===l.attr("id"))for(j=l,l=l.prev;l;l=l.walk(!0))if(3===l.type||!r.isBlock(l.name)){a.schema.isValidChild(l.parent.name,"span")&&l.parent.insert(j,l,"br"===l.name);break}if(a._selectionOverrides.showBlockCaretContainer(f),v.invalid){for(q.setContent(n),f=q.getNode(),g=a.getBody(),9===f.nodeType?f=l=g:l=f;l!==g;)f=l,l=l.parentNode;b=f===g?g.innerHTML:r.getOuterHTML(f),b=e.serialize(d.parse(b.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return e.serialize(h)}))),f===g?r.setHTML(g,b):r.setOuterHTML(f,b)}else b=e.serialize(h),Pp(a,b,f);!function(){if(o){var b=a.getBody(),c=new np(r);zd.each(r.select("*[data-mce-fragment]"),function(a){for(var d=a.parentNode;d&&d!==b;d=d.parentNode)p[a.nodeName.toLowerCase()]&&c.compare(d,a)&&r.remove(a,!0)})}}(),function(b){var c,d,e;if(b){if(q.scrollIntoView(b),c=function(b){for(var c=a.getBody();b&&b!==c;b=b.parentNode)if("false"===a.dom.getContentEditable(b))return b;return null}(b))return r.remove(b),void q.select(c);k=r.createRng(),l=b.previousSibling,l&&3===l.nodeType?(k.setStart(l,l.nodeValue.length),Ib.ie||(m=b.nextSibling)&&3===m.nodeType&&(l.appendData(m.data),m.parentNode.removeChild(m))):(k.setStartBefore(b),k.setEndBefore(b));d=r.getParent(b,r.isBlock),r.remove(b),d&&r.isEmpty(d)&&(a.$(d).empty(),k.setStart(d,0),k.setEnd(d,0),Op(d)||s(d)||!(e=function(b){var c=Jk.fromRangeStart(b);if(c=Nn(a.getBody()).next(c))return c.toRange()}(k))?r.add(d,r.create("br",{"data-mce-bogus":"1"})):(k=e,r.remove(d))),q.setRng(k)}}(r.get("mce_marker")),function(a){zd.each(a.getElementsByTagName("*"),function(a){a.removeAttribute("data-mce-fragment")})}(a.getBody()),Qp(a.dom,a.selection.getStart()),a.fire("SetContent",i),a.addVisual()},Sp=function(a){var b;return"string"!=typeof a?(b=zd.extend({paste:a.paste,data:{paste:a.paste}},a),{content:a.content,details:b}):{content:a,details:{}}},Tp=function(a,b){var c=Sp(b);Rp(a,c.content,c.details)},Up={insertAtCaret:Tp},Vp=function(a){return $p(Tf.body(),a)},Wp=function(a,b,c){for(var d=a.dom(),e=Ka.isFunction(c)?c:Aa.constant(!1);d.parentNode;){d=d.parentNode;var f=kf.fromDom(d);if(b(f))return Ha.some(f);if(e(f))break}return Ha.none()},Xp=function(a,b,c){return A(function(a){return b(a)},Wp,a,b,c)},Yp=function(a,b){var c=a.dom();return c.parentNode?Zp(kf.fromDom(c.parentNode),function(c){return!Og.eq(a,c)&&b(c)}):Ha.none()},Zp=function(a,b){return ob.find(a.dom().childNodes,Aa.compose(b,kf.fromDom)).map(kf.fromDom)},$p=function(a,b){var c=function(a){for(var d=0;d<a.childNodes.length;d++){if(b(kf.fromDom(a.childNodes[d])))return Ha.some(kf.fromDom(a.childNodes[d]));var e=c(a.childNodes[d]);if(e.isSome())return e}return Ha.none()};return c(a.dom())},_p={first:Vp,ancestor:Wp,closest:Xp,sibling:Yp,child:Zp,descendant:$p},aq=sg.immutable("sections","settings"),bq=df.detect(),cq=bq.deviceType.isTouch(),dq=["lists","autolink","autosave"],eq={theme:"mobile"},fq=function(a){var b=Ka.isArray(a)?a.join(" "):a,c=ob.map(Ka.isString(b)?b.split(" "):[],We.trim);return ob.filter(c,function(a){return a.length>0})},gq=function(a){return ob.filter(a,Aa.curry(ob.contains,dq))},hq=function(a,b){var c=Ef.bifilter(b,function(b,c){return ob.contains(a,c)});return aq(c.t,c.f)},iq=function(a,b,c){var d=a.sections(),e=d.hasOwnProperty(b)?d[b]:{};return zd.extend({},c,e)},jq=function(a,b){return a.sections().hasOwnProperty(b)},kq=function(a,b,c){return{id:a,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:b,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:c.convertURL,url_converter_scope:c,ie7_compat:!0}},lq=function(a,b){var c=b.external_plugins?b.external_plugins:{};return a&&a.external_plugins?zd.extend({},a.external_plugins,c):c},mq=function(a,b){return[].concat(fq(a)).concat(fq(b))},nq=function(a,b,c,d){var e=fq(c.forced_plugins),f=fq(d.plugins),g=a&&jq(b,"mobile")?gq(f):f,h=mq(e,g);return zd.extend(d,{plugins:h.join(" ")})},oq=function(a,b){var c=b.settings().inline;return a&&jq(b,"mobile")&&!c},pq=function(a,b,c,d){var e=hq(["mobile"],d),f=zd.extend(b,c,e.settings(),oq(a,e)?iq(e,"mobile",eq):{},{validate:!0,content_editable:e.settings().inline,external_plugins:lq(c,e.settings())});return nq(a,e,c,f)},qq=function(a,b,c,d,e){var f=kq(b,c,a);return pq(cq,f,d,e)},rq=function(a,b,c){return Ha.from(b.settings[c]).filter(a)},sq=Aa.curry(rq,Ka.isString),tq=function(a){var b={};return"string"==typeof a?ob.each(a.indexOf("=")>0?a.split(/[;,](?![^=;,]*(?:[;,]|$))/):a.split(","),function(a){var c=a.split("=");c.length>1?b[zd.trim(c[0])]=zd.trim(c[1]):b[zd.trim(c[0])]=zd.trim(c)}):b=a,b},uq=function(a){return function(b){return Ka.isArray(b)&&ob.forall(b,a)}},vq=function(a,b,c,d){var e=b in a.settings?a.settings[b]:c;return"hash"===d?tq(e):"string"===d?rq(Ka.isString,a,b).getOr(c):"number"===d?rq(Ka.isNumber,a,b).getOr(c):"boolean"===d?rq(Ka.isBoolean,a,b).getOr(c):"object"===d?rq(Ka.isObject,a,b).getOr(c):"array"===d?rq(Ka.isArray,a,b).getOr(c):"string[]"===d?rq(uq(Ka.isString),a,b).getOr(c):"function"===d?rq(Ka.isFunction,a,b).getOr(c):e},wq=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,xq=function(a){return wq.test(a)},yq=function(a,b){var c=sq(a,"inline_boundaries_selector").getOr("a[href],code");return Gg.is(kf.fromDom(b),c)},zq=function(a){return"rtl"===_i.DOM.getStyle(a,"direction",!0)||xq(a.textContent)},Aq=function(a,b,c){return ob.filter(_i.DOM.getParents(c.container(),"*",b),a)},Bq=function(a,b,c){var d=Aq(a,b,c);return Ha.from(d[d.length-1])},Cq=function(a,b,c){var d=kn(b,a),e=kn(c,a);return d&&d===e},Dq=function(a){return qj(a)||rj(a)},Eq=function(a,b){var c=b.container(),d=b.offset();return a?mj(c)?oi.isText(c.nextSibling)?Jk(c.nextSibling,0):Jk.after(c):qj(b)?Jk(c,d+1):b:mj(c)?oi.isText(c.previousSibling)?Jk(c.previousSibling,c.previousSibling.data.length):Jk.before(c):rj(b)?Jk(c,d-1):b},Fq=Aa.curry(Eq,!0),Gq=Aa.curry(Eq,!1),Hq={isInlineTarget:yq,findRootInline:Bq,isRtl:zq,isAtZwsp:Dq,normalizePosition:Eq,normalizeForwards:Fq,normalizeBackwards:Gq,hasSameParentBlock:Cq},Iq=function(a){return function(b){return Og.eq(a,kf.fromDom(b.dom().parentNode))}},Jq=function(a,b){return Og.contains(a,b)?_p.closest(b,function(a){return Sh(a)||Uh(a)},Iq(a)):Ha.none()},Kq=function(a){var b=a.getBody(),c=b.firstChild&&a.dom.isBlock(b.firstChild)?b.firstChild:b;a.selection.setCursorLocation(c,0)},Lq=function(a){a.dom.isEmpty(a.getBody())&&(a.setContent(""),Kq(a))},Mq=function(a,b,c){return nk.liftN([gl.firstPositionIn(c),gl.lastPositionIn(c)],function(d,e){var f=Hq.normalizePosition(!0,d),g=Hq.normalizePosition(!1,e),h=Hq.normalizePosition(!1,b);return a?gl.nextPosition(c,h).map(function(a){return a.isEqual(g)&&b.isEqual(f)}).getOr(!1):gl.prevPosition(c,h).map(function(a){return a.isEqual(f)&&b.isEqual(g)}).getOr(!1)}).getOr(!0)},Nq={getParentBlock:Jq,paddEmptyBody:Lq,willDeleteLastPositionInElement:Mq},Oq=function(a){return Gg.one(a)},Pq=function(a,b,c){return _p.ancestor(a,function(a){return Gg.is(a,b)},c)},Qq=function(a,b){return _p.sibling(a,function(a){return Gg.is(a,b)})},Rq=function(a,b){return _p.child(a,function(a){return Gg.is(a,b)})},Sq=function(a,b){return Gg.one(b,a)},Tq=function(a,b,c){return A(Gg.is,Pq,a,b,c)},Uq={first:Oq,ancestor:Pq,sibling:Qq,child:Rq,descendant:Sq,closest:Tq},Vq=function(a){return Uq.first(a).isSome()},Wq=function(a,b,c){return Uq.ancestor(a,b,c).isSome()},Xq=function(a,b){return Uq.sibling(a,b).isSome()},Yq=function(a,b){return Uq.child(a,b).isSome()},Zq=function(a,b){return Uq.descendant(a,b).isSome()},$q=function(a,b,c){return Uq.closest(a,b,c).isSome()},_q={any:Vq,ancestor:Wq,sibling:Xq,child:Yq,descendant:Zq,closest:$q},ar=function(a,b){var c=kf.fromDom(a),d=kf.fromDom(b);return _q.ancestor(d,"pre,code",Aa.curry(Og.eq,c))},br=function(a,b){return oi.isText(b)&&/^[ \t\r\n]*$/.test(b.data)&&!1===ar(a,b)},cr=function(a){return oi.isElement(a)&&"A"===a.nodeName&&a.hasAttribute("name")},dr=function(a,b){return Hj(b)&&!1===br(a,b)||cr(b)||er(b)},er=oi.hasAttribute("data-mce-bookmark"),fr=oi.hasAttribute("data-mce-bogus"),gr=oi.hasAttributeValue("data-mce-bogus","all"),hr=function(a){var b,c,d=0;if(dr(a,a))return!1;if(!(c=a.firstChild))return!0;b=new s(c,a);do{if(gr(c))c=b.next(!0);else if(fr(c))c=b.next();else if(oi.isBr(c))d++,c=b.next();else{if(dr(a,c))return!1;c=b.next()}}while(c);return d<=1},ir=function(a){return hr(a.dom())},jr={isEmpty:ir},kr=sg.immutable("block","position"),lr=sg.immutable("from","to"),mr=function(a,b){var c=kf.fromDom(a),d=kf.fromDom(b.container());return Nq.getParentBlock(c,d).map(function(a){return kr(a,b)})},nr=function(a){return!1===Og.eq(a.from().block(),a.to().block())},or=function(a){return hh.parent(a.from().block()).bind(function(b){return hh.parent(a.to().block()).filter(function(a){return Og.eq(b,a)})}).isSome()},pr=function(a){return!1===oi.isContentEditableFalse(a.from().block())&&!1===oi.isContentEditableFalse(a.to().block())},qr=function(a,b,c){return oi.isBr(c.position().getNode())&&!1===jr.isEmpty(c.block())?gl.positionIn(!1,c.block().dom()).bind(function(d){return d.isEqual(c.position())?gl.fromPosition(b,a,d).bind(function(b){return mr(a,b)}):Ha.some(c)}).getOr(c):c},rr=function(a,b,c){var d=mr(a,Jk.fromRangeStart(c)),e=d.bind(function(c){return gl.fromPosition(b,a,c.position()).bind(function(c){return mr(a,c).map(function(c){return qr(a,b,c)})})});return nk.liftN([d,e],lr).filter(function(a){return nr(a)&&or(a)&&pr(a)})},sr=function(a,b,c){return c.collapsed?rr(a,b,c):Ha.none()},tr={read:sr},ur=function(a){return a.slice(0,-1)},vr=function(a,b,c){return Og.contains(b,a)?ur(hh.parents(a,function(a){return c(a)||Og.eq(a,b)})):[]},wr=function(a,b){return vr(a,b,Aa.constant(!1))},xr=function(a,b){return[a].concat(wr(a,b))},yr={parentsUntil:vr,parents:wr,parentsAndSelf:xr},zr=function(a){var b=hh.children(a);return ob.findIndex(b,Ph).fold(function(){return b},function(a){return b.slice(0,a)})},Ar=function(a){var b=zr(a);return ob.each(b,function(a){wp.remove(a)}),b},Br=function(a,b){gl.positionIn(a,b.dom()).each(function(a){var b=a.getNode();oi.isBr(b)&&wp.remove(kf.fromDom(b))})},Cr=function(a,b){var c=yr.parentsAndSelf(b,a);return ob.find(c.reverse(),jr.isEmpty).each(wp.remove)},Dr=function(a,b){var c=hh.parents(b,function(b){return Og.eq(b,a)});return Ha.from(c[c.length-2])},Er=function(a,b){return Og.contains(b,a)?hh.parent(a).bind(function(c){return Og.eq(c,b)?Ha.some(a):Dr(b,a)}):Ha.none()},Fr=function(a,b,c){if(jr.isEmpty(c))return wp.remove(c),jr.isEmpty(b)&&Ip.fillWithPaddingBr(b),gl.firstPositionIn(b.dom());Br(!0,b),Br(!1,c);var d=Ar(b);return Er(b,c).fold(function(){Cr(a,b);var e=gl.lastPositionIn(c.dom());return ob.each(d,function(a){Cm.append(c,a)}),e},function(e){var f=gl.prevPosition(c.dom(),Jk.before(e.dom()));return ob.each(d,function(a){Cm.before(e,a)}),Cr(a,b),f})},Gr=function(a,b,c,d){return b?Fr(a,d,c):Fr(a,c,d)},Hr={mergeBlocks:Gr},Ir=function(a,b){var c,d=kf.fromDom(a.getBody());return c=tr.read(d.dom(),b,a.selection.getRng()).bind(function(a){return Hr.mergeBlocks(d,b,a.from().block(),a.to().block())}),c.each(function(b){a.selection.setRng(b.toRange())}),c.isSome()},Jr={backspaceDelete:Ir},Kr=function(a,b){var c=b.getRng();return nk.liftN([Nq.getParentBlock(a,kf.fromDom(c.startContainer)),Nq.getParentBlock(a,kf.fromDom(c.endContainer))],function(d,e){return!1===Og.eq(d,e)&&(c.deleteContents(),Hr.mergeBlocks(a,!0,d,e).each(function(a){b.setRng(a.toRange())}),!0)}).getOr(!1)},Lr=function(a,b){var c=kf.fromDom(b),d=Aa.curry(Og.eq,a);return _p.ancestor(c,Xh,d).isSome()},Mr=function(a,b){return Lr(a,b.startContainer)||Lr(a,b.endContainer)},Nr=function(a,b){var c=gl.prevPosition(a.dom(),Jk.fromRangeStart(b)).isNone(),d=gl.nextPosition(a.dom(),Jk.fromRangeEnd(b)).isNone();return!Mr(a,b)&&c&&d},Or=function(a){return a.setContent(""),a.selection.setCursorLocation(),!0},Pr=function(a){var b=kf.fromDom(a.getBody()),c=a.selection.getRng();return Nr(b,c)?Or(a):Kr(b,a.selection)},Qr=function(a,b){return!a.selection.isCollapsed()&&Pr(a)},Rr={backspaceDelete:Qr},Sr=function(a){if(!Ka.isArray(a))throw new Error("cases must be an array");if(0===a.length)throw new Error("there must be at least one case");var b=[],c={};return ob.each(a,function(d,e){var f=Ef.keys(d);if(1!==f.length)throw new Error("one and only one name per case");var g=f[0],h=d[g];if(void 0!==c[g])throw new Error("duplicate key detected:"+g);if("cata"===g)throw new Error("cannot have a case named cata (sorry)");if(!Ka.isArray(h))throw new Error("case arguments must be an array");b.push(g),c[g]=function(){var c=arguments.length;if(c!==h.length)throw new Error("Wrong number of arguments to case "+g+". Expected "+h.length+" ("+h+"), got "+c);for(var d=new Array(c),f=0;f<d.length;f++)d[f]=arguments[f];var i=function(a){var c=Ef.keys(a);if(b.length!==c.length)throw new Error("Wrong number of arguments to match. Expected: "+b.join(",")+"\nActual: "+c.join(","));if(!ob.forall(b,function(a){return ob.contains(c,a)}))throw new Error("Not all branches were specified when using match. Specified: "+c.join(", ")+"\nRequired: "+b.join(", "));return a[g].apply(null,d)};return{fold:function(){if(arguments.length!==a.length)throw new Error("Wrong number of arguments to fold. Expected "+a.length+", got "+arguments.length);return arguments[e].apply(null,d)},match:i,log:function(a){console.log(a,{constructors:b,constructor:g,params:d})}}}}),c},Tr={generate:Sr},Ur=function(a){return Xh(kf.fromDom(a))||Uh(kf.fromDom(a))},Vr=Tr.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Wr=function(a,b){var c=b.getNode(!1===a),d=a?"after":"before";return oi.isElement(c)&&c.getAttribute("data-mce-caret")===d},Xr=function(a,b,c,d){var e=function(b){return Qh(kf.fromDom(b))&&!ln(c,d,a)};return vn(!b,c).fold(function(){return vn(b,d).fold(Aa.constant(!1),e)},e)},Yr=function(a,b,c,d){var e=d.getNode(!1===b);return Nq.getParentBlock(kf.fromDom(a),kf.fromDom(c.getNode())).map(function(a){return jr.isEmpty(a)?Vr.remove(a.dom()):Vr.moveToElement(e)}).orThunk(function(){return Ha.some(Vr.moveToElement(e))})},Zr=function(a,b,c){return gl.fromPosition(b,a,c).bind(function(d){return Ur(d.getNode())?Ha.none():Xr(a,b,c,d)?Ha.none():b&&oi.isContentEditableFalse(d.getNode())?Yr(a,b,c,d):!1===b&&oi.isContentEditableFalse(d.getNode(!0))?Yr(a,b,c,d):b&&yn(c)?Ha.some(Vr.moveToPosition(d)):!1===b&&xn(c)?Ha.some(Vr.moveToPosition(d)):Ha.none()})},$r=function(a,b){return a&&oi.isContentEditableFalse(b.nextSibling)?Ha.some(Vr.moveToElement(b.nextSibling)):!1===a&&oi.isContentEditableFalse(b.previousSibling)?Ha.some(Vr.moveToElement(b.previousSibling)):Ha.none()},_r=function(a,b,c){return c.fold(function(a){return Ha.some(Vr.remove(a))},function(a){return Ha.some(Vr.moveToElement(a))},function(c){return ln(b,c,a)?Ha.none():Ha.some(Vr.moveToPosition(c))})},as=function(a,b,c){return Wr(b,c)?$r(b,c.getNode(!1===b)).fold(function(){return Zr(a,b,c)},Ha.some):Zr(a,b,c).bind(function(b){return _r(a,c,b)})},bs=function(a,b,c){var d=sn(b?1:-1,a,c),e=Jk.fromRangeStart(d);return!1===b&&yn(e)?Ha.some(Vr.remove(e.getNode(!0))):b&&xn(e)?Ha.some(Vr.remove(e.getNode())):as(a,b,e)},cs=function(a,b){var c=a.container(),d=a.offset();return!1===Jk.isTextPosition(a)&&c===b.parentNode&&d>Jk.before(b).offset()},ds=function(a,b){return cs(b,a)?Jk(b.container(),b.offset()-1):b},es=function(a){return oi.isText(a)?Jk(a,0):Jk.before(a)},fs=function(a){return oi.isText(a)?Jk(a,a.data.length):Jk.after(a)},gs=function(a){return Hj(a.previousSibling)?Ha.some(fs(a.previousSibling)):a.previousSibling?gl.lastPositionIn(a.previousSibling):Ha.none()},hs=function(a){return Hj(a.nextSibling)?Ha.some(es(a.nextSibling)):a.nextSibling?gl.firstPositionIn(a.nextSibling):Ha.none()},is=function(a,b){var c=Jk.before(b.previousSibling?b.previousSibling:b.parentNode);return gl.prevPosition(a,c).fold(function(){return gl.nextPosition(a,Jk.after(b))},Ha.some)},js=function(a,b){return gl.nextPosition(a,Jk.after(b)).fold(function(){return gl.prevPosition(a,Jk.before(b))},Ha.some)},ks=function(a,b){return gs(b).orThunk(function(){return hs(b)}).orThunk(function(){return is(a,b)})},ls=function(a,b){return hs(b).orThunk(function(){return gs(b)}).orThunk(function(){return js(a,b)})},ms=function(a,b,c){return a?ls(b,c):ks(b,c)},ns=function(a,b,c){return ms(a,b,c).map(Aa.curry(ds,c))},os=function(a,b,c){c.fold(function(){a.focus()},function(c){a.selection.setRng(c.toRange(),b)})},ps=function(a){return function(b){return b.dom()===a}},qs=function(a,b){return b&&a.schema.getBlockElements().hasOwnProperty(uf.name(b))},rs=function(a){if(jr.isEmpty(a)){var b=kf.fromHtml('<br data-mce-bogus="1">');return wp.empty(a),Cm.append(a,b),Ha.some(Jk.before(b.dom()))}return Ha.none()},ss=function(a,b){return nk.liftN([hh.prevSibling(a),hh.nextSibling(a),b],function(b,c,d){var e,f=b.dom(),g=c.dom();return oi.isText(f)&&oi.isText(g)?(e=f.data.length,f.appendData(g.data),wp.remove(c),wp.remove(a),d.container()===g?Jk(f,e):d):(wp.remove(a),d)}).orThunk(function(){return wp.remove(a),b})},ts=function(a,b,c){var d=ns(b,a.getBody(),c.dom()),e=_p.ancestor(c,Aa.curry(qs,a),ps(a.getBody())),f=ss(c,d);a.dom.isEmpty(a.getBody())?(a.setContent(""),a.selection.setCursorLocation()):e.bind(rs).fold(function(){os(a,b,f)},function(c){os(a,b,Ha.some(c))})},us={deleteElement:ts},vs=function(a,b){return function(c){return a._selectionOverrides.hideFakeCaret(),us.deleteElement(a,b,kf.fromDom(c)),!0}},ws=function(a,b){return function(c){var d=b?Jk.before(c):Jk.after(c);return a.selection.setRng(d.toRange()),!0}},xs=function(a){return function(b){return a.selection.setRng(b.toRange()),!0}},ys=function(a,b){return bs(a.getBody(),b,a.selection.getRng()).map(function(c){return c.fold(vs(a,b),ws(a,b),xs(a))}).getOr(!1)},zs=function(a){ob.each(Nl.descendants(a,".mce-offscreen-selection"),wp.remove)},As=function(a,b){var c=a.selection.getNode();return!!oi.isContentEditableFalse(c)&&(zs(kf.fromDom(a.getBody())),us.deleteElement(a,b,kf.fromDom(a.selection.getNode())),Nq.paddEmptyBody(a),!0)},Bs=function(a,b){for(;b&&b!==a;){if(oi.isContentEditableTrue(b)||oi.isContentEditableFalse(b))return b;b=b.parentNode}return null},Cs=function(a){var b,c=Bs(a.getBody(),a.selection.getNode());return oi.isContentEditableTrue(c)&&a.dom.isBlock(c)&&a.dom.isEmpty(c)&&(b=a.dom.create("br",{"data-mce-bogus":"1"}),a.dom.setHTML(c,""),c.appendChild(b),a.selection.setRng(Jk.before(b).toRange())),!0},Ds=function(a,b){return a.selection.isCollapsed()?ys(a,b):As(a,b)},Es={backspaceDelete:Ds,paddEmptyElement:Cs},Fs=oi.isText,Gs=function(a){return Fs(a)&&a.data[0]===ij.ZWSP},Hs=function(a){return Fs(a)&&a.data[a.data.length-1]===ij.ZWSP},Is=function(a){return a.ownerDocument.createTextNode(ij.ZWSP)},Js=function(a){if(Fs(a.previousSibling))return Hs(a.previousSibling)?a.previousSibling:(a.previousSibling.appendData(ij.ZWSP),a.previousSibling);if(Fs(a))return Gs(a)?a:(a.insertData(0,ij.ZWSP),a);var b=Is(a);return a.parentNode.insertBefore(b,a),b},Ks=function(a){if(Fs(a.nextSibling))return Gs(a.nextSibling)?a.nextSibling:(a.nextSibling.insertData(0,ij.ZWSP),a.nextSibling);if(Fs(a))return Hs(a)?a:(a.appendData(ij.ZWSP),a);var b=Is(a);return a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b),b},Ls=function(a,b){return a?Js(b):Ks(b)},Ms=Aa.curry(Ls,!0),Ns=Aa.curry(Ls,!1),Os=function(a,b){return oi.isText(a.container())?Ls(b,a.container()):Ls(b,a.getNode())},Ps=function(a,b){var c=b.get();return c&&a.container()===c&&mj(c)},Qs=function(a,b){return b.fold(function(b){Xk.remove(a.get());var c=Ms(b);return a.set(c),Ha.some(Jk(c,c.length-1))},function(b){return gl.firstPositionIn(b).map(function(b){if(Ps(b,a))return Jk(a.get(),1);Xk.remove(a.get());var c=Os(b,!0);return a.set(c),Jk(c,1)})},function(b){return gl.lastPositionIn(b).map(function(b){if(Ps(b,a))return Jk(a.get(),a.get().length-1);Xk.remove(a.get());var c=Os(b,!1);return a.set(c),Jk(c,c.length-1)})},function(b){Xk.remove(a.get());var c=Ns(b);return a.set(c),Ha.some(Jk(c,1))})},Rs={renderCaret:Qs},Ss=function(a,b){for(var c=0;c<a.length;c++){var d=a[c].apply(null,b);if(d.isSome())return d}return Ha.none()},Ts={evaluateUntil:Ss},Us=Tr.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),Vs=function(a,b){var c=kn(b,a);return c||a},Ws=function(a,b,c){var d=Hq.normalizeForwards(c),e=Vs(b,d.container());return Hq.findRootInline(a,e,d).fold(function(){return gl.nextPosition(e,d).bind(Aa.curry(Hq.findRootInline,a,e)).map(function(a){return Us.before(a)})},Ha.none)},Xs=function(a,b){return null===Po(a,b)},Ys=function(a,b,c){return Hq.findRootInline(a,b,c).filter(Aa.curry(Xs,b))},Zs=function(a,b,c){var d=Hq.normalizeBackwards(c);return Ys(a,b,d).bind(function(a){return gl.prevPosition(a,d).isNone()?Ha.some(Us.start(a)):Ha.none()})},$s=function(a,b,c){var d=Hq.normalizeForwards(c);return Ys(a,b,d).bind(function(a){return gl.nextPosition(a,d).isNone()?Ha.some(Us.end(a)):Ha.none()})},_s=function(a,b,c){var d=Hq.normalizeBackwards(c),e=Vs(b,d.container());return Hq.findRootInline(a,e,d).fold(function(){return gl.prevPosition(e,d).bind(Aa.curry(Hq.findRootInline,a,e)).map(function(a){return Us.after(a)})},Ha.none)},at=function(a){return!1===Hq.isRtl(ct(a))},bt=function(a,b,c){return Ts.evaluateUntil([Ws,Zs,$s,_s],[a,b,c]).filter(at)},ct=function(a){return a.fold(Aa.identity,Aa.identity,Aa.identity,Aa.identity)},dt=function(a){return a.fold(Aa.constant("before"),Aa.constant("start"),Aa.constant("end"),Aa.constant("after"))},et=function(a){return a.fold(Us.before,Us.before,Us.after,Us.after)},ft=function(a){return a.fold(Us.start,Us.start,Us.end,Us.end)},gt=function(a,b){return dt(a)===dt(b)&&ct(a)===ct(b)},ht=function(a,b,c,d,e,f){return nk.liftN([Hq.findRootInline(b,c,d),Hq.findRootInline(b,c,e)],function(b,d){return b!==d&&Hq.hasSameParentBlock(c,b,d)?Us.after(a?b:d):f}).getOr(f)},it=function(a,b){return a.fold(Aa.constant(!0),function(a){return!gt(a,b)})},jt=function(a,b,c,d,e){var f=Hq.normalizePosition(a,e);return gl.fromPosition(a,c,f).map(Aa.curry(Hq.normalizePosition,a)).fold(function(){return d.map(et)},function(e){return bt(b,c,e).map(Aa.curry(ht,a,b,c,f,e)).filter(Aa.curry(it,d))}).filter(at)},kt=function(a,b){return a?b.fold(Aa.compose(Ha.some,Us.start),Ha.none,Aa.compose(Ha.some,Us.after),Ha.none):b.fold(Ha.none,Aa.compose(Ha.some,Us.before),Ha.none,Aa.compose(Ha.some,Us.end))},lt=function(a,b,c,d){var e=Hq.normalizePosition(a,d),f=bt(b,c,e);return bt(b,c,e).bind(Aa.curry(kt,a)).orThunk(function(){return jt(a,b,c,f,d)})},mt={readLocation:bt,findLocation:lt,prevLocation:Aa.curry(lt,!1),nextLocation:Aa.curry(lt,!0),getElement:ct,outside:et,inside:ft},nt=function(a){return Ka.isFunction(a.selection.getSel().modify)},ot=function(a,b,c){var d=a?1:-1;return b.setRng(Jk(c.container(),c.offset()+d).toRange()),b.getSel().modify("move",a?"forward":"backward","word"),!0},pt=function(a,b){var c=b.selection.getRng(),d=a?Jk.fromRangeEnd(c):Jk.fromRangeStart(c);return!!nt(b)&&(a&&qj(d)?ot(!0,b.selection,d):!(a||!rj(d))&&ot(!1,b.selection,d))},qt={hasSelectionModifyApi:nt,moveByWord:pt},rt=function(a,b){var c=a.dom.createRng();c.setStart(b.container(),b.offset()),
c.setEnd(b.container(),b.offset()),a.selection.setRng(c)},st=function(a){return!1!==a.settings.inline_boundaries},tt=function(a,b){a?b.setAttribute("data-mce-selected","inline-boundary"):b.removeAttribute("data-mce-selected")},ut=function(a,b,c){return Rs.renderCaret(b,c).map(function(b){return rt(a,b),c})},vt=function(a,b,c){var d=a.getBody(),e=Jk.fromRangeStart(a.selection.getRng()),f=Aa.curry(Hq.isInlineTarget,a);return mt.findLocation(c,f,d,e).bind(function(c){return ut(a,b,c)})},wt=function(a,b,c){var d=ob.filter(b.select('*[data-mce-selected="inline-boundary"]'),a),e=ob.filter(c,a);ob.each(ob.difference(d,e),Aa.curry(tt,!1)),ob.each(ob.difference(e,d),Aa.curry(tt,!0))},xt=function(a,b){if(a.selection.isCollapsed()&&!0!==a.composing&&b.get()){var c=Jk.fromRangeStart(a.selection.getRng());Jk.isTextPosition(c)&&!1===Hq.isAtZwsp(c)&&(rt(a,Xk.removeAndReposition(b.get(),c)),b.set(null))}},yt=function(a,b,c,d){if(b.selection.isCollapsed()){var e=ob.filter(d,a);ob.each(e,function(d){var e=Jk.fromRangeStart(b.selection.getRng());mt.readLocation(a,b.getBody(),e).bind(function(a){return ut(b,c,a)})})}},zt=function(a,b,c){return function(){return!!st(a)&&vt(a,b,c).isSome()}},At=function(a,b,c){return function(){return!!st(b)&&qt.moveByWord(a,b)}},Bt=function(a){var b=Tm(null),c=Aa.curry(Hq.isInlineTarget,a);return a.on("NodeChange",function(d){st(a)&&(wt(c,a.dom,d.parents),xt(a,b),yt(c,a,b,d.parents))}),b},Ct=Aa.curry(At,!0),Dt=Aa.curry(At,!1),Et={move:zt,moveNextWord:Ct,movePrevWord:Dt,setupSelectedState:Bt,setCaretPosition:rt},Ft=function(a){return!1!==a.settings.inline_boundaries},Gt=function(a,b){var c=document.createRange();return c.setStart(a.container(),a.offset()),c.setEnd(b.container(),b.offset()),c},Ht=function(a){return nk.liftN([gl.firstPositionIn(a),gl.lastPositionIn(a)],function(b,c){var d=Hq.normalizePosition(!0,b),e=Hq.normalizePosition(!1,c);return gl.nextPosition(a,d).map(function(a){return a.isEqual(e)}).getOr(!0)}).getOr(!0)},It=function(a,b){return function(c){return Rs.renderCaret(b,c).map(function(b){return Et.setCaretPosition(a,b),!0}).getOr(!1)}},Jt=function(a,b,c,d){var e=a.getBody(),f=Aa.curry(Hq.isInlineTarget,a);a.undoManager.ignore(function(){a.selection.setRng(Gt(c,d)),a.execCommand("Delete"),mt.readLocation(f,e,Jk.fromRangeStart(a.selection.getRng())).map(mt.inside).map(It(a,b))}),a.nodeChanged()},Kt=function(a,b){var c=kn(b,a);return c||a},Lt=function(a,b,c,d){var e=Kt(a.getBody(),d.container()),f=Aa.curry(Hq.isInlineTarget,a),g=mt.readLocation(f,e,d);return g.bind(function(a){return c?a.fold(Aa.constant(Ha.some(mt.inside(a))),Ha.none,Aa.constant(Ha.some(mt.outside(a))),Ha.none):a.fold(Ha.none,Aa.constant(Ha.some(mt.outside(a))),Ha.none,Aa.constant(Ha.some(mt.inside(a))))}).map(It(a,b)).getOrThunk(function(){var h=gl.navigate(c,e,d),i=h.bind(function(a){return mt.readLocation(f,e,a)});return g.isSome()&&i.isSome()?Hq.findRootInline(f,e,d).map(function(b){return!!Ht(b)&&(us.deleteElement(a,c,kf.fromDom(b)),!0)}).getOr(!1):i.bind(function(e){return h.map(function(e){return c?Jt(a,b,d,e):Jt(a,b,e,d),!0})}).getOr(!1)})},Mt=function(a,b,c){if(a.selection.isCollapsed()&&Ft(a)){var d=Jk.fromRangeStart(a.selection.getRng());return Lt(a,b,c,d)}return!1},Nt={backspaceDelete:Mt},Ot=sg.immutable("start","end"),Pt=sg.immutable("rng","table","cells"),Qt=Tr.generate([{removeTable:["element"]},{emptyCells:["cells"]}]),Rt=function(a){return Aa.curry(Og.eq,a)},St=function(a,b){return Uq.closest(kf.fromDom(a),"td,th",b)},Tt=function(a,b){return Uq.ancestor(a,"table",b)},Ut=function(a){return!1===Og.eq(a.start(),a.end())},Vt=function(a,b){return Tt(a.start(),b).bind(function(c){return Tt(a.end(),b).bind(function(a){return Og.eq(c,a)?Ha.some(c):Ha.none()})})},Wt=function(a){return Nl.descendants(a,"td,th")},Xt=function(a,b){return Tt(a.start(),b).bind(function(b){return ob.last(Wt(b)).map(function(b){return Ot(a.start(),b)})})},Yt=function(a,b){var c=St(b.startContainer,a),d=St(b.endContainer,a);return b.collapsed?Ha.none():nk.liftN([c,d],Ot).fold(function(){return c.fold(function(){return d.bind(function(b){return Tt(b,a).bind(function(a){return ob.head(Wt(a)).map(function(a){return Ot(a,b)})})})},function(b){return Tt(b,a).bind(function(a){return ob.last(Wt(a)).map(function(a){return Ot(b,a)})})})},function(b){return Zt(a,b)?Ha.none():Xt(b,a)})},Zt=function(a,b){return Vt(b,a).isSome()},$t=function(a,b){var c=St(a.startContainer,b),d=St(a.endContainer,b);return nk.liftN([c,d],Ot).filter(Ut).filter(function(a){return Zt(b,a)}).orThunk(function(){return Yt(b,a)})},_t=function(a,b){return Vt(a,b).map(function(b){return Pt(a,b,Wt(b))})},au=function(a,b){var c=Rt(a);return $t(b,c).bind(function(a){return _t(a,c)})},bu=function(a,b){return ob.findIndex(a,function(a){return Og.eq(a,b)})},cu=function(a){return nk.liftN([bu(a.cells(),a.rng().start()),bu(a.cells(),a.rng().end())],function(b,c){return a.cells().slice(b,c+1)})},du=function(a){return cu(a).map(function(b){var c=a.cells();return b.length===c.length?Qt.removeTable(a.table()):Qt.emptyCells(b)})},eu=function(a){return Qt.emptyCells(a)},fu=function(a,b){return au(a,b).bind(du)},gu={getActionFromRange:fu,getActionFromCells:eu},hu=function(a){var b=[];if(a)for(var c=0;c<a.rangeCount;c++)b.push(a.getRangeAt(c));return b},iu=function(a){return ob.bind(a,function(a){var b=Zj(a);return b?[kf.fromDom(b)]:[]})},ju=function(a){return hu(a).length>1},ku={getRanges:hu,getSelectedNodes:iu,hasMultipleRanges:ju},lu=function(a){return ob.filter(ku.getSelectedNodes(a),Xh)},mu=function(a){return Nl.descendants(a,"td[data-mce-selected],th[data-mce-selected]")},nu=function(a,b){var c=mu(b),d=lu(a);return c.length>0?c:d},ou=function(a){return nu(ku.getRanges(a.selection.getSel()),kf.fromDom(a.getBody()))},pu={getCellsFromRanges:lu,getCellsFromElement:mu,getCellsFromElementOrRanges:nu,getCellsFromEditor:ou},qu=function(a,b){return ob.each(b,Ip.fillWithPaddingBr),a.selection.setCursorLocation(b[0].dom(),0),!0},ru=function(a,b){return us.deleteElement(a,!1,b),!0},su=function(a,b,c){return gu.getActionFromRange(b,c).map(function(b){return b.fold(Aa.curry(ru,a),Aa.curry(qu,a))})},tu=function(a,b){return zu(a,b)},uu=function(a,b,c,d){return xu(b,d).fold(function(){return su(a,b,c)},function(b){return tu(a,b)}).getOr(!1)},vu=function(a,b){var c=kf.fromDom(a.getBody()),d=a.selection.getRng(),e=pu.getCellsFromEditor(a);return 0!==e.length?qu(a,e):uu(a,c,d,b)},wu=function(a,b){return ob.find(yr.parentsAndSelf(b,a),Xh)},xu=function(a,b){return ob.find(yr.parentsAndSelf(b,a),function(a){return"caption"===uf.name(a)})},yu=function(a,b,c,d,e){return gl.navigate(c,a.getBody(),e).bind(function(a){return wu(b,kf.fromDom(a.getNode())).map(function(a){return!1===Og.eq(a,d)})})},zu=function(a,b){return Ip.fillWithPaddingBr(b),a.selection.setCursorLocation(b.dom(),0),Ha.some(!0)},Au=function(a,b,c,d){return gl.firstPositionIn(a.dom()).bind(function(e){return gl.lastPositionIn(a.dom()).map(function(a){return b?c.isEqual(e)&&d.isEqual(a):c.isEqual(a)&&d.isEqual(e)})}).getOr(!0)},Bu=function(a,b){return zu(a,b)},Cu=function(a,b,c){return xu(a,kf.fromDom(c.getNode())).map(function(a){return!1===Og.eq(a,b)})},Du=function(a,b,c,d,e){return gl.navigate(c,a.getBody(),e).bind(function(f){return Au(d,c,e,f)?Bu(a,d):Cu(b,d,f)}).or(Ha.some(!0))},Eu=function(a,b,c,d){var e=Jk.fromRangeStart(a.selection.getRng());return wu(c,d).bind(function(d){return jr.isEmpty(d)?zu(a,d):yu(a,c,b,d,e)})},Fu=function(a,b,c,d){var e=Jk.fromRangeStart(a.selection.getRng());return jr.isEmpty(d)?zu(a,d):Du(a,c,b,d,e)},Gu=function(a,b,c){var d=kf.fromDom(a.getBody());return xu(d,c).fold(function(){return Eu(a,b,d,c)},function(c){return Fu(a,b,d,c)}).getOr(!1)},Hu=function(a,b){var c=kf.fromDom(a.selection.getStart(!0)),d=pu.getCellsFromEditor(a);return a.selection.isCollapsed()&&0===d.length?Gu(a,b,c):vu(a,c)},Iu={backspaceDelete:Hu},Ju=function(a,b){a.getDoc().execCommand(b,!1,null)},Ku=function(a){Es.backspaceDelete(a,!1)||Nt.backspaceDelete(a,!1)||Jr.backspaceDelete(a,!1)||Iu.backspaceDelete(a)||Rr.backspaceDelete(a,!1)||(Ju(a,"Delete"),Nq.paddEmptyBody(a))},Lu=function(a){Es.backspaceDelete(a,!0)||Nt.backspaceDelete(a,!0)||Jr.backspaceDelete(a,!0)||Iu.backspaceDelete(a)||Rr.backspaceDelete(a,!0)||Ju(a,"ForwardDelete")},Mu={deleteCommand:Ku,forwardDeleteCommand:Lu},Nu=function(a,b,c){var d=function(b){return kg.getRaw(b,a)},e=function(a){return Og.eq(kf.fromDom(b),a)};return _p.closest(kf.fromDom(c),function(a){return d(a).isSome()},e).bind(d)},Ou=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},Pu=function(a,b){return/[0-9.]+px$/.test(a)?Ou(72*parseInt(a,10)/96,b||0)+"pt":a},Qu=function(a){return a.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},Ru=function(a,b){return Ha.from(_i.DOM.getStyle(b,a,!0))},Su=function(a){return function(b,c){return Ha.from(c).map(kf.fromDom).filter(uf.isElement).bind(function(c){return Nu(a,b,c.dom()).or(Ru(a,c.dom()))}).getOr("")}},Tu={getFontSize:Su("font-size"),getFontFamily:Aa.compose(Qu,Su("font-family")),toPt:Pu},Uu=function(a){return gl.firstPositionIn(a.getBody()).map(function(a){var b=a.container();return oi.isText(b)?b.parentNode:b})},Vu=function(a,b){return a.startContainer===b&&0===a.startOffset},Wu=function(a){return Ha.from(a.selection.getRng()).bind(function(b){var c=a.getBody();return Vu(b,c)?Ha.none():Ha.from(a.selection.getStart(!0))})},Xu=function(a,b){if(/^[0-9\.]+$/.test(b)){var c=parseInt(b,10);if(c>=1&&c<=7){var d=vm.getFontStyleValues(a),e=vm.getFontSizeClasses(a);return e?e[c-1]||b:d[c-1]||b}return b}return b},Yu=function(a,b){a.formatter.toggle("fontname",{value:Xu(a,b)}),a.nodeChanged()},Zu=function(a){return Wu(a).fold(function(){return Uu(a).map(function(b){return Tu.getFontFamily(a.getBody(),b)}).getOr("")},function(b){return Tu.getFontFamily(a.getBody(),b)})},$u=function(a,b){a.formatter.toggle("fontsize",{value:Xu(a,b)}),a.nodeChanged()},_u=function(a){return Wu(a).fold(function(){return Uu(a).map(function(b){return Tu.getFontSize(a.getBody(),b)}).getOr("")},function(b){return Tu.getFontSize(a.getBody(),b)})},av=function(a,b){return a&&b&&a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},bv={isEq:av},cv=function(a,b,c){for(;a&&a!==b;){if(c(a))return a;a=a.parentNode}return null},dv=function(a,b,c){return null!==cv(a,b,c)},ev=function(a,b,c){return dv(a,b,function(a){return a.nodeName===c})},fv=function(a){return a&&"TABLE"===a.nodeName},gv=function(a){return a&&/^(TD|TH|CAPTION)$/.test(a.nodeName)},hv=function(a,b){return nj(a)&&!1===dv(a,b,Oo)},iv=function(a,b,c){for(var d=new s(b,a.getParent(b.parentNode,a.isBlock)||a.getRoot());b=d[c?"prev":"next"]();)if(oi.isBr(b))return!0},jv=function(a,b){return a.previousSibling&&a.previousSibling.nodeName===b},kv=function(a,b){for(;b&&b!==a;){if(oi.isContentEditableFalse(b))return!0;b=b.parentNode}return!1},lv=function(a,b,c,d,e){var f,g,h,i,j=a.getRoot(),k=a.schema.getNonEmptyElements();if(h=a.getParent(e.parentNode,a.isBlock)||j,d&&oi.isBr(e)&&b&&a.isEmpty(h))return Ha.some(x(e.parentNode,a.nodeIndex(e)));for(f=new s(e,h);i=f[d?"prev":"next"]();){if("false"===a.getContentEditableParent(i)||hv(i,j))return Ha.none();if(oi.isText(i)&&i.nodeValue.length>0)return!1===ev(i,j,"A")?Ha.some(x(i,d?i.nodeValue.length:0)):Ha.none();if(a.isBlock(i)||k[i.nodeName.toLowerCase()])return Ha.none();g=i}return c&&g?Ha.some(x(g,0)):Ha.none()},mv=function(a,b,c,d){var e,f,g,h,i,j,k,l=a.getRoot(),m=!1;if(e=d[(c?"start":"end")+"Container"],f=d[(c?"start":"end")+"Offset"],k=oi.isElement(e)&&f===e.childNodes.length,i=a.schema.getNonEmptyElements(),j=c,nj(e))return Ha.none();if(oi.isElement(e)&&f>e.childNodes.length-1&&(j=!1),oi.isDocument(e)&&(e=l,f=0),e===l){if(j&&(h=e.childNodes[f>0?f-1:0])){if(nj(h))return Ha.none();if(i[h.nodeName]||fv(h))return Ha.none()}if(e.hasChildNodes()){if(f=Math.min(!j&&f>0?f-1:f,e.childNodes.length-1),e=e.childNodes[f],f=oi.isText(e)&&k?e.data.length:0,!b&&e===l.lastChild&&fv(e))return Ha.none();if(kv(l,e)||nj(e))return Ha.none();if(e.hasChildNodes()&&!1===fv(e)){h=e,g=new s(e,l);do{if(oi.isContentEditableFalse(h)||nj(h)){m=!1;break}if(oi.isText(h)&&h.nodeValue.length>0){f=j?0:h.nodeValue.length,e=h,m=!0;break}if(i[h.nodeName.toLowerCase()]&&!gv(h)){f=a.nodeIndex(h),e=h.parentNode,j||f++,m=!0;break}}while(h=j?g.next():g.prev())}}}return b&&(oi.isText(e)&&0===f&&lv(a,k,b,!0,e).each(function(a){e=a.container(),f=a.offset(),m=!0}),oi.isElement(e)&&(h=e.childNodes[f],h||(h=e.childNodes[f-1]),!h||!oi.isBr(h)||jv(h,"A")||iv(a,h,!1)||iv(a,h,!0)||lv(a,k,b,!0,h).each(function(a){e=a.container(),f=a.offset(),m=!0}))),j&&!b&&oi.isText(e)&&f===e.nodeValue.length&&lv(a,k,b,!1,e).each(function(a){e=a.container(),f=a.offset(),m=!0}),m?Ha.some(x(e,f)):Ha.none()},nv=function(a,b){var c=b.collapsed,d=b.cloneRange(),e=x.fromRangeStart(b);return mv(a,c,!0,d).each(function(a){c&&x.isAbove(e,a)||d.setStart(a.container(),a.offset())}),c||mv(a,c,!1,d).each(function(a){d.setEnd(a.container(),a.offset())}),c&&d.collapse(!0),bv.isEq(b,d)?Ha.none():Ha.some(d)},ov={normalize:nv},pv=function(a,b,c){for(var d,e=new s(b,c),f=a.getNonEmptyElements();d=e.next();)if(f[d.nodeName.toLowerCase()]||d.length>0)return!0},qv=function(a,b,c){var d=a.create("span",{},"&nbsp;");c.parentNode.insertBefore(d,c),b.scrollIntoView(d),a.remove(d)},rv=function(a,b,c,d){var e=a.createRng();d?(e.setStartBefore(c),e.setEndBefore(c)):(e.setStartAfter(c),e.setEndAfter(c)),b.setRng(e)},sv=function(a,b){var c,d,e=a.selection,f=a.dom,g=e.getRng();ov.normalize(f,g).each(function(a){g.setStart(a.startContainer,a.startOffset),g.setEnd(a.endContainer,a.endOffset)});var h=g.startOffset,i=g.startContainer;if(1===i.nodeType&&i.hasChildNodes()){var j=h>i.childNodes.length-1;i=i.childNodes[Math.min(h,i.childNodes.length-1)]||i,h=j&&3===i.nodeType?i.nodeValue.length:0}var k=f.getParent(i,f.isBlock),l=k?f.getParent(k.parentNode,f.isBlock):null,m=l?l.nodeName.toUpperCase():"",n=b&&b.ctrlKey;"LI"!==m||n||(k=l),i&&3===i.nodeType&&h>=i.nodeValue.length&&(pv(a.schema,i,k)||(c=f.create("br"),g.insertNode(c),g.setStartAfter(c),g.setEndAfter(c),d=!0)),c=f.create("br"),g.insertNode(c),qv(f,e,c),rv(f,e,c,d),a.undoManager.add()},tv=function(a,b){var c=kf.fromTag("br");Cm.before(kf.fromDom(b),c),a.undoManager.add()},uv=function(a,b){wv(a.getBody(),b)||Cm.after(kf.fromDom(b),kf.fromTag("br"));var c=kf.fromTag("br");Cm.after(kf.fromDom(b),c),qv(a.dom,a.selection,c.dom()),rv(a.dom,a.selection,c.dom(),!1),a.undoManager.add()},vv=function(a){return oi.isBr(a.getNode())},wv=function(a,b){return!!vv(Jk.after(b))||gl.nextPosition(a,Jk.after(b)).map(function(a){return oi.isBr(a.getNode())}).getOr(!1)},xv=function(a){return a&&"A"===a.nodeName&&"href"in a},yv=function(a){return a.fold(Aa.constant(!1),xv,xv,Aa.constant(!1))},zv=function(a){var b=Aa.curry(Hq.isInlineTarget,a),c=Jk.fromRangeStart(a.selection.getRng());return mt.readLocation(b,a.getBody(),c).filter(yv)},Av=function(a,b){b.fold(Aa.noop,Aa.curry(tv,a),Aa.curry(uv,a),Aa.noop)},Bv=function(a,b){var c=zv(a);c.isSome()?c.each(Aa.curry(Av,a)):sv(a,b)},Cv={insert:Bv},Dv=Tr.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ev=function(a,b,c,d){return a.fold(b,c,d)},Fv=function(a){return a.fold(Aa.identity,Aa.identity,Aa.identity)},Gv={before:Dv.before,on:Dv.on,after:Dv.after,cata:Ev,getStart:Fv},Hv=Tr.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Iv=sg.immutable("start","soffset","finish","foffset"),Jv=function(a){return Hv.exact(a.start(),a.soffset(),a.finish(),a.foffset())},Kv=function(a){return a.match({domRange:function(a){return kf.fromDom(a.startContainer)},relative:function(a,b){return Gv.getStart(a)},exact:function(a,b,c,d){return a}})},Lv=function(a){var b=Kv(a);return hh.defaultView(b)},Mv={domRange:Hv.domRange,relative:Hv.relative,exact:Hv.exact,exactFromRange:Jv,range:Iv,getWin:Lv},Nv=df.detect().browser,Ov=function(a,b){var c=uf.isText(b)?Bp.get(b).length:hh.children(b).length+1;return a>c?c:a<0?0:a},Pv=function(a){return Mv.range(a.start(),Ov(a.soffset(),a.start()),a.finish(),Ov(a.foffset(),a.finish()))},Qv=function(a,b){return Og.contains(a,b)||Og.eq(a,b)},Rv=function(a){return function(b){return Qv(a,b.start())&&Qv(a,b.finish())}},Sv=function(a){return!0===a.inline||Nv.isIE()},Tv=function(a){return Mv.range(kf.fromDom(a.startContainer),a.startOffset,kf.fromDom(a.endContainer),a.endOffset)},Uv=function(a){var b=a.getSelection();return(b&&0!==b.rangeCount?Ha.from(b.getRangeAt(0)):Ha.none()).map(Tv)},Vv=function(a){var b=hh.defaultView(a);return Uv(b.dom()).filter(Rv(a))},Wv=function(a,b){return Ha.from(b).filter(Rv(a)).map(Pv)},Xv=function(a){var b=document.createRange();try{return b.setStart(a.start().dom(),a.soffset()),b.setEnd(a.finish().dom(),a.foffset()),Ha.some(b)}catch(a){return Ha.none()}},Yv=function(a){var b=Sv(a)?Vv(kf.fromDom(a.getBody())):Ha.none();a.bookmark=b.isSome()?b:a.bookmark},Zv=function(a,b){var c=kf.fromDom(a.getBody()),d=Sv(a)?Ha.from(b):Ha.none(),e=d.map(Tv).filter(Rv(c));a.bookmark=e.isSome()?e:a.bookmark},$v=function(a){return(a.bookmark?a.bookmark:Ha.none()).bind(Aa.curry(Wv,kf.fromDom(a.getBody()))).bind(Xv)},_v=function(a){$v(a).each(function(b){a.selection.setRng(b)})},aw={store:Yv,storeNative:Zv,readRange:Uv,restore:_v,getRng:$v,getBookmark:Vv,validate:Wv},bw=function(a,b,c,d,e,f){if("false"!==a.getContentEditable(f)&&"LI"!==f.nodeName){var g=c?"margin":"padding";if(g="TABLE"===f.nodeName?"margin":g,g+="rtl"===a.getStyle(f,"direction",!0)?"Right":"Left","outdent"===b){var h=Math.max(0,parseInt(f.style[g]||0,10)-d);a.setStyle(f,g,h?h+e:"")}else{var h=parseInt(f.style[g]||0,10)+d+e;a.setStyle(f,g,h)}}},cw=function(a,b){var c=a.settings,d=a.dom,e=a.selection,f=a.formatter,g=/[a-z%]+$/i.exec(c.indentation)[0],h=parseInt(c.indentation,10),i=a.getParam("indent_use_margin",!1);a.queryCommandState("InsertUnorderedList")||a.queryCommandState("InsertOrderedList")||(c.forced_root_block||d.getParent(e.getNode(),d.isBlock)||f.apply("div"),ob.each(e.getSelectedBlocks(),function(a){return bw(d,b,i,h,g,a)}))},dw=zd.each,ew=zd.extend,fw=zd.map,gw=zd.inArray,hw=zd.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend"," "),iw=function(a){var b,c,d=this,e={},f=function(){return!1},g=function(){return!0};a=a||{},b=a.scope||d,c=a.toggleEvent||f;var h=function(c,d){var h,i,k,l;if(c=c.toLowerCase(),d=d||{},d.type=c,d.target||(d.target=b),d.preventDefault||(d.preventDefault=function(){d.isDefaultPrevented=g},d.stopPropagation=function(){d.isPropagationStopped=g},d.stopImmediatePropagation=function(){d.isImmediatePropagationStopped=g},d.isDefaultPrevented=f,d.isPropagationStopped=f,d.isImmediatePropagationStopped=f),a.beforeFire&&a.beforeFire(d),h=e[c])for(i=0,k=h.length;i<k;i++){if(l=h[i],l.once&&j(c,l.func),d.isImmediatePropagationStopped())return d.stopPropagation(),d;if(!1===l.func.call(b,d))return d.preventDefault(),d}return d},i=function(a,b,g,h){var i,j,k;if(!1===b&&(b=f),b)for(b={func:b},h&&zd.extend(b,h),j=a.toLowerCase().split(" "),k=j.length;k--;)a=j[k],i=e[a],i||(i=e[a]=[],c(a,!0)),g?i.unshift(b):i.push(b);return d},j=function(a,b){var f,g,h,i,j;if(a)for(i=a.toLowerCase().split(" "),f=i.length;f--;){if(a=i[f],g=e[a],!a){for(h in e)c(h,!1),delete e[h];return d}if(g){if(b)for(j=g.length;j--;)g[j].func===b&&(g=g.slice(0,j).concat(g.slice(j+1)),e[a]=g);else g.length=0;g.length||(c(a,!1),delete e[a])}}else{for(a in e)c(a,!1);e={}}return d},k=function(a,b,c){return i(a,b,c,{once:!0})},l=function(a){return a=a.toLowerCase(),!(!e[a]||0===e[a].length)};d.fire=h,d.on=i,d.off=j,d.once=k,d.has=l};iw.isNative=function(a){return!!hw[a.toLowerCase()]};var jw,kw=function(a){return a._eventDispatcher||(a._eventDispatcher=new iw({scope:a,toggleEvent:function(b,c){iw.isNative(b)&&a.toggleNativeEvent&&a.toggleNativeEvent(b,c)}})),a._eventDispatcher},lw={fire:function(a,b,c){var d=this;if(d.removed&&"remove"!==a)return b;if(b=kw(d).fire(a,b,c),!1!==c&&d.parent)for(var e=d.parent();e&&!b.isPropagationStopped();)e.fire(a,b,!1),e=e.parent();return b},on:function(a,b,c){return kw(this).on(a,b,c)},off:function(a,b){return kw(this).off(a,b)},once:function(a,b){return kw(this).once(a,b)},hasEventListeners:function(a){return kw(this).has(a)}},mw=function(a,b){var c=Pf.get(a,b);return void 0===c||""===c?[]:c.split(" ")},nw=function(a,b,c){var d=mw(a,b),e=d.concat([c]);Pf.set(a,b,e.join(" "))},ow=function(a,b,c){var d=ob.filter(mw(a,b),function(a){return a!==c});d.length>0?Pf.set(a,b,d.join(" ")):Pf.remove(a,b)},pw={read:mw,add:nw,remove:ow},qw=function(a){return void 0!==a.dom().classList},rw=function(a){return pw.read(a,"class")},sw=function(a,b){return pw.add(a,"class",b)},tw=function(a,b){return pw.remove(a,"class",b)},uw=function(a,b){ob.contains(rw(a),b)?tw(a,b):sw(a,b)},vw={get:rw,add:sw,remove:tw,toggle:uw,supports:qw},ww=function(a,b){vw.supports(a)?a.dom().classList.add(b):vw.add(a,b)},xw=function(a){0===(vw.supports(a)?a.dom().classList:vw.get(a)).length&&Pf.remove(a,"class")},yw=function(a,b){if(vw.supports(a)){a.dom().classList.remove(b)}else vw.remove(a,b);xw(a)},zw=function(a,b){return vw.supports(a)?a.dom().classList.toggle(b):vw.toggle(a,b)},Aw=function(a,b){var c=vw.supports(a),d=a.dom().classList;return C(function(){c?d.remove(b):vw.remove(a,b)},function(){c?d.add(b):vw.add(a,b)},Bw(a,b))},Bw=function(a,b){return vw.supports(a)&&a.dom().classList.contains(b)},Cw={add:ww,remove:yw,toggle:zw,toggler:Aw,has:Bw},Dw=function(a,b){return a.fire("PreProcess",b)},Ew=function(a,b){return a.fire("PostProcess",b)},Fw=function(a){return a.fire("remove")},Gw=function(a,b){return a.fire("SwitchMode",{mode:b})},Hw=function(a,b,c,d){a.fire("ObjectResizeStart",{target:b,width:c,height:d})},Iw=function(a,b,c,d){a.fire("ObjectResized",{target:b,width:c,height:d})},Jw={firePreProcess:Dw,firePostProcess:Ew,fireRemove:Fw,fireSwitchMode:Gw,fireObjectResizeStart:Hw,fireObjectResized:Iw},Kw=function(a,b,c){try{a.getDoc().execCommand(b,!1,c)}catch(a){}},Lw=function(a,b,c){Cw.has(a,b)&&!1===c?Cw.remove(a,b):c&&Cw.add(a,b)},Mw=function(a,b){Lw(kf.fromDom(a.getBody()),"mce-content-readonly",b),b?(a.selection.controlSelection.hideResizeRect(),a.readonly=!0,a.getBody().contentEditable="false"):(a.readonly=!1,a.getBody().contentEditable="true",Kw(a,"StyleWithCSS",!1),Kw(a,"enableInlineTableEditing",!1),Kw(a,"enableObjectResizing",!1),a.focus(),a.nodeChanged())},Nw=function(a,b){b!==Ow(a)&&(a.initialized?Mw(a,"readonly"===b):a.on("init",function(){Mw(a,"readonly"===b)}),Jw.fireSwitchMode(a,b))},Ow=function(a){return a.readonly?"readonly":"design"},Pw=function(a){return!0===a.readonly},Qw=_i.DOM,Rw=function(a,b){return"selectionchange"===b?a.getDoc():!a.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(b)?a.getDoc().documentElement:a.settings.event_root?(a.eventRoot||(a.eventRoot=Qw.select(a.settings.event_root)[0]),a.eventRoot):a.getBody()},Sw=function(a){return!a.hidden&&!a.readonly},Tw=function(a,b,c){Sw(a)?a.fire(b,c):Pw(a)&&c.preventDefault()},Uw=function(a,b){var c,d;if(a.delegates||(a.delegates={}),!a.delegates[b]&&!a.removed)if(c=Rw(a,b),a.settings.event_root){if(jw||(jw={},a.editorManager.on("removeEditor",function(){var b;if(!a.editorManager.activeEditor&&jw){for(b in jw)a.dom.unbind(Rw(a,b));jw=null}})),jw[b])return;d=function(c){for(var d=c.target,e=a.editorManager.get(),f=e.length;f--;){var g=e[f].getBody();(g===d||Qw.isChildOf(d,g))&&Tw(e[f],b,c)}},jw[b]=d,Qw.bind(c,b,d)}else d=function(c){Tw(a,b,c)},Qw.bind(c,b,d),a.delegates[b]=d},Vw={bindPendingEventDelegates:function(){var a=this;zd.each(a._pendingNativeEvents,function(b){Uw(a,b)})},toggleNativeEvent:function(a,b){var c=this;"focus"!==a&&"blur"!==a&&(b?c.initialized?Uw(c,a):c._pendingNativeEvents?c._pendingNativeEvents.push(a):c._pendingNativeEvents=[a]:c.initialized&&(c.dom.unbind(Rw(c,a),a,c.delegates[a]),delete c.delegates[a]))},unbindAllNativeEvents:function(){var a,b=this,c=b.getBody(),d=b.dom;if(b.delegates){for(a in b.delegates)b.dom.unbind(Rw(b,a),a,b.delegates[a]);delete b.delegates}!b.inline&&c&&d&&(c.onload=null,d.unbind(b.getWin()),d.unbind(b.getDoc())),d&&(d.unbind(c),d.unbind(b.getContainer()))}};Vw=zd.extend({},lw,Vw);var Ww,Xw=Vw,Yw=zd.each,Zw=zd.explode,$w={f9:120,f10:121,f11:122},_w=zd.makeMap("alt,ctrl,shift,meta,access"),ax=function(a){return _p.first(a).isSome()},bx=function(a,b,c){return _p.ancestor(a,b,c).isSome()},cx=function(a,b,c){return _p.closest(a,b,c).isSome()},dx=function(a,b){return _p.sibling(a,b).isSome()},ex=function(a,b){return _p.child(a,b).isSome()},fx=function(a,b){return _p.descendant(a,b).isSome()},gx={any:ax,ancestor:bx,closest:cx,sibling:dx,child:ex,descendant:fx},hx=function(a){a.dom().focus()},ix=function(a){a.dom().blur()},jx=function(a){var b=hh.owner(a).dom();return a.dom()===b.activeElement},kx=function(a){var b=void 0!==a?a.dom():document;return Ha.from(b.activeElement).map(kf.fromDom)},lx=function(a){var b=hh.owner(a);kx(b).filter(function(b){return gx.closest(b,Aa.curry(Og.eq,a))}).fold(function(){hx(a)},Aa.noop)},mx=function(a){return kx(hh.owner(a)).filter(function(b){return a.dom().contains(b.dom())})},nx={hasFocus:jx,focus:hx,blur:ix,active:kx,search:mx,focusInside:lx},ox=function(a,b){return a.dom.getParent(b,function(b){return"true"===a.dom.getContentEditable(b)})},px=function(a){return a.collapsed?Ha.from($j(a.startContainer,a.startOffset)).map(kf.fromDom):Ha.none()},qx=function(a,b){return px(b).bind(function(b){return Wh(b)?Ha.some(b):!1===Og.contains(a,b)?Ha.some(a):Ha.none()})},rx=function(a,b){qx(kf.fromDom(a.getBody()),b).bind(function(a){return gl.firstPositionIn(a.dom())}).fold(function(){a.selection.normalize()},function(b){return a.selection.setRng(b.toRange())})},sx=function(a){if(a.setActive)try{a.setActive()}catch(b){a.focus()}else a.focus()},tx=function(a){return nx.hasFocus(a)||nx.search(a).isSome()},ux=function(a){return a.iframeElement&&nx.hasFocus(kf.fromDom(a.iframeElement))},vx=function(a){var b=a.getBody();return b&&tx(kf.fromDom(b))},wx=function(a){return a.inline?vx(a):ux(a)},xx=function(a){var b=a.selection,c=a.settings.content_editable,d=a.getBody(),e=b.getRng();a.quirks.refreshContentEditable();var f=ox(a,b.getNode());if(a.$.contains(d,f))return sx(f),rx(a,e),void yx(a);void 0!==a.bookmark&&!1===wx(a)&&aw.getRng(a).each(function(b){a.selection.setRng(b),e=b}),c||(Ib.opera||sx(d),a.getWin().focus()),(Ib.gecko||c)&&(sx(d),rx(a,e)),yx(a)},yx=function(a){return a.editorManager.setActive(a)},zx=function(a,b){a.removed||(b?yx(a):xx(a))},Ax={focus:zx,hasFocus:wx},Bx=function(a,b){return b.dom()[a]},Cx=function(a,b){return parseInt(kg.get(b,a),10)},Dx=Aa.curry(Bx,"clientWidth"),Ex=Aa.curry(Bx,"clientHeight"),Fx=Aa.curry(Cx,"margin-top"),Gx=Aa.curry(Cx,"margin-left"),Hx=function(a){return a.dom().getBoundingClientRect()},Ix=function(a,b,c){var d=Dx(a),e=Ex(a);return b>=0&&c>=0&&b<=d&&c<=e},Jx=function(a,b,c,d){var e=Hx(b);return{x:c-(a?e.left+b.dom().clientLeft+Gx(b):0),y:d-(a?e.top+b.dom().clientTop+Fx(b):0)}},Kx=function(a,b,c){var d=kf.fromDom(a.getBody()),e=a.inline?d:hh.documentElement(d),f=Jx(a.inline,e,b,c);return Ix(e,f.x,f.y)},Lx=function(a){return Ha.from(a).map(kf.fromDom)},Mx=function(a){var b=a.inline?a.getBody():a.getContentAreaContainer();return Lx(b).map(function(a){return Og.contains(hh.owner(a),a)}).getOr(!1)},Nx={isXYInContentArea:Kx,isEditorAttachedToDom:Mx},Ox=w.PluginManager,Px=function(a,b){for(var c in Ox.urls){if(Ox.urls[c]+"/plugin"+b+".js"===a)return c}return null},Qx=function(a,b){var c=Px(b,a.suffix);return c?"Failed to load plugin: "+c+" from url "+b:"Failed to load plugin url: "+b},Rx=function(a,b){a.notificationManager.open({type:"error",text:b})},Sx=function(a,b){a._skinLoaded?Rx(a,b):a.on("SkinLoaded",function(){Rx(a,b)})},Tx=function(a,b){Sx(a,"Failed to upload image: "+b)},Ux=function(a,b){Sx(a,Qx(a,b))},Vx=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=window.console;d&&(d.error?d.error.apply(d,arguments):d.log.apply(d,arguments))},Wx={pluginLoadError:Ux,uploadError:Tx,displayError:Sx,initError:Vx},Xx=w.PluginManager,Yx=w.ThemeManager,Zx=function(a){yb.getOrDie("requestAnimationFrame")(a)},$x=function(a){return yb.getOrDie("atob")(a)},_x={atob:$x,requestAnimationFrame:Zx},ay=function(a){return new Jb(function(b,c){var d=function(){c("Cannot convert "+a+" to Blob. Resource might not exist or is inaccessible.")};try{var e=new I;e.open("GET",a,!0),e.responseType="blob",e.onload=function(){200===this.status?b(this.response):d()},e.onerror=d,e.send()}catch(a){d()}})},by=function(a){var b,c;return a=decodeURIComponent(a).split(","),c=/data:([^;]+)/.exec(a[0]),c&&(b=c[1]),{type:b,data:a[1]}},cy=function(a){return new Jb(function(b){var c,d,e;a=by(a);try{c=_x.atob(a.data)}catch(a){return void b(new K([]))}for(d=new M(c.length),e=0;e<d.length;e++)d[e]=c.charCodeAt(e);b(new K([d],{type:a.type}))})},dy=function(a){return 0===a.indexOf("blob:")?ay(a):0===a.indexOf("data:")?cy(a):null},ey=function(a){return new Jb(function(b){var c=new L;c.onloadend=function(){b(c.result)},c.readAsDataURL(a)})},fy={uriToBlob:dy,blobToDataUri:ey,parseDataUri:by},gy=0,hy=function(a){return(a||"blobid")+gy++},iy=function(a,b,c,d){var e,f;if(0===b.src.indexOf("blob:"))return f=a.getByUri(b.src),void(f?c({image:b,blobInfo:f}):fy.uriToBlob(b.src).then(function(d){fy.blobToDataUri(d).then(function(g){e=fy.parseDataUri(g).data,f=a.create(hy(),d,e),a.add(f),c({image:b,blobInfo:f})})},function(a){d(a)}));e=fy.parseDataUri(b.src).data,f=a.findFirst(function(a){return a.base64()===e}),f?c({image:b,blobInfo:f}):fy.uriToBlob(b.src).then(function(d){f=a.create(hy(),d,e),a.add(f),c({image:b,blobInfo:f})},function(a){d(a)})},jy=function(a){return a?a.getElementsByTagName("img"):[]},ky=0,ly=function(){var a=function(){return Math.round(4294967295*Math.random()).toString(36)};return"s"+(new Date).getTime().toString(36)+a()+a()+a()},my=function(a){return a+ky+++ly()},ny={uuid:my},oy=function(a,b){return a.hasOwnProperty(b.nodeName)},py=function(a,b){return!!oi.isText(b)||!!oi.isElement(b)&&(!oy(a,b)&&!lp.isBookmarkNode(b))},qy=function(a,b,c){return ob.exists(yr.parents(kf.fromDom(c),kf.fromDom(b)),function(b){return oy(a,b.dom())})},ry=function(a,b){if(oi.isText(b)){if(0===b.nodeValue.length)return!0;if(/^\s+$/.test(b.nodeValue)&&(!b.nextSibling||oy(a,b.nextSibling)))return!0}return!1},sy=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=a.settings,n=a.dom,o=a.selection,p=a.schema,q=p.getBlockElements(),r=o.getStart(),s=a.getBody();if(l=m.forced_root_block,r&&oi.isElement(r)&&l&&(k=s.nodeName.toLowerCase(),p.isValidChild(k,l.toLowerCase())&&!qy(q,s,r))){for(b=o.getRng(),c=b.startContainer,d=b.startOffset,e=b.endContainer,f=b.endOffset,j=Ax.hasFocus(a),r=s.firstChild;r;)if(py(q,r)){if(ry(q,r)){h=r,r=r.nextSibling,n.remove(h);continue}g||(g=n.create(l,a.settings.forced_root_block_attrs),r.parentNode.insertBefore(g,r),i=!0),h=r,r=r.nextSibling,g.appendChild(h)}else g=null,r=r.nextSibling;i&&j&&(b.setStart(c,d),b.setEnd(e,f),o.setRng(b),a.nodeChanged())}},ty=function(a){a.settings.forced_root_block&&a.on("NodeChange",Aa.curry(sy,a))},uy={setup:ty},vy=function(a){var b=a.startContainer,c=a.startOffset;return oi.isText(b)?0===c?Ha.some(kf.fromDom(b)):Ha.none():Ha.from(b.childNodes[c]).map(kf.fromDom)},wy=function(a){var b=a.endContainer,c=a.endOffset;return oi.isText(b)?c===b.data.length?Ha.some(kf.fromDom(b)):Ha.none():Ha.from(b.childNodes[c-1]).map(kf.fromDom)},xy=function(a){return hh.firstChild(a).fold(Aa.constant([a]),function(b){return[a].concat(xy(b))})},yy=function(a){return hh.lastChild(a).fold(Aa.constant([a]),function(b){return"br"===uf.name(b)?hh.prevSibling(b).map(function(b){
return[a].concat(yy(b))}).getOr([]):[a].concat(yy(b))})},zy=function(a,b){return nk.liftN([vy(b),wy(b)],function(b,c){var d=ob.find(xy(a),Aa.curry(Og.eq,b)),e=ob.find(yy(a),Aa.curry(Og.eq,c));return d.isSome()&&e.isSome()}).getOr(!1)},Ay=function(a,b,c,d){var e=c,f=new s(c,e),g=a.schema.getNonEmptyElements();do{if(3===c.nodeType&&0!==zd.trim(c.nodeValue).length)return void(d?b.setStart(c,0):b.setEnd(c,c.nodeValue.length));if(g[c.nodeName]&&!/^(TD|TH)$/.test(c.nodeName))return void(d?b.setStartBefore(c):"BR"===c.nodeName?b.setEndBefore(c):b.setEndAfter(c));if(Ib.ie&&Ib.ie<11&&a.isBlock(c)&&a.isEmpty(c))return void(d?b.setStart(c,0):b.setEnd(c,0))}while(c=d?f.next():f.prev());"BODY"===e.nodeName&&(d?b.setStart(e,0):b.setEnd(e,e.childNodes.length))},By=function(a){var b=a.selection.getSel();return b&&b.rangeCount>0},Cy=function(a){var b,c,d,e;return e=a.getBoundingClientRect(),b=a.ownerDocument,c=b.documentElement,d=b.defaultView,{top:e.top+d.pageYOffset-c.clientTop,left:e.left+d.pageXOffset-c.clientLeft}},Dy=function(a){return a.inline?Cy(a.getBody()):{left:0,top:0}},Ey=function(a){var b=a.getBody();return a.inline?{left:b.scrollLeft,top:b.scrollTop}:{left:0,top:0}},Fy=function(a){var b=a.getBody(),c=a.getDoc().documentElement,d={left:b.scrollLeft,top:b.scrollTop},e={left:b.scrollLeft||c.scrollLeft,top:b.scrollTop||c.scrollTop};return a.inline?d:e},Gy=function(a,b){if(b.target.ownerDocument!==a.getDoc()){var c=Cy(a.getContentAreaContainer()),d=Fy(a);return{left:b.pageX-c.left+d.left,top:b.pageY-c.top+d.top}}return{left:b.pageX,top:b.pageY}},Hy=function(a,b,c){return{pageX:c.left-a.left+b.left,pageY:c.top-a.top+b.top}},Iy=function(a,b){return Hy(Dy(a),Ey(a),Gy(a,b))},Jy={calc:Iy},Ky=oi.isContentEditableFalse,Ly=oi.isContentEditableTrue,My=function(a,b){return Ky(b)&&b!==a},Ny=function(a,b,c){return b!==c&&!a.dom.isChildOf(b,c)&&!Ky(b)},Oy=function(a){var b=a.cloneNode(!0);return b.removeAttribute("data-mce-selected"),b},Py=function(a,b,c,d){var e=b.cloneNode(!0);a.dom.setStyles(e,{width:c,height:d}),a.dom.setAttrib(e,"data-mce-selected",null);var f=a.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return a.dom.setStyles(f,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:c,height:d}),a.dom.setStyles(e,{margin:0,boxSizing:"border-box"}),f.appendChild(e),f},Qy=function(a,b){a.parentNode!==b&&b.appendChild(a)},Ry=function(a,b,c,d,e,f){var g=0,h=0;a.style.left=b.pageX+"px",a.style.top=b.pageY+"px",b.pageX+c>e&&(g=b.pageX+c-e),b.pageY+d>f&&(h=b.pageY+d-f),a.style.width=c-g+"px",a.style.height=d-h+"px"},Sy=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},Ty=function(a){return 0===a.button},Uy=function(a){return a.element},Vy=function(a,b){return{pageX:b.pageX-a.relX,pageY:b.pageY+5}},Wy=function(a,b){return function(c){if(Ty(c)){var d=md.find(b.dom.getParents(c.target),jk.or(Ky,Ly));if(My(b.getBody(),d)){var e=b.dom.getPos(d),f=b.getBody(),g=b.getDoc().documentElement;a.element=d,a.screenX=c.screenX,a.screenY=c.screenY,a.maxX=(b.inline?f.scrollWidth:g.offsetWidth)-2,a.maxY=(b.inline?f.scrollHeight:g.offsetHeight)-2,a.relX=c.pageX-e.x,a.relY=c.pageY-e.y,a.width=d.offsetWidth,a.height=d.offsetHeight,a.ghost=Py(b,d,a.width,a.height)}}}},Xy=function(a,b){var c=Qb.throttle(function(a,c){b._selectionOverrides.hideFakeCaret(),b.selection.placeCaretAt(a,c)},0);return function(d){var e=Math.max(Math.abs(d.screenX-a.screenX),Math.abs(d.screenY-a.screenY));if(Uy(a)&&!a.dragging&&e>10){if(b.fire("dragstart",{target:a.element}).isDefaultPrevented())return;a.dragging=!0,b.focus()}if(a.dragging){var f=Vy(a,Jy.calc(b,d));Qy(a.ghost,b.getBody()),Ry(a.ghost,f,a.width,a.height,a.maxX,a.maxY),c(d.clientX,d.clientY)}}},Yy=function(a){var b=a.getSel().getRangeAt(0),c=b.startContainer;return 3===c.nodeType?c.parentNode:c},Zy=function(a,b){return function(c){if(a.dragging&&Ny(b,Yy(b.selection),a.element)){var d=Oy(a.element),e=b.fire("drop",{targetClone:d,clientX:c.clientX,clientY:c.clientY});e.isDefaultPrevented()||(d=e.targetClone,b.undoManager.transact(function(){Sy(a.element),b.insertContent(b.dom.getOuterHTML(d)),b._selectionOverrides.hideFakeCaret()}))}_y(a)}},$y=function(a,b){return function(){a.dragging&&b.fire("dragend"),_y(a)}},_y=function(a){a.dragging=!1,a.element=null,Sy(a.ghost)},az=function(a){var b,c,d,e,f,g,h={};b=_i.DOM,g=document,c=Wy(h,a),d=Xy(h,a),e=Zy(h,a),f=$y(h,a),a.on("mousedown",c),a.on("mousemove",d),a.on("mouseup",e),b.bind(g,"mousemove",d),b.bind(g,"mouseup",f),a.on("remove",function(){b.unbind(g,"mousemove",d),b.unbind(g,"mouseup",f)})},bz=function(a){a.on("drop",function(b){var c=void 0!==b.clientX?a.getDoc().elementFromPoint(b.clientX,b.clientY):null;(Ky(c)||Ky(a.dom.getContentEditableParent(c)))&&b.preventDefault()})},cz=function(a){az(a),bz(a)},dz={init:cz},ez=function(a){var b=function(b){return md.map(b,function(b){return b=Pj(b),b.node=a,b})};if(oi.isElement(a))return b(a.getClientRects());if(oi.isText(a)){var c=a.ownerDocument.createRange();return c.setStart(a,0),c.setEnd(a,a.data.length),b(c.getClientRects())}},fz=function(a){return md.reduce(a,function(a,b){return a.concat(ez(b))},[])};!function(a){a[a.Up=-1]="Up",a[a.Down=1]="Down"}(Ww||(Ww={}));var gz=function(a,b,c,d){for(;d=jn(d,a,Nj,b);)if(c(d))return},hz=function(a,b,c,d,e,f){var g,h,i=0,j=[],k=function(d){var f,g,k;for(k=fz([d]),-1===a&&(k=k.reverse()),f=0;f<k.length;f++)if(g=k[f],!c(g,h)){if(j.length>0&&b(g,md.last(j))&&i++,g.line=i,e(g))return!0;j.push(g)}};return(h=md.last(f.getClientRects()))?(g=f.getNode(),k(g),gz(a,d,k,g),j):j},iz=function(a,b){return b.line>a},jz=function(a,b){return b.line===a},kz=Aa.curry(hz,Ww.Up,Tj,Uj),lz=Aa.curry(hz,Ww.Down,Uj,Tj),mz=function(a,b,c,d){var e,f,g,h,i,j,k=Nn(b),l=[],m=0,n=function(a){return md.last(a.getClientRects())};1===a?(e=k.next,f=Uj,g=Tj,h=Jk.after(d)):(e=k.prev,f=Tj,g=Uj,h=Jk.before(d)),j=n(h);do{if(h.isVisible()&&(i=n(h),!g(i,j))){if(l.length>0&&f(i,md.last(l))&&m++,i=Pj(i),i.position=h,i.line=m,c(i))return l;l.push(i)}}while(h=e(h));return l},nz=function(a){return function(b){return iz(a,b)}},oz=function(a){return function(b){return jz(a,b)}},pz=oi.isContentEditableFalse,qz=jn,rz=function(a,b){return Math.abs(a.left-b)},sz=function(a,b){return Math.abs(a.right-b)},tz=function(a,b){return a>=b.left&&a<=b.right},uz=function(a,b){return md.reduce(a,function(a,c){var d,e;return d=Math.min(rz(a,b),sz(a,b)),e=Math.min(rz(c,b),sz(c,b)),tz(b,c)?c:tz(b,a)?a:e===d&&pz(c.node)?c:e<d?c:a})},vz=function(a,b,c,d){for(;d=qz(d,a,Nj,b);)if(c(d))return},wz=function(a,b){var c=[],d=function(a,d){var e;return e=md.filter(fz([d]),function(c){return!a(c,b)}),c=c.concat(e),0===e.length};return c.push(b),vz(Ww.Up,a,Aa.curry(d,Tj),b.node),vz(Ww.Down,a,Aa.curry(d,Uj),b.node),c},xz=function(a){return md.filter(md.toArray(a.getElementsByTagName("*")),Zm)},yz=function(a,b){return{node:a.node,before:rz(a,b)<sz(a,b)}},zz=function(a,b,c){var d,e=fz(xz(a)),f=md.filter(e,function(a){return c>=a.top&&c<=a.bottom});return d=uz(f,b),d&&(d=uz(wz(a,d),b))&&Zm(d.node)?yz(d,b):null},Az=function(a,b,c){return!c.collapsed&&ob.foldl(c.getClientRects(),function(c,d){return c||Vj(d,a,b)},!1)},Bz={isXYWithinRange:Az},Cz=function(a,b){var c=null,d=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null,d=null)},throttle:function(){d=arguments,null===c&&(c=setTimeout(function(){a.apply(null,d),c=null,d=null},b))}}},Dz=function(a,b){var c=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null)},throttle:function(){var d=arguments;null===c&&(c=setTimeout(function(){a.apply(null,d),c=null,d=null},b))}}},Ez=function(a,b){var c=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null)},throttle:function(){var d=arguments;null!==c&&clearTimeout(c),c=setTimeout(function(){a.apply(null,d),c=null,d=null},b)}}},Fz={adaptable:Cz,first:Dz,last:Ez},Gz=function(a){var b=Fz.first(function(){if(!a.removed){if(a.selection.getRng().collapsed){var b=nl(a,a.selection.getRng(),!1);a.selection.setRng(b)}}},0);a.on("focus",function(){b.throttle()}),a.on("blur",function(){b.cancel()})},Hz={setup:Gz},Iz={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(a){return a.shiftKey||a.ctrlKey||a.altKey||this.metaKeyPressed(a)},metaKeyPressed:function(a){return Ib.mac?a.metaKey:a.ctrlKey&&!a.altKey}},Jz=oi.isContentEditableTrue,Kz=oi.isContentEditableFalse,Lz=yn,Mz=xn,Nz=function(a,b){for(var c=a.getBody();b&&b!==c;){if(Jz(b)||Kz(b))return b;b=b.parentNode}return null},Oz=function(a){var b,c=function(b){return a.dom.isBlock(b)},d=a.getBody(),e=Ym(a.getBody(),c,function(){return Ax.hasFocus(a)}),f="sel-"+a.dom.uniqueId(),g=function(b){return a.dom.hasClass(b,"mce-offscreen-selection")},h=function(){var b=a.dom.get(f);return b?b.getElementsByTagName("*")[0]:b},i=function(b){b&&a.selection.setRng(b)},j=function(){return a.selection.getRng()},k=function(b,c,d,f){void 0===f&&(f=!0);var g;return g=a.fire("ShowCaret",{target:c,direction:b,before:d}),g.isDefaultPrevented()?null:(f&&a.selection.scrollIntoView(c,-1===b),e.show(d,c))},l=function(a,b){return b=sn(a,d,b),-1===a?Jk.fromRangeStart(b):Jk.fromRangeEnd(b)},m=function(b){b.hasAttribute("data-mce-caret")&&(xj(b),i(j()),a.selection.scrollIntoView(b[0]))},n=function(a){return nj(a)||uj(a)||vj(a)},o=function(a){return n(a.startContainer)||n(a.endContainer)},p=function(c,d){var e,g,h,i,j,m,n,p,q,r,t=a.$,u=a.dom;if(!c)return null;if(c.collapsed){if(!o(c))if(!1===d){if(p=l(-1,c),Zm(p.getNode(!0)))return k(-1,p.getNode(!0),!1,!1);if(Zm(p.getNode()))return k(-1,p.getNode(),!p.isAtEnd(),!1)}else{if(p=l(1,c),Zm(p.getNode()))return k(1,p.getNode(),!p.isAtEnd(),!1);if(Zm(p.getNode(!0)))return k(1,p.getNode(!0),!1,!1)}return null}return i=c.startContainer,j=c.startOffset,m=c.endOffset,3===i.nodeType&&0===j&&Kz(i.parentNode)&&(i=i.parentNode,j=u.nodeIndex(i),i=i.parentNode),1!==i.nodeType?null:(m===j+1&&(e=i.childNodes[j]),Kz(e)?(q=r=e.cloneNode(!0),n=a.fire("ObjectSelected",{target:e,targetClone:q}),n.isDefaultPrevented()?null:(g=Uq.descendant(kf.fromDom(a.getBody()),"#"+f).fold(function(){return t([])},function(a){return t([a.dom()])}),q=n.targetClone,0===g.length&&(g=t('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",f),g.appendTo(a.getBody())),c=a.dom.createRng(),q===r&&Ib.ie?(g.empty().append('<p style="font-size: 0" data-mce-bogus="all"></p>').append(q),c.setStartAfter(g[0].firstChild.firstChild),c.setEndAfter(q)):(g.empty().append("").append(q).append(""),c.setStart(g[0].firstChild,1),c.setEnd(g[0].lastChild,0)),g.css({top:u.getPos(e,a.getBody()).y}),g[0].focus(),h=a.selection.getSel(),h.removeAllRanges(),h.addRange(c),ob.each(Nl.descendants(kf.fromDom(a.getBody()),"*[data-mce-selected]"),function(a){Pf.remove(a,"data-mce-selected")}),e.setAttribute("data-mce-selected","1"),b=e,s(),c)):null)},q=function(){b&&b.removeAttribute("data-mce-selected"),Uq.descendant(kf.fromDom(a.getBody()),"#"+f).each(wp.remove),b=null},r=function(){e.destroy(),b=null},s=function(){e.hide()};return Ib.ceFalse&&(function(){a.on("mouseup",function(b){var c=j();c.collapsed&&Nx.isXYInContentArea(a,b.clientX,b.clientY)&&i(ml(a,c,!1))}),a.on("click",function(b){var c;(c=Nz(a,b.target))&&(Kz(c)&&(b.preventDefault(),a.focus()),Jz(c)&&a.dom.isChildOf(c,a.selection.getNode())&&q())}),a.on("blur NewBlock",function(){q()}),a.on("ResizeWindow FullscreenStateChanged",function(){return e.reposition()});var c=function(a){var b=Nn(a);if(!a.firstChild)return!1;var c=Jk.before(a.firstChild),d=b.next(c);return d&&!Mz(d)&&!Lz(d)},f=function(b,c){return a.dom.getParent(b,a.dom.isBlock)===a.dom.getParent(c,a.dom.isBlock)},l=function(b,d){var e=a.dom.getParent(b,a.dom.isBlock),g=a.dom.getParent(d,a.dom.isBlock);return!(!e||!a.dom.isChildOf(e,g)||!1!==Kz(Nz(a,e)))||e&&!f(e,g)&&c(e)};!function(a){var b=!1;a.on("touchstart",function(){b=!1}),a.on("touchmove",function(){b=!0}),a.on("touchend",function(c){var d=Nz(a,c.target);Kz(d)&&(b||(c.preventDefault(),p(ll(a,d))))})}(a),a.on("mousedown",function(b){var c,e=b.target;if((e===d||"HTML"===e.nodeName||a.dom.isChildOf(e,d))&&!1!==Nx.isXYInContentArea(a,b.clientX,b.clientY))if(c=Nz(a,e))Kz(c)?(b.preventDefault(),p(ll(a,c))):(q(),Jz(c)&&b.shiftKey||Bz.isXYWithinRange(b.clientX,b.clientY,a.selection.getRng())||(s(),a.selection.placeCaretAt(b.clientX,b.clientY)));else if(!1===Zm(e)){q(),s();var f=zz(d,b.clientX,b.clientY);if(f&&!l(b.target,f.node)){b.preventDefault();var g=k(1,f.node,f.before,!1);a.getBody().focus(),i(g)}}}),a.on("keypress",function(b){Iz.modifierPressed(b)||(b.keyCode,Kz(a.selection.getNode())&&b.preventDefault())}),a.on("getSelectionRange",function(a){var c=a.range;if(b){if(!b.parentNode)return void(b=null);c=c.cloneRange(),c.selectNode(b),a.range=c}}),a.on("setSelectionRange",function(a){var b;(b=p(a.range,a.forward))&&(a.range=b)}),a.on("AfterSetSelectionRange",function(a){var b=a.range;o(b)||s(),g(b.startContainer.parentNode)||q()}),a.on("copy",function(a){var b=a.clipboardData;if(!a.isDefaultPrevented()&&a.clipboardData&&!Ib.ie){var c=h();c&&(a.preventDefault(),b.clearData(),b.setData("text/html",c.outerHTML),b.setData("text/plain",c.outerText))}}),dz.init(a),Hz.setup(a)}(),function(){var b=a.contentStyles;b.push(e.getCss()),b.push(".mce-content-body .mce-offscreen-selection {position: absolute;left: -9999999999px;max-width: 1000000px;}.mce-content-body *[contentEditable=false] {cursor: default;}.mce-content-body *[contentEditable=true] {cursor: text;}")}()),{showCaret:k,showBlockCaretContainer:m,hideFakeCaret:s,destroy:r}},Pz=function(a){return 0===a.indexOf("data-")||0===a.indexOf("aria-")},Qz=function(a){return a.replace(/<!--|-->/g,"")},Rz=function(a,b){return!a.allow_html_data_urls&&(/^data:image\//i.test(b)?!1===a.allow_svg_data_urls&&/^data:image\/svg\+xml/i.test(b):/^data:/i.test(b))},Sz=function(a,b,c){var d,e,f,g,h=1;for(g=a.getShortEndedElements(),f=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g,f.lastIndex=d=c;e=f.exec(b);){if(d=f.lastIndex,"/"===e[1])h--;else if(!e[1]){if(e[2]in g)continue;h++}if(0===h)break}return d};!function(a){a.findEndTag=Sz}(S||(S={}));var Tz=S,Uz=function(a,b){var c=new RegExp(["\\s?("+a.join("|")+')="[^"]+"'].join("|"),"gi");return b.replace(c,"")},Vz=function(a,b){var c,d,e,f,g,h=b,i=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,j=a.schema;for(h=Uz(a.getTempAttrs(),h),g=j.getShortEndedElements();f=i.exec(h);)d=i.lastIndex,e=f[0].length,c=g[f[1]]?d:Tz.findEndTag(j,h,d),h=h.substring(0,d-e)+h.substring(c),i.lastIndex=d-e;return ij.trim(h)},Wz=Vz,Xz={trimExternal:Wz,trimInternal:Vz},Yz=function(a,b){var c=a.length+b.length+2,d=new Array(c),e=new Array(c),f=function(a,b,c){return{start:a,end:b,diag:c}},g=function(c,d,e,f,h){var j=i(c,d,e,f);if(null===j||j.start===d&&j.diag===d-f||j.end===c&&j.diag===c-e)for(var k=c,l=e;k<d||l<f;)k<d&&l<f&&a[k]===b[l]?(h.push([0,a[k]]),++k,++l):d-c>f-e?(h.push([2,a[k]]),++k):(h.push([1,b[l]]),++l);else{g(c,j.start,e,j.start-j.diag,h);for(var m=j.start;m<j.end;++m)h.push([0,a[m]]);g(j.end,d,j.end-j.diag,f,h)}},h=function(c,d,e,g){for(var h=c;h-d<g&&h<e&&a[h]===b[h-d];)++h;return f(c,h,d)},i=function(c,f,g,i){var j=f-c,k=i-g;if(0===j||0===k)return null;var l=j-k,m=k+j,n=(m%2==0?m:m+1)/2;d[1+n]=c,e[1+n]=f+1;var o,p,q,r,s;for(o=0;o<=n;++o){for(p=-o;p<=o;p+=2){for(q=p+n,p===-o||p!==o&&d[q-1]<d[q+1]?d[q]=d[q+1]:d[q]=d[q-1]+1,r=d[q],s=r-c+g-p;r<f&&s<i&&a[r]===b[s];)d[q]=++r,++s;if(l%2!=0&&l-o<=p&&p<=l+o&&e[q-l]<=d[q])return h(e[q-l],p+c-g,f,i)}for(p=l-o;p<=l+o;p+=2){for(q=p+n-l,p===l-o||p!==l+o&&e[q+1]<=e[q-1]?e[q]=e[q+1]-1:e[q]=e[q-1],r=e[q]-1,s=r-c+g-p;r>=c&&s>=g&&a[r]===b[s];)e[q]=r--,s--;if(l%2==0&&-o<=p&&p<=o&&e[q]<=d[q+l])return h(e[q],p+c-g,f,i)}}},j=[];return g(0,a.length,0,b.length,j),j},Zz={KEEP:0,DELETE:2,INSERT:1,diff:Yz},$z=function(a){return oi.isElement(a)?a.outerHTML:oi.isText(a)?Hi.encodeRaw(a.data,!1):oi.isComment(a)?"\x3c!--"+a.data+"--\x3e":""},_z=function(a){var b,c,d;for(d=document.createElement("div"),b=document.createDocumentFragment(),a&&(d.innerHTML=a);c=d.firstChild;)b.appendChild(c);return b},aA=function(a,b,c){var d=_z(b);if(a.hasChildNodes()&&c<a.childNodes.length){var e=a.childNodes[c];e.parentNode.insertBefore(d,e)}else a.appendChild(d)},bA=function(a,b){if(a.hasChildNodes()&&b<a.childNodes.length){var c=a.childNodes[b];c.parentNode.removeChild(c)}},cA=function(a,b){var c=0;md.each(a,function(a){a[0]===Zz.KEEP?c++:a[0]===Zz.INSERT?(aA(b,a[1],c),c++):a[0]===Zz.DELETE&&bA(b,c)})},dA=function(a){return md.filter(md.map(a.childNodes,$z),function(a){return a.length>0})},eA=function(a,b){var c=md.map(b.childNodes,$z);return cA(Zz.diff(c,a),b),b},fA={read:dA,write:eA},gA=function(a,b){var c=b||document,d=c.createElement("div");return d.innerHTML=a,hh.children(kf.fromDom(d))},hA=function(a,b){return ob.map(a,function(a){return kf.fromTag(a,b)})},iA=function(a,b){return ob.map(a,function(a){return kf.fromText(a,b)})},jA=function(a){return ob.map(a,kf.fromDom)},kA={fromHtml:gA,fromTags:hA,fromText:iA,fromDom:jA},lA=function(a){return a.dom().innerHTML},mA=function(a,b){var c=hh.owner(a),d=c.dom(),e=kf.fromDom(d.createDocumentFragment()),f=kA.fromHtml(b,d);sp.append(e,f),wp.empty(a),Cm.append(a,e)},nA=function(a){var b=kf.fromTag("div"),c=kf.fromDom(a.dom().cloneNode(!0));return Cm.append(b,c),lA(b)},oA={get:lA,set:mA,getOuter:nA},pA=Tm(Ha.none()),qA=function(){return pA.get().getOrThunk(function(){var a=document.implementation.createHTMLDocument("undo");return pA.set(Ha.some(a)),a})},rA=function(a){return-1!==a.indexOf("</iframe>")},sA=function(a){return{type:"fragmented",fragments:a,content:"",bookmark:null,beforeBookmark:null}},tA=function(a){return{type:"complete",fragments:null,content:a,bookmark:null,beforeBookmark:null}},uA=function(a){var b,c,d;return b=fA.read(a.getBody()),d=ob.bind(b,function(b){var c=Xz.trimInternal(a.serializer,b);return c.length>0?[c]:[]}),c=d.join(""),rA(c)?sA(d):tA(c)},vA=function(a,b,c){"fragmented"===b.type?fA.write(b.fragments,a.getBody()):a.setContent(b.content,{format:"raw"}),a.selection.moveToBookmark(c?b.beforeBookmark:b.bookmark)},wA=function(a){return"fragmented"===a.type?a.fragments.join(""):a.content},xA=function(a){var b=kf.fromTag("body",qA());return oA.set(b,wA(a)),ob.each(Nl.descendants(b,"*[data-mce-bogus]"),wp.unwrap),oA.get(b)},yA=function(a,b){return wA(a)===wA(b)},zA=function(a,b){return xA(a)===xA(b)},AA=function(a,b){return!(!a||!b)&&(!!yA(a,b)||zA(a,b))},BA={createFragmentedLevel:sA,createCompleteLevel:tA,createFromEditor:uA,applyToEditor:vA,isEq:AA},CA=function(a){return a&&/^(IMG)$/.test(a.nodeName)},DA=function(a,b,c){var d,e,f,g=c.startOffset,h=c.startContainer;if((c.startContainer!==c.endContainer||!CA(c.startContainer.childNodes[c.startOffset]))&&1===h.nodeType)for(f=h.childNodes,g<f.length?(h=f[g],d=new s(h,a.getParent(h,a.isBlock))):(h=f[f.length-1],d=new s(h,a.getParent(h,a.isBlock)),d.next(!0)),e=d.current();e;e=d.next())if(3===e.nodeType&&!HA(e))return c.setStart(e,0),void b.setRng(c)},EA=function(a,b,c){if(a)for(b=b?"nextSibling":"previousSibling",a=c?a:a[b];a;a=a[b])if(1===a.nodeType||!HA(a))return a},FA=function(a,b){return b.nodeType&&(b=b.nodeName),!!a.schema.getTextBlockElements()[b.toLowerCase()]},GA=function(a,b,c){return a.schema.isValidChild(b,c)},HA=function(a){return a&&3===a.nodeType&&/^([\t \r\n]+|)$/.test(a.nodeValue)},IA=function(a,b){return"string"!=typeof a?a=a(b):b&&(a=a.replace(/%(\w+)/g,function(a,c){return b[c]||a})),a},JA=function(a,b){return a=a||"",b=b||"",a=""+(a.nodeName||a),b=""+(b.nodeName||b),a.toLowerCase()===b.toLowerCase()},KA=function(a,b,c){return"color"!==c&&"backgroundColor"!==c||(b=a.toHex(b)),"fontWeight"===c&&700===b&&(b="bold"),"fontFamily"===c&&(b=b.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+b},LA=function(a,b,c){return KA(a,a.getStyle(b,c),c)},MA=function(a,b){var c;return a.getParent(b,function(b){return(c=a.getStyle(b,"text-decoration"))&&"none"!==c}),c},NA=function(a,b,c){return a.getParents(b,c,a.getRoot())},OA={isInlineBlock:CA,moveStart:DA,getNonWhiteSpaceSibling:EA,isTextBlock:FA,isValid:GA,isWhiteSpaceNode:HA,replaceVars:IA,isEq:JA,normalizeStyleValue:KA,getStyle:LA,getTextDecoration:MA,getParents:NA},PA=lp.isBookmarkNode,QA=OA.getParents,RA=OA.isWhiteSpaceNode,SA=OA.isTextBlock,TA=function(a,b){for(void 0===b&&(b=3===a.nodeType?a.length:a.childNodes.length);a&&a.hasChildNodes();)(a=a.childNodes[b])&&(b=3===a.nodeType?a.length:a.childNodes.length);return{node:a,offset:b}},UA=function(a,b){var c=TA(a,b);if(c.node){for(;c.node&&0===c.offset&&c.node.previousSibling;)c=TA(c.node.previousSibling);c.node&&c.offset>0&&3===c.node.nodeType&&" "===c.node.nodeValue.charAt(c.offset-1)&&c.offset>1&&(a=c.node,a.splitText(c.offset-1))}return a},VA=function(a){return"BR"===a.nodeName&&a.getAttribute("data-mce-bogus")&&!a.nextSibling},WA=function(a,b){for(var c=b;c;){if(1===c.nodeType&&a.getContentEditable(c))return"false"===a.getContentEditable(c)?c:b;c=c.parentNode}return b},XA=function(a,b,c,d){var e,f,g=c.nodeValue;return void 0===d&&(d=a?g.length:0),a?(e=g.lastIndexOf(" ",d),f=g.lastIndexOf("",d),-1===(e=e>f?e:f)||b||e++):(e=g.indexOf(" ",d),f=g.indexOf("",d),e=-1!==e&&(-1===f||e<f)?e:f),e},YA=function(a,b,c,d,e,f){var g,h,i,j;if(3===c.nodeType){if(-1!==(i=XA(e,f,c,d)))return{container:c,offset:i};j=c}for(g=new s(c,a.getParent(c,a.isBlock)||b);h=g[e?"prev":"next"]();)if(3===h.nodeType){if(j=h,-1!==(i=XA(e,f,h)))return{container:h,offset:i}}else if(a.isBlock(h))break;if(j)return d=e?0:j.length,{container:j,offset:d}},ZA=function(a,b,c,d,e){var f,g,h,i;for(3===d.nodeType&&0===d.nodeValue.length&&d[e]&&(d=d[e]),f=QA(a,d),g=0;g<f.length;g++)for(h=0;h<b.length;h++)if(!("collapsed"in(i=b[h])&&i.collapsed!==c.collapsed)&&a.is(f[g],i.selector))return f[g];return d},$A=function(a,b,c,d){var e,f=a.dom,g=f.getRoot();if(b[0].wrapper||(e=f.getParent(c,b[0].block,g)),!e){var h=f.getParent(c,"LI,TD,TH");e=f.getParent(3===c.nodeType?c.parentNode:c,function(b){return b!==g&&SA(a,b)},h)}if(e&&b[0].wrapper&&(e=QA(f,e,"ul,ol").reverse()[0]||e),!e)for(e=c;e[d]&&!f.isBlock(e[d])&&(e=e[d],!OA.isEq(e,"br")););return e||c},_A=function(a,b,c,d,e,f,g){var h,i,j,k,l;if(h=i=g?c:e,k=g?"previousSibling":"nextSibling",l=a.getRoot(),3===h.nodeType&&!RA(h)&&(g?d>0:f<h.nodeValue.length))return h;for(;;){if(!b[0].block_expand&&a.isBlock(i))return i;for(j=i[k];j;j=j[k])if(!PA(j)&&!RA(j)&&!VA(j))return i;if(i===l||i.parentNode===l){h=i;break}i=i.parentNode}return h},aB=function(a,b,c,d){var e,f=b.startContainer,g=b.startOffset,h=b.endContainer,i=b.endOffset,j=a.dom;return 1===f.nodeType&&f.hasChildNodes()&&(f=$j(f,g),3===f.nodeType&&(g=0)),1===h.nodeType&&h.hasChildNodes()&&(h=$j(h,b.collapsed?i:i-1),3===h.nodeType&&(i=h.nodeValue.length)),f=WA(j,f),h=WA(j,h),(PA(f.parentNode)||PA(f))&&(f=PA(f)?f:f.parentNode,f=f.nextSibling||f,3===f.nodeType&&(g=0)),(PA(h.parentNode)||PA(h))&&(h=PA(h)?h:h.parentNode,h=h.previousSibling||h,3===h.nodeType&&(i=h.length)),c[0].inline&&(b.collapsed&&(e=YA(j,a.getBody(),f,g,!0,d),e&&(f=e.container,g=e.offset),(e=YA(j,a.getBody(),h,i,!1,d))&&(h=e.container,i=e.offset)),h=d?h:UA(h,i)),(c[0].inline||c[0].block_expand)&&(c[0].inline&&3===f.nodeType&&0!==g||(f=_A(j,c,f,g,h,i,!0)),c[0].inline&&3===h.nodeType&&i!==h.nodeValue.length||(h=_A(j,c,f,g,h,i,!1))),c[0].selector&&!1!==c[0].expand&&!c[0].inline&&(f=ZA(j,c,b,f,"previousSibling"),h=ZA(j,c,b,h,"nextSibling")),(c[0].block||c[0].selector)&&(f=$A(a,c,f,"previousSibling"),h=$A(a,c,h,"nextSibling"),c[0].block&&(j.isBlock(f)||(f=_A(j,c,f,g,h,i,!0)),j.isBlock(h)||(h=_A(j,c,f,g,h,i,!1)))),1===f.nodeType&&(g=j.nodeIndex(f),f=f.parentNode),1===h.nodeType&&(i=j.nodeIndex(h)+1,h=h.parentNode),{startContainer:f,startOffset:g,endContainer:h,endOffset:i}},bB={expandRng:aB},cB=OA.isEq,dB=function(a,b,c){var d=a.formatter.get(c);if(d)for(var e=0;e<d.length;e++)if(!1===d[e].inherit&&a.dom.is(b,d[e].selector))return!0;return!1},eB=function(a,b,c,d){var e=a.dom.getRoot();return b!==e&&(b=a.dom.getParent(b,function(b){return!!dB(a,b,c)||(b.parentNode===e||!!hB(a,b,c,d,!0))}),hB(a,b,c,d))},fB=function(a,b,c){return!!cB(b,c.inline)||(!!cB(b,c.block)||(c.selector?1===b.nodeType&&a.is(b,c.selector):void 0))},gB=function(a,b,c,d,e,f){var g,h,i,j=c[d];if(c.onmatch)return c.onmatch(b,c,d);if(j)if(void 0===j.length){for(g in j)if(j.hasOwnProperty(g)){if(h="attributes"===d?a.getAttrib(b,g):OA.getStyle(a,b,g),e&&!h&&!c.exact)return;if((!e||c.exact)&&!cB(h,OA.normalizeStyleValue(a,OA.replaceVars(j[g],f),g)))return}}else for(i=0;i<j.length;i++)if("attributes"===d?a.getAttrib(b,j[i]):OA.getStyle(a,b,j[i]))return c;return c},hB=function(a,b,c,d,e){var f,g,h,i,j=a.formatter.get(c),k=a.dom;if(j&&b)for(g=0;g<j.length;g++)if(f=j[g],fB(a.dom,b,f)&&gB(k,b,f,"attributes",e,d)&&gB(k,b,f,"styles",e,d)){if(i=f.classes)for(h=0;h<i.length;h++)if(!a.dom.hasClass(b,i[h]))return;return f}},iB=function(a,b,c,d){var e;return d?eB(a,d,b,c):(d=a.selection.getNode(),!!eB(a,d,b,c)||!((e=a.selection.getStart())===d||!eB(a,e,b,c)))},jB=function(a,b,c){var d,e=[],f={};return d=a.selection.getStart(),a.dom.getParent(d,function(d){var g,h;for(g=0;g<b.length;g++)h=b[g],!f[h]&&hB(a,d,h,c)&&(f[h]=!0,e.push(h))},a.dom.getRoot()),e},kB=function(a,b){var c,d,e,f,g,h=a.formatter.get(b),i=a.dom;if(h)for(c=a.selection.getStart(),d=OA.getParents(i,c),f=h.length-1;f>=0;f--){if(!(g=h[f].selector)||h[f].defaultBlock)return!0;for(e=d.length-1;e>=0;e--)if(i.is(d[e],g))return!0}return!1},lB={matchNode:hB,matchName:fB,match:iB,matchAll:jB,canApply:kB,matchesUnInheritedFormatSelector:dB},mB=function(a,b){return a.splitText(b)},nB=function(a){var b=a.startContainer,c=a.startOffset,d=a.endContainer,e=a.endOffset;return b===d&&oi.isText(b)?c>0&&c<b.nodeValue.length&&(d=mB(b,c),b=d.previousSibling,e>c?(e-=c,b=d=mB(d,e).previousSibling,e=d.nodeValue.length,c=0):e=0):(oi.isText(b)&&c>0&&c<b.nodeValue.length&&(b=mB(b,c),c=0),oi.isText(d)&&e>0&&e<d.nodeValue.length&&(d=mB(d,e).previousSibling,e=d.nodeValue.length)),{startContainer:b,startOffset:c,endContainer:d,endOffset:e}},oB={split:nB},pB=ij.ZWSP,qB=function(a,b){return a.importNode(b,!0)},rB=function(a){for(var b=[];a;){if(3===a.nodeType&&a.nodeValue!==pB||a.childNodes.length>1)return[];1===a.nodeType&&b.push(a),a=a.firstChild}return b},sB=function(a){return rB(a).length>0},tB=function(a){var b;if(a)for(b=new s(a,a),a=b.current();a;a=b.next())if(3===a.nodeType)return a;return null},uB=function(a){var b=kf.fromTag("span");return Pf.setAll(b,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),a&&Cm.append(b,kf.fromText(pB)),b},vB=function(a){var b=tB(a);return b&&b.nodeValue.charAt(0)===pB&&b.deleteData(0,1),b},wB=function(a,b,c,d){var e,f,g;e=b.getRng(!0),f=a.getParent(c,a.isBlock),sB(c)?(!1!==d&&(e.setStartBefore(c),e.setEndBefore(c)),a.remove(c)):(g=vB(c),e.startContainer===g&&e.startOffset>0&&e.setStart(g,e.startOffset-1),e.endContainer===g&&e.endOffset>0&&e.setEnd(g,e.endOffset-1),a.remove(c,!0)),f&&a.isEmpty(f)&&Ip.fillWithPaddingBr(kf.fromDom(f)),b.setRng(e)},xB=function(a,b,c,d,e){if(d)wB(b,c,d,e);else if(!(d=Po(a,c.getStart())))for(;d=b.get("_mce_caret");)wB(b,c,d,!1)},yB=function(a,b,c){var d=a.dom,e=d.getParent(c,jk.curry(OA.isTextBlock,a));e&&d.isEmpty(e)?c.parentNode.replaceChild(b,c):(Ip.removeTrailingBr(kf.fromDom(c)),d.isEmpty(c)?c.parentNode.replaceChild(b,c):d.insertAfter(b,c))},zB=function(a,b){return a.appendChild(b),b},AB=function(a,b){var c=ob.foldr(a,function(a,b){return zB(a,b.cloneNode(!1))},b);return zB(c,c.ownerDocument.createTextNode(pB))},BB=function(a,b,c){var d,e,f,g,h,i,j,k=a.selection;d=k.getRng(!0),g=d.startOffset,i=d.startContainer,j=i.nodeValue,(e=Po(a.getBody(),k.getStart()))&&(f=tB(e));var l=/[^\s\u00a0\u00ad\u200b\ufeff]/;j&&g>0&&g<j.length&&l.test(j.charAt(g))&&l.test(j.charAt(g-1))?(h=k.getBookmark(),d.collapse(!0),d=bB.expandRng(a,d,a.formatter.get(b)),d=oB.split(d),a.formatter.apply(b,c,d),k.moveToBookmark(h)):(e&&f.nodeValue===pB?a.formatter.apply(b,c,e):(e=qB(a.getDoc(),uB(!0).dom()),f=e.firstChild,d.insertNode(e),g=1,a.formatter.apply(b,c,e)),k.setCursorLocation(f,g))},CB=function(a,b,c,d){var e,f,g,h,i,j,k,l=a.dom,m=a.selection,n=[],o=m.getRng();for(e=o.startContainer,f=o.startOffset,i=e,3===e.nodeType&&(f!==e.nodeValue.length&&(h=!0),i=i.parentNode);i;){if(lB.matchNode(a,i,b,c,d)){j=i;break}i.nextSibling&&(h=!0),n.push(i),i=i.parentNode}if(j)if(h){g=m.getBookmark(),o.collapse(!0);var p=bB.expandRng(a,o,a.formatter.get(b),!0);p=oB.split(p),a.formatter.remove(b,c,p),m.moveToBookmark(g)}else{k=Po(a.getBody(),j);var q=uB(!1).dom(),r=AB(n,q);k?yB(a,q,k):yB(a,q,j),wB(l,m,k,!1),m.setCursorLocation(r,1),l.isEmpty(j)&&l.remove(j)}},DB=function(a,b,c,d){xB(a,b,c,null,!1),8===d&&c.isCollapsed()&&c.getStart().innerHTML===pB&&xB(a,b,c,Po(a,c.getStart())),37!==d&&39!==d||xB(a,b,c,Po(a,c.getStart()))},EB=function(a){var b=a.dom,c=a.selection,d=a.getBody();a.on("mouseup keydown",function(a){DB(d,b,c,a.keyCode)})},FB=function(a,b){var c=uB(!1),d=AB(b,c.dom());return Cm.before(kf.fromDom(a),c),wp.remove(kf.fromDom(a)),Jk(d,0)},GB=function(a,b){return a.schema.getTextInlineElements().hasOwnProperty(uf.name(b))&&!Oo(b.dom())&&!oi.isBogus(b.dom())},HB={},IB=md.filter,JB=md.each,KB=function(a,b){JB(HB[a],function(a){a(b)})};!function(a,b){var c=HB[a];c||(HB[a]=c=[]),HB[a].push(b)}("pre",function(a){var b,c,d=a.selection.getRng(),e=function(a){return b(a.previousSibling)&&-1!==md.indexOf(c,a.previousSibling)},f=function(a,b){Td(b).remove(),Td(a).append("<br><br>").append(b.childNodes)};b=oi.matchNodeNames("pre"),d.collapsed||(c=a.selection.getSelectedBlocks(),JB(IB(IB(c,b),e),function(a){f(a.previousSibling,a)}))});var LB={postProcess:KB},MB=zd.each,NB=function(a,b){var c=a.childNodes;return b--,b>c.length-1?b=c.length-1:b<0&&(b=0),c[b]||a},OB=function(a,b,c){var d,e,f,g,h,i,j,k=b.startContainer,l=b.startOffset,m=b.endContainer,n=b.endOffset;if(j=a.select("td[data-mce-selected],th[data-mce-selected]"),j.length>0)return void MB(j,function(a){c([a])});var o=function(a){var b;return b=a[0],3===b.nodeType&&b===k&&l>=b.nodeValue.length&&a.splice(0,1),b=a[a.length-1],0===n&&a.length>0&&b===m&&3===b.nodeType&&a.splice(a.length-1,1),a},p=function(a,b,c){for(var d=[];a&&a!==c;a=a[b])d.push(a);return d},q=function(a,b){do{if(a.parentNode===b)return a;a=a.parentNode}while(a)},r=function(a,b,d){var e=d?"nextSibling":"previousSibling";for(g=a,h=g.parentNode;g&&g!==b;g=h)h=g.parentNode,i=p(g===a?g:g[e],e),i.length&&(d||i.reverse(),c(o(i)))};if(1===k.nodeType&&k.hasChildNodes()&&(k=k.childNodes[l]),1===m.nodeType&&m.hasChildNodes()&&(m=NB(m,n)),k===m)return c(o([k]));for(d=a.findCommonAncestor(k,m),g=k;g;g=g.parentNode){if(g===m)return r(k,d,!0);if(g===d)break}for(g=m;g;g=g.parentNode){if(g===k)return r(m,d);if(g===d)break}e=q(k,d)||k,f=q(m,d)||m,r(k,e,!0),i=p(e===k?e:e.nextSibling,"nextSibling",f===m?f.nextSibling:f),i.length&&c(o(i)),r(m,f)},PB={walk:OB},QB=/^(src|href|style)$/,RB=zd.each,SB=OA.isEq,TB=function(a){return/^(TH|TD)$/.test(a.nodeName)},UB=function(a,b,c){var d,e,f;return d=b[c?"startContainer":"endContainer"],e=b[c?"startOffset":"endOffset"],oi.isElement(d)&&(f=d.childNodes.length-1,!c&&e&&e--,d=d.childNodes[e>f?f:e]),oi.isText(d)&&c&&e>=d.nodeValue.length&&(d=new s(d,a.getBody()).next()||d),oi.isText(d)&&!c&&0===e&&(d=new s(d,a.getBody()).prev()||d),d},VB=function(a,b,c,d){var e=a.create(c,d);return b.parentNode.insertBefore(e,b),e.appendChild(b),e},WB=function(a,b,c){return!!SB(b,c.inline)||(!!SB(b,c.block)||(c.selector?oi.isElement(b)&&a.is(b,c.selector):void 0))},XB=function(a,b){return b.links&&"A"===a.tagName},YB=function(a,b,c,d){return!(b=OA.getNonWhiteSpaceSibling(b,c,d))||"BR"===b.nodeName||a.isBlock(b)},ZB=function(a,b,c){var d,e=b.parentNode,f=a.dom,g=a.settings.forced_root_block;c.block&&(g?e===f.getRoot()&&(c.list_block&&SB(b,c.list_block)||RB(zd.grep(b.childNodes),function(b){OA.isValid(a,g,b.nodeName.toLowerCase())?d?d.appendChild(b):(d=VB(f,b,g),
f.setAttribs(d,a.settings.forced_root_block_attrs)):d=0})):f.isBlock(b)&&!f.isBlock(e)&&(YB(f,b,!1)||YB(f,b.firstChild,!0,1)||b.insertBefore(f.create("br"),b.firstChild),YB(f,b,!0)||YB(f,b.lastChild,!1,1)||b.appendChild(f.create("br")))),c.selector&&c.inline&&!SB(c.inline,b)||f.remove(b,1)},$B=function(a,b,c,d,e){var f,g,h,i=a.dom;if(!WB(i,d,b)&&!XB(d,b))return!1;if("all"!==b.remove)for(RB(b.styles,function(a,f){a=OA.normalizeStyleValue(i,OA.replaceVars(a,c),f),"number"==typeof f&&(f=a,e=0),(b.remove_similar||!e||SB(OA.getStyle(i,e,f),a))&&i.setStyle(d,f,""),h=1}),h&&""===i.getAttrib(d,"style")&&(d.removeAttribute("style"),d.removeAttribute("data-mce-style")),RB(b.attributes,function(a,b){var f;if(a=OA.replaceVars(a,c),"number"==typeof b&&(b=a,e=0),!e||SB(i.getAttrib(e,b),a)){if("class"===b&&(a=i.getAttrib(d,b))&&(f="",RB(a.split(/\s+/),function(a){/mce\-\w+/.test(a)&&(f+=(f?" ":"")+a)}),f))return void i.setAttrib(d,b,f);"class"===b&&d.removeAttribute("className"),QB.test(b)&&d.removeAttribute("data-mce-"+b),d.removeAttribute(b)}}),RB(b.classes,function(a){a=OA.replaceVars(a,c),e&&!i.hasClass(e,a)||i.removeClass(d,a)}),g=i.getAttribs(d),f=0;f<g.length;f++){var j=g[f].nodeName;if(0!==j.indexOf("_")&&0!==j.indexOf("data-"))return!1}return"none"!==b.remove?(ZB(a,d,b),!0):void 0},_B=function(a,b,c,d,e){var f;return RB(OA.getParents(a.dom,b.parentNode).reverse(),function(b){var g;f||"_start"===b.id||"_end"===b.id||(g=lB.matchNode(a,b,c,d,e))&&!1!==g.split&&(f=b)}),f},aC=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=a.dom;if(c){for(n=c.parentNode,i=d.parentNode;i&&i!==n;i=i.parentNode){for(j=o.clone(i,!1),m=0;m<b.length;m++)if($B(a,b[m],h,j,j)){j=0;break}j&&(k&&j.appendChild(k),l||(l=j),k=j)}!f||g.mixed&&o.isBlock(c)||(d=o.split(c,d)),k&&(e.parentNode.insertBefore(k,e),l.appendChild(e))}return d},bC=function(a,b,c,d,e){var f,g,h=a.formatter.get(b),i=h[0],j=!0,k=a.dom,l=a.selection,m=function(d){var f=_B(a,d,b,c,e);return aC(a,h,f,d,d,!0,i,c)},n=function(b){var d,e,f,g,l;if(oi.isElement(b)&&k.getContentEditable(b)&&(g=j,j="true"===k.getContentEditable(b),l=!0),d=zd.grep(b.childNodes),j&&!l)for(e=0,f=h.length;e<f&&!$B(a,h[e],c,b,b);e++);if(i.deep&&d.length){for(e=0,f=d.length;e<f;e++)n(d[e]);l&&(j=g)}},o=function(a){var b=k.get(a?"_start":"_end"),c=b[a?"firstChild":"lastChild"];return lp.isBookmarkNode(c)&&(c=c[a?"firstChild":"lastChild"]),oi.isText(c)&&0===c.data.length&&(c=a?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling),k.remove(b,!0),c},p=function(b){var c,d,e=b.commonAncestorContainer;if(b=bB.expandRng(a,b,h,!0),i.split){if(c=UB(a,b,!0),d=UB(a,b),c!==d){if(/^(TR|TH|TD)$/.test(c.nodeName)&&c.firstChild&&(c="TR"===c.nodeName?c.firstChild.firstChild||c:c.firstChild||c),e&&/^T(HEAD|BODY|FOOT|R)$/.test(e.nodeName)&&TB(d)&&d.firstChild&&(d=d.firstChild||d),k.isChildOf(c,d)&&c!==d&&!k.isBlock(d)&&!TB(c)&&!TB(d))return c=VB(k,c,"span",{id:"_start","data-mce-type":"bookmark"}),m(c),void(c=o(!0));c=VB(k,c,"span",{id:"_start","data-mce-type":"bookmark"}),d=VB(k,d,"span",{id:"_end","data-mce-type":"bookmark"}),m(c),m(d),c=o(!0),d=o()}else c=d=m(c);b.startContainer=c.parentNode?c.parentNode:c,b.startOffset=k.nodeIndex(c),b.endContainer=d.parentNode?d.parentNode:d,b.endOffset=k.nodeIndex(d)+1}PB.walk(k,b,function(b){RB(b,function(b){n(b),oi.isElement(b)&&"underline"===a.dom.getStyle(b,"text-decoration")&&b.parentNode&&"underline"===OA.getTextDecoration(k,b.parentNode)&&$B(a,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,b)})})};if(d)return void(d.nodeType?(g=k.createRng(),g.setStartBefore(d),g.setEndAfter(d),p(g)):p(d));if("false"!==k.getContentEditable(l.getNode()))l.isCollapsed()&&i.inline&&!k.select("td[data-mce-selected],th[data-mce-selected]").length?CB(a,b,c,e):(f=No.getPersistentBookmark(a.selection,!0),p(l.getRng()),l.moveToBookmark(f),i.inline&&lB.match(a,b,c,l.getStart())&&OA.moveStart(k,l,l.getRng()),a.nodeChanged());else{d=l.getNode();for(var q=0,r=h.length;q<r&&(!h[q].ceFalseOverride||!$B(a,h[q],c,d,d));q++);}},cC={removeFormat:$B,remove:bC},dC=zd.each,eC=function(a){return a&&1===a.nodeType&&!lp.isBookmarkNode(a)&&!Oo(a)&&!oi.isBogus(a)},fC=function(a,b){var c;for(c=a;c;c=c[b]){if(3===c.nodeType&&0!==c.nodeValue.length)return a;if(1===c.nodeType&&!lp.isBookmarkNode(c))return c}return a},gC=function(a,b,c){var d,e,f=new np(a);if(b&&c&&(b=fC(b,"previousSibling"),c=fC(c,"nextSibling"),f.compare(b,c))){for(d=b.nextSibling;d&&d!==c;)e=d,d=d.nextSibling,b.appendChild(e);return a.remove(c),zd.each(zd.grep(c.childNodes),function(a){b.appendChild(a)}),b}return c},hC=function(a,b,c){dC(a.childNodes,function(a){eC(a)&&(b(a)&&c(a),a.hasChildNodes()&&hC(a,b,c))})},iC=function(a,b){return Aa.curry(function(b,c){return!(!c||!OA.getStyle(a,c,b))},b)},jC=function(a,b,c){return Aa.curry(function(b,c,d){a.setStyle(d,b,c),""===d.getAttribute("style")&&d.removeAttribute("style"),kC(a,d)},b,c)},kC=function(a,b){"SPAN"===b.nodeName&&0===a.getAttribs(b).length&&a.remove(b,!0)},lC=function(a,b){var c;1===b.nodeType&&b.parentNode&&1===b.parentNode.nodeType&&(c=OA.getTextDecoration(a,b.parentNode),a.getStyle(b,"color")&&c?a.setStyle(b,"text-decoration",c):a.getStyle(b,"text-decoration")===c&&a.setStyle(b,"text-decoration",null))},mC=function(a,b,c,d){(b.styles.color||b.styles.textDecoration)&&(zd.walk(d,Aa.curry(lC,a),"childNodes"),lC(a,d))},nC=function(a,b,c,d){b.styles&&b.styles.backgroundColor&&hC(d,iC(a,"fontSize"),jC(a,"backgroundColor",OA.replaceVars(b.styles.backgroundColor,c)))},oC=function(a,b,c,d){"sub"!==b.inline&&"sup"!==b.inline||(hC(d,iC(a,"fontSize"),jC(a,"fontSize","")),a.remove(a.select("sup"===b.inline?"sub":"sup",d),!0))},pC=function(a,b,c,d){d&&!1!==b.merge_siblings&&(d=gC(a,OA.getNonWhiteSpaceSibling(d),d),d=gC(a,d,OA.getNonWhiteSpaceSibling(d,!0)))},qC=function(a,b,c){if(b.clear_child_styles){var d=b.links?"*:not(a)":"*";dC(a.select(d,c),function(c){eC(c)&&dC(b.styles,function(b,d){a.setStyle(c,d,"")})})}},rC=function(a,b,c,d){dC(b,function(b){dC(a.dom.select(b.inline,d),function(d){eC(d)&&cC.removeFormat(a,b,c,d,b.exact?d:null)}),qC(a.dom,b,d)})},sC=function(a,b,c,d,e){lB.matchNode(a,e.parentNode,c,d)&&cC.removeFormat(a,b,d,e)||b.merge_with_parents&&a.dom.getParent(e.parentNode,function(f){if(lB.matchNode(a,f,c,d))return cC.removeFormat(a,b,d,e),!0})},tC={mergeWithChildren:rC,mergeUnderlineAndColor:mC,mergeBackgroundColorAndFontSize:nC,mergeSubSup:oC,mergeSiblings:pC,mergeWithParents:sC},uC=zd.each,vC=function(a){return a&&1===a.nodeType&&!lp.isBookmarkNode(a)&&!Oo(a)&&!oi.isBogus(a)},wC=function(a,b,c,d){var e,f,g=a.formatter.get(b),h=g[0],i=!d&&a.selection.isCollapsed(),j=a.dom,k=a.selection,l=function(a,b){if(b=b||h,a){if(b.onformat&&b.onformat(a,b,c,d),uC(b.styles,function(b,d){j.setStyle(a,d,OA.replaceVars(b,c))}),b.styles){var e=j.getAttrib(a,"style");e&&a.setAttribute("data-mce-style",e)}uC(b.attributes,function(b,d){j.setAttrib(a,d,OA.replaceVars(b,c))}),uC(b.classes,function(b){b=OA.replaceVars(b,c),j.hasClass(a,b)||j.addClass(a,b)})}},m=function(a,b){var c=!1;return!!h.selector&&(uC(a,function(a){if(!("collapsed"in a&&a.collapsed!==i))return j.is(b,a.selector)&&!Oo(b)?(l(b,a),c=!0,!1):void 0}),c)},n=function(d,e,f,i){var j,k,n=[],o=!0;j=h.inline||h.block,k=d.create(j),l(k),PB.walk(d,e,function(e){var f,p=function(e){var q,r,s,t;if(t=o,q=e.nodeName.toLowerCase(),r=e.parentNode.nodeName.toLowerCase(),1===e.nodeType&&d.getContentEditable(e)&&(t=o,o="true"===d.getContentEditable(e),s=!0),OA.isEq(q,"br"))return f=0,void(h.block&&d.remove(e));if(h.wrapper&&lB.matchNode(a,e,b,c))return void(f=0);if(o&&!s&&h.block&&!h.wrapper&&OA.isTextBlock(a,q)&&OA.isValid(a,r,j))return e=d.rename(e,j),l(e),n.push(e),void(f=0);if(h.selector){var u=m(g,e);if(!h.inline||u)return void(f=0)}!o||s||!OA.isValid(a,j,q)||!OA.isValid(a,r,j)||!i&&3===e.nodeType&&1===e.nodeValue.length&&65279===e.nodeValue.charCodeAt(0)||Oo(e)||h.inline&&d.isBlock(e)?(f=0,uC(zd.grep(e.childNodes),p),s&&(o=t),f=0):(f||(f=d.clone(k,!1),e.parentNode.insertBefore(f,e),n.push(f)),f.appendChild(e))};uC(e,p)}),!0===h.links&&uC(n,function(a){var b=function(a){"A"===a.nodeName&&l(a,h),uC(zd.grep(a.childNodes),b)};b(a)}),uC(n,function(e){var f,i=function(a){var b=!1;return uC(a.childNodes,function(a){if(vC(a))return b=a,!1}),b};if(f=function(a){var b=0;return uC(a.childNodes,function(a){OA.isWhiteSpaceNode(a)||lp.isBookmarkNode(a)||b++}),b}(e),(n.length>1||!d.isBlock(e))&&0===f)return void d.remove(e,1);(h.inline||h.wrapper)&&(h.exact||1!==f||(e=function(a){var b,c;return b=i(a),b&&!lp.isBookmarkNode(b)&&lB.matchName(d,b,h)&&(c=d.clone(b,!1),l(c),d.replace(c,a,!0),d.remove(b,1)),c||a}(e)),tC.mergeWithChildren(a,g,c,e),tC.mergeWithParents(a,h,b,c,e),tC.mergeBackgroundColorAndFontSize(d,h,c,e),tC.mergeSubSup(d,h,c,e),tC.mergeSiblings(d,h,c,e))})};if("false"!==j.getContentEditable(k.getNode())){if(h){if(d)d.nodeType?m(g,d)||(f=j.createRng(),f.setStartBefore(d),f.setEndAfter(d),n(j,bB.expandRng(a,f,g),0,!0)):n(j,d,0,!0);else if(i&&h.inline&&!j.select("td[data-mce-selected],th[data-mce-selected]").length)BB(a,b,c);else{var o=a.selection.getNode();a.settings.forced_root_block||!g[0].defaultBlock||j.getParent(o,j.isBlock)||wC(a,g[0].defaultBlock),a.selection.setRng(Np.normalize(a.selection.getRng())),e=No.getPersistentBookmark(a.selection,!0),n(j,bB.expandRng(a,k.getRng(),g)),h.styles&&tC.mergeUnderlineAndColor(j,h,c,o),k.moveToBookmark(e),OA.moveStart(j,k,k.getRng()),a.nodeChanged()}LB.postProcess(b,a)}}else{d=k.getNode();for(var p=0,q=g.length;p<q;p++)if(g[p].ceFalseOverride&&j.is(d,g[p].selector))return void l(d,g[p])}},xC={applyFormat:wC},yC=zd.each,zC=function(a,b){var c={};a.set({}),b.on("NodeChange",function(d){var e=OA.getParents(b.dom,d.element),f={};e=zd.grep(e,function(a){return 1===a.nodeType&&!a.getAttribute("data-mce-bogus")}),yC(a.get(),function(a,d){yC(e,function(g){return b.formatter.matchNode(g,d,{},a.similar)?(c[d]||(yC(a,function(a){a(!0,{node:g,format:d,parents:e})}),c[d]=a),f[d]=a,!1):!lB.matchesUnInheritedFormatSelector(b,g,d)&&void 0})}),yC(c,function(a,b){f[b]||(delete c[b],yC(a,function(a){a(!1,{node:d.element,format:b,parents:e})}))})})},AC=function(a,b,c,d){var e=a.get();yC(b.split(","),function(a){e[a]||(e[a]=[],e[a].similar=d),e[a].push(c)}),a.set(e)},BC=function(a,b,c,d,e){null===b.get()&&zC(b,a),AC(b,c,d,e)},CC={formatChanged:BC},DC=function(a){var b={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(b,c,d){zd.each(d,function(c,d){a.setAttrib(b,d,c)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return zd.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(a){b[a]={block:a,remove:"all"}}),b},EC={get:DC},FC=zd.each,GC=_i.DOM,HC=function(a,b){var c,d,e,f=b&&b.schema||t({}),g=function(a,b){b.classes.length&&GC.addClass(a,b.classes.join(" ")),GC.setAttribs(a,b.attrs)},h=function(a){var b;return d="string"==typeof a?{name:a,classes:[],attrs:{}}:a,b=GC.create(d.name),g(b,d),b},i=function(a,b){var c="string"!=typeof a?a.nodeName.toLowerCase():a,d=f.getElementRule(c),e=d&&d.parentsRequired;return!(!e||!e.length)&&(b&&-1!==zd.inArray(e,b)?b:e[0])},j=function(a,b,c){var d,e,f,g=b.length>0&&b[0],k=g&&g.name;if(f=i(a,k))k===f?(e=b[0],b=b.slice(1)):e=f;else if(g)e=b[0],b=b.slice(1);else if(!c)return a;return e&&(d=h(e),d.appendChild(a)),c&&(d||(d=GC.create("div"),d.appendChild(a)),zd.each(c,function(b){var c=h(b);d.insertBefore(c,a)})),j(d,b,e&&e.siblings)};return a&&a.length?(d=a[0],c=h(d),e=GC.create("div"),e.appendChild(j(c,a.slice(1),d.siblings)),e):""},IC=function(a,b){return HC(KC(a),b)},JC=function(a){var b,c={classes:[],attrs:{}};return a=c.selector=zd.trim(a),"*"!==a&&(b=a.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(a,b,d,e,f){switch(b){case"#":c.attrs.id=d;break;case".":c.classes.push(d);break;case":":-1!==zd.inArray("checked disabled enabled read-only required".split(" "),d)&&(c.attrs[d]=d)}if("["===e){var g=f.match(/([\w\-]+)(?:\=\"([^\"]+))?/);g&&(c.attrs[g[1]]=g[2])}return""})),c.name=b||"div",c},KC=function(a){return a&&"string"==typeof a?(a=a.split(/\s*,\s*/)[0],a=a.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),zd.map(a.split(/(?:>|\s+(?![^\[\]]+\]))/),function(a){var b=zd.map(a.split(/(?:~\+|~|\+)/),JC),c=b.pop();return b.length&&(c.siblings=b),c}).reverse()):[]},LC=function(a,b){var c,d,e,f,g,h,i="";if(!1===(h=a.settings.preview_styles))return"";"string"!=typeof h&&(h="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");var j=function(a){return a.replace(/%(\w+)/g,"")};if("string"==typeof b){if(!(b=a.formatter.get(b)))return;b=b[0]}return"preview"in b&&!1===(h=b.preview)?"":(c=b.block||b.inline||"span",f=KC(b.selector),f.length?(f[0].name||(f[0].name=c),c=b.selector,d=HC(f,a)):d=HC([c],a),e=GC.select(c,d)[0]||d.firstChild,FC(b.styles,function(a,b){(a=j(a))&&GC.setStyle(e,b,a)}),FC(b.attributes,function(a,b){(a=j(a))&&GC.setAttrib(e,b,a)}),FC(b.classes,function(a){a=j(a),GC.hasClass(e,a)||GC.addClass(e,a)}),a.fire("PreviewFormats"),GC.setStyles(d,{position:"absolute",left:-65535}),a.getBody().appendChild(d),g=GC.getStyle(a.getBody(),"fontSize",!0),g=/px$/.test(g)?parseInt(g,10):0,FC(h.split(" "),function(b){var c=GC.getStyle(e,b,!0);if(!("background-color"===b&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(c)&&(c=GC.getStyle(a.getBody(),b,!0),"#ffffff"===GC.toHex(c).toLowerCase())||"color"===b&&"#000000"===GC.toHex(c).toLowerCase())){if("font-size"===b&&/em|%$/.test(c)){if(0===g)return;c=parseFloat(c)/(/%$/.test(c)?100:1)*g+"px"}"border"===b&&c&&(i+="padding:0 2px;"),i+=b+":"+c+";"}}),a.fire("AfterPreviewFormats"),GC.remove(d),i)},MC={getCssText:LC,parseSelector:KC,selectorToHtml:IC},NC=function(a,b,c,d,e){var f=b.get(c);!lB.match(a,c,d,e)||"toggle"in f[0]&&!f[0].toggle?xC.applyFormat(a,c,d,e):cC.remove(a,c,d,e)},OC={toggle:NC},PC=function(a){a.addShortcut("meta+b","","Bold"),a.addShortcut("meta+i","","Italic"),a.addShortcut("meta+u","","Underline");for(var b=1;b<=6;b++)a.addShortcut("access+"+b,"",["FormatBlock",!1,"h"+b]);a.addShortcut("access+7","",["FormatBlock",!1,"p"]),a.addShortcut("access+8","",["FormatBlock",!1,"div"]),a.addShortcut("access+9","",["FormatBlock",!1,"address"])},QC={setup:PC},RC=function(a,b){return b},SC=function(a,b){return Ka.isObject(a)&&Ka.isObject(b)?UC(a,b):b},TC=function(a){return function(){for(var b=new Array(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];if(0===b.length)throw new Error("Can't merge zero objects");for(var d={},e=0;e<b.length;e++){var f=b[e];for(var g in f)f.hasOwnProperty(g)&&(d[g]=a(d[g],f[g]))}return d}},UC=TC(SC),VC=TC(RC),WC={deepMerge:UC,merge:VC},XC=function(a,b,c){a.addAttributeFilter("data-mce-tabindex",function(a,b){for(var c,d=a.length;d--;)c=a[d],c.attr("tabindex",c.attributes.map["data-mce-tabindex"]),c.attr(b,null)}),a.addAttributeFilter("src,href,style",function(a,d){for(var e,f,g=a.length,h="data-mce-"+d,i=b.url_converter,j=b.url_converter_scope;g--;)e=a[g],f=e.attributes.map[h],void 0!==f?(e.attr(d,f.length>0?f:null),e.attr(h,null)):(f=e.attributes.map[d],"style"===d?f=c.serializeStyle(c.parseStyle(f),e.name):i&&(f=i.call(j,f,d,e.name)),e.attr(d,f.length>0?f:null))}),a.addAttributeFilter("class",function(a){for(var b,c,d=a.length;d--;)b=a[d],(c=b.attr("class"))&&(c=b.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),b.attr("class",c.length>0?c:null))}),a.addAttributeFilter("data-mce-type",function(a,b,c){for(var d,e=a.length;e--;)d=a[e],"bookmark"!==d.attributes.map["data-mce-type"]||c.cleanup||d.remove()}),a.addNodeFilter("noscript",function(a){for(var b,c=a.length;c--;)(b=a[c].firstChild)&&(b.value=Hi.decode(b.value))}),a.addNodeFilter("script,style",function(a,c){for(var d,e,f,g=a.length,h=function(a){return a.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};g--;)d=a[g],e=d.firstChild?d.firstChild.value:"","script"===c?(f=d.attr("type"),f&&d.attr("type","mce-no/type"===f?null:f.replace(/^mce\-/,"")),"xhtml"===b.element_format&&e.length>0&&(d.firstChild.value="// <![CDATA[\n"+h(e)+"\n// ]]>")):"xhtml"===b.element_format&&e.length>0&&(d.firstChild.value="\x3c!--\n"+h(e)+"\n--\x3e")}),a.addNodeFilter("#comment",function(a){for(var b,c=a.length;c--;)b=a[c],0===b.value.indexOf("[CDATA[")?(b.name="#cdata",b.type=4,b.value=b.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===b.value.indexOf("mce:protected ")&&(b.name="#text",b.type=3,b.raw=!0,b.value=unescape(b.value).substr(14))}),a.addNodeFilter("xml:namespace,input",function(a,b){for(var c,d=a.length;d--;)c=a[d],7===c.type?c.remove():1===c.type&&("input"!==b||"type"in c.attributes.map||c.attr("type","text"))}),a.addAttributeFilter("data-mce-type",function(b){ob.each(b,function(b){"format-caret"===b.attr("data-mce-type")&&(b.isEmpty(a.schema.getNonEmptyElements())?b.remove():b.unwrap())})}),a.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",function(a,b){for(var c=a.length;c--;)a[c].attr(b,null)})},YC=function(a){var b,c,d=function(a){return a&&"br"===a.name};b=a.lastChild,d(b)&&(c=b.prev,d(c)&&(b.remove(),c.remove()))},ZC={register:XC,trimTrailingBr:YC},$C=function(a,b,c){var d,e,f,g=a.dom;return b=b.cloneNode(!0),d=document.implementation,d.createHTMLDocument&&(e=d.createHTMLDocument(""),zd.each("BODY"===b.nodeName?b.childNodes:[b],function(a){e.body.appendChild(e.importNode(a,!0))}),b="BODY"!==b.nodeName?e.body.firstChild:e.body,f=g.doc,g.doc=e),Jw.firePreProcess(a,WC.merge(c,{node:b})),f&&(g.doc=f),b},_C=function(a,b){return a&&a.hasEventListeners("PreProcess")&&!b.no_events},aD=function(a,b,c){return _C(a,c)?$C(a,b,c):b},bD={process:aD},cD=function(a,b){ob.each(b,function(b){a.attr(b,null)})},dD=function(a,b,c){a.addNodeFilter("font",function(a){ob.each(a,function(a){var d=b.parse(a.attr("style")),e=a.attr("color"),f=a.attr("face"),g=a.attr("size");e&&(d.color=e),f&&(d["font-family"]=f),g&&(d["font-size"]=c[parseInt(a.attr("size"),10)-1]),a.name="span",a.attr("style",b.serialize(d)),cD(a,["color","face","size"])})})},eD=function(a,b){a.addNodeFilter("strike",function(a){ob.each(a,function(a){var c=b.parse(a.attr("style"));c["text-decoration"]="line-through",a.name="span",a.attr("style",b.serialize(c))})})},fD=function(a,b){var c=u();b.convert_fonts_to_spans&&dD(a,c,zd.explode(b.font_size_legacy_values)),eD(a,c)},gD=function(a,b){b.inline_styles&&fD(a,b)},hD={register:gD},iD=/^[ \t\r\n]*$/,jD={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},kD=function(a,b,c){var d,e,f=c?"lastChild":"firstChild",g=c?"prev":"next";if(a[f])return a[f];if(a!==b){if(d=a[g])return d;for(e=a.parent;e&&e!==b;e=e.parent)if(d=e[g])return d}},lD=function(){function a(a,b){this.name=a,this.type=b,1===b&&(this.attributes=[],this.attributes.map={})}return a.create=function(b,c){var d,e;if(d=new a(b,jD[b]||1),c)for(e in c)d.attr(e,c[e]);return d},a.prototype.replace=function(a){var b=this;return a.parent&&a.remove(),b.insert(a,b),b.remove(),b},a.prototype.attr=function(a,b){var c,d,e=this;if("string"!=typeof a){for(d in a)e.attr(d,a[d]);return e}if(c=e.attributes){if(void 0!==b){if(null===b){if(a in c.map)for(delete c.map[a],d=c.length;d--;)if(c[d].name===a)return c=c.splice(d,1),e;return e}if(a in c.map){for(d=c.length;d--;)if(c[d].name===a){c[d].value=b;break}}else c.push({name:a,value:b});return c.map[a]=b,e}return c.map[a]}},a.prototype.clone=function(){var b,c,d,e,f,g=this,h=new a(g.name,g.type);if(d=g.attributes){for(f=[],f.map={},b=0,c=d.length;b<c;b++)e=d[b],"id"!==e.name&&(f[f.length]={name:e.name,value:e.value},f.map[e.name]=e.value);h.attributes=f}return h.value=g.value,h.shortEnded=g.shortEnded,h},a.prototype.wrap=function(a){var b=this;return b.parent.insert(a,b),a.append(b),b},a.prototype.unwrap=function(){var a,b,c=this;for(a=c.firstChild;a;)b=a.next,c.insert(a,c,!0),a=b;c.remove()},a.prototype.remove=function(){var a=this,b=a.parent,c=a.next,d=a.prev;return b&&(b.firstChild===a?(b.firstChild=c,c&&(c.prev=null)):d.next=c,b.lastChild===a?(b.lastChild=d,d&&(d.next=null)):c.prev=d,a.parent=a.next=a.prev=null),a},a.prototype.append=function(a){var b,c=this;return a.parent&&a.remove(),b=c.lastChild,b?(b.next=a,a.prev=b,c.lastChild=a):c.lastChild=c.firstChild=a,a.parent=c,a},a.prototype.insert=function(a,b,c){var d;return a.parent&&a.remove(),d=b.parent||this,c?(b===d.firstChild?d.firstChild=a:b.prev.next=a,a.prev=b.prev,a.next=b,b.prev=a):(b===d.lastChild?d.lastChild=a:b.next.prev=a,a.next=b.next,a.prev=b,b.next=a),a.parent=d,a},a.prototype.getAll=function(a){var b,c=this,d=[];for(b=c.firstChild;b;b=kD(b,c))b.name===a&&d.push(b);return d},a.prototype.empty=function(){var a,b,c,d=this;if(d.firstChild){for(a=[],c=d.firstChild;c;c=kD(c,d))a.push(c);for(b=a.length;b--;)c=a[b],c.parent=c.firstChild=c.lastChild=c.next=c.prev=null}return d.firstChild=d.lastChild=null,d},a.prototype.isEmpty=function(a,b,c){var d,e,f=this,g=f.firstChild;if(b=b||{},g)do{if(1===g.type){if(g.attributes.map["data-mce-bogus"])continue;if(a[g.name])return!1;for(d=g.attributes.length;d--;)if("name"===(e=g.attributes[d].name)||0===e.indexOf("data-mce-bookmark"))return!1}if(8===g.type)return!1;if(3===g.type&&!iD.test(g.value))return!1;if(3===g.type&&g.parent&&b[g.parent.name]&&iD.test(g.value))return!1;if(c&&c(g))return!1}while(g=kD(g,f));return!0},a.prototype.walk=function(a){return kD(this,null,a)},a}(),mD=function(a,b,c,d){(a.padd_empty_with_br||b.insert)&&c[d.name]?d.empty().append(new lD("br",1)).shortEnded=!0:d.empty().append(new lD("#text",3)).value=""},nD=function(a){return oD(a,"#text")&&""===a.firstChild.value},oD=function(a,b){return a&&a.firstChild&&a.firstChild===a.lastChild&&a.firstChild.name===b},pD=function(a,b){var c=a.getElementRule(b.name);return c&&c.paddEmpty},qD=function(a,b,c,d){return d.isEmpty(b,c,function(b){return pD(a,b)})},rD=function(a,b){return a&&(b[a.name]||"br"===a.name)},sD=function(a,b){var c=a.schema;b.remove_trailing_brs&&a.addNodeFilter("br",function(a,d,e){var f,g,h,i,j,k,l,m,n=a.length,o=zd.extend({},c.getBlockElements()),p=c.getNonEmptyElements(),q=c.getNonEmptyElements();for(o.body=1,f=0;f<n;f++)if(g=a[f],h=g.parent,o[g.parent.name]&&g===h.lastChild){for(j=g.prev;j;){if("span"!==(k=j.name)||"bookmark"!==j.attr("data-mce-type")){if("br"!==k)break;if("br"===k){g=null;break}}j=j.prev}g&&(g.remove(),qD(c,p,q,h)&&(l=c.getElementRule(h.name))&&(l.removeEmpty?h.remove():l.paddEmpty&&mD(b,e,o,h)))}else{for(i=g;h&&h.firstChild===i&&h.lastChild===i&&(i=h,!o[h.name]);)h=h.parent;i===h&&!0!==b.padd_empty_with_br&&(m=new lD("#text",3),m.value="",g.replace(m))}}),a.addAttributeFilter("href",function(a){var c,d=a.length,e=function(a){return a.split(" ").filter(function(a){return a.length>0}).concat(["noopener"]).sort().join(" ")};if(!b.allow_unsafe_link_target)for(;d--;)c=a[d],"a"===c.name&&"_blank"===c.attr("target")&&c.attr("rel",function(a){var b=a?zd.trim(a):"";return/\b(noopener)\b/g.test(b)?b:e(b)}(c.attr("rel")))}),b.allow_html_in_named_anchor||a.addAttributeFilter("id,name",function(a){for(var b,c,d,e,f=a.length;f--;)if(e=a[f],"a"===e.name&&e.firstChild&&!e.attr("href")){d=e.parent,b=e.lastChild;do{c=b.prev,d.insert(b,e),b=c}while(b)}}),b.fix_list_elements&&a.addNodeFilter("ul,ol",function(a){for(var b,c,d=a.length;d--;)if(b=a[d],c=b.parent,"ul"===c.name||"ol"===c.name)if(b.prev&&"li"===b.prev.name)b.prev.append(b);else{var e=new lD("li",1);e.attr("style","list-style-type: none"),b.wrap(e)}}),b.validate&&c.getValidClasses()&&a.addAttributeFilter("class",function(a){for(var b,d,e,f,g,h,i,j=a.length,k=c.getValidClasses();j--;){for(b=a[j],d=b.attr("class").split(" "),g="",e=0;e<d.length;e++)f=d[e],i=!1,h=k["*"],h&&h[f]&&(i=!0),h=k[b.name],!i&&h&&h[f]&&(i=!0),i&&(g&&(g+=" "),g+=f);g.length||(g=null),b.attr("class",g)}})},tD=zd.makeMap,uD=zd.each,vD=zd.explode,wD=zd.extend,xD=function(a,b,c){-1===zd.inArray(b,c)&&(a.addAttributeFilter(c,function(a,b){for(var c=a.length;c--;)a[c].attr(b,null)}),b.push(c))},yD=function(a,b,c){if(!b.no_events&&a){return Jw.firePostProcess(a,WC.merge(b,{content:c})).content}return c},zD=function(a,b,c){var d=ij.trim(c.getInner?b.innerHTML:a.getOuterHTML(b));return c.selection||Yh(kf.fromDom(b))?d:zd.trim(d)},AD=function(a,b,c){var d=c.selection?WC.merge({forced_root_block:!1},c):c,e=a.parse(b,d);return ZC.trimTrailingBr(e),e},BD=function(a,b,c){return z(a,b).serialize(c)},CD=function(a,b,c,d,e){var f=BD(b,c,d);return yD(a,e,f)};!function(a){a.isBookmarkNode=lp.isBookmarkNode}(Z||(Z={}));var DD=Z,ED=oi.isContentEditableFalse,FD=oi.isContentEditableTrue,GD=function(a,b){for(;b&&b!==a;){if(FD(b)||ED(b))return b;b=b.parentNode}return null},HD=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=b.dom,u=zd.each,v=b.getDoc(),w=document,x=Math.abs,y=Math.round,z=b.getBody();f={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var A=".mce-content-body";b.contentStyles.push(A+" div.mce-resizehandle {position: absolute;border: 1px solid black;box-sizing: content-box;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+A+" .mce-resizehandle:hover {background: #000}"+A+" img[data-mce-selected],"+A+" hr[data-mce-selected] {outline: 1px solid black;resize: none}"+A+" .mce-clonedresizable {position: absolute;"+(Ib.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+A+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}");var B=function(a){return a&&("IMG"===a.nodeName||b.dom.is(a,"figure.image"))},C=function(a,b){return B(a.target)&&!Bz.isXYWithinRange(a.clientX,a.clientY,b)},D=function(a){var c=a.target;C(a,b.selection.getRng())&&!a.isDefaultPrevented()&&(a.preventDefault(),b.selection.select(c))},E=function(a){return b.dom.is(a,"figure.image")?a.querySelector("img"):a},F=function(a){var c=b.settings.object_resizing;return!1!==c&&!Ib.iOS&&("string"!=typeof c&&(c="table,img,figure.image,div"),"false"!==a.getAttribute("data-mce-resize")&&(a!==b.getBody()&&Gg.is(kf.fromDom(a),c)))},G=function(a){var f,u,v,w,A;f=a.screenX-h,u=a.screenY-i,p=f*g[2]+l,q=u*g[3]+m,p=p<5?5:p,q=q<5?5:q,v=B(c)&&!1!==b.settings.resize_img_proportional?!Iz.modifierPressed(a):Iz.modifierPressed(a)||B(c)&&g[2]*g[3]!=0,v&&(x(f)>x(u)?(q=y(p*n),p=y(q/n)):(p=y(q/n),q=y(p*n))),t.setStyles(E(d),{width:p,height:q}),w=g.startPos.x+f,A=g.startPos.y+u,w=w>0?w:0,A=A>0?A:0,t.setStyles(e,{left:w,top:A,display:"block"}),e.innerHTML=p+" &times; "+q,g[2]<0&&d.clientWidth<=p&&t.setStyle(d,"left",j+(l-p)),g[3]<0&&d.clientHeight<=q&&t.setStyle(d,"top",k+(m-q)),f=z.scrollWidth-r,u=z.scrollHeight-s,f+u!==0&&t.setStyles(e,{left:w-f,top:A-u}),o||(Jw.fireObjectResizeStart(b,c,l,m),o=!0)},H=function(){o=!1;var a=function(a,d){d&&(c.style[a]||!b.schema.isValid(c.nodeName.toLowerCase(),a)?t.setStyle(E(c),a,d):t.setAttrib(E(c),a,d))};a("width",p),a("height",q),t.unbind(v,"mousemove",G),t.unbind(v,"mouseup",H),w!==v&&(t.unbind(w,"mousemove",G),t.unbind(w,"mouseup",H)),t.remove(d),t.remove(e),I(c),Jw.fireObjectResized(b,c,p,q),t.setAttrib(c,"style",t.getAttrib(c,"style")),b.nodeChanged()},I=function(a){var o,x,y,A,B;J(),M(),o=t.getPos(a,z),j=o.x,k=o.y,B=a.getBoundingClientRect(),x=B.width||B.right-B.left,y=B.height||B.bottom-B.top,c!==a&&(c=a,p=q=0),A=b.fire("ObjectSelected",{target:a}),F(a)&&!A.isDefaultPrevented()?u(f,function(a,b){var f,o=function(b){h=b.screenX,i=b.screenY,l=E(c).clientWidth,m=E(c).clientHeight,n=m/l,g=a,a.startPos={x:x*a[0]+j,y:y*a[1]+k},r=z.scrollWidth,s=z.scrollHeight,d=c.cloneNode(!0),t.addClass(d,"mce-clonedresizable"),t.setAttrib(d,"data-mce-bogus","all"),d.contentEditable=!1,d.unSelectabe=!0,t.setStyles(d,{left:j,top:k,margin:0}),d.removeAttribute("data-mce-selected"),z.appendChild(d),t.bind(v,"mousemove",G),t.bind(v,"mouseup",H),w!==v&&(t.bind(w,"mousemove",G),t.bind(w,"mouseup",H)),e=t.add(z,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},l+" &times; "+m)};f=t.get("mceResizeHandle"+b),f&&t.remove(f),f=t.add(z,"div",{id:"mceResizeHandle"+b,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+b+"-resize; margin:0; padding:0"}),11===Ib.ie&&(f.contentEditable=!1),t.bind(f,"mousedown",function(a){a.stopImmediatePropagation(),a.preventDefault(),o(a)}),a.elm=f,t.setStyles(f,{left:x*a[0]+j-f.offsetWidth/2,top:y*a[1]+k-f.offsetHeight/2})}):J(),c.setAttribute("data-mce-selected","1")},J=function(){var a,b;M(),c&&c.removeAttribute("data-mce-selected");for(a in f)(b=t.get("mceResizeHandle"+a))&&(t.unbind(b),t.remove(b))},K=function(c){var d,e,f=function(a,b){if(a)do{if(a===b)return!0}while(a=a.parentNode)};if(!o&&!b.removed){if(u(t.select("img[data-mce-selected],hr[data-mce-selected]"),function(a){a.removeAttribute("data-mce-selected")}),
e="mousedown"===c.type?c.target:a.getNode(),e=t.$(e).closest("table,img,figure.image,hr")[0],f(e,z)&&(N(),d=a.getStart(!0),f(d,e)&&f(a.getEnd(!0),e)))return void I(e);J()}},L=function(a){return ED(GD(b.getBody(),a))},M=function(){for(var a in f){var b=f[a];b.elm&&(t.unbind(b.elm),delete b.elm)}},N=function(){try{b.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(a){}};return b.on("init",function(){N(),Ib.ie&&Ib.ie>=11&&(b.on("mousedown click",function(a){var c=a.target,d=c.nodeName;o||!/^(TABLE|IMG|HR)$/.test(d)||L(c)||(2!==a.button&&b.selection.select(c,"TABLE"===d),"mousedown"===a.type&&b.nodeChanged())}),b.dom.bind(z,"mscontrolselect",function(a){var c=function(a){Qb.setEditorTimeout(b,function(){b.selection.select(a)})};if(L(a.target))return a.preventDefault(),void c(a.target);/^(TABLE|IMG|HR)$/.test(a.target.nodeName)&&(a.preventDefault(),"IMG"===a.target.tagName&&c(a.target))}));var a=Qb.throttle(function(a){b.composing||K(a)});b.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged",a),b.on("keyup compositionend",function(b){c&&"TABLE"===c.nodeName&&a(b)}),b.on("hide blur",J),b.on("contextmenu",D)}),b.on("remove",M),{isResizable:F,showResizeRect:I,hideResizeRect:J,updateResizeRect:K,destroy:function(){c=d=null}}},ID=function(a){return oi.isContentEditableTrue(a)||oi.isContentEditableFalse(a)},JD=function(a,b,c){for(;a&&a!==b;){if(c(a))return a;a=a.parentNode}return null},KD=function(a,b,c){var d,e,f;if(d=c.elementFromPoint(a,b),e=c.body.createTextRange(),d&&"HTML"!==d.tagName||(d=c.body),e.moveToElementText(d),f=zd.toArray(e.getClientRects()),f=f.sort(function(a,c){return a=Math.abs(Math.max(a.top-b,a.bottom-b)),c=Math.abs(Math.max(c.top-b,c.bottom-b)),a-c}),f.length>0){b=(f[0].bottom+f[0].top)/2;try{return e.moveToPoint(a,b),e.collapse(!0),e}catch(a){}}return null},LD=function(a,b){var c=a&&a.parentElement?a.parentElement():null;return oi.isContentEditableFalse(JD(c,b,ID))?null:a},MD=function(a,b,c){var d,e,f=c;if(f.caretPositionFromPoint)(e=f.caretPositionFromPoint(a,b))&&(d=c.createRange(),d.setStart(e.offsetNode,e.offset),d.collapse(!0));else if(c.caretRangeFromPoint)d=c.caretRangeFromPoint(a,b);else if(f.body.createTextRange){d=f.body.createTextRange();try{d.moveToPoint(a,b),d.collapse(!0)}catch(e){d=KD(a,b,c)}return LD(d,c.body)}return d},ND={fromPoint:MD},OD=function(a,b){return ob.map(b,function(b){var c=a.fire("GetSelectionRange",{range:b});return c.range!==b?c.range:b})},PD={processRanges:OD},QD=function(a,b){return kf.fromDom(a.dom().cloneNode(b))},RD=function(a){return QD(a,!1)},SD=function(a){return QD(a,!0)},TD=function(a,b){var c=kf.fromTag(b),d=Pf.clone(a);return Pf.setAll(c,d),c},UD=function(a,b){var c=TD(a,b),d=hh.children(SD(a));return sp.append(c,d),c},VD=function(a,b){var c=TD(a,b);Cm.before(a,c);var d=hh.children(a);return sp.append(c,d),wp.remove(a),c},WD={shallow:RD,shallowAs:TD,deep:SD,copy:UD,mutate:VD},XD=function(a,b){var c=b||document,d=c.createDocumentFragment();return ob.each(a,function(a){d.appendChild(a.dom())}),kf.fromDom(d)},YD={fromElements:XD},ZD=sg.immutable("element","width","rows"),$D=sg.immutable("element","cells"),_D=sg.immutable("x","y"),aE=function(a,b){var c=parseInt(Pf.get(a,b),10);return isNaN(c)?1:c},bE=function(a,b,c,d,e){for(var f=aE(e,"rowspan"),g=aE(e,"colspan"),h=a.rows(),i=c;i<c+f;i++){h[i]||(h[i]=$D(WD.deep(d),[]));for(var j=b;j<b+g;j++){h[i].cells()[j]=i===c&&j===b?e:WD.shallow(e)}}},cE=function(a,b,c){var d=a.rows();return!!(d[c]?d[c].cells():[])[b]},dE=function(a,b,c){for(;cE(a,b,c);)b++;return b},eE=function(a){return ob.foldl(a,function(a,b){return b.cells().length>a?b.cells().length:a},0)},fE=function(a,b){for(var c=a.rows(),d=0;d<c.length;d++)for(var e=c[d].cells(),f=0;f<e.length;f++)if(Og.eq(e[f],b))return Ha.some(_D(f,d));return Ha.none()},gE=function(a,b,c,d,e){for(var f=[],g=a.rows(),h=c;h<=e;h++){var i=g[h].cells(),j=b<d?i.slice(b,d+1):i.slice(d,b+1);f.push($D(g[h].element(),j))}return f},hE=function(a,b,c){var d=b.x(),e=b.y(),f=c.x(),g=c.y(),h=e<g?gE(a,d,e,f,g):gE(a,d,g,f,e);return ZD(a.element(),eE(h),h)},iE=function(a,b){var c=WD.shallow(a.element()),d=kf.fromTag("tbody");return sp.append(d,b),Cm.append(c,d),c},jE=function(a){return ob.map(a.rows(),function(a){var b=ob.map(a.cells(),function(a){var b=WD.deep(a);return Pf.remove(b,"colspan"),Pf.remove(b,"rowspan"),b}),c=WD.shallow(a.element());return sp.append(c,b),c})},kE=function(a){var b=ZD(WD.shallow(a),0,[]);return ob.each(Nl.descendants(a,"tr"),function(a,c){ob.each(Nl.descendants(a,"td,th"),function(d,e){bE(b,dE(b,e,c),c,a,d)})}),ZD(b.element(),eE(b.rows()),b.rows())},lE=function(a){return iE(a,jE(a))},mE=function(a,b,c){return fE(a,b).bind(function(b){return fE(a,c).map(function(c){return hE(a,b,c)})})},nE={fromDom:kE,toDom:lE,subsection:mE},oE=function(a){return ob.find(a,function(a){return"ul"===uf.name(a)||"ol"===uf.name(a)})},pE=function(a,b){return ob.find(a,function(a){return"li"===uf.name(a)&&zy(a,b)}).fold(Aa.constant([]),function(b){return oE(a).map(function(a){return[kf.fromTag("li"),kf.fromTag(uf.name(a))]}).getOr([])})},qE=function(a,b){var c=ob.foldl(b,function(a,b){return Cm.append(b,a),b},a);return b.length>0?YD.fromElements([c]):c},rE=function(a){return Uh(a)?hh.parent(a).filter(Th).fold(Aa.constant([]),function(b){return[a,b]}):Th(a)?[a]:[]},sE=function(a,b){var c=kf.fromDom(b.commonAncestorContainer),d=yr.parentsAndSelf(c,a),e=ob.filter(d,function(a){return Qh(a)||Oh(a)}),f=pE(d,b),g=e.concat(f.length?f:rE(c));return ob.map(g,WD.shallow)},tE=function(){return YD.fromElements([])},uE=function(a,b){return qE(kf.fromDom(b.cloneContents()),sE(a,b))},vE=function(a,b){return Uq.ancestor(b,"table",Aa.curry(Og.eq,a))},wE=function(a,b){return vE(a,b[0]).bind(function(a){var c=b[0],d=b[b.length-1],e=nE.fromDom(a);return nE.subsection(e,c,d).map(function(a){return YD.fromElements([nE.toDom(a)])})}).getOrThunk(tE)},xE=function(a,b){return b.length>0&&b[0].collapsed?tE():uE(a,b[0])},yE=function(a,b){var c=pu.getCellsFromElementOrRanges(b,a);return c.length>0?wE(a,c):xE(a,b)},zE={read:yE},AE=function(a,b){var c,d=a.selection.getRng(),e=a.dom.create("body"),f=a.selection.getSel(),g=PD.processRanges(a,ku.getRanges(f));if(b=b||{},b.get=!0,b.format=b.format||"html",b.selection=!0,b=a.fire("BeforeGetContent",b),b.isDefaultPrevented())return a.fire("GetContent",b),b.content;if("text"===b.format)return a.selection.isCollapsed()?"":ij.trim(d.text||(f.toString?f.toString():""));d.cloneContents?(c=b.contextual?zE.read(kf.fromDom(a.getBody()),g).dom():d.cloneContents())&&e.appendChild(c):void 0!==d.item||void 0!==d.htmlText?(e.innerHTML="<br>"+(d.item?d.item(0).outerHTML:d.htmlText),e.removeChild(e.firstChild)):e.innerHTML=d.toString(),b.getInner=!0;var h=a.selection.serializer.serialize(e,b);return"tree"===b.format?h:(b.content=a.selection.isCollapsed()?"":h,a.fire("GetContent",b),b.content)},BE={getContent:AE},CE=function(a,b,c){var d,e,f,g=a.selection.getRng(),h=a.getDoc();if(c=c||{format:"html"},c.set=!0,c.selection=!0,c.content=b,!c.no_events&&(c=a.fire("BeforeSetContent",c),c.isDefaultPrevented()))return void a.fire("SetContent",c);if(b=c.content,g.insertNode){b+='<span id="__caret">_</span>',g.startContainer===h&&g.endContainer===h?h.body.innerHTML=b:(g.deleteContents(),0===h.body.childNodes.length?h.body.innerHTML=b:g.createContextualFragment?g.insertNode(g.createContextualFragment(b)):(e=h.createDocumentFragment(),f=h.createElement("div"),e.appendChild(f),f.outerHTML=b,g.insertNode(e))),d=a.dom.get("__caret"),g=h.createRange(),g.setStartBefore(d),g.setEndBefore(d),a.selection.setRng(g),a.dom.remove("__caret");try{a.selection.setRng(g)}catch(a){}}else g.item&&(h.execCommand("Delete",!1,null),g=a.getRng()),/^\s+/.test(b)?(g.pasteHTML('<span id="__mce_tmp">_</span>'+b),a.dom.remove("__mce_tmp")):g.pasteHTML(b);c.no_events||a.fire("SetContent",c)},DE={setContent:CE},EE=function(a,b,c,d,e){var f=c?b.startContainer:b.endContainer,g=c?b.startOffset:b.endOffset;return Ha.from(f).map(kf.fromDom).map(function(a){return d&&b.collapsed?a:hh.child(a,e(a,g)).getOr(a)}).bind(function(a){return uf.isElement(a)?Ha.some(a):hh.parent(a)}).map(function(a){return a.dom()}).getOr(a)},FE=function(a,b,c){return EE(a,b,!0,c,function(a,b){return Math.min(hh.childNodesCount(a),b)})},GE=function(a,b,c){return EE(a,b,!1,c,function(a,b){return b>0?b-1:b})},HE=function(a,b){for(var c=a;a&&oi.isText(a)&&0===a.length;)a=b?a.nextSibling:a.previousSibling;return a||c},IE=function(a,b){var c,d,e,f,g;return b?(d=b.startContainer,e=b.endContainer,f=b.startOffset,g=b.endOffset,c=b.commonAncestorContainer,!b.collapsed&&(d===e&&g-f<2&&d.hasChildNodes()&&(c=d.childNodes[f]),3===d.nodeType&&3===e.nodeType&&(d=d.length===f?HE(d.nextSibling,!0):d.parentNode,e=0===g?HE(e.previousSibling,!1):e.parentNode,d&&d===e))?d:c&&3===c.nodeType?c.parentNode:c):a},JE=function(a,b,c,d){var e,f,g=[];if(f=a.getRoot(),c=a.getParent(c||FE(f,b,!1),a.isBlock),d=a.getParent(d||GE(f,b,!1),a.isBlock),c&&c!==f&&g.push(c),c&&d&&c!==d){e=c;for(var h=new s(c,f);(e=h.next())&&e!==d;)a.isBlock(e)&&g.push(e)}return d&&c!==d&&d!==f&&g.push(d),g},KE=function(a,b,c){return Ha.from(b).map(function(b){var d=a.nodeIndex(b),e=a.createRng();return e.setStart(b.parentNode,d),e.setEnd(b.parentNode,d+1),c&&(Ay(a,e,b,!0),Ay(a,e,b,!1)),e})},LE=zd.each,ME=function(a){return!!a.select},NE=function(a){return!(!a||!a.ownerDocument)&&Og.contains(kf.fromDom(a.ownerDocument),kf.fromDom(a))},OE=function(a){return!!a&&(!!ME(a)||NE(a.startContainer)&&NE(a.endContainer))},PE=function(a,b,c,d){var e,f,g,h,i,j=function(b,c){var e=a.createRng();b?(e.setStart(b,c),e.setEnd(b,c),v(e),s(!1)):(Ay(a,e,d.getBody(),!0),v(e))},k=function(a){return BE.getContent(d,a)},l=function(a,b){return DE.setContent(d,a,b)},m=function(a){return FE(d.getBody(),u(),a)},n=function(a){return GE(d.getBody(),u(),a)},o=function(a,b){return e.getBookmark(a,b)},p=function(a){return e.moveToBookmark(a)},q=function(b,c){return KE(a,b,c).each(v),b},r=function(){var a=u(),b=t();return!(!a||a.item)&&(a.compareEndPoints?0===a.compareEndPoints("StartToEnd",a):!b||a.collapsed)},s=function(a){var b=u();b.collapse(!!a),v(b)},t=function(){return b.getSelection?b.getSelection():b.document.selection},u=function(){var c,e,f,i,j=function(a,b,c){try{return b.compareBoundaryPoints(a,c)}catch(a){return-1}};if(!b)return null;if(void 0===(i=b.document)||null===i)return null;if(void 0!==d.bookmark&&!1===Ax.hasFocus(d)){var k=aw.getRng(d);if(k.isSome())return k.map(function(a){return PD.processRanges(d,[a])[0]}).getOr(i.createRange())}try{(c=t())&&(e=c.rangeCount>0?c.getRangeAt(0):c.createRange?c.createRange():i.createRange())}catch(a){}return e=PD.processRanges(d,[e])[0],e||(e=i.createRange?i.createRange():i.body.createTextRange()),e.setStart&&9===e.startContainer.nodeType&&e.collapsed&&(f=a.getRoot(),e.setStart(f,0),e.setEnd(f,0)),g&&h&&(0===j(e.START_TO_START,e,g)&&0===j(e.END_TO_END,e,g)?e=h:(g=null,h=null)),e},v=function(a,b){var c,e,f;if(OE(a)){var i=ME(a)?a:null;if(i){h=null;try{i.select()}catch(a){}}else{if(c=t(),f=d.fire("SetSelectionRange",{range:a,forward:b}),a=f.range,c){h=a;try{c.removeAllRanges(),c.addRange(a)}catch(a){}!1===b&&c.extend&&(c.collapse(a.endContainer,a.endOffset),c.extend(a.startContainer,a.startOffset)),g=c.rangeCount>0?c.getRangeAt(0):null}a.collapsed||a.startContainer!==a.endContainer||!c.setBaseAndExtent||Ib.ie||a.endOffset-a.startOffset<2&&a.startContainer.hasChildNodes()&&(e=a.startContainer.childNodes[a.startOffset])&&"IMG"===e.tagName&&(c.setBaseAndExtent(a.startContainer,a.startOffset,a.endContainer,a.endOffset),c.anchorNode===a.startContainer&&c.focusNode===a.endContainer||c.setBaseAndExtent(e,0,e,1)),d.fire("AfterSetSelectionRange",{range:a,forward:b})}}},w=function(b){return l(a.getOuterHTML(b)),b},x=function(){return IE(d.getBody(),u())},y=function(b,c){return JE(a,u(),b,c)},z=function(){var b,c,d=t();return!(d&&d.anchorNode&&d.focusNode)||(b=a.createRng(),b.setStart(d.anchorNode,d.anchorOffset),b.collapse(!0),c=a.createRng(),c.setStart(d.focusNode,d.focusOffset),c.collapse(!0),b.compareBoundaryPoints(b.START_TO_START,c)<=0)},A=function(){var b=u(),c=t();if(!ku.hasMultipleRanges(c)&&By(d)){var e=ov.normalize(a,b);return e.each(function(a){v(a,z())}),e.getOr(b)}return b},B=function(b,c){var e;return i||(i={},e={},d.on("NodeChange",function(b){var c=b.element,d=a.getParents(c,null,a.getRoot()),f={};LE(i,function(b,c){LE(d,function(g){if(a.is(g,c))return e[c]||(LE(b,function(a){a(!0,{node:g,selector:c,parents:d})}),e[c]=b),f[c]=b,!1})}),LE(e,function(a,b){f[b]||(delete e[b],LE(a,function(a){a(!1,{node:c,selector:b,parents:d})}))})})),i[b]||(i[b]=[]),i[b].push(c),H},C=function(){for(var b,c=a.getRoot();c&&"BODY"!==c.nodeName;){if(c.scrollHeight>c.clientHeight){b=c;break}c=c.parentNode}return b},D=function(a,b){return em.scrollElementIntoView(d,a,b)},E=function(a,b){return v(ND.fromPoint(a,b,d.getDoc()))},F=function(){var a=u();return a.collapsed?Jk.fromRangeStart(a).getClientRects()[0]:a.getBoundingClientRect()},G=function(){b=g=h=null,f.destroy()},H={bookmarkManager:null,controlSelection:null,dom:a,win:b,serializer:c,editor:d,collapse:s,setCursorLocation:j,getContent:k,setContent:l,getBookmark:o,moveToBookmark:p,select:q,isCollapsed:r,isForward:z,setNode:w,getNode:x,getSel:t,setRng:v,getRng:u,getStart:m,getEnd:n,getSelectedBlocks:y,normalize:A,selectorChanged:B,getScrollContainer:C,scrollIntoView:D,placeCaretAt:E,getBoundingClientRect:F,destroy:G};return e=DD(H),f=HD(H,d),H.bookmarkManager=e,H.controlSelection=f,H},QE=oi.isContentEditableFalse,RE=Zj,SE=yn,TE=xn,UE=function(a,b){for(;b=a(b);)if(b.isVisible())return b;return b},VE=function(a,b){var c=ln(a,b);return!(c||!oi.isBr(a.getNode()))||c},WE=function(a,b,c,d){var e,f,g,h,i=a===ol.Forwards,j=i?TE:SE;return!d.collapsed&&(e=RE(d),QE(e))?jl(a,b,e,a===ol.Backwards,!0):(h=yj(d),f=wn(a,b.getBody(),d),j(f)?ll(b,f.getNode(!i)):(f=c(f))?j(f)?jl(a,b,f.getNode(!i),i,!0):(g=c(f),j(g)&&VE(f,g)?jl(a,b,g.getNode(!i),i,!0):h?nl(b,f.toRange(),!0):null):h?d:null)},XE=function(a,b,c,d){var e,f,g,h,i,j,k,l,m;if(m=RE(d),e=wn(a,b.getBody(),d),f=c(b.getBody(),nz(1),e),g=md.filter(f,oz(1)),i=md.last(e.getClientRects()),(TE(e)||zn(e))&&(m=e.getNode()),(SE(e)||An(e))&&(m=e.getNode(!0)),!i)return null;if(j=i.left,(h=uz(g,j))&&QE(h.node))return k=Math.abs(j-h.left),l=Math.abs(j-h.right),jl(a,b,h.node,k<l,!0);if(m){var n=mz(a,b.getBody(),nz(1),m);if(h=uz(md.filter(n,oz(1)),j))return nl(b,h.position.toRange(),!0);if(h=md.last(md.filter(n,oz(0))))return nl(b,h.position.toRange(),!0)}},YE=function(a){var b=a.dom.create(a.settings.forced_root_block);return(!Ib.ie||Ib.ie>=11)&&(b.innerHTML='<br data-mce-bogus="1">'),b},ZE=function(a,b,c){var d,e,f,g=Nn(a.getBody()),h=jk.curry(UE,g.next),i=jk.curry(UE,g.prev);if(c.collapsed&&a.settings.forced_root_block){if(!(d=a.dom.getParent(c.startContainer,"PRE")))return;e=1===b?h(Jk.fromRangeStart(c)):i(Jk.fromRangeStart(c)),e||(f=YE(a),1===b?a.$(d).after(f):a.$(d).before(f),a.selection.select(f,!0),a.selection.collapse())}},$E=function(a,b){var c,d=Nn(a.getBody()),e=jk.curry(UE,d.next),f=jk.curry(UE,d.prev),g=b?ol.Forwards:ol.Backwards,h=b?e:f,i=a.selection.getRng();return(c=WE(g,a,h,i))?c:(c=ZE(a,g,i))||null},_E=function(a,b){var c,d=b?1:-1,e=b?lz:kz,f=a.selection.getRng();return(c=XE(d,a,e,f))?c:(c=ZE(a,d,f))||null},aF=function(a,b){return function(){var c=$E(a,b);return!!c&&(a.selection.setRng(c),!0)}},bF=function(a,b){return function(){var c=_E(a,b);return!!c&&(a.selection.setRng(c),!0)}},cF=function(a){return ob.map(a,function(a){return WC.merge({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:Aa.noop},a)})},dF=function(a,b){return b.keyCode===a.keyCode&&b.shiftKey===a.shiftKey&&b.altKey===a.altKey&&b.ctrlKey===a.ctrlKey&&b.metaKey===a.metaKey},eF=function(a,b){return ob.bind(cF(a),function(a){return dF(a,b)?[a]:[]})},fF=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,d)}},gF=function(a,b){return ob.find(eF(a,b),function(a){return a.action()})},hF={match:eF,action:fF,execute:gF},iF=function(a,b,c){var d=df.detect().os;hF.execute([{keyCode:Iz.RIGHT,action:aF(a,!0)},{keyCode:Iz.LEFT,action:aF(a,!1)},{keyCode:Iz.UP,action:bF(a,!1)},{keyCode:Iz.DOWN,action:bF(a,!0)},{keyCode:Iz.RIGHT,action:Rm(a,!0)},{keyCode:Iz.LEFT,action:Rm(a,!1)},{keyCode:Iz.UP,action:Sm(a,!1)},{keyCode:Iz.DOWN,action:Sm(a,!0)},{keyCode:Iz.RIGHT,action:Et.move(a,b,!0)},{keyCode:Iz.LEFT,action:Et.move(a,b,!1)},{keyCode:Iz.RIGHT,ctrlKey:!d.isOSX(),altKey:d.isOSX(),action:Et.moveNextWord(a,b)},{keyCode:Iz.LEFT,ctrlKey:!d.isOSX(),altKey:d.isOSX(),action:Et.movePrevWord(a,b)}],c).each(function(a){c.preventDefault()})},jF=function(a,b){a.on("keydown",function(c){!1===c.isDefaultPrevented()&&iF(a,b,c)})},kF={setup:jF},lF=function(a,b){var c=yr.parentsAndSelf(b,a);return ob.findIndex(c,Ph).fold(Aa.constant(c),function(a){return c.slice(0,a)})},mF=function(a){return 1===hh.children(a).length},nF=function(a,b,c,d){var e=Aa.curry(GB,b),f=ob.map(ob.filter(d,e),function(a){return a.dom()});if(0===f.length)us.deleteElement(b,a,c);else{var g=FB(c.dom(),f);b.selection.setRng(g.toRange())}},oF=function(a,b){var c=kf.fromDom(a.getBody()),d=kf.fromDom(a.selection.getStart()),e=ob.filter(lF(c,d),mF);return ob.last(e).map(function(c){var d=Jk.fromRangeStart(a.selection.getRng());return!!Nq.willDeleteLastPositionInElement(b,d,c.dom())&&(nF(b,a,c,e),!0)}).getOr(!1)},pF=function(a,b){return!!a.selection.isCollapsed()&&oF(a,b)},qF={backspaceDelete:pF},rF=function(a,b,c){hF.execute([{keyCode:Iz.BACKSPACE,action:hF.action(Es.backspaceDelete,a,!1)},{keyCode:Iz.DELETE,action:hF.action(Es.backspaceDelete,a,!0)},{keyCode:Iz.BACKSPACE,action:hF.action(Nt.backspaceDelete,a,b,!1)},{keyCode:Iz.DELETE,action:hF.action(Nt.backspaceDelete,a,b,!0)},{keyCode:Iz.BACKSPACE,action:hF.action(Rr.backspaceDelete,a,!1)},{keyCode:Iz.DELETE,action:hF.action(Rr.backspaceDelete,a,!0)},{keyCode:Iz.BACKSPACE,action:hF.action(Jr.backspaceDelete,a,!1)},{keyCode:Iz.DELETE,action:hF.action(Jr.backspaceDelete,a,!0)},{keyCode:Iz.BACKSPACE,action:hF.action(Iu.backspaceDelete,a,!1)},{keyCode:Iz.DELETE,action:hF.action(Iu.backspaceDelete,a,!0)},{keyCode:Iz.BACKSPACE,action:hF.action(qF.backspaceDelete,a,!1)},{keyCode:Iz.DELETE,action:hF.action(qF.backspaceDelete,a,!0)}],c).each(function(a){c.preventDefault()})},sF=function(a,b){hF.execute([{keyCode:Iz.BACKSPACE,action:hF.action(Es.paddEmptyElement,a)},{keyCode:Iz.DELETE,action:hF.action(Es.paddEmptyElement,a)}],b)},tF=function(a,b){a.on("keydown",function(c){!1===c.isDefaultPrevented()&&rF(a,b,c)}),a.on("keyup",function(b){!1===b.isDefaultPrevented()&&sF(a,b)})},uF={setup:tF},vF=function(a){for(;a;){if(1===a.nodeType||3===a.nodeType&&a.data&&/[\r\n\s]/.test(a.data))return a;a=a.nextSibling}},wF=function(a,b){var c,d,e,f=b,g=a.dom,h=a.schema.getMoveCaretBeforeOnEnterElements();if(b){if(/^(LI|DT|DD)$/.test(b.nodeName)){var i=vF(b.firstChild);i&&/^(UL|OL|DL)$/.test(i.nodeName)&&b.insertBefore(g.doc.createTextNode(""),b.firstChild)}if(e=g.createRng(),b.normalize(),b.hasChildNodes()){for(c=new s(b,b);d=c.current();){if(oi.isText(d)){e.setStart(d,0),e.setEnd(d,0);break}if(h[d.nodeName.toLowerCase()]){e.setStartBefore(d),e.setEndBefore(d);break}f=d,d=c.next()}d||(e.setStart(f,0),e.setEnd(f,0))}else oi.isBr(b)?b.nextSibling&&g.isBlock(b.nextSibling)?(e.setStartBefore(b),e.setEndBefore(b)):(e.setStartAfter(b),e.setEndAfter(b)):(e.setStart(b,0),e.setEnd(b,0));a.selection.setRng(e),g.remove(void 0),a.selection.scrollIntoView(b)}},xF=function(a,b){var c,d,e=a.getRoot();for(c=b;c!==e&&"false"!==a.getContentEditable(c);)"true"===a.getContentEditable(c)&&(d=c),c=c.parentNode;return c!==e?d:e},yF=function(a){return Ha.from(a.dom.getParent(a.selection.getStart(!0),a.dom.isBlock))},zF=function(a){return yF(a).fold(Aa.constant(""),function(a){return a.nodeName.toUpperCase()})},AF=function(a){return yF(a).filter(function(a){return Uh(kf.fromDom(a))}).isSome()},BF={moveToCaretPosition:wF,getEditableRoot:xF,getParentBlock:yF,getParentBlockName:zF,isListItemParentBlock:AF},CF=function(a,b){return a.firstChild&&a.firstChild.nodeName===b},DF=function(a,b){return a&&a.parentNode&&a.parentNode.nodeName===b},EF=function(a){return a&&/^(OL|UL|LI)$/.test(a.nodeName)},FF=function(a){return EF(a)&&EF(a.parentNode)},GF=function(a){var b=a.parentNode;return/^(LI|DT|DD)$/.test(b.nodeName)?b:a},HF=function(a,b,c){for(var d=a[c?"firstChild":"lastChild"];d&&!oi.isElement(d);)d=d[c?"nextSibling":"previousSibling"];return d===b},IF=function(a,b,c,d,e){var f=a.dom,g=a.selection.getRng();if(c!==a.getBody()){FF(c)&&(e="LI");var h=e?b(e):f.create("BR");if(HF(c,d,!0)&&HF(c,d,!1))DF(c,"LI")?f.insertAfter(h,GF(c)):f.replace(h,c);else if(HF(c,d,!0))DF(c,"LI")?(f.insertAfter(h,GF(c)),h.appendChild(f.doc.createTextNode(" ")),h.appendChild(c)):c.parentNode.insertBefore(h,c);else if(HF(c,d,!1))f.insertAfter(h,GF(c));else{c=GF(c);var i=g.cloneRange();i.setStartAfter(d),i.setEndAfter(c);var j=i.extractContents();"LI"===e&&CF(j,"LI")?(h=j.firstChild,f.insertAfter(j,c)):(f.insertAfter(j,c),f.insertAfter(h,c))}f.remove(d),BF.moveToCaretPosition(a,h)}},JF={insert:IF},KF=function(a){return a&&"A"===a.nodeName&&0===zd.trim(ij.trim(a.innerText||a.textContent)).length},LF=function(a){return a&&/^(TD|TH|CAPTION)$/.test(a.nodeName)},MF=function(a){a.innerHTML='<br data-mce-bogus="1">'},NF=function(a,b){return a.nodeName===b||a.previousSibling&&a.previousSibling.nodeName===b},OF=function(a,b){return b&&a.isBlock(b)&&!/^(TD|TH|CAPTION|FORM)$/.test(b.nodeName)&&!/^(fixed|absolute)/i.test(b.style.position)&&"true"!==a.getContentEditable(b)},PF=function(a,b,c){var d,e=c,f=[];if(e){for(;e=e.firstChild;){if(a.isBlock(e))return;oi.isElement(e)&&!b[e.nodeName.toLowerCase()]&&f.push(e)}for(d=f.length;d--;)e=f[d],!e.hasChildNodes()||e.firstChild===e.lastChild&&""===e.firstChild.nodeValue?a.remove(e):KF(e)&&a.remove(e)}},QF=function(a,b,c){return!1===oi.isText(b)?c:a?1===c&&b.data.charAt(c-1)===ij.ZWSP?0:c:c===b.data.length-1&&b.data.charAt(c)===ij.ZWSP?b.data.length:c},RF=function(a){var b=a.cloneRange();return b.setStart(a.startContainer,QF(!0,a.startContainer,a.startOffset)),b.setEnd(a.endContainer,QF(!1,a.endContainer,a.endOffset)),b},SF=function(a){do{oi.isText(a)&&(a.nodeValue=a.nodeValue.replace(/^[\r\n]+/,"")),a=a.firstChild}while(a)},TF=function(a,b){var c,d,e=a.getRoot();for(c=b;c!==e&&"false"!==a.getContentEditable(c);)"true"===a.getContentEditable(c)&&(d=c),c=c.parentNode;return c!==e?d:e},UF=function(a,b){var c=vm.getForcedRootBlock(a);c&&c.toLowerCase()===b.tagName.toLowerCase()&&a.dom.setAttribs(b,vm.getForcedRootBlockAttrs(a))},VF=function(a,b,c,d,e){var f,g,h,i,j,k,l=b||"P",m=a.dom,n=TF(m,d);if(!(g=m.getParent(d,m.isBlock))||!OF(m,g)){if(g=g||n,k=g===a.getBody()||LF(g)?g.nodeName.toLowerCase():g.parentNode.nodeName.toLowerCase(),!g.hasChildNodes())return f=m.create(l),UF(a,f),g.appendChild(f),c.setStart(f,0),c.setEnd(f,0),f;for(i=d;i.parentNode!==g;)i=i.parentNode;for(;i&&!m.isBlock(i);)h=i,i=i.previousSibling;if(h&&a.schema.isValidChild(k,l.toLowerCase())){for(f=m.create(l),UF(a,f),h.parentNode.insertBefore(f,h),i=h;i&&!m.isBlock(i);)j=i.nextSibling,f.appendChild(i),i=j;c.setStart(d,e),c.setEnd(d,e)}}return d},WF=function(a,b){var c;b.normalize(),(c=b.lastChild)&&!/^(left|right)$/gi.test(a.getStyle(c,"float",!0))||a.add(b,"br")},XF=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.dom,q=a.schema,r=q.getNonEmptyElements(),t=a.selection.getRng(),u=function(b){var c,f,h,i=e,j=q.getTextInlineElements();if(b||"TABLE"===l||"HR"===l?(c=p.create(b||n),UF(a,c)):c=g.cloneNode(!1),h=c,!1===vm.shouldKeepStyles(a))p.setAttrib(c,"style",null),p.setAttrib(c,"class",null);else do{if(j[i.nodeName]){if(Oo(i))continue;f=i.cloneNode(!1),p.setAttrib(f,"id",""),c.hasChildNodes()?(f.appendChild(c.firstChild),c.appendChild(f)):(h=f,c.appendChild(f))}}while((i=i.parentNode)&&i!==d);return MF(h),c},v=function(a){var b,c,d,h;if(h=QF(a,e,f),oi.isText(e)&&(a?h>0:h<e.nodeValue.length))return!1;if(e.parentNode===g&&o&&!a)return!0;if(a&&oi.isElement(e)&&e===g.firstChild)return!0;if(NF(e,"TABLE")||NF(e,"HR"))return o&&!a||!o&&a;for(b=new s(e,g),oi.isText(e)&&(a&&0===h?b.prev():a||h!==e.nodeValue.length||b.next());c=b.current();){if(oi.isElement(c)){if(!c.getAttribute("data-mce-bogus")&&(d=c.nodeName.toLowerCase(),r[d]&&"br"!==d))return!1}else if(oi.isText(c)&&!/^[ \t\r\n]*$/.test(c.nodeValue))return!1;a?b.prev():b.next()}return!0},w=function(){i=/^(H[1-6]|PRE|FIGURE)$/.test(l)&&"HGROUP"!==m?u(n):u(),vm.shouldEndContainerOnEmptyBlock(a)&&OF(p,k)&&p.isEmpty(g)?i=p.split(k,g):p.insertAfter(i,g),BF.moveToCaretPosition(a,i)};if(ov.normalize(p,t).each(function(a){t.setStart(a.startContainer,a.startOffset),t.setEnd(a.endContainer,a.endOffset)}),e=t.startContainer,f=t.startOffset,n=vm.getForcedRootBlock(a),h=b.shiftKey,oi.isElement(e)&&e.hasChildNodes()&&(o=f>e.childNodes.length-1,e=e.childNodes[Math.min(f,e.childNodes.length-1)]||e,f=o&&oi.isText(e)?e.nodeValue.length:0),d=TF(p,e)){if((n&&!h||!n&&h)&&(e=VF(a,n,t,e,f)),g=p.getParent(e,p.isBlock),k=g?p.getParent(g.parentNode,p.isBlock):null,l=g?g.nodeName.toUpperCase():"",m=k?k.nodeName.toUpperCase():"","LI"!==m||b.ctrlKey||(g=k,k=k.parentNode,l=m),/^(LI|DT|DD)$/.test(l)&&p.isEmpty(g))return void JF.insert(a,u,k,g,n);n&&g===a.getBody()||(n=n||"P",lj(g)?(i=xj(g),p.isEmpty(g)&&MF(g),BF.moveToCaretPosition(a,i)):v()?w():v(!0)?(i=g.parentNode.insertBefore(u(),g),BF.moveToCaretPosition(a,NF(g,"HR")?i:g)):(c=RF(t).cloneRange(),c.setEndAfter(g),j=c.extractContents(),SF(j),i=j.firstChild,p.insertAfter(j,g),PF(p,r,i),WF(p,g),p.isEmpty(g)&&MF(g),i.normalize(),p.isEmpty(i)?(p.remove(i),w()):BF.moveToCaretPosition(a,i)),p.setAttrib(i,"id",""),a.fire("NewBlock",{newBlock:i}))}},YF={insert:XF},ZF=function(a,b){return BF.getParentBlock(a).filter(function(a){return b.length>0&&Gg.is(kf.fromDom(a),b)}).isSome()},$F=function(a){return ZF(a,vm.getBrNewLineSelector(a))},_F=function(a){return ZF(a,vm.getNoNewLineSelector(a))},aG={shouldInsertBr:$F,shouldBlockNewLine:_F},bG=Tr.generate([{br:[]},{block:[]},{none:[]}]),cG=function(a,b){return aG.shouldBlockNewLine(a)},dG=function(a){return function(b,c){return""===vm.getForcedRootBlock(b)===a}},eG=function(a){return function(b,c){return BF.isListItemParentBlock(b)===a}},fG=function(a,b){return function(c,d){return BF.getParentBlockName(c)===a.toUpperCase()===b}},gG=function(a){return fG("pre",a)},hG=function(){return fG("summary",!0)},iG=function(a){return function(b,c){return vm.shouldPutBrInPre(b)===a}},jG=function(a,b){return aG.shouldInsertBr(a)},kG=function(a,b){return b},lG=function(a){var b=vm.getForcedRootBlock(a),c=BF.getEditableRoot(a.dom,a.selection.getStart());return c&&a.schema.isValidChild(c.nodeName,b||"P")},mG=function(a,b){return function(c,d){return ob.foldl(a,function(a,b){return a&&b(c,d)},!0)?Ha.some(b):Ha.none()}},nG=function(a,b){return Ts.evaluateUntil([mG([cG],bG.none()),mG([hG()],bG.br()),mG([gG(!0),iG(!1),kG],bG.br()),mG([gG(!0),iG(!1)],bG.block()),mG([gG(!0),iG(!0),kG],bG.block()),mG([gG(!0),iG(!0)],bG.br()),mG([eG(!0),kG],bG.br()),mG([eG(!0)],bG.block()),mG([dG(!0),kG,lG],bG.block()),mG([dG(!0)],bG.br()),mG([jG],bG.br()),mG([dG(!1),kG],bG.br()),mG([lG],bG.block())],[a,b.shiftKey]).getOr(bG.none())},oG={getAction:nG},pG=function(a,b){oG.getAction(a,b).fold(function(){Cv.insert(a,b)},function(){YF.insert(a,b)},Aa.noop)},qG={insert:pG},rG=function(a){a.typing&&(a.typing=!1,a.add())},sG=function(a,b){b.isDefaultPrevented()||(b.preventDefault(),rG(a.undoManager),a.undoManager.transact(function(){!1===a.selection.isCollapsed()&&a.execCommand("Delete"),qG.insert(a,b)}))},tG=function(a){a.on("keydown",function(b){b.keyCode===Iz.ENTER&&sG(a,b)})},uG={setup:tG},vG=function(a,b){return zG(a)&&oi.isText(b.container())},wG=function(a,b){var c=b.container(),d=b.offset();c.insertData(d,""),a.selection.setCursorLocation(c,d+1)},xG=function(a,b,c){return!!vG(c,b)&&(wG(a,b),!0)},yG=function(a){var b=Aa.curry(Hq.isInlineTarget,a),c=Jk.fromRangeStart(a.selection.getRng());return mt.readLocation(b,a.getBody(),c).map(Aa.curry(xG,a,c)).getOr(!1)},zG=function(a){return a.fold(Aa.constant(!1),Aa.constant(!0),Aa.constant(!0),Aa.constant(!1))},AG=function(a){return!!a.selection.isCollapsed()&&yG(a)},BG={insertAtSelection:AG},CG=function(a,b){hF.execute([{keyCode:Iz.SPACEBAR,action:hF.action(BG.insertAtSelection,a)}],b).each(function(a){b.preventDefault()})},DG=function(a){a.on("keydown",function(b){!1===b.isDefaultPrevented()&&CG(a,b)})},EG={setup:DG},FG=function(a){return Uq.descendant(kf.fromDom(a.getBody()),"*[data-mce-caret]").fold(Aa.constant(null),function(a){return a.dom()})},GG=function(a){a.selection.setRng(a.selection.getRng())},HG=function(a,b){b.hasAttribute("data-mce-caret")&&(xj(b),GG(a),a.selection.scrollIntoView(b))},IG=function(a,b){var c=FG(a);if(c)return"compositionstart"===b.type?(b.preventDefault(),b.stopPropagation(),void HG(a,c)):void(oj(c)&&(HG(a,c),a.undoManager.add()))},JG=function(a){a.on("keyup compositionstart",Aa.curry(IG,a))},KG={setup:JG},LG=function(a){var b=Et.setupSelectedState(a);KG.setup(a),kF.setup(a,b),uF.setup(a,b),uG.setup(a),EG.setup(a)},MG={setup:LG},NG=function(a){return oi.isElement(a)&&Sh(kf.fromDom(a))},OG=function(a){var b=a.selection.getRng(),c=x.fromRangeStart(b),d=x.fromRangeEnd(b);if(x.isElementPosition(c)){var e=c.container();NG(e)&&gl.firstPositionIn(e).each(function(a){return b.setStart(a.container(),a.offset())})}if(x.isElementPosition(d)){var e=c.container();NG(e)&&gl.lastPositionIn(e).each(function(a){return b.setEnd(a.container(),a.offset())})}a.selection.setRng(Np.normalize(b))},PG=function(a){a.on("click",function(b){3===b.detail&&OG(a)})},QG={setup:PG},RG=function(a){a.on("click",function(b){a.dom.getParent(b.target,"details")&&b.preventDefault()})},SG=function(a){a.parser.addNodeFilter("details",function(a){ob.each(a,function(a){a.attr("data-mce-open",a.attr("open")),a.attr("open","open")})}),a.serializer.addNodeFilter("details",function(a){ob.each(a,function(a){var b=a.attr("data-mce-open");a.attr("open",Ka.isString(b)?b:null),a.attr("data-mce-open",null)})})},TG=function(a){RG(a),SG(a)},UG=_i.DOM,VG=function(a,b){var c=kf.fromDom(a.getDoc().head),d=kf.fromTag("style");Pf.set(d,"type","text/css"),Cm.append(d,kf.fromText(b)),Cm.append(c,d)},WG=function(a){var b=W(a.settings,a.schema);return b.addAttributeFilter("src,href,style,tabindex",function(b,c){for(var d,e,f,g=b.length,h=a.dom;g--;)if(d=b[g],e=d.attr(c),f="data-mce-"+c,!d.attributes.map[f]){if(0===e.indexOf("data:")||0===e.indexOf("blob:"))continue;"style"===c?(e=h.serializeStyle(h.parseStyle(e),d.name),e.length||(e=null),d.attr(f,e),d.attr(c,e)):"tabindex"===c?(d.attr(f,e),d.attr(c,null)):d.attr(f,a.convertURL(e,c,d.name))}}),b.addNodeFilter("script",function(a){for(var b,c,d=a.length;d--;)b=a[d],c=b.attr("type")||"no/type",0!==c.indexOf("mce-")&&b.attr("type","mce-"+c)}),b.addNodeFilter("#cdata",function(a){for(var b,c=a.length;c--;)b=a[c],b.type=8,b.name="#comment",b.value="[CDATA["+b.value+"]]"}),b.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(b){for(var c,d=b.length,e=a.schema.getNonEmptyElements();d--;)c=b[d],c.isEmpty(e)&&0===c.getAll("br").length&&(c.append(new lD("br",1)).shortEnded=!0)}),b},XG=function(a){a.settings.auto_focus&&Qb.setEditorTimeout(a,function(){var b;b=!0===a.settings.auto_focus?a:a.editorManager.get(a.settings.auto_focus),b.destroyed||b.focus()},100)},YG=function(a){a.bindPendingEventDelegates(),a.initialized=!0,a.fire("init"),a.focus(!0),a.nodeChanged({initial:!0}),a.execCallback("init_instance_callback",a),XG(a)},ZG=function(a){return a.inline?UG.styleSheetLoader:a.dom.styleSheetLoader},$G=function(a,b){var c,d,e=a.settings,f=a.getElement(),g=a.getDoc();e.inline||(a.getElement().style.visibility=a.orgVisibility),b||e.content_editable||(g.open(),g.write(a.iframeHTML),g.close()),e.content_editable&&(a.on("remove",function(){var a=this.getBody()
;UG.removeClass(a,"mce-content-body"),UG.removeClass(a,"mce-edit-focus"),UG.setAttrib(a,"contentEditable",null)}),UG.addClass(f,"mce-content-body"),a.contentDocument=g=e.content_document||document,a.contentWindow=e.content_window||window,a.bodyElement=f,e.content_document=e.content_window=null,e.root_name=f.nodeName.toLowerCase()),c=a.getBody(),c.disabled=!0,a.readonly=e.readonly,a.readonly||(a.inline&&"static"===UG.getStyle(c,"position",!0)&&(c.style.position="relative"),c.contentEditable=a.getParam("content_editable_state",!0)),c.disabled=!1,a.editorUpload=Q(a),a.schema=t(e),a.dom=_i(g,{keep_values:!0,url_converter:a.convertURL,url_converter_scope:a,hex_colors:e.force_hex_style_colors,class_filter:e.class_filter,update_styles:!0,root_element:a.inline?a.getBody():null,collect:e.content_editable,schema:a.schema,onSetAttrib:function(b){a.fire("SetAttrib",b)}}),a.parser=WG(a),a.serializer=Y(e,a),a.selection=PE(a.dom,a.getWin(),a.serializer,a),a.formatter=V(a),a.undoManager=T(a),a._nodeChangeDispatcher=new R(a),a._selectionOverrides=Oz(a),TG(a),QG.setup(a),MG.setup(a),uy.setup(a),a.fire("PreInit"),e.browser_spellcheck||e.gecko_spellcheck||(g.body.spellcheck=!1,UG.setAttrib(c,"spellcheck","false")),a.quirks=$(a),a.fire("PostRender"),e.directionality&&(c.dir=e.directionality),e.nowrap&&(c.style.whiteSpace="nowrap"),e.protect&&a.on("BeforeSetContent",function(a){zd.each(e.protect,function(b){a.content=a.content.replace(b,function(a){return"\x3c!--mce:protected "+escape(a)+"--\x3e"})})}),a.on("SetContent",function(){a.addVisual(a.getBody())}),a.load({initial:!0,format:"html"}),a.startContent=a.getContent({format:"raw"}),a.on("compositionstart compositionend",function(b){a.composing="compositionstart"===b.type}),a.contentStyles.length>0&&(d="",zd.each(a.contentStyles,function(a){d+=a+"\r\n"}),a.dom.addStyle(d)),ZG(a).loadAll(a.contentCSS,function(b){YG(a)},function(b){YG(a)}),e.content_style&&VG(a,e.content_style)},_G={initContentBody:$G},aH=_i.DOM,bH=function(a,b){if(document.domain!==window.location.hostname&&Ib.ie&&Ib.ie<12){var c=ny.uuid("mce");a[c]=function(){_G.initContentBody(a)};var d='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+a.id+'");document.write(ed.iframeHTML);document.close();ed.'+c+"(true);})()";return aH.setAttrib(b,"src",d),!0}return!1},cH=function(a){var b="number"==typeof a?a+"px":a;return b||""},dH=function(a,b,c,d){var e=kf.fromTag("iframe");return Pf.setAll(e,d),Pf.setAll(e,{id:a+"_ifr",frameBorder:"0",allowTransparency:"true",title:b}),kg.setAll(e,{width:"100%",height:cH(c),display:"block"}),e},eH=function(a){var b,c,d;return d=vm.getDocType(a)+"<html><head>",vm.getDocumentBaseUrl(a)!==a.documentBaseUrl&&(d+='<base href="'+a.documentBaseURI.getURI()+'" />'),d+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',b=vm.getBodyId(a),c=vm.getBodyClass(a),vm.getContentSecurityPolicy(a)&&(d+='<meta http-equiv="Content-Security-Policy" content="'+vm.getContentSecurityPolicy(a)+'" />'),d+='</head><body id="'+b+'" class="mce-content-body '+c+'" data-id="'+a.id+'"><br></body></html>'},fH=function(a,b){var c=a.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),d=dH(a.id,c,b.height,vm.getIframeAttrs(a)).dom();d.onload=function(){d.onload=null,a.fire("load")};var e=bH(a,d);return a.contentAreaContainer=b.iframeContainer,a.iframeElement=d,a.iframeHTML=eH(a),aH.add(b.iframeContainer,d),e},gH=function(a,b){var c=fH(a,b);b.editorContainer&&(aH.get(b.editorContainer).style.display=a.orgDisplay,a.hidden=aH.isHidden(b.editorContainer)),a.getElement().style.display="none",aH.setAttrib(a.id,"aria-hidden","true"),c||_G.initContentBody(a)},hH={init:gH},iH=_i.DOM,jH=function(a,b,c){var d,e,f=Xx.get(c);if(d=Xx.urls[c]||a.documentBaseUrl.replace(/\/$/,""),c=zd.trim(c),f&&-1===zd.inArray(b,c)){if(zd.each(Xx.dependencies(c),function(c){jH(a,b,c)}),a.plugins[c])return;e=new f(a,d,a.$),a.plugins[c]=e,e.init&&(e.init(a,d),b.push(c))}},kH=function(a){return a.replace(/^\-/,"")},lH=function(a){var b=[];zd.each(a.settings.plugins.split(/[ ,]/),function(c){jH(a,b,kH(c))})},mH=function(a){var b,c=a.settings.theme;Ka.isString(c)?(a.settings.theme=kH(c),b=Yx.get(c),a.theme=new b(a,Yx.urls[c]),a.theme.init&&a.theme.init(a,Yx.urls[c]||a.documentBaseUrl.replace(/\/$/,""),a.$)):a.theme={}},nH=function(a){var b,c,d,e,f,g=a.settings,h=a.getElement();return b=g.width||iH.getStyle(h,"width")||"100%",c=g.height||iH.getStyle(h,"height")||h.offsetHeight,d=g.min_height||100,e=/^[0-9\.]+(|px)$/i,e.test(""+b)&&(b=Math.max(parseInt(b,10),100)),e.test(""+c)&&(c=Math.max(parseInt(c,10),d)),f=a.theme.renderUI({targetNode:h,width:b,height:c,deltaWidth:g.delta_width,deltaHeight:g.delta_height}),g.content_editable||(c=(f.iframeHeight||c)+("number"==typeof c?f.deltaHeight||0:""))<d&&(c=d),f.height=c,f},oH=function(a){var b,c=a.getElement();return b=a.settings.theme(a,c),b.editorContainer.nodeType&&(b.editorContainer.id=b.editorContainer.id||a.id+"_parent"),b.iframeContainer&&b.iframeContainer.nodeType&&(b.iframeContainer.id=b.iframeContainer.id||a.id+"_iframecontainer"),b.height=b.iframeHeight?b.iframeHeight:c.offsetHeight,b},pH=function(a){return{editorContainer:a,iframeContainer:a}},qH=function(a){var b=iH.create("div");return iH.insertAfter(b,a),pH(b)},rH=function(a){var b=a.getElement();return a.inline?pH(null):qH(b)},sH=function(a){var b=a.settings,c=a.getElement();return a.orgDisplay=c.style.display,Ka.isString(b.theme)?nH(a):Ka.isFunction(b.theme)?oH(a):rH(a)},tH=function(a){var b,c=a.settings,d=a.getElement();return a.rtl=c.rtl_ui||a.editorManager.i18n.rtl,a.editorManager.i18n.setCode(c.language),c.aria_label=c.aria_label||iH.getAttrib(d,"aria-label",a.getLang("aria.rich_text_area")),a.fire("ScriptsLoaded"),mH(a),lH(a),b=sH(a),a.editorContainer=b.editorContainer?b.editorContainer:null,c.content_css&&zd.each(zd.explode(c.content_css),function(b){a.contentCSS.push(a.documentBaseURI.toAbsolute(b))}),c.content_editable?_G.initContentBody(a):hH.init(a,b)},uH={init:tH},vH=_i.DOM,wH=function(a){return"-"===a.charAt(0)},xH=function(a,b){var c=b.settings;c.language&&"en"!==c.language&&!c.language_url&&(c.language_url=b.editorManager.baseURL+"/langs/"+c.language+".js"),c.language_url&&!b.editorManager.i18n.data[c.language]&&a.add(c.language_url)},yH=function(a,b,c,d){var e=b.settings,f=e.theme;if(Ka.isString(f)){if(!wH(f)&&!Yx.urls.hasOwnProperty(f)){var g=e.theme_url;g?Yx.load(f,b.documentBaseURI.toAbsolute(g)):Yx.load(f,"themes/"+f+"/theme"+c+".js")}a.loadQueue(function(){Yx.waitFor(f,d)})}else d()},zH=function(a,b){zd.isArray(a.plugins)&&(a.plugins=a.plugins.join(" ")),zd.each(a.external_plugins,function(b,c){Xx.load(c,b),a.plugins+=" "+c}),zd.each(a.plugins.split(/[ ,]/),function(a){if((a=zd.trim(a))&&!Xx.urls[a])if(wH(a)){a=a.substr(1,a.length);var c=Xx.dependencies(a);zd.each(c,function(a){var c={prefix:"plugins/",resource:a,suffix:"/plugin"+b+".js"};a=Xx.createUrl(c,a),Xx.load(a.resource,a)})}else Xx.load(a,{prefix:"plugins/",resource:a,suffix:"/plugin"+b+".js"})})},AH=function(a,b){var c=ej.ScriptLoader;yH(c,a,b,function(){xH(c,a),zH(a.settings,b),c.loadQueue(function(){a.removed||uH.init(a)},a,function(b){Wx.pluginLoadError(a,b[0]),a.removed||uH.init(a)})})},BH=function(a){var b=a.settings,c=a.id,d=function(){vH.unbind(window,"ready",d),a.render()};if(!_b.Event.domLoaded)return void vH.bind(window,"ready",d);if(a.getElement()&&Ib.contentEditable){b.inline?a.inline=!0:(a.orgVisibility=a.getElement().style.visibility,a.getElement().style.visibility="hidden");var e=a.getElement().form||vH.getParent(c,"form");e&&(a.formElement=e,b.hidden_input&&!/TEXTAREA|INPUT/i.test(a.getElement().nodeName)&&(vH.insertAfter(vH.create("input",{type:"hidden",name:c}),c),a.hasHiddenInput=!0),a.formEventDelegate=function(b){a.fire(b.type,b)},vH.bind(e,"submit reset",a.formEventDelegate),a.on("reset",function(){a.setContent(a.startContent,{format:"raw"})}),!b.submit_patch||e.submit.nodeType||e.submit.length||e._mceOldSubmit||(e._mceOldSubmit=e.submit,e.submit=function(){return a.editorManager.triggerSave(),a.setDirty(!1),e._mceOldSubmit(e)})),a.windowManager=H(a),a.notificationManager=F(a),"xml"===b.encoding&&a.on("GetContent",function(a){a.save&&(a.content=vH.encode(a.content))}),b.add_form_submit_trigger&&a.on("submit",function(){a.initialized&&a.save()}),b.add_unload_trigger&&(a._beforeUnload=function(){!a.initialized||a.destroyed||a.isHidden()||a.save({format:"raw",no_events:!0,set_dirty:!1})},a.editorManager.on("BeforeUnload",a._beforeUnload)),a.editorManager.add(a),AH(a,a.suffix)}},CH={render:BH},DH=function(a,b,c){var d=a.sidebars?a.sidebars:[];d.push({name:b,settings:c}),a.sidebars=d},EH={add:DH},FH=zd.each,GH=zd.trim,HH="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),IH={ftp:21,http:80,https:443,mailto:25},JH=function(a,b){var c,d,e=this;if(a=GH(a),b=e.settings=b||{},c=b.base_uri,/^([\w\-]+):([^\/]{2})/i.test(a)||/^\s*#/.test(a))return void(e.source=a);var f=0===a.indexOf("//");0!==a.indexOf("/")||f||(a=(c?c.protocol||"http":"http")+"://mce_host"+a),/^[\w\-]*:?\/\//.test(a)||(d=b.base_uri?b.base_uri.path:new JH(document.location.href).directory,""==b.base_uri.protocol?a="//mce_host"+e.toAbsPath(d,a):(a=/([^#?]*)([#?]?.*)/.exec(a),a=(c&&c.protocol||"http")+"://mce_host"+e.toAbsPath(d,a[1])+a[2])),a=a.replace(/@@/g,"(mce_at)"),a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a),FH(HH,function(b,c){var d=a[c];d&&(d=d.replace(/\(mce_at\)/g,"@@")),e[b]=d}),c&&(e.protocol||(e.protocol=c.protocol),e.userInfo||(e.userInfo=c.userInfo),e.port||"mce_host"!==e.host||(e.port=c.port),e.host&&"mce_host"!==e.host||(e.host=c.host),e.source=""),f&&(e.protocol="")};JH.prototype={setPath:function(a){var b=this;a=/^(.*?)\/?(\w+)?$/.exec(a),b.path=a[0],b.directory=a[1],b.file=a[2],b.source="",b.getURI()},toRelative:function(a){var b,c=this;if("./"===a)return a;if(a=new JH(a,{base_uri:c}),"mce_host"!==a.host&&c.host!==a.host&&a.host||c.port!==a.port||c.protocol!==a.protocol&&""!==a.protocol)return a.getURI();var d=c.getURI(),e=a.getURI();return d===e||"/"===d.charAt(d.length-1)&&d.substr(0,d.length-1)===e?d:(b=c.toRelPath(c.path,a.path),a.query&&(b+="?"+a.query),a.anchor&&(b+="#"+a.anchor),b)},toAbsolute:function(a,b){return a=new JH(a,{base_uri:this}),a.getURI(b&&this.isSameOrigin(a))},isSameOrigin:function(a){if(this.host==a.host&&this.protocol==a.protocol){if(this.port==a.port)return!0;var b=IH[this.protocol];if(b&&(this.port||b)==(a.port||b))return!0}return!1},toRelPath:function(a,b){var c,d,e,f=0,g="";if(a=a.substring(0,a.lastIndexOf("/")),a=a.split("/"),c=b.split("/"),a.length>=c.length)for(d=0,e=a.length;d<e;d++)if(d>=c.length||a[d]!==c[d]){f=d+1;break}if(a.length<c.length)for(d=0,e=c.length;d<e;d++)if(d>=a.length||a[d]!==c[d]){f=d+1;break}if(1===f)return b;for(d=0,e=a.length-(f-1);d<e;d++)g+="../";for(d=f-1,e=c.length;d<e;d++)g+=d!==f-1?"/"+c[d]:c[d];return g},toAbsPath:function(a,b){var c,d,e,f=0,g=[];for(d=/\/$/.test(b)?"/":"",a=a.split("/"),b=b.split("/"),FH(a,function(a){a&&g.push(a)}),a=g,c=b.length-1,g=[];c>=0;c--)0!==b[c].length&&"."!==b[c]&&(".."!==b[c]?f>0?f--:g.push(b[c]):f++);return c=a.length-f,e=c<=0?g.reverse().join("/"):a.slice(0,c).join("/")+"/"+g.reverse().join("/"),0!==e.indexOf("/")&&(e="/"+e),d&&e.lastIndexOf("/")!==e.length-1&&(e+=d),e},getURI:function(a){var b,c=this;return c.source&&!a||(b="",a||(c.protocol?b+=c.protocol+"://":b+="//",c.userInfo&&(b+=c.userInfo+"@"),c.host&&(b+=c.host),c.port&&(b+=":"+c.port)),c.path&&(b+=c.path),c.query&&(b+="?"+c.query),c.anchor&&(b+="#"+c.anchor),c.source=b),c.source}},JH.parseDataUri=function(a){var b,c;return a=decodeURIComponent(a).split(","),c=/data:([^;]+)/.exec(a[0]),c&&(b=c[1]),{type:b,data:a[1]}},JH.getDocumentBaseUrl=function(a){var b;return b=0!==a.protocol.indexOf("http")&&"file:"!==a.protocol?a.href:a.protocol+"//"+a.host+a.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(b)&&(b=b.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(b)||(b+="/")),b};var KH=function(a,b){var c=vm.getForcedRootBlock(a),d=new RegExp("^(<"+c+"[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/"+c+">[\r\n]*|<br \\/>[\r\n]*)$");return b.replace(d,"")},LH=function(a,b,c){var d;if(b.format=b.format?b.format:"html",b.get=!0,b.getInner=!0,b.no_events||a.fire("BeforeGetContent",b),"raw"===b.format)d=zd.trim(Xz.trimExternal(a.serializer,c.innerHTML));else if("text"===b.format)d=ij.trim(c.innerText||c.textContent);else{if("tree"===b.format)return a.serializer.serialize(c,b);d=KH(a,a.serializer.serialize(c,b))}return"text"===b.format||Yh(kf.fromDom(c))?b.content=d:b.content=zd.trim(d),b.no_events||a.fire("GetContent",b),b.content},MH=function(a,b){return void 0===b&&(b={}),Ha.from(a.getBody()).fold(Aa.constant("tree"===b.format?new lD("body",11):""),function(c){return LH(a,b,c)})},NH=function(a,b){b(a),a.firstChild&&NH(a.firstChild,b),a.next&&NH(a.next,b)},OH=function(a,b,c){var d={},e={},f=[];c.firstChild&&NH(c.firstChild,function(c){ob.each(a,function(a){a.name===c.name&&(d[a.name]?d[a.name].nodes.push(c):d[a.name]={filter:a,nodes:[c]})}),ob.each(b,function(a){"string"==typeof c.attr(a.name)&&(e[a.name]?e[a.name].nodes.push(c):e[a.name]={filter:a,nodes:[c]})})});for(var g in d)d.hasOwnProperty(g)&&f.push(d[g]);for(var h in e)e.hasOwnProperty(h)&&f.push(e[h]);return f},PH=function(a,b,c){var d=OH(a,b,c);ob.each(d,function(a){ob.each(a.filter.callbacks,function(b){b(a.nodes,a.filter.name,{})})})},QH=function(a){return a instanceof lD},RH=function(a){Ax.hasFocus(a)&&gl.firstPositionIn(a.getBody()).each(function(b){var c=b.getNode(),d=oi.isTable(c)?gl.firstPositionIn(c).getOr(b):b;a.selection.setRng(d.toRange())})},SH=function(a,b){a.dom.setHTML(a.getBody(),b),RH(a)},TH=function(a,b,c,d){var e,f;return 0===c.length||/^\s+$/.test(c)?(f='<br data-mce-bogus="1">',"TABLE"===b.nodeName?c="<tr><td>"+f+"</td></tr>":/^(UL|OL)$/.test(b.nodeName)&&(c="<li>"+f+"</li>"),e=vm.getForcedRootBlock(a),e&&a.schema.isValidChild(b.nodeName.toLowerCase(),e.toLowerCase())?(c=f,c=a.dom.createHTML(e,a.settings.forced_root_block_attrs,c)):c||(c='<br data-mce-bogus="1">'),SH(a,c),a.fire("SetContent",d)):("raw"!==d.format&&(c=z({validate:a.validate},a.schema).serialize(a.parser.parse(c,{isRootContent:!0,insert:!0}))),d.content=Yh(kf.fromDom(b))?c:zd.trim(c),SH(a,d.content),d.no_events||a.fire("SetContent",d)),d.content},UH=function(a,b,c,d){PH(a.parser.getNodeFilters(),a.parser.getAttributeFilters(),c);var e=z({validate:a.validate},a.schema).serialize(c);return d.content=Yh(kf.fromDom(b))?e:zd.trim(e),SH(a,d.content),d.no_events||a.fire("SetContent",d),c},VH=function(a,b,c){return void 0===c&&(c={}),c.format=c.format?c.format:"html",c.set=!0,c.content=QH(b)?"":b,QH(b)||c.no_events||(a.fire("BeforeSetContent",c),b=c.content),Ha.from(a.getBody()).fold(Aa.constant(b),function(d){return QH(b)?UH(a,d,b,c):TH(a,d,b,c)})},WH=_i.DOM,XH=function(a){WH.setStyle(a.id,"display",a.orgDisplay)},YH=function(a){return Ha.from(a).each(function(a){return a.destroy()})},ZH=function(a){a.contentAreaContainer=a.formElement=a.container=a.editorContainer=null,a.bodyElement=a.contentDocument=a.contentWindow=null,a.iframeElement=a.targetElm=null,a.selection&&(a.selection=a.selection.win=a.selection.dom=a.selection.dom.doc=null)},$H=function(a){var b=a.formElement;b&&(b._mceOldSubmit&&(b.submit=b._mceOldSubmit,b._mceOldSubmit=null),WH.unbind(b,"submit reset",a.formEventDelegate))},_H=function(a){if(!a.removed){var b=a._selectionOverrides,c=a.editorUpload,d=a.getBody(),e=a.getElement();d&&a.save(),a.removed=!0,a.unbindAllNativeEvents(),a.hasHiddenInput&&e&&WH.remove(e.nextSibling),!a.inline&&d&&XH(a),Jw.fireRemove(a),a.editorManager.remove(a),WH.remove(a.getContainer()),YH(b),YH(c),a.destroy()}},aI=function(a,b){var c=a.selection,d=a.dom;if(!a.destroyed){if(!b&&!a.removed)return void a.remove();b||(a.editorManager.off("beforeunload",a._beforeUnload),a.theme&&a.theme.destroy&&a.theme.destroy(),YH(c),YH(d)),$H(a),ZH(a),a.destroyed=!0}},bI=_i.DOM,cI=zd.extend,dI=zd.each,eI=zd.resolve,fI=Ib.ie,gI=function(a,b,c){var d=this,e=d.documentBaseUrl=c.documentBaseURL,f=c.baseURI;b=qq(d,a,e,c.defaultSettings,b),d.settings=b,w.language=b.language||"en",w.languageLoad=b.language_load,w.baseURL=c.baseURL,d.id=a,d.setDirty(!1),d.plugins={},d.documentBaseURI=new JH(b.document_base_url,{base_uri:f}),d.baseURI=f,d.contentCSS=[],d.contentStyles=[],d.shortcuts=new D(d),d.loadedCSS={},d.editorCommands=new B(d),d.suffix=c.suffix,d.editorManager=c,d.inline=b.inline,d.buttons={},d.menuItems={},b.cache_suffix&&(Ib.cacheSuffix=b.cache_suffix.replace(/^[\?\&]+/,"")),!1===b.override_viewport&&(Ib.overrideViewPort=!1),c.fire("SetupEditor",{editor:d}),d.execCallback("setup",d),d.$=Td.overrideDefaults(function(){return{context:d.inline?d.getBody():d.getDoc(),element:d.getBody()}})};gI.prototype={render:function(){CH.render(this)},focus:function(a){Ax.focus(this,a)},hasFocus:function(){return Ax.hasFocus(this)},execCallback:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d,e=this,f=e.settings[a];if(f)return e.callbackLookup&&(d=e.callbackLookup[a])&&(f=d.func,d=d.scope),"string"==typeof f&&(d=f.replace(/\.\w+$/,""),d=d?eI(d):0,f=eI(f),e.callbackLookup=e.callbackLookup||{},e.callbackLookup[a]={func:f,scope:d}),f.apply(d||e,Array.prototype.slice.call(arguments,1))},translate:function(a){if(a&&zd.is(a,"string")){var b=this.settings.language||"en",c=this.editorManager.i18n;a=c.data[b+"."+a]||a.replace(/\{\#([^\}]+)\}/g,function(a,d){return c.data[b+"."+d]||"{#"+d+"}"})}return this.editorManager.translate(a)},getLang:function(a,b){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+a]||(void 0!==b?b:"{#"+a+"}")},getParam:function(a,b,c){return vq(this,a,b,c)},nodeChanged:function(a){this._nodeChangeDispatcher.nodeChanged(a)},addButton:function(a,b){var c=this;b.cmd&&(b.onclick=function(){c.execCommand(b.cmd)}),b.stateSelector&&void 0===b.active&&(b.active=!1),b.text||b.icon||(b.icon=a),c.buttons=c.buttons,b.tooltip=b.tooltip||b.title,c.buttons[a]=b},addSidebar:function(a,b){return EH.add(this,a,b)},addMenuItem:function(a,b){var c=this;b.cmd&&(b.onclick=function(){c.execCommand(b.cmd)}),c.menuItems=c.menuItems,c.menuItems[a]=b},addContextToolbar:function(a,b){var c,d=this;d.contextToolbars=d.contextToolbars||[],"string"==typeof a&&(c=a,a=function(a){return d.dom.is(a,c)}),d.contextToolbars.push({id:ny.uuid("mcet"),predicate:a,items:b})},addCommand:function(a,b,c){this.editorCommands.addCommand(a,b,c)},addQueryStateHandler:function(a,b,c){this.editorCommands.addQueryStateHandler(a,b,c)},addQueryValueHandler:function(a,b,c){this.editorCommands.addQueryValueHandler(a,b,c)},addShortcut:function(a,b,c,d){this.shortcuts.add(a,b,c,d)},execCommand:function(a,b,c,d){return this.editorCommands.execCommand(a,b,c,d)},queryCommandState:function(a){return this.editorCommands.queryCommandState(a)},queryCommandValue:function(a){return this.editorCommands.queryCommandValue(a)},queryCommandSupported:function(a){return this.editorCommands.queryCommandSupported(a)},show:function(){var a=this;a.hidden&&(a.hidden=!1,a.inline?a.getBody().contentEditable=!0:(bI.show(a.getContainer()),bI.hide(a.id)),a.load(),a.fire("show"))},hide:function(){var a=this,b=a.getDoc();a.hidden||(fI&&b&&!a.inline&&b.execCommand("SelectAll"),a.save(),a.inline?(a.getBody().contentEditable=!1,a===a.editorManager.focusedEditor&&(a.editorManager.focusedEditor=null)):(bI.hide(a.getContainer()),bI.setStyle(a.id,"display",a.orgDisplay)),a.hidden=!0,a.fire("hide"))},isHidden:function(){return!!this.hidden},setProgressState:function(a,b){this.fire("ProgressState",{state:a,time:b})},load:function(a){var b,c=this,d=c.getElement();return c.removed?"":d?(a=a||{},a.load=!0,b=c.setContent(void 0!==d.value?d.value:d.innerHTML,a),a.element=d,a.no_events||c.fire("LoadContent",a),a.element=d=null,b):void 0},save:function(a){var b,c,d=this,e=d.getElement();if(e&&d.initialized&&!d.removed)return a=a||{},a.save=!0,a.element=e,b=a.content=d.getContent(a),a.no_events||d.fire("SaveContent",a),"raw"===a.format&&d.fire("RawSaveContent",a),b=a.content,/TEXTAREA|INPUT/i.test(e.nodeName)?e.value=b:(d.inline||(e.innerHTML=b),(c=bI.getParent(d.id,"form"))&&dI(c.elements,function(a){if(a.name===d.id)return a.value=b,!1})),a.element=e=null,!1!==a.set_dirty&&d.setDirty(!1),b},setContent:function(a,b){return VH(this,a,b)},getContent:function(a){return MH(this,a)},insertContent:function(a,b){b&&(a=cI({content:a},b)),this.execCommand("mceInsertContent",!1,a)},isDirty:function(){return!this.isNotDirty},setDirty:function(a){var b=!this.isNotDirty;this.isNotDirty=!a,a&&a!==b&&this.fire("dirty")},setMode:function(a){Nw(this,a)},getContainer:function(){var a=this;return a.container||(a.container=bI.get(a.editorContainer||a.id+"_parent")),a.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return this.targetElm||(this.targetElm=bI.get(this.id)),this.targetElm},getWin:function(){var a,b=this;return b.contentWindow||(a=b.iframeElement)&&(b.contentWindow=a.contentWindow),b.contentWindow},getDoc:function(){var a,b=this;return b.contentDocument||(a=b.getWin())&&(b.contentDocument=a.document),b.contentDocument},getBody:function(){var a=this.getDoc();return this.bodyElement||(a?a.body:null)},convertURL:function(a,b,c){var d=this,e=d.settings;return e.urlconverter_callback?d.execCallback("urlconverter_callback",a,c,!0,b):!e.convert_urls||c&&"LINK"===c.nodeName||0===a.indexOf("file:")||0===a.length?a:e.relative_urls?d.documentBaseURI.toRelative(a):a=d.documentBaseURI.toAbsolute(a,e.remove_script_host)},addVisual:function(a){var b,c=this,d=c.settings,e=c.dom;a=a||c.getBody(),void 0===c.hasVisual&&(c.hasVisual=d.visual),dI(e.select("table,a",a),function(a){var f;switch(a.nodeName){case"TABLE":return b=d.visual_table_class||"mce-item-table",f=e.getAttrib(a,"border"),void(f&&"0"!==f||!c.hasVisual?e.removeClass(a,b):e.addClass(a,b));case"A":return void(e.getAttrib(a,"href")||(f=e.getAttrib(a,"name")||a.id,b=d.visual_anchor_class||"mce-item-anchor",f&&c.hasVisual?e.addClass(a,b):e.removeClass(a,b)))}}),c.fire("VisualAid",{element:a,hasVisual:c.hasVisual})},remove:function(){_H(this)},destroy:function(a){aI(this,a)},uploadImages:function(a){return this.editorUpload.uploadImages(a)},_scanForImages:function(){return this.editorUpload.scanForImages()}},cI(gI.prototype,Xw);var hI,iI,jI,kI=function(a){return-1!==a.className.toString().indexOf("mce-")},lI={isEditorUIElement:kI},mI=function(a){return"nodechange"===a.type&&a.selectionChange},nI=function(a,b){var c=function(){b.throttle()};_i.DOM.bind(document,"mouseup",c),a.on("remove",function(){_i.DOM.unbind(document,"mouseup",c)})},oI=function(a){a.on("focusout",function(){aw.store(a)})},pI=function(a,b){a.on("mouseup touchend",function(a){b.throttle()})},qI=function(a,b){df.detect().browser.isIE()?oI(a):pI(a,b),a.on("keyup nodechange",function(b){mI(b)||aw.store(a)})},rI=function(a){var b=Fz.first(function(){aw.store(a)},0);a.inline&&nI(a,b),a.on("init",function(){qI(a,b)}),a.on("remove",function(){b.cancel()})},sI={register:rI},tI=_i.DOM,uI=function(a){return lI.isEditorUIElement(a)},vI=function(a,b){var c=a?a.settings.custom_ui_selector:"";return null!==tI.getParent(b,function(b){return uI(b)||!!c&&a.dom.is(b,c)})},wI=function(){try{return document.activeElement}catch(a){return document.body}},xI=function(a,b){var c=b.editor;sI.register(c),c.on("focusin",function(){var b=this,c=a.focusedEditor;c!==b&&(c&&c.fire("blur",{focusedEditor:b}),a.setActive(b),a.focusedEditor=b,b.fire("focus",{blurredEditor:c}),b.focus(!0))}),c.on("focusout",function(){var b=this;Qb.setEditorTimeout(b,function(){var c=a.focusedEditor;vI(b,wI())||c!==b||(b.fire("blur",{focusedEditor:null}),a.focusedEditor=null)})}),hI||(hI=function(b){var c,d=a.activeEditor;c=b.target,d&&c.ownerDocument===document&&(c===document.body||vI(d,c)||a.focusedEditor!==d||(d.fire("blur",{focusedEditor:null}),a.focusedEditor=null))},tI.bind(document,"focusin",hI))},yI=function(a,b){a.focusedEditor===b.editor&&(a.focusedEditor=null),a.activeEditor||(tI.unbind(document,"focusin",hI),hI=null)},zI=function(a){a.on("AddEditor",Aa.curry(xI,a)),a.on("RemoveEditor",Aa.curry(yI,a))},AI={setup:zI,isEditorUIElement:uI,isUIElement:vI},BI={},CI="en",DI={setCode:function(a){a&&(CI=a,this.rtl=!!this.data[a]&&"rtl"===this.data[a]._dir)},getCode:function(){return CI},rtl:!1,add:function(a,b){var c=BI[a];c||(BI[a]=c={});for(var d in b)c[d]=b[d];this.setCode(a)},translate:function(a){var b=BI[CI]||{},c=function(a){return zd.is(a,"function")?Object.prototype.toString.call(a):d(a)?"":""+a},d=function(a){return""===a||null===a||zd.is(a,"undefined")},e=function(a){return a=c(a),zd.hasOwn(b,a)?c(b[a]):a};if(d(a))return"";if(zd.is(a,"object")&&zd.hasOwn(a,"raw"))return c(a.raw);if(zd.is(a,"array")){var f=a.slice(1);a=e(a[0]).replace(/\{([0-9]+)\}/g,function(a,b){return zd.hasOwn(f,b)?c(f[b]):a})}return e(a).replace(/{context:\w+}$/,"")},data:BI},EI=_i.DOM,FI=zd.explode,GI=zd.each,HI=zd.extend,II=0,JI=!1,KI=[],LI=[],MI=function(a){return"length"!==a},NI=function(a){GI(jI.get(),function(b){"scroll"===a.type?b.fire("ScrollWindow",a):b.fire("ResizeWindow",a)})},OI=function(a){a!==JI&&(a?Td(window).on("resize scroll",NI):Td(window).off("resize scroll",NI),JI=a)},PI=function(a){var b=LI;delete KI[a.id];for(var c=0;c<KI.length;c++)if(KI[c]===a){KI.splice(c,1);break}return LI=ob.filter(LI,function(b){return a!==b}),jI.activeEditor===a&&(jI.activeEditor=LI.length>0?LI[0]:null),jI.focusedEditor===a&&(jI.focusedEditor=null),b.length!==LI.length},QI=function(a){return a&&a.initialized&&!(a.getContainer()||a.getBody()).parentNode&&(PI(a),a.unbindAllNativeEvents(),a.destroy(!0),a.removed=!0,a=null),a};jI={defaultSettings:{},$:Td,majorVersion:"4",minorVersion:"7.13",releaseDate:"2018-05-16",editors:KI,i18n:DI,activeEditor:null,settings:{},setup:function(){var a,b,c,d,e=this,f="";if(b=JH.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(b)&&(b=b.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(b)||(b+="/")),c=window.tinymce||window.tinyMCEPreInit)a=c.base||c.baseURL,f=c.suffix;else{for(var g=document.getElementsByTagName("script"),h=0;h<g.length;h++){d=g[h].src;var i=d.substring(d.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(d)){-1!==i.indexOf(".min")&&(f=".min"),a=d.substring(0,d.lastIndexOf("/"));break}}!a&&document.currentScript&&(d=document.currentScript.src,-1!==d.indexOf(".min")&&(f=".min"),a=d.substring(0,d.lastIndexOf("/")))}e.baseURL=new JH(b).toAbsolute(a),e.documentBaseURL=b,e.baseURI=new JH(e.baseURL),e.suffix=f,AI.setup(e)},overrideDefaults:function(a){var b,c;b=a.base_url,b&&(this.baseURL=new JH(this.documentBaseURL).toAbsolute(b.replace(/\/+$/,"")),this.baseURI=new JH(this.baseURL)),c=a.suffix,a.suffix&&(this.suffix=c),this.defaultSettings=a;var d=a.plugin_base_urls;for(var e in d)w.PluginManager.urls[e]=d[e]},init:function(a){var b,c,d=this;c=zd.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu"," ");var e=function(a,b){return a.inline&&b.tagName.toLowerCase()in c},f=function(a){var b=a.id;return b||(b=a.name,b=b&&!EI.get(b)?a.name:EI.uniqueId(),a.setAttribute("id",b)),b},g=function(b){var c=a[b];if(c)return c.apply(d,Array.prototype.slice.call(arguments,2))},h=function(a,b){return b.constructor===RegExp?b.test(a.className):EI.hasClass(a,b)},i=function(a){var b,c=[];if(Ib.ie&&Ib.ie<11)return Wx.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(a.types)return GI(a.types,function(a){c=c.concat(EI.select(a.selector))}),c;if(a.selector)return EI.select(a.selector);if(a.target)return[a.target];switch(a.mode){case"exact":b=a.elements||"",b.length>0&&GI(FI(b),function(a){var b;(b=EI.get(a))?c.push(b):GI(document.forms,function(b){GI(b.elements,function(b){b.name===a&&(a="mce_editor_"+II++,EI.setAttrib(b,"id",a),c.push(b))})})});break;case"textareas":case"specific_textareas":GI(EI.select("textarea"),function(b){a.editor_deselector&&h(b,a.editor_deselector)||a.editor_selector&&!h(b,a.editor_selector)||c.push(b)})}return c},j=function(a){b=a},k=function(){var b,c=0,h=[],l=function(a,e,f){var g=new gI(a,e,d);h.push(g),g.on("init",function(){++c===b.length&&j(h)}),g.targetElm=g.targetElm||f,g.render()};if(EI.unbind(window,"ready",k),g("onpageload"),b=Td.unique(i(a)),a.types)return void GI(a.types,function(c){zd.each(b,function(b){return!EI.is(b,c.selector)||(l(f(b),HI({},a,c),b),!1)})});zd.each(b,function(a){QI(d.get(a.id))}),b=zd.grep(b,function(a){return!d.get(a.id)}),0===b.length?j([]):GI(b,function(b){e(a,b)?Wx.initError("Could not initialize inline editor on invalid inline target element",b):l(f(b),a,b)})};return d.settings=a,EI.bind(window,"ready",k),new Jb(function(a){b?a(b):j=function(b){a(b)}})},get:function(a){return 0===arguments.length?LI.slice(0):Ka.isString(a)?ob.find(LI,function(b){return b.id===a}).getOr(null):Ka.isNumber(a)&&LI[a]?LI[a]:null},add:function(a){var b=this;return KI[a.id]===a?a:(null===b.get(a.id)&&(MI(a.id)&&(KI[a.id]=a),KI.push(a),LI.push(a)),OI(!0),b.activeEditor=a,b.fire("AddEditor",{editor:a}),iI||(iI=function(){b.fire("BeforeUnload")},EI.bind(window,"beforeunload",iI)),a)},createEditor:function(a,b){return this.add(new gI(a,b,this))},remove:function(a){var b,c,d=this;if(a)return Ka.isString(a)?(a=a.selector||a,void GI(EI.select(a),function(a){(c=d.get(a.id))&&d.remove(c)})):(c=a,Ka.isNull(d.get(c.id))?null:(PI(c)&&d.fire("RemoveEditor",{editor:c}),0===LI.length&&EI.unbind(window,"beforeunload",iI),c.remove(),OI(LI.length>0),c));for(b=LI.length-1;b>=0;b--)d.remove(LI[b])},execCommand:function(a,b,c){var d=this,e=d.get(c);switch(a){case"mceAddEditor":return d.get(c)||new gI(c,d.settings,d).render(),!0;case"mceRemoveEditor":return e&&e.remove(),!0;case"mceToggleEditor":return e?(e.isHidden()?e.show():e.hide(),!0):(d.execCommand("mceAddEditor",0,c),!0)}return!!d.activeEditor&&d.activeEditor.execCommand(a,b,c)},triggerSave:function(){GI(LI,function(a){a.save()})},addI18n:function(a,b){DI.add(a,b)},translate:function(a){return DI.translate(a)},setActive:function(a){var b=this.activeEditor;this.activeEditor!==a&&(b&&b.fire("deactivate",{relatedTarget:a}),a.fire("activate",{relatedTarget:b})),this.activeEditor=a}},HI(jI,lw),jI.setup();var RI=jI;!function(a){a.compareRanges=bv.isEq,a.getCaretRangeFromPoint=ND.fromPoint,a.getSelectedNode=Zj,a.getNode=$j}(_||(_={}));var SI,TI,UI=_,VI=Math.min,WI=Math.max,XI=Math.round,YI=function(a,b,c){var d,e,f,g,h,i;return d=b.x,e=b.y,f=a.w,g=a.h,h=b.w,i=b.h,c=(c||"").split(""),"b"===c[0]&&(e+=i),"r"===c[1]&&(d+=h),"c"===c[0]&&(e+=XI(i/2)),"c"===c[1]&&(d+=XI(h/2)),"b"===c[3]&&(e-=g),"r"===c[4]&&(d-=f),"c"===c[3]&&(e-=XI(g/2)),"c"===c[4]&&(d-=XI(f/2)),bJ(d,e,f,g)},ZI=function(a,b,c,d){var e,f;for(f=0;f<d.length;f++)if(e=YI(a,b,d[f]),e.x>=c.x&&e.x+e.w<=c.w+c.x&&e.y>=c.y&&e.y+e.h<=c.h+c.y)return d[f];return null},$I=function(a,b,c){return bJ(a.x-b,a.y-c,a.w+2*b,a.h+2*c)},_I=function(a,b){var c,d,e,f;return c=WI(a.x,b.x),d=WI(a.y,b.y),e=VI(a.x+a.w,b.x+b.w),f=VI(a.y+a.h,b.y+b.h),e-c<0||f-d<0?null:bJ(c,d,e-c,f-d)},aJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return h=a.x,i=a.y,j=a.x+a.w,k=a.y+a.h,l=b.x+b.w,m=b.y+b.h,d=WI(0,b.x-h),e=WI(0,b.y-i),f=WI(0,j-l),g=WI(0,k-m),h+=d,i+=e,c&&(j+=d,k+=e,h-=f,i-=g),j-=f,k-=g,bJ(h,i,j-h,k-i)},bJ=function(a,b,c,d){return{x:a,y:b,w:c,h:d}},cJ=function(a){return bJ(a.left,a.top,a.width,a.height)},dJ={inflate:$I,relativePosition:YI,findBestRelativePosition:ZI,
intersect:_I,clamp:aJ,create:bJ,fromClientRect:cJ},eJ={},fJ={add:function(a,b){eJ[a.toLowerCase()]=b},has:function(a){return!!eJ[a.toLowerCase()]},get:function(a){var b=a.toLowerCase(),c=eJ.hasOwnProperty(b)?eJ[b]:null;if(null===c)throw new Error("Could not find module for type: "+a);return c},create:function(a,b){var c;if("string"==typeof a?(b=b||{},b.type=a):(b=a,a=b.type),a=a.toLowerCase(),!(c=eJ[a]))throw new Error("Could not find control by type: "+a);return c=new c(b),c.type=a,c}},gJ=zd.each,hJ=zd.extend,iJ=function(){};iJ.extend=SI=function(a){var b,c,d,e=this,f=e.prototype,g=function(){var a,b,c,d=this;if(!TI&&(d.init&&d.init.apply(d,arguments),b=d.Mixins))for(a=b.length;a--;)c=b[a],c.init&&c.init.apply(d,arguments)},h=function(){return this};TI=!0,b=new e,TI=!1,a.Mixins&&(gJ(a.Mixins,function(b){for(var c in b)"init"!==c&&(a[c]=b[c])}),f.Mixins&&(a.Mixins=f.Mixins.concat(a.Mixins))),a.Methods&&gJ(a.Methods.split(","),function(b){a[b]=h}),a.Properties&&gJ(a.Properties.split(","),function(b){var c="_"+b;a[b]=function(a){var b=this;return void 0!==a?(b[c]=a,b):b[c]}}),a.Statics&&gJ(a.Statics,function(a,b){g[b]=a}),a.Defaults&&f.Defaults&&(a.Defaults=hJ({},f.Defaults,a.Defaults));for(c in a)d=a[c],"function"==typeof d&&f[c]?b[c]=function(a,b){return function(){var c,d=this,e=d._super;return d._super=f[a],c=b.apply(d,arguments),d._super=e,c}}(c,d):b[c]=d;return g.prototype=b,g.constructor=g,g.extend=SI,g};var jJ=Math.min,kJ=Math.max,lJ=Math.round,mJ=function(a){var b={},c=0,d=0,e=0,f=function(a,b,c){var d,e,f,g,h,i;return d=0,e=0,f=0,a/=255,b/=255,c/=255,h=jJ(a,jJ(b,c)),i=kJ(a,kJ(b,c)),h===i?(f=h,{h:0,s:0,v:100*f}):(g=a===h?b-c:c===h?a-b:c-a,d=a===h?3:c===h?1:5,d=60*(d-g/(i-h)),e=(i-h)/i,f=i,{h:lJ(d),s:lJ(100*e),v:lJ(100*f)})},g=function(a,b,f){var g,h,i,j;if(a=(parseInt(a,10)||0)%360,b=parseInt(b,10)/100,f=parseInt(f,10)/100,b=kJ(0,jJ(b,1)),f=kJ(0,jJ(f,1)),0===b)return void(c=d=e=lJ(255*f));switch(g=a/60,h=f*b,i=h*(1-Math.abs(g%2-1)),j=f-h,Math.floor(g)){case 0:c=h,d=i,e=0;break;case 1:c=i,d=h,e=0;break;case 2:c=0,d=h,e=i;break;case 3:c=0,d=i,e=h;break;case 4:c=i,d=0,e=h;break;case 5:c=h,d=0,e=i;break;default:c=d=e=0}c=lJ(255*(c+j)),d=lJ(255*(d+j)),e=lJ(255*(e+j))},h=function(){var a=function(a){return a=parseInt(a,10).toString(16),a.length>1?a:"0"+a};return"#"+a(c)+a(d)+a(e)},i=function(){return{r:c,g:d,b:e}},j=function(){return f(c,d,e)},k=function(a){var f;return"object"==typeof a?"r"in a?(c=a.r,d=a.g,e=a.b):"v"in a&&g(a.h,a.s,a.v):(f=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(a))?(c=parseInt(f[1],10),d=parseInt(f[2],10),e=parseInt(f[3],10)):(f=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(a))?(c=parseInt(f[1],16),d=parseInt(f[2],16),e=parseInt(f[3],16)):(f=/#([0-F])([0-F])([0-F])/gi.exec(a))&&(c=parseInt(f[1]+f[1],16),d=parseInt(f[2]+f[2],16),e=parseInt(f[3]+f[3],16)),c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,e=e<0?0:e>255?255:e,b};return a&&k(a),b.toRgb=i,b.toHsv=j,b.toHex=h,b.parse=k,b},nJ=function(a,b){var c,d,e,f;if(b=b||'"',null===a)return"null";if("string"===(e=typeof a))return d="\bb\tt\nn\ff\rr\"\"''\\\\",b+a.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,e){return'"'===b&&"'"===a?a:(c=d.indexOf(e))+1?"\\"+d.charAt(c+1):(a=e.charCodeAt().toString(16),"\\u"+"0000".substring(a.length)+a)})+b;if("object"===e){if(a.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(a)){for(c=0,d="[";c<a.length;c++)d+=(c>0?",":"")+nJ(a[c],b);return d+"]"}d="{";for(f in a)a.hasOwnProperty(f)&&(d+="function"!=typeof a[f]?(d.length>1?","+b:b)+f+b+":"+nJ(a[f],b):"");return d+"}"}return""+a},oJ={serialize:nJ,parse:function(a){try{return JSON.parse(a)}catch(a){}}},pJ={callbacks:{},count:0,send:function(a){var b=this,c=_i.DOM,d=void 0!==a.count?a.count:b.count,e="tinymce_jsonp_"+d;b.callbacks[d]=function(f){c.remove(e),delete b.callbacks[d],a.callback(f)},c.add(c.doc.body,"script",{id:e,src:a.url,type:"text/javascript"}),b.count++}},qJ={send:function(a){var b,c=0,d=function(){!a.async||4===b.readyState||c++>1e4?(a.success&&c<1e4&&200===b.status?a.success.call(a.success_scope,""+b.responseText,b,a):a.error&&a.error.call(a.error_scope,c>1e4?"TIMED_OUT":"GENERAL",b,a),b=null):setTimeout(d,10)};if(a.scope=a.scope||this,a.success_scope=a.success_scope||a.scope,a.error_scope=a.error_scope||a.scope,a.async=!1!==a.async,a.data=a.data||"",qJ.fire("beforeInitialize",{settings:a}),b=new I){if(b.overrideMimeType&&b.overrideMimeType(a.content_type),b.open(a.type||(a.data?"POST":"GET"),a.url,a.async),a.crossDomain&&(b.withCredentials=!0),a.content_type&&b.setRequestHeader("Content-Type",a.content_type),a.requestheaders&&zd.each(a.requestheaders,function(a){b.setRequestHeader(a.key,a.value)}),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b=qJ.fire("beforeSend",{xhr:b,settings:a}).xhr,b.send(a.data),!a.async)return d();setTimeout(d,10)}}};zd.extend(qJ,lw);var rJ=zd.extend,sJ=function(a){this.settings=rJ({},a),this.count=0};sJ.sendRPC=function(a){return(new sJ).send(a)},sJ.prototype={send:function(a){var b=a.error,c=a.success;a=rJ(this.settings,a),a.success=function(d,e){d=oJ.parse(d),void 0===d&&(d={error:"JSON Parse error."}),d.error?b.call(a.error_scope||a.scope,d.error,e):c.call(a.success_scope||a.scope,d.result)},a.error=function(c,d){b&&b.call(a.error_scope||a.scope,c,d)},a.data=oJ.serialize({id:a.id||"c"+this.count++,method:a.method,params:a.params}),a.content_type="application/json",qJ.send(a)}};var tJ=window.localStorage,uJ=RI,vJ={geom:{Rect:dJ},util:{Promise:Jb,Delay:Qb,Tools:zd,VK:Iz,URI:JH,Class:iJ,EventDispatcher:iw,Observable:lw,I18n:DI,XHR:qJ,JSON:oJ,JSONRequest:sJ,JSONP:pJ,LocalStorage:tJ,Color:mJ},dom:{EventUtils:_b,Sizzle:bd,DomQuery:Td,TreeWalker:s,DOMUtils:_i,ScriptLoader:ej,RangeUtils:UI,Serializer:Y,ControlSelection:HD,BookmarkManager:DD,Selection:PE,Event:_b.Event},html:{Styles:u,Entities:Hi,Node:lD,Schema:t,SaxParser:Tz,DomParser:W,Writer:y,Serializer:z},ui:{Factory:fJ},Env:Ib,AddOnManager:w,Formatter:V,UndoManager:T,EditorCommands:B,WindowManager:H,NotificationManager:F,EditorObservable:Xw,Shortcuts:D,Editor:gI,FocusManager:lI,EditorManager:RI,DOM:_i.DOM,ScriptLoader:ej.ScriptLoader,PluginManager:w.PluginManager,ThemeManager:w.ThemeManager,trim:zd.trim,isArray:zd.isArray,is:zd.is,toArray:zd.toArray,makeMap:zd.makeMap,each:zd.each,map:zd.map,grep:zd.grep,inArray:zd.inArray,extend:zd.extend,create:zd.create,walk:zd.walk,createNS:zd.createNS,resolve:zd.resolve,explode:zd.explode,_addCacheSuffix:zd._addCacheSuffix,isOpera:Ib.opera,isWebKit:Ib.webkit,isIE:Ib.ie,isGecko:Ib.gecko,isMac:Ib.mac};uJ=zd.extend(uJ,vJ);var wJ=uJ;!function(a){window.tinymce=a,window.tinyMCE=a}(wJ),function(a){if("object"==typeof module)try{module.exports=a}catch(a){}}(wJ)}()}(),function(){return this.tinyMCE.DOM.events.domLoaded=!0,this.tinyMCE}.apply(this,arguments)||window.tinyMCE}.apply(a,arguments)})}(this),define("text!mockup-patterns-tinymce-url/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result pattern-relateditems-type-<%= portal_type %> <% if (selected) { %>pattern-active<% } %>">\n  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">\n    <% if (!folderish) { %>\n    <span class="pattern-relateditems-result-image">\n      <img src="<%= generateImageUrl(_item, \'thumb\') %>" />\n    </span>\n    <% } %>\n    <span class="pattern-relateditems-result-title"><%= Title %></span>\n    <span class="pattern-relateditems-result-path"><%= path %></span>\n  </a>\n  <span class="pattern-relateditems-buttons">\n    <% if (folderish) { %>\n      <a class="pattern-relateditems-result-browse" href="#" data-path="<%= path %>"></a>\n    <% } %>\n  </span>\n</div>\n'}),define("text!mockup-patterns-tinymce-url/templates/selection.xml",[],function(){return'<span class="pattern-relateditems-item pattern-relateditems-type-<%= portal_type %>">\n <span class="pattern-relateditems-result-image">\n   <img src="<%= generateImageUrl(_item, \'thumb\') %>" />\n </span>\n <span class="pattern-relateditems-item-title"><%= Title %></span>\n <span class="pattern-relateditems-item-path"><%= path %></span>\n</span>\'\n'}),define("text!mockup-patterns-tinymce-url/templates/link.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n      <fieldset class="linkType internal" data-linkType="internal">\n        <legend id="tinylink-internal">Internal</legend>\n        <div>\n          <div class="form-group main">\n            \x3c!-- this gives the name to the "linkType" --\x3e\n            <input type="text" name="internal" />\n          </div>\n          <div class="form-group urltype">\n            <label for="external">URL Type</label>\n            <select type="text" class="form-control url-type" name="urlType">\n              <option value="/view" selected="true">View</option>\n              <option value="_direct_">Download</option>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType external" data-linkType="external">\n        <legend id="tinylink-external">External</legend>\n        <div class="form-group main">\n          <label for="external"><%- externalText %></label>\n          <input type="text" class="form-control" name="external" />\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType email" data-linkType="email">\n        <legend id="tinylink-email">Email</legend>\n        <div class="form-inline">\n          <div class="form-group main">\n            <label><%- emailText %></label>\n            <input type="text" class="form-control" name="email" />\n          </div>\n          <div class="form-group">\n            <label><%- subjectText %></label>\n            <input type="text" class="form-control" name="subject" />\n          </div>\n        </div>\n      </fieldset>\n\n      <fieldset class="linkType anchor" data-linkType="anchor">\n        <legend id="tinylink-anchor">Anchor</legend>\n        <div>\n          <div class="form-group main">\n            <label>Select an anchor</label>\n            <div class="input-wrapper">\n              <select name="anchor" class="pat-select2" style="width:500px" />\n            </div>\n          </div>\n        </div>\n      </fieldset>\n\n      <% if(linkTypes.indexOf(\'modallink\') !== -1){ %>\n      <fieldset class="linkType modallink" data-linkType="modallink">\n        <legend id="tinylink-modal">Modal</legend>\n        <div>\n          <div class="form-group main">\n            <label>Select content for modal</label>\n            \x3c!-- reuse internal value here! --\x3e\n            <input type="text" name="internal" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls">\n      <div class="form-group">\n        <label>Target</label>\n        <select name="target" class="form-control">\n          <% _.each(targetList, function(target){ %>\n            <option value="<%- target.value %>"><%- target.text %></option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="form-group">\n        <label><%- titleText %></label>\n        <input type="text" name="title" />\n      </div>\n    </div>\n\n    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="plone-btn plone-btn-primary context" name="insert" value="<%- insertBtn %>" />\n  </div>\n</div>\n'}),define("text!mockup-patterns-tinymce-url/templates/image.xml",[],function(){return'<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n        <% if(_.contains(linkTypes, \'image\')){ %>\n      <fieldset class="linkType image" data-linkType="image">\n        <legend id="tinylink-image">Internal Image</legend>\n        <div class="form">\n          <div class="form-group main">\n            <input type="text" name="image" />\n          </div>\n          <div class="form-group scale">\n            <label><%- scaleText %></label>\n            <select name="scale">\n              <option value="">Original</option>\n                <% _.each(scales, function(scale){ %>\n                  <option value="<%- scale.part %>" <% if(scale.name === options.defaultScale){ %>selected<% } %> >\n                    <%- scale.label %>\n                  </option>\n                <% }); %>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n        <% } %>\n\n      <% if(_.contains(linkTypes, \'externalImage\')){ %>\n      <fieldset class="linkType externalImage" data-linkType="externalImage">\n        <legend id="tinylink-externalImage">External Image</legend>\n        <div>\n          <div class="form-group main">\n            <label><%- externalImageText %></label>\n            <input type="text" name="externalImage" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls">\n      <div class="form-group text">\n        <label>Summary</label>\n        <input type="text" name="alt" />\n      </div>\n      <div class="form-group align">\n        <label><%- imageAlignText %></label>\n        <select name="align">\n          <% _.each([\'inline\', \'right\', \'left\'], function(align){ %>\n              <option value="<%- align %>">\n              <%- align.charAt(0).toUpperCase() + align.slice(1) %>\n              </option>\n          <% }); %>\n        <select>\n      </div>\n    </div>\n\n    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="plone-btn plone-btn-primary context" name="insert" value="<%- insertBtn %>" />\n\n  </div>\n</div>\n'}),define("mockup-patterns-tinymce-url/js/links",["jquery","underscore","pat-registry","pat-base","tinymce","text!mockup-patterns-tinymce-url/templates/link.xml","text!mockup-patterns-tinymce-url/templates/image.xml","mockup-patterns-relateditems","castle-url/components/utils","mockup-utils","mockup-patterns-autotoc","mockup-patterns-modal"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=d.extend({defaults:{linkModal:null},init:function(){this.linkModal=this.options.linkModal,this.tinypattern=this.options.tinypattern,this.tiny=this.tinypattern.tiny,this.dom=this.tiny.dom},getEl:function(){return this.$el.find("input").first()},value:function(){return a.trim(this.getEl().val())},toUrl:function(){return this.value()},load:function(a){this.getEl().attr("value",this.tiny.dom.getAttrib(a,"data-val"))},set:function(a){var b=this.getEl();b.attr("value",a),b.val(a)},attributes:function(){return{"data-val":this.value()}}}),l=k.extend({init:function(){k.prototype.init.call(this),this.getEl().on("change",function(){var b=a(this).val();if(!new RegExp("https?://").test(b)){-1!==a(this).val().split("/")[0].indexOf(".")&&a(this).val("http://"+b)}})}}),m=k.extend({init:function(){k.prototype.init.call(this),this.getEl().addClass("pat-relateditems"),this.createRelatedItems()},getEl:function(){return this.$el.find("input:not(.select2-input)").first()},createRelatedItems:function(){this.relatedItems=new h(this.getEl().first(),this.linkModal.options.relatedItems)},value:function(){var a=this.getEl().val();return a&&("object"==typeof a?a=a[0]:"string"==typeof a&&(a={UID:a})),a},toUrl:function(){var a=this.value();return a?this.tinypattern.generateUrl(a):null},load:function(a){var b=this.tiny.dom.getAttrib(a,"data-val");b&&this.set(b)},set:function(a){var b=this.getEl().first();b[0].component.setState({selected:[a]}),b[0].component.selectionUpdated()},attributes:function(){var a=this.value();return a?{"data-val":a.UID}:{}}}),n=m.extend({toUrl:function(){var a=this.value();return this.tinypattern.generateImageUrl(a,this.linkModal.$scale.val())},createRelatedItems:function(){this.relatedItems=new h(this.getEl().first(),i.extend(this.linkModal.options.relatedItems,{initialPath:"/image-repository"}))}}),o=k.extend({toUrl:function(){var a=this,b=a.value();if(b){var c=a.getSubject(),d="mailto:"+b;return c&&(d+="?subject="+c),d}return null},load:function(a){k.prototype.load.apply(this,[a]),this.linkModal.$subject.val(this.tiny.dom.getAttrib(a,"data-subject"))},getSubject:function(){return this.linkModal.$subject.val()},attributes:function(){var a=k.prototype.attributes.call(this);return a["data-subject"]=this.getSubject(),a}}),p=k.extend({init:function(){k.prototype.init.call(this),this.$select=this.$el.find("select"),this.anchorNodes=[],this.anchorData=[],this.populate()},value:function(){var a=this.$select.val();if(a)return this.findData(a)},updated:function(){this.populate()},populate:function(){var c=this;c.anchorNodes=[],c.anchorData=[],c.addAnchors(a("a.mceItemAnchor,img.mceItemAnchor,a.mce-item-anchor,img.mce-item-anchor,a[id]:not([href])"));var d=c.linkModal.linkTypes.internal.value();d&&d.UID?(d=d.UID&&d.UID||d,a.ajax({url:a("body").attr("data-portal-url")+"/resolveuid/"+d+"/view"}).done(function(e){var f=a(j.parseBodyTag(e)),g=b.find(a.parseHTML(e),function(a){return"TITLE"===a.tagName});g=g?g.innerHTML:void 0,c.addAnchors(a("a[id]:not([href])",f),g+": ",d);var h=c.$select.attr("data-selected");c.createSelect2(h)}).fail(function(){c.createSelect2()})):c.createSelect2()},addAnchors:function(a,b,c){var d,e,f,g,h=this;for(b||(b=""),e=0;e<a.length;e+=1)d=a[e],g=h.tiny.dom.getAttrib(d,"id"),f=h.tiny.dom.getAttrib(d,"name"),f||(f=g),g||(g=f),""!==g&&(h.anchorNodes.push(d),h.anchorData.push({name:f,label:b+f,id:g,uid:c}))},createSelect2:function(b){var c=this;c.$select.select2("destroy"),c.$select.empty();var d;if(c.anchorNodes.length>0)for(d=0;d<c.anchorData.length;d+=1){var e=c.anchorData[d],f=c.getAnchorId(e),g=a("<option value='"+f+"'>"+e.label+"</option>");b==f&&(g[0].selected=!0),c.$select.append(g)}else c.$select.append("<option>No anchors found..</option>");this.$select.select2()},getAnchorId:function(a){var b=a.id;return a.uid&&(b+=a.uid),b},findData:function(a){for(var b=this,c=0;c<b.anchorData.length;c++)if(a===b.getAnchorId(b.anchorData[c]))return b.anchorData[c]},toUrl:function(){var a=this.value();return a?a.uid?this.linkModal.linkTypes.internal.toUrl()+"#"+a.id:"#"+a.id:null},attributes:function(){var a=this.value();return{"data-val":a.uid,"data-id":this.getAnchorId(a)}},load:function(b){var c=a(b),d=c.attr("data-val"),e=c.attr("data-id");this.$select.attr("data-selected",e);var f=this.findData(e);f&&this.set(f),d&&this.linkModal.linkTypes.internal.load(c)},set:function(a){var b=this.getAnchorId(a);this.$select.select2("data",b)}});return e.PluginManager.add("ploneimage",function(a){a.addButton("ploneimage",{icon:"image",tooltip:"Insert/edit image",onclick:a.settings.addImageClicked,stateSelector:"img:not([data-mce-object])"}),a.addMenuItem("ploneimage",{icon:"image",text:"Insert image",onclick:a.settings.addImageClicked,context:"insert",prependToContext:!0})}),e.PluginManager.add("plonelink",function(a){a.addButton("plonelink",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:a.settings.addLinkClicked,stateSelector:"a[href]"}),a.addButton("unlink",{icon:"unlink",tooltip:"Remove link(s)",cmd:"unlink",stateSelector:"a[href]"}),a.addShortcut("Ctrl+K","",a.settings.addLinkClicked),a.addMenuItem("plonelink",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:a.settings.addLinkClicked,stateSelector:"a[href]",context:"insert",prependToContext:!0})}),d.extend({name:"linkmodal",trigger:".pat-linkmodal",defaults:{anchorSelector:"h1,h2,h3",linkTypes:[],initialLinkType:"internal",text:{insertHeading:"Insert Link"},linkTypeClassMapping:{internal:m,modallink:m,external:l,email:o,anchor:p,image:n,externalImage:k}},linkTypeTemplateMapping:{internal:f,modallink:f,external:f,email:f,anchor:f,image:g,externalImage:g},template:function(a){return b.template(this.linkTypeTemplateMapping[this.linkType])(a)},init:function(){var b=this;b.$selectedTile=a(".mosaic-selected-tile"),b.tinypattern=b.options.tinypattern,b.tinypattern.options.anchorSelector&&(b.options.anchorSelector=b.tinypattern.options.anchorSelector),b.tiny=b.tinypattern.tiny,b.dom=b.tiny.dom,b.linkType=b.options.initialLinkType,b.urlType="/view",b.linkTypes={},b.modal=c.patterns["plone-modal"].init(b.$el,{html:b.generateModalHtml(),content:null,buttons:".plone-btn"}),b.modal.on("shown",function(a){b.modalShown.apply(b,[a])}),b.modal.on("hide",function(a){if(b.$selectedTile.length>0){new(require("mosaic-url/mosaic.tile"))(b.$selectedTile).select()}b.tiny.selection.setRng(b.rng)})},isOnlyTextSelected:function(){var a=this.tiny.selection.getContent();if(/</.test(a)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(a)||-1===a.indexOf("href=")))return!1;if(this.anchorElm){var b=this.anchorElm.childNodes;if(0===b.length)return!1;for(var c=b.length-1;c>=0;c--)if(3!==b[c].nodeType)return!1}return!0},generateModalHtml:function(){return this.template({options:this.options,text:this.options.text,insertHeading:this.options.text.insertHeading,linkTypes:this.options.linkTypes,externalText:this.options.text.external,emailText:this.options.text.email,subjectText:this.options.text.subject,targetList:this.options.targetList,titleText:this.options.text.title,externalImageText:this.options.text.externalImage,altText:this.options.text.alt,imageAlignText:this.options.text.imageAlign,scaleText:this.options.text.scale,scales:this.options.scales,cancelBtn:this.options.text.cancelBtn,insertBtn:this.options.text.insertBtn})},isImageMode:function(){return-1!==["image","externalImage"].indexOf(this.linkType)},emitLinkLoaded:function(){var a=this;b.each(a.options.linkTypes,function(b){a.linkTypes[b].updated&&a.linkTypes[b].updated()})},initElements:function(){var c=this;c.$selectedTile=a(".mosaic-selected-tile"),c.$target=a('select[name="target"]',c.modal.$modal),c.$button=a('.plone-modal-footer input[name="insert"]',c.modal.$modal),c.$title=a('input[name="title"]',c.modal.$modal),c.$subject=a('input[name="subject"]',c.modal.$modal),c.$urlTypeContainer=a(".urltype",c.modal.$modal),c.$urlType=a('select[name="urlType"]',c.$urlTypeContainer),c.$urlTypeContainer.hide(),c.$alt=a('input[name="alt"]',c.modal.$modal),c.$align=a('select[name="align"]',c.modal.$modal),c.$scale=a('select[name="scale"]',c.modal.$modal),b.each(c.options.linkTypes,function(b){var d=a(".linkType."+b+" .main",c.modal.$modal);if(c.linkTypes[b]=new c.options.linkTypeClassMapping[b](d,{linkModal:c,tinypattern:c.tinypattern}),"internal"===b||"modallink"===b){var e=c.linkTypes[b].relatedItems;e.$el.on("loaded",function(){var a=e.component.state.items[0];a&&-1!==["File","Video","Audio","Image"].indexOf(a.portal_type)?c.$urlTypeContainer.show():(c.$urlTypeContainer.hide(),c.urlType="_direct_",c.$urlType.val("_direct_")),c.emitLinkLoaded()})}}),a(".autotoc-nav a",c.modal.$modal).click(function(){var d=a("fieldset.linkType",c.modal.$modal).eq(a(this).index()),e=d[0].className.split(/\s+/);b.each(e,function(a){-1!==b.indexOf(c.options.linkTypes,a)&&(c.linkType=a)})}),c.data={},c.initialText=null;var d;c.rng=c.tiny.selection.getRng(),c.selectedElm=c.tiny.selection.getNode(),c.anchorElm=c.tiny.dom.getParent(c.selectedElm,"a[href]"),c.onlyText=c.isOnlyTextSelected(),c.data.text=c.initialText=c.anchorElm?c.anchorElm.innerText||c.anchorElm.textContent:c.tiny.selection.getContent({format:"text"}),c.data.href=c.anchorElm?c.tiny.dom.getAttrib(c.anchorElm,"href"):"",c.anchorElm?c.data.target=c.tiny.dom.getAttrib(c.anchorElm,"target"):c.tiny.settings.default_link_target&&(c.data.target=c.tiny.settings.default_link_target),(d=c.tiny.dom.getAttrib(c.anchorElm,"rel"))&&(c.data.rel=d),(d=c.tiny.dom.getAttrib(c.anchorElm,"class"))&&(c.data.class=d),(d=c.tiny.dom.getAttrib(c.anchorElm,"title"))&&(c.data.title=d),a(".autotoc-nav a:first",c.modal.$modal).trigger("click")},getLinkUrl:function(){return this.linkTypes[this.linkType].toUrl()},getValue:function(){return this.linkTypes[this.linkType].value()},updateAnchor:function(b){var c=this;c.urlType=c.$urlType.val()||"_direct_",c.tiny.focus(),c.tiny.selection.setRng(c.rng),"internal"!==c.linkType&&"modallink"!==c.linkType||"_direct_"===c.urlType||(b+=c.urlType);var d=c.$target.val(),e=c.$title.val(),f=a.extend(!0,c.data,{title:e||null,target:d||null,"data-linkType":c.linkType,"data-urltype":c.urlType,href:b},c.linkTypes[c.linkType].attributes());c.anchorElm?(c.onlyText&&f.text!==c.initialText&&("innerText"in c.anchorElm?c.anchorElm.innerText=c.data.text:c.anchorElm.textContent=c.data.text),c.tiny.dom.setAttribs(c.anchorElm,f),c.tiny.selection.select(c.anchorElm),c.tiny.undoManager.add()):c.onlyText?c.tiny.insertContent(c.tiny.dom.createHTML("a",f,c.tiny.dom.encode(c.data.text))):c.tiny.execCommand("mceInsertLink",!1,f)},focusElement:function(a){this.tiny.focus(),this.tiny.selection.select(a),this.tiny.nodeChanged()},updateImage:function(b){var c=this,d=c.$title.val();c.tiny.focus(),c.tiny.selection.setRng(c.rng);var e=a.extend(!0,{},{src:b,title:d||null,alt:c.$alt.val(),class:"image-"+c.$align.val(),"data-linkType":c.linkType,"data-scale":c.$scale.val()},c.linkTypes[c.linkType].attributes());c.imgElm&&!c.imgElm.getAttribute("data-mce-object")?(e.width=c.dom.getAttrib(c.imgElm,"width"),e.height=c.dom.getAttrib(c.imgElm,"height")):c.imgElm=null,c.imgElm?c.dom.setAttribs(c.imgElm,e):(e.id="__mcenew",c.tiny.insertContent(c.dom.createHTML("img",e)),c.imgElm=c.dom.get("__mcenew"),c.dom.setAttrib(c.imgElm,"id",null)),function(a){a.onload=a.onerror=function(){a.onload=a.onerror=null,c.focusElement(a)}}(c.imgElm),c.imgElm.complete&&c.focusElement(c.imgElm)},modalShown:function(b){var c=this;c.initElements(),c.initData(),c.$button.off("click").on("click",function(a){c.hide(),a.preventDefault(),a.stopPropagation(),c.linkType=c.modal.$modal.find("fieldset.active").data("linktype");var b;try{b=c.getLinkUrl()}catch(a){return}b&&(c.isImageMode()?c.updateImage(b):c.updateAnchor(b))}),a('.plone-modal-footer input[name="cancel"]',c.modal.$modal).click(function(a){a.preventDefault(),c.hide()})},show:function(){this.modal.show()},hide:function(){this.modal.hide()},initData:function(){var b=this;b.selection=b.tiny.selection,b.tiny.focus();var c=b.imgElm=b.selection.getNode();b.anchorElm=b.dom.getParent(c,"a[href]");var d;if(b.isImageMode()){if("IMG"!==b.imgElm.nodeName&&b.anchorElm){var e=b.anchorElm.getElementsByTagName("img");e.length>0&&(b.imgElm=e[0],b.focusElement(b.imgElm))}if("IMG"!==b.imgElm.nodeName&&(b.imgElm=null),b.imgElm){var f=b.dom.getAttrib(b.imgElm,"src");if(b.$title.val(b.dom.getAttrib(b.imgElm,"title")),b.$alt.val(b.dom.getAttrib(b.imgElm,"alt")),d=b.dom.getAttrib(b.imgElm,"data-linktype")){b.linkType=d,b.linkTypes[b.linkType].load(b.imgElm);var g=b.dom.getAttrib(b.imgElm,"data-scale");g&&b.$scale.val(g),a("#tinylink-"+b.linkType,b.modal.$modal).trigger("click")}else f&&b.guessImageLink(f);for(var h=b.dom.getAttrib(b.imgElm,"class"),i=h.split(" "),j=0;j<i.length;j+=1){var k=i[j];-1!==k.indexOf("image-")&&b.$align.val(k.replace("image-",""))}}}else if(b.anchorElm){b.focusElement(b.anchorElm);var l="";l=b.dom.getAttrib(b.anchorElm,"href"),b.$target.val(b.dom.getAttrib(b.anchorElm,"target")),b.$title.val(b.dom.getAttrib(b.anchorElm,"title")),d=b.dom.getAttrib(b.anchorElm,"data-linktype"),d?(b.linkType=d,b.linkTypes[b.linkType].load(b.anchorElm),a("#tinylink-"+b.linkType,b.modal.$modal).trigger("click")):l&&b.guessAnchorLink(l);var m=b.dom.getAttrib(b.anchorElm,"data-urltype");m&&(b.urlType=m,b.$urlType.val(m))}},guessImageLink:function(a){-1!==a.indexOf(this.options.prependToScalePart)?(this.linkType="image",this.$scale.val(this.tinypattern.getScaleFromUrl(a)),this.linkTypes.image.set(this.tinypattern.stripGeneratedUrl(a))):(this.linkType="externalImage",this.linkTypes.externalImage.set(a))},guessAnchorLink:function(a){if(this.options.prependToUrl&&-1!==a.indexOf(this.options.prependToUrl))this.linkType="internal",this.linkTypes.internal.set(this.tinypattern.stripGeneratedUrl(a));else if(-1!==a.indexOf("mailto:")){this.linkType="email";var b=a.substring("mailto:".length,a.length),c=b.split("?subject=");this.linkTypes.email.set(c[0]),c.length>1&&this.$subject.val(decodeURIComponent(c[1]))}else"#"===a[0]?(this.linkType="anchor",this.linkTypes.anchor.set(a.substring(1))):(this.linkType="external",this.linkTypes.external.set(a))},setSelectElement:function(a,b){a.find("option:selected").prop("selected",!1),b&&a.find('option[value="'+b+'"]').prop("selected",!0)},reinitialize:function(){this.modal.options.html=this.generateModalHtml()}})}),function(a){define("tinymce-modern-theme",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(a,b,c){var d,e,f,g,h,i,j,k,l,m;return l=vc(),e=rc.getPos(b,Qa.getUiContainer(a)),f=e.x,g=e.y,tc(a)&&sc(document.body)&&(f-=l.x,g-=l.y),d=a.getEl(),m=rc.getSize(d),h=m.width,i=m.height,m=rc.getSize(b),j=m.width,k=m.height,c=(c||"").split(""),"b"===c[0]&&(g+=k),"r"===c[1]&&(f+=j),"c"===c[0]&&(g+=Math.round(k/2)),"c"===c[1]&&(f+=Math.round(j/2)),"b"===c[3]&&(g-=i),"r"===c[4]&&(f-=h),"c"===c[3]&&(g-=Math.round(i/2)),"c"===c[4]&&(f-=Math.round(h/2)),{x:f,y:g,w:h,h:i}}function b(){}function c(a){this.cls=[],this.cls._map={},this.onchange=a||b,this.prefix=""}function d(a){for(var b,c=[],d=a.length;d--;)b=a[d],b.__checked||(c.push(b),b.__checked=1);for(d=c.length;d--;)delete c[d].__checked;return c}function e(a){return a.nodeType>0}function f(a,b){var c,d;if(a===b)return!0;if(null===a||null===b)return a===b;if("object"!=typeof a||"object"!=typeof b)return a===b;if(M.isArray(b)){if(a.length!==b.length)return!1;for(c=a.length;c--;)if(!f(a[c],b[c]))return!1}if(e(a)||e(b))return a===b;d={};for(c in b){if(!f(a[c],b[c]))return!1;d[c]=!0}for(c in a)if(!d[c]&&!f(a[c],b[c]))return!1;return!0}function g(a){return a._eventDispatcher||(a._eventDispatcher=new zc({scope:a,toggleEvent:function(b,c){c&&zc.isNative(b)&&(a._nativeEvents||(a._nativeEvents={}),a._nativeEvents[b]=!0,a.state.get("rendered")&&h(a))}})),a._eventDispatcher}function h(a){function b(b){var c=a.getParentCtrl(b.target);c&&c.fire(b.type,b)}function c(){var a=i._lastHoverCtrl;a&&(a.fire("mouseleave",{target:a.getEl()}),a.parents().each(function(a){a.fire("mouseleave",{target:a.getEl()})}),i._lastHoverCtrl=null)}function d(b){var c,d,e,f=a.getParentCtrl(b.target),g=i._lastHoverCtrl,h=0;if(f!==g){if(i._lastHoverCtrl=f,d=f.parents().toArray().reverse(),d.push(f),g){for(e=g.parents().toArray().reverse(),e.push(g),h=0;h<e.length&&d[h]===e[h];h++);for(c=e.length-1;c>=h;c--)g=e[c],g.fire("mouseleave",{target:g.getEl()})}for(c=h;c<d.length;c++)f=d[c],f.fire("mouseenter",{target:f.getEl()})}}function e(b){b.preventDefault(),"mousewheel"===b.type?(b.deltaY=-.025*b.wheelDelta,b.wheelDeltaX&&(b.deltaX=-.025*b.wheelDeltaX)):(b.deltaX=0,b.deltaY=b.detail),b=a.fire("wheel",b)}var f,g,h,i,j,k;if(j=a._nativeEvents){for(h=a.parents().toArray(),h.unshift(a),f=0,g=h.length;!i&&f<g;f++)i=h[f]._eventsRoot;for(i||(i=h[h.length-1]||a),a._eventsRoot=i,g=f,f=0;f<g;f++)h[f]._eventsRoot=i;var l=i._delegates;l||(l=i._delegates={});for(k in j){if(!j)return!1;"wheel"!==k||Tc?("mouseenter"===k||"mouseleave"===k?i._hasMouseEnter||(pc(i.getEl()).on("mouseleave",c).on("mouseover",d),i._hasMouseEnter=1):l[k]||(pc(i.getEl()).on(k,b),l[k]=!0),j[k]=!1):Sc?pc(a.getEl()).on("mousewheel",e):pc(a.getEl()).on("DOMMouseScroll",e)}}}function i(a){function b(a){return a&&1===a.nodeType}function c(a){return a=a||t,b(a)?a.getAttribute("role"):null}function d(a){for(var b,d=a||t;d=d.parentNode;)if(b=c(d))return b}function e(a){var c=t;if(b(c))return c.getAttribute("aria-"+a)}function f(a){var b=a.tagName.toUpperCase();return"INPUT"===b||"TEXTAREA"===b||"SELECT"===b}function g(a){return!(!f(a)||a.hidden)||(!!_c(a)||!!/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell|slider)$/.test(c(a)))}
function h(a){function b(a){if(1===a.nodeType&&"none"!==a.style.display&&!a.disabled){g(a)&&c.push(a);for(var d=0;d<a.childNodes.length;d++)b(a.childNodes[d])}}var c=[];return b(a||v.getEl()),c}function i(a){var b,c;a=a||u,c=a.parents().toArray(),c.unshift(a);for(var d=0;d<c.length&&(b=c[d],!b.settings.ariaRoot);d++);return b}function j(a){var b=i(a),c=h(b.getEl());b.settings.ariaRemember&&"lastAriaIndex"in b?k(b.lastAriaIndex,c):k(0,c)}function k(a,b){return a<0?a=b.length-1:a>=b.length&&(a=0),b[a]&&b[a].focus(),a}function l(a,b){var c=-1,d=i();b=b||h(d.getEl());for(var e=0;e<b.length;e++)b[e]===t&&(c=e);c+=a,d.lastAriaIndex=k(c,b)}function m(){"tablist"===d()?l(-1,h(t.parentNode)):u.parent().submenu?r():l(-1)}function n(){var a=c(),b=d();"tablist"===b?l(1,h(t.parentNode)):"menuitem"===a&&"menu"===b&&e("haspopup")?s():l(1)}function o(){l(-1)}function p(){var a=c(),b=d();"menuitem"===a&&"menubar"===b?s():"button"===a&&e("haspopup")?s({key:"down"}):l(1)}function q(a){if("tablist"===d()){var b=h(u.getEl("body"))[0];b&&b.focus()}else l(a.shiftKey?-1:1)}function r(){u.fire("cancel")}function s(a){a=a||{},u.fire("click",{target:t,aria:a})}var t,u,v=a.root;try{t=document.activeElement}catch(a){t=document.body}return u=v.getParentCtrl(t),v.on("keydown",function(a){function b(a,b){f(t)||_c(t)||"slider"!==c(t)&&!1!==b(a)&&a.preventDefault()}if(!a.isDefaultPrevented())switch(a.keyCode){case 37:b(a,m);break;case 39:b(a,n);break;case 38:b(a,o);break;case 40:b(a,p);break;case 27:r();break;case 14:case 13:case 32:b(a,s);break;case 9:q(a),a.preventDefault()}}),v.on("focusin",function(a){t=a.target,u=a.control}),{focusFirst:j}}function j(a){var b,c,d,e,f,g,h,i,j=Math.max;return b=a.documentElement,c=a.body,d=j(b.scrollWidth,c.scrollWidth),e=j(b.clientWidth,c.clientWidth),f=j(b.offsetWidth,c.offsetWidth),g=j(b.scrollHeight,c.scrollHeight),h=j(b.clientHeight,c.clientHeight),i=j(b.offsetHeight,c.offsetHeight),{width:d<f?e:d,height:g<i?h:g}}function k(a){var b,c;if(a.changedTouches)for(b="screenX screenY pageX pageY clientX clientY".split(" "),c=0;c<b.length;c++)a[b[c]]=a.changedTouches[0][b[c]]}function l(a,b){var c,d,e,f,g,h,i,l=b.document||document;b=b||{};var m=l.getElementById(b.handle||a);e=function(a){var e,n,o=j(l);k(a),a.preventDefault(),d=a.button,e=m,h=a.screenX,i=a.screenY,n=window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue("cursor"):e.runtimeStyle.cursor,c=pc("<div></div>").css({position:"absolute",top:0,left:0,width:o.width,height:o.height,zIndex:2147483647,opacity:1e-4,cursor:n}).appendTo(l.body),pc(l).on("mousemove touchmove",g).on("mouseup touchend",f),b.start(a)},g=function(a){if(k(a),a.button!==d)return f(a);a.deltaX=a.screenX-h,a.deltaY=a.screenY-i,a.preventDefault(),b.drag(a)},f=function(a){k(a),pc(l).off("mousemove touchmove",g).off("mouseup touchend",f),c.remove(),b.stop&&b.stop(a)},this.destroy=function(){pc(m).off()},pc(m).on("mousedown touchstart",e)}function m(a,b){for(;a;){if(a===b)return!0;a=a.parent()}}function n(a){for(var b=fd.length;b--;){var c=fd[b],d=c.getParentCtrl(a.target);if(c.settings.autohide){if(d&&(m(d,c)||c.parent()===d))continue;a=c.fire("autohide",{target:a.target}),a.isDefaultPrevented()||c.hide()}}}function o(){Wc||(Wc=function(a){2!==a.button&&n(a)},pc(document).on("click touchstart",Wc))}function p(){Xc||(Xc=function(){var a;for(a=fd.length;a--;)r(fd[a])},pc(window).on("scroll",Xc))}function q(){if(!Yc){var a=document.documentElement,b=a.clientWidth,c=a.clientHeight;Yc=function(){document.all&&b===a.clientWidth&&c===a.clientHeight||(b=a.clientWidth,c=a.clientHeight,hd.hideAll())},pc(window).on("resize",Yc)}}function r(a){function b(b,c){for(var d,e=0;e<fd.length;e++)if(fd[e]!==a)for(d=fd[e].parent();d&&(d=d.parent());)d===a&&fd[e].fixed(b).moveBy(0,c).repaint()}var c=rc.getViewPort().y;a.settings.autofix&&(a.state.get("fixed")?a._autoFixY>c&&(a.fixed(!1).layoutRect({y:a._autoFixY}).repaint(),b(!1,a._autoFixY-c)):(a._autoFixY=a.layoutRect().y,a._autoFixY<c&&(a.fixed(!0).layoutRect({y:0}).repaint(),b(!0,c-a._autoFixY))))}function s(a,b){var c,d,e=hd.zIndex||65535;if(a)gd.push(b);else for(c=gd.length;c--;)gd[c]===b&&gd.splice(c,1);if(gd.length)for(c=0;c<gd.length;c++)gd[c].modal&&(e++,d=gd[c]),gd[c].getEl().style.zIndex=e,gd[c].zIndex=e,e++;var f=pc("#"+b.classPrefix+"modal-block",b.getContainerElm())[0];d?pc(f).css("z-index",d.zIndex-1):f&&(f.parentNode.removeChild(f),Zc=!1),hd.currentZIndex=e}function t(a){var b;for(b=fd.length;b--;)fd[b]===a&&fd.splice(b,1);for(b=gd.length;b--;)gd[b]===a&&gd.splice(b,1)}function u(a,b){var c,d,e=this,f=$c.classPrefix;e.show=function(g,h){function i(){c&&(pc(a).append('<div class="'+f+"throbber"+(b?" "+f+"throbber-inline":"")+'"></div>'),h&&h())}return e.hide(),c=!0,g?d=qa.setTimeout(i,g):i(),e},e.hide=function(){var b=a.lastChild;return qa.clearTimeout(d),b&&-1!==b.className.indexOf("throbber")&&b.parentNode.removeChild(b),c=!1,e}}function v(a){var b=function(a){return a.inline?a.getElement():a.getContentAreaContainer()},c=function(){var c=b(a);return rc.getSize(c).width},d=function(a){Ib.each(a,function(a){a.moveTo(0,0)})},e=function(c){if(c.length>0){var d=c.slice(0,1)[0],e=b(a);d.moveRel(e,"tc-tc"),Ib.each(c,function(a,b){b>0&&a.moveRel(c[b-1].getEl(),"bc-tc")})}},f=function(a){d(a),e(a)};return{open:function(a,b){var d=M.extend(a,{maxWidth:c()}),e=new td(d);return e.args=d,d.timeout>0&&(e.timer=setTimeout(function(){e.close(),b()},d.timeout)),e.on("close",function(){b()}),e.renderTo(),e},close:function(a){a.close()},reposition:f,getArgs:function(a){return a.args}}}function w(a){var b,c=pc("meta[name=viewport]")[0];!1!==Yb.overrideViewPort&&(c||(c=document.createElement("meta"),c.setAttribute("name","viewport"),document.getElementsByTagName("head")[0].appendChild(c)),b=c.getAttribute("content"),b&&void 0!==vd&&(vd=b),c.setAttribute("content",a?"width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0":vd))}function x(a,b){y()&&!1===b&&pc([document.documentElement,document.body]).removeClass(a+"fullscreen")}function y(){for(var a=0;a<ud.length;a++)if(ud[a]._fullscreen)return!0;return!1}function z(a){return{open:function(a,b,c){var d;return a.title=a.title||" ",a.url=a.url||a.file,a.url&&(a.width=parseInt(a.width||320,10),a.height=parseInt(a.height||240,10)),a.body&&(a.items={defaults:a.defaults,type:a.bodyType||"form",items:a.body,data:a.data,callbacks:a.commands}),a.url||a.buttons||(a.buttons=[{text:"Ok",subtype:"primary",onclick:function(){d.find("form")[0].submit()}},{text:"Cancel",onclick:function(){d.close()}}]),d=new wd(a),d.on("close",function(){c(d)}),a.data&&d.on("postRender",function(){this.find("*").each(function(b){var c=b.name();c in a.data&&b.value(a.data[c])})}),d.features=a||{},d.params=b||{},d=d.renderTo(document.body).reflow()},alert:function(a,b,c){var d;return d=xd.alert(a,function(){b()}),d.on("close",function(){c(d)}),d},confirm:function(a,b,c){var d;return d=xd.confirm(a,function(a){b(a)}),d.on("close",function(){c(d)}),d},close:function(a){a.close()},getParams:function(a){return a.params},setParams:function(a,b){a.params=b}}}function A(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];if(a.length!==b.length)throw new Error('Wrong number of arguments to struct. Expected "['+a.length+']", got '+b.length+" arguments");var d={};return Ib.each(a,function(a,c){d[a]=Ea.constant(b[c])}),d}}function B(a,b){var c=a.concat(b);if(0===c.length)throw new Error("You must specify at least one required or optional field.");return He.validateStrArr("required",a),He.validateStrArr("optional",b),He.checkDupes(c),function(d){var e=Ae.keys(d);Ib.forall(a,function(a){return Ib.contains(e,a)})||He.reqMessage(a,e);var f=Ib.filter(e,function(a){return!Ib.contains(c,a)});f.length>0&&He.unsuppMessage(f);var g={};return Ib.each(a,function(a){g[a]=Ea.constant(d[a])}),Ib.each(b,function(a){g[a]=Ea.constant(Object.prototype.hasOwnProperty.call(d,a)?La.some(d[a]):La.none())}),g}}function C(a,b,c){var d=a.isiOS()&&!0===/ipad/i.test(c),e=a.isiOS()&&!d,f=a.isAndroid()&&3===a.version.major,g=a.isAndroid()&&4===a.version.major,h=d||f||g&&!0===/mobile/i.test(c),i=a.isiOS()||a.isAndroid(),j=i&&!h,k=b.isSafari()&&a.isiOS()&&!1===/safari/i.test(c);return{isiPad:Ea.constant(d),isiPhone:Ea.constant(e),isTablet:Ea.constant(h),isPhone:Ea.constant(j),isTouch:Ea.constant(i),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:Ea.constant(k)}}function D(a,b,c,d,e){return a(c,d)?La.some(c):cb.isFunction(e)&&e(c)?La.none():b(c,d,e)}function E(a,b){for(;a;){if(b===a)return!0;a=a.parentNode}return!1}function F(a){var b="";if(a)for(var c=0;c<a.length;c++)b+='<option value="'+a[c]+'">'+a[c]+"</option>";return b}function G(a,b,c){return a<b&&(a=b),a>c&&(a=c),a}function H(a,b,c){a.setAttribute("aria-"+b,c)}function I(a,b){var c,d,e,f,g,h;"v"===a.settings.orientation?(f="top",e="height",d="h"):(f="left",e="width",d="w"),h=a.getEl("handle"),c=(a.layoutRect()[d]||100)-rc.getSize(h)[e],g=c*((b-a._minValue)/(a._maxValue-a._minValue))+"px",h.style[f]=g,h.style.height=a.layoutRect().h+"px",H(h,"valuenow",b),H(h,"valuetext",""+a.settings.previewFilter(b)),H(h,"valuemin",a._minValue),H(h,"valuemax",a._maxValue)}function J(){}var K=tinymce.util.Tools.resolve("tinymce.ThemeManager"),L=tinymce.util.Tools.resolve("tinymce.EditorManager"),M=tinymce.util.Tools.resolve("tinymce.util.Tools"),N=function(a){return a.getParam("branding",!0,"boolean")},O=function(a){return!1!==P(a)},P=function(a){return a.getParam("menubar")},Q=function(a){return a.getParam("statusbar",!0,"boolean")},R=function(a){return a.getParam("toolbar_items_size")},S=function(a){return a.getParam("readonly",!1,"boolean")},T=function(a){return a.getParam("fixed_toolbar_container")},U=function(a){return a.getParam("inline_toolbar_position_handler")},V=function(a){return a.getParam("menu")},W=function(a){return a.getParam("removed_menuitems","")},X=function(a){return a.getParam("min_width",100,"number")},Y=function(a){return a.getParam("min_height",100,"number")},Z=function(a){return a.getParam("max_width",65535,"number")},$=function(a){return a.getParam("max_height",65535,"number")},_=function(a){return!1===a.settings.skin},aa=function(a){return a.getParam("inline",!1,"boolean")},ba=function(a){var b=a.getParam("resize","vertical");return!1===b?"none":"both"===b?"both":"vertical"},ca=function(a){var b=a.settings,c=b.skin,d=b.skin_url;if(!1!==c){var e=c||"lightgray";d=d?a.documentBaseURI.toAbsolute(d):L.baseURL+"/skins/"+e}return d},da=function(a,b){for(var c=[],d=1;d<10;d++){var e=a["toolbar"+d];if(!e)break;c.push(e)}var f=a.toolbar?[a.toolbar]:[b];return c.length>0?c:f},ea=function(a){var b=a.getParam("toolbar");return!1===b?[]:M.isArray(b)?M.grep(b,function(a){return a.length>0}):da(a.settings,"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image")},fa=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ga=tinymce.util.Tools.resolve("tinymce.ui.Factory"),ha=tinymce.util.Tools.resolve("tinymce.util.I18n"),ia=function(a){return a.fire("SkinLoaded")},ja=function(a){return a.fire("ResizeEditor")},ka=function(a){return a.fire("BeforeRenderUI")},la={fireSkinLoaded:ia,fireResizeEditor:ja,fireBeforeRenderUI:ka},ma=function(a,b){return function(){var c=a.find(b)[0];c&&c.focus(!0)}},na=function(a,b){a.shortcuts.add("Alt+F9","",ma(b,"menubar")),a.shortcuts.add("Alt+F10,F10","",ma(b,"toolbar")),a.shortcuts.add("Alt+F11","",ma(b,"elementpath")),b.on("cancel",function(){a.focus()})},oa={addKeys:na},pa=tinymce.util.Tools.resolve("tinymce.geom.Rect"),qa=tinymce.util.Tools.resolve("tinymce.util.Delay"),ra=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},sa=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},ta=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},ua=function(a){return function(){return a}},va=function(a){return a},wa=function(a,b){return a===b},xa=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},ya=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},za=function(a){return function(){throw new Error(a)}},Aa=function(a){return a()},Ba=function(a){a()},Ca=ua(!1),Da=ua(!0),Ea={noop:ra,noarg:sa,compose:ta,constant:ua,identity:va,tripleEquals:wa,curry:xa,not:ya,die:za,apply:Aa,call:Ba,never:Ca,always:Da},Fa=Ea.never,Ga=Ea.always,Ha=function(){return Ia},Ia=function(){var a=function(a){return a.isNone()},b=function(a){return a()},c=function(a){return a},d=function(){},e={fold:function(a,b){return a()},is:Fa,isSome:Fa,isNone:Ga,getOr:c,getOrThunk:b,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:c,orThunk:b,map:Ha,ap:Ha,each:d,bind:Ha,flatten:Ha,exists:Fa,forall:Ga,filter:Ha,equals:a,equals_:a,toArray:function(){return[]},toString:Ea.constant("none()")};return Object.freeze&&Object.freeze(e),e}(),Ja=function(a){var b=function(){return a},c=function(){return f},d=function(b){return Ja(b(a))},e=function(b){return b(a)},f={fold:function(b,c){return c(a)},is:function(b){return a===b},isSome:Ga,isNone:Fa,getOr:b,getOrThunk:b,getOrDie:b,or:c,orThunk:c,map:d,ap:function(b){return b.fold(Ha,function(b){return Ja(b(a))})},each:function(b){b(a)},bind:e,flatten:b,exists:e,forall:e,filter:function(b){return b(a)?f:Ia},equals:function(b){return b.is(a)},equals_:function(b,c){return b.fold(Fa,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return f},Ka=function(a){return null===a||void 0===a?Ia:Ja(a)},La={some:Ja,none:Ha,from:Ka},Ma=function(a){var b=Oa(a);if(b&&"static"!==fa.DOM.getStyle(b,"position",!0)){var c=fa.DOM.getPos(b),d=b.scrollLeft-c.x,e=b.scrollTop-c.y;return La.some({x:d,y:e})}return La.none()},Na=function(a,b){var c=fa.DOM.select(a.settings.ui_container)[0];b.getRoot().uiContainer=c},Oa=function(a){return a?a.getRoot().uiContainer:null},Pa=function(a,b){return b.uiContainer=Oa(a)},Qa={getUiContainerDelta:Ma,setUiContainer:Na,getUiContainer:Oa,inheritUiContainer:Pa},Ra=function(a,b,c){var d,e=[];if(b)return M.each(b.split(/[ ,]/),function(b){var f,g=function(){var c=a.selection;b.settings.stateSelector&&c.selectorChanged(b.settings.stateSelector,function(a){b.active(a)},!0),b.settings.disabledStateSelector&&c.selectorChanged(b.settings.disabledStateSelector,function(a){b.disabled(a)})};"|"===b?d=null:(d||(d={type:"buttongroup",items:[]},e.push(d)),a.buttons[b]&&(f=b,b=a.buttons[f],"function"==typeof b&&(b=b()),b.type=b.type||"button",b.size=c,b=ga.create(b),d.items.push(b),a.initialized?g():a.on("init",g)))}),{type:"toolbar",layout:"flow",items:e}},Sa=function(a,b){var c=[],d=function(d){d&&c.push(Ra(a,d,b))};if(M.each(ea(a),function(a){d(a)}),c.length)return{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:c}},Ta={createToolbar:Ra,createToolbars:Sa},Ua=fa.DOM,Va=function(a){return{left:a.x,top:a.y,width:a.w,height:a.h,right:a.x+a.w,bottom:a.y+a.h}},Wa=function(a){M.each(a.contextToolbars,function(a){a.panel&&a.panel.hide()})},Xa=function(a,b){a.moveTo(b.left,b.top)},Ya=function(a,b,c){b=b?b.substr(0,2):"",M.each({t:"down",b:"up"},function(d,e){a.classes.toggle("arrow-"+d,c(e,b.substr(0,1)))}),M.each({l:"left",r:"right"},function(d,e){a.classes.toggle("arrow-"+d,c(e,b.substr(1,1)))})},Za=function(a,b,c,d,e,f){return f=Va({x:b,y:c,w:f.w,h:f.h}),a&&(f=a({elementRect:Va(d),contentAreaRect:Va(e),panelRect:f})),f},$a=function(a){var b,c=function(){return a.contextToolbars||[]},d=function(b){var c,d,e;return c=Ua.getPos(a.getContentAreaContainer()),d=a.dom.getRect(b),e=a.dom.getRoot(),"BODY"===e.nodeName&&(d.x-=e.ownerDocument.documentElement.scrollLeft||e.scrollLeft,d.y-=e.ownerDocument.documentElement.scrollTop||e.scrollTop),d.x+=c.x,d.y+=c.y,d},e=function(b,c){var e,f,g,h,i,j,k,l,m=U(a);if(!a.removed){if(!b||!b.toolbar.panel)return void Wa(a);k=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"],i=b.toolbar.panel,c&&i.show(),g=d(b.element),f=Ua.getRect(i.getEl()),h=Ua.getRect(a.getContentAreaContainer()||a.getBody());var n=Qa.getUiContainerDelta(i).getOr({x:0,y:0});if(g.x+=n.x,g.y+=n.y,f.x+=n.x,f.y+=n.y,h.x+=n.x,h.y+=n.y,l=25,"inline"!==Ua.getStyle(b.element,"display",!0)){var o=b.element.getBoundingClientRect();g.w=o.width,g.h=o.height}a.inline||(h.w=a.getDoc().documentElement.offsetWidth),a.selection.controlSelection.isResizable(b.element)&&g.w<l&&(g=pa.inflate(g,0,8)),e=pa.findBestRelativePosition(f,g,h,k),g=pa.clamp(g,h),e?(j=pa.relativePosition(f,g,e),Xa(i,Za(m,j.x,j.y,g,h,f))):(h.h+=f.h,g=pa.intersect(h,g),g?(e=pa.findBestRelativePosition(f,g,h,["bc-tc","bl-tl","br-tr"]),e?(j=pa.relativePosition(f,g,e),Xa(i,Za(m,j.x,j.y,g,h,f))):Xa(i,Za(m,g.x,g.y,g,h,f))):i.hide()),Ya(i,e,function(a,b){return a===b})}},f=function(b){return function(){var c=function(){a.selection&&e(j(a.selection.getNode()),b)};qa.requestAnimationFrame(c)}},g=function(c){if(!b){var d=f(!0),e=Qa.getUiContainer(c);b=a.selection.getScrollContainer()||a.getWin(),Ua.bind(b,"scroll",d),Ua.bind(e,"scroll",d),a.on("remove",function(){Ua.unbind(b,"scroll",d),Ua.unbind(e,"scroll",d)})}},h=function(b){var c;if(b.toolbar.panel)return b.toolbar.panel.show(),void e(b);c=ga.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:Ta.createToolbar(a,b.toolbar.items),oncancel:function(){a.focus()}}),Qa.setUiContainer(a,c),g(c),b.toolbar.panel=c,c.renderTo().reflow(),e(b)},i=function(){M.each(c(),function(a){a.panel&&a.panel.hide()})},j=function(b){var d,e,f,g=c();for(f=a.$(b).parents().add(b),d=f.length-1;d>=0;d--)for(e=g.length-1;e>=0;e--)if(g[e].predicate(f[d]))return{toolbar:g[e],element:f[d]};return null};a.on("click keyup setContent ObjectResized",function(b){("setcontent"!==b.type||b.selection)&&qa.setEditorTimeout(a,function(){var b;b=j(a.selection.getNode()),b?(i(),h(b)):i()})}),a.on("blur hide contextmenu",i),a.on("ObjectResizeStart",function(){var b=j(a.selection.getNode());b&&b.toolbar.panel&&b.toolbar.panel.hide()}),a.on("ResizeEditor ResizeWindow",f(!0)),a.on("nodeChange",f(!1)),a.on("remove",function(){M.each(c(),function(a){a.panel&&a.panel.remove()}),a.contextToolbars={}}),a.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var b=j(a.selection.getNode());b&&b.toolbar.panel&&b.toolbar.panel.items()[0].focus()})},_a={addContextualToolbars:$a},ab=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&Array.prototype.isPrototypeOf(a)?"array":"object"===b&&String.prototype.isPrototypeOf(a)?"string":b},bb=function(a){return function(b){return ab(b)===a}},cb={isString:bb("string"),isObject:bb("object"),isArray:bb("array"),isNull:bb("null"),isBoolean:bb("boolean"),isUndefined:bb("undefined"),isFunction:bb("function"),isNumber:bb("number")},db=function(){var a=Array.prototype.indexOf,b=function(b,c){return a.call(b,c)},c=function(a,b){return tb(a,b)};return void 0===a?c:b}(),eb=function(a,b){var c=db(a,b);return-1===c?La.none():La.some(c)},fb=function(a,b){return db(a,b)>-1},gb=function(a,b){return sb(a,b).isSome()},hb=function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},ib=function(a,b){for(var c=[],d=0;d<a.length;d+=b){var e=a.slice(d,d+b);c.push(e)}return c},jb=function(a,b){for(var c=a.length,d=new Array(c),e=0;e<c;e++){var f=a[e];d[e]=b(f,e,a)}return d},kb=function(a,b){for(var c=0,d=a.length;c<d;c++){b(a[c],c,a)}},lb=function(a,b){for(var c=a.length-1;c>=0;c--){b(a[c],c,a)}},mb=function(a,b){for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];(b(g,e,a)?c:d).push(g)}return{pass:c,fail:d}},nb=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d];b(f,d,a)&&c.push(f)}return c},ob=function(a,b){if(0===a.length)return[];for(var c=b(a[0]),d=[],e=[],f=0,g=a.length;f<g;f++){var h=a[f],i=b(h);i!==c&&(d.push(e),e=[]),c=i,e.push(h)}return 0!==e.length&&d.push(e),d},pb=function(a,b,c){return lb(a,function(a){c=b(c,a)}),c},qb=function(a,b,c){return kb(a,function(a){c=b(c,a)}),c},rb=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e,c,a))return La.some(e)}return La.none()},sb=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b(a[c],c,a))return La.some(c)}return La.none()},tb=function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1},ub=Array.prototype.push,vb=function(a){for(var b=[],c=0,d=a.length;c<d;++c){if(!Array.prototype.isPrototypeOf(a[c]))throw new Error("Arr.flatten item "+c+" was not an array, input: "+a);ub.apply(b,a[c])}return b},wb=function(a,b){var c=jb(a,b);return vb(c)},xb=function(a,b){for(var c=0,d=a.length;c<d;++c){if(!0!==b(a[c],c,a))return!1}return!0},yb=function(a,b){return a.length===b.length&&xb(a,function(a,c){return a===b[c]})},zb=Array.prototype.slice,Ab=function(a){var b=zb.call(a,0);return b.reverse(),b},Bb=function(a,b){return nb(a,function(a){return!fb(b,a)})},Cb=function(a,b){for(var c={},d=0,e=a.length;d<e;d++){var f=a[d];c[String(f)]=b(f,d)}return c},Db=function(a){return[a]},Eb=function(a,b){var c=zb.call(a,0);return c.sort(b),c},Fb=function(a){return 0===a.length?La.none():La.some(a[0])},Gb=function(a){return 0===a.length?La.none():La.some(a[a.length-1])},Hb=cb.isFunction(Array.from)?Array.from:function(a){return zb.call(a)},Ib={map:jb,each:kb,eachr:lb,partition:mb,filter:nb,groupBy:ob,indexOf:eb,foldr:pb,foldl:qb,find:rb,findIndex:sb,flatten:vb,bind:wb,forall:xb,exists:gb,contains:fb,equal:yb,reverse:Ab,chunk:ib,difference:Bb,mapToObject:Cb,pure:Db,sort:Eb,range:hb,head:Fb,last:Gb,from:Hb},Jb={file:{title:"File",items:"newdocument restoredraft | preview | print"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen"},insert:{title:"Insert",items:"image link media template codesample inserttable | charmap hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | blockformats align | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code"},table:{title:"Table"},help:{title:"Help"}},Kb=function(){return{name:"|",item:{text:"|"}}},Lb=function(a,b){var c=b?{name:a,item:b}:null;return"|"===a?Kb():c},Mb=function(a,b){return Ib.findIndex(a,function(a){return a.name===b}).isSome()},Nb=function(a){return a&&"|"===a.item.text},Ob=function(a,b){var c=Ib.filter(a,function(a){return!1===b.hasOwnProperty(a.name)}),d=Ib.filter(c,function(a,b,c){return!Nb(a)||!Nb(c[b-1])});return Ib.filter(d,function(a,b,c){return!Nb(a)||b>0&&b<c.length-1})},Pb=function(a,b,c,d){var e,f,g,h;return b?(f=b[d],h=!0):f=Jb[d],f&&(e={text:f.title},g=[],M.each((f.items||"").split(/[ ,]/),function(b){var c=Lb(b,a[b]);c&&g.push(c)}),h||M.each(a,function(a,b){a.context!==d||Mb(g,b)||("before"===a.separator&&g.push(Kb()),a.prependToContext?g.unshift(Lb(b,a)):g.push(Lb(b,a)),"after"===a.separator&&g.push(Kb()))}),e.menu=Ib.map(Ob(g,c),function(a){return a.item}),!e.menu.length)?null:e},Qb=function(a){var b,c=[],d=V(a);if(d)for(b in d)c.push(b);else for(b in Jb)c.push(b);return c},Rb=function(a){for(var b=[],c=Qb(a),d=M.makeMap(W(a).split(/[ ,]/)),e=P(a),f="string"==typeof e?e.split(/[ ,]/):c,g=0;g<f.length;g++){var h=f[g],i=Pb(a.menuItems,V(a),d,h);i&&b.push(i)}return b},Sb={createMenuButtons:Rb},Tb=fa.DOM,Ub=function(a){return{width:a.clientWidth,height:a.clientHeight}},Vb=function(a,b,c){var d,e,f,g;d=a.getContainer(),e=a.getContentAreaContainer().firstChild,f=Ub(d),g=Ub(e),null!==b&&(b=Math.max(X(a),b),b=Math.min(Z(a),b),Tb.setStyle(d,"width",b+(f.width-g.width)),Tb.setStyle(e,"width",b)),c=Math.max(Y(a),c),c=Math.min($(a),c),Tb.setStyle(e,"height",c),la.fireResizeEditor(a)},Wb=function(a,b,c){var d=a.getContentAreaContainer();Vb(a,d.clientWidth+b,d.clientHeight+c)},Xb={resizeTo:Vb,resizeBy:Wb},Yb=tinymce.util.Tools.resolve("tinymce.Env"),Zb=function(a){return{element:function(){return a}}},$b=function(a,b,c){var d=a.settings[c];d&&d(Zb(b.getEl("body")))},_b=function(a,b,c){M.each(c,function(c){var d=b.items().filter("#"+c.name)[0];d&&d.visible()&&c.name!==a&&($b(c,d,"onhide"),d.visible(!1))})},ac=function(a){a.items().each(function(a){a.active(!1)})},bc=function(a,b){return M.grep(a,function(a){return a.name===b})[0]},cc=function(a,b,c){return function(d){var e=d.control,f=e.parents().filter("panel")[0],g=f.find("#"+b)[0],h=bc(c,b);_b(b,f,c),ac(e.parent()),g&&g.visible()?($b(h,g,"onhide"),g.hide(),e.active(!1)):(g?(g.show(),$b(h,g,"onshow")):(g=ga.create({type:"container",name:b,layout:"stack",classes:"sidebar-panel",html:""}),f.prepend(g),$b(h,g,"onrender"),$b(h,g,"onshow")),e.active(!0)),la.fireResizeEditor(a)}},dc=function(){return!Yb.ie||Yb.ie>=11},ec=function(a){return!(!dc()||!a.sidebars)&&a.sidebars.length>0},fc=function(a){return{type:"panel",name:"sidebar",layout:"stack",classes:"sidebar",items:[{type:"toolbar",layout:"stack",classes:"sidebar-toolbar",items:M.map(a.sidebars,function(b){var c=b.settings;return{type:"button",icon:c.icon,image:c.image,tooltip:c.tooltip,onclick:cc(a,b.name,a.sidebars)}})}]}},gc={hasSidebar:ec,createSidebar:fc},hc=function(a){var b=function(){a._skinLoaded=!0,la.fireSkinLoaded(a)};return function(){a.initialized?b():a.on("init",b)}},ic={fireSkinLoaded:hc},jc=fa.DOM,kc=function(a){return function(b){a.find("*").disabled("readonly"===b.mode)}},lc=function(a){return{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",border:a,html:""}},mc=function(a){return{type:"panel",layout:"stack",classes:"edit-aria-container",border:"1 0 0 0",items:[lc("0"),gc.createSidebar(a)]}},nc=function(a,b,c){var d,e,f;if(!1===_(a)&&c.skinUiCss?jc.styleSheetLoader.load(c.skinUiCss,ic.fireSkinLoaded(a)):ic.fireSkinLoaded(a)(),d=b.panel=ga.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[{type:"container",classes:"top-part",items:[!1===O(a)?null:{type:"menubar",border:"0 0 1 0",items:Sb.createMenuButtons(a)},Ta.createToolbars(a,R(a))]},gc.hasSidebar(a)?mc(a):lc("1 0 0 0")]}),Qa.setUiContainer(a,d),"none"!==ba(a)&&(e={type:"resizehandle",direction:ba(a),onResizeStart:function(){var b=a.getContentAreaContainer().firstChild;f={width:b.clientWidth,height:b.clientHeight}},onResize:function(b){"both"===ba(a)?Xb.resizeTo(a,f.width+b.deltaX,f.height+b.deltaY):Xb.resizeTo(a,null,f.height+b.deltaY)}}),Q(a)){var g=ha.translate(["Powered by {0}",'<a href="https://www.tinymce.com/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce" rel="noopener" target="_blank" role="presentation" tabindex="-1">tinymce</a>']),h=N(a)?{type:"label",classes:"branding",html:" "+g}:null;d.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath",editor:a},e,h]})}return la.fireBeforeRenderUI(a),a.on("SwitchMode",kc(d)),d.renderBefore(c.targetNode).reflow(),S(a)&&a.setMode("readonly"),c.width&&jc.setStyle(d.getEl(),"width",c.width),a.on("remove",function(){d.remove(),d=null}),oa.addKeys(a,d),_a.addContextualToolbars(a),{iframeContainer:d.find("#iframe")[0].getEl(),editorContainer:d.getEl()}},oc={render:nc},pc=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),qc=0,rc={id:function(){return"mceu_"+qc++},create:function(a,b,c){var d=document.createElement(a);return fa.DOM.setAttribs(d,b),"string"==typeof c?d.innerHTML=c:M.each(c,function(a){a.nodeType&&d.appendChild(a)}),d},createFragment:function(a){return fa.DOM.createFragment(a)},getWindowSize:function(){return fa.DOM.getViewPort()},getSize:function(a){var b,c;if(a.getBoundingClientRect){var d=a.getBoundingClientRect();b=Math.max(d.width||d.right-d.left,a.offsetWidth),c=Math.max(d.height||d.bottom-d.bottom,a.offsetHeight)}else b=a.offsetWidth,c=a.offsetHeight;return{width:b,height:c}},getPos:function(a,b){return fa.DOM.getPos(a,b||rc.getContainer())},getContainer:function(){return Yb.container?Yb.container:document.body},getViewPort:function(a){return fa.DOM.getViewPort(a)},get:function(a){return document.getElementById(a)},addClass:function(a,b){return fa.DOM.addClass(a,b)},removeClass:function(a,b){return fa.DOM.removeClass(a,b)},hasClass:function(a,b){return fa.DOM.hasClass(a,b)},toggleClass:function(a,b,c){return fa.DOM.toggleClass(a,b,c)},css:function(a,b,c){return fa.DOM.setStyle(a,b,c)},getRuntimeStyle:function(a,b){return fa.DOM.getStyle(a,b,!0)},on:function(a,b,c,d){return fa.DOM.bind(a,b,c,d)},off:function(a,b,c){return fa.DOM.unbind(a,b,c)},fire:function(a,b,c){return fa.DOM.fire(a,b,c)},innerHtml:function(a,b){fa.DOM.setHTML(a,b)}},sc=function(a){return"static"===rc.getRuntimeStyle(a,"position")},tc=function(a){return a.state.get("fixed")},uc=function(a){return{x:0,y:0,w:a.scrollWidth-1,h:a.scrollHeight-1}},vc=function(){var a=window,b=Math.max(a.pageXOffset,document.body.scrollLeft,document.documentElement.scrollLeft),c=Math.max(a.pageYOffset,document.body.scrollTop,document.documentElement.scrollTop);return{x:b,y:c,w:b+(a.innerWidth||document.documentElement.clientWidth),h:c+(a.innerHeight||document.documentElement.clientHeight)}},wc=function(a){var b=Qa.getUiContainer(a);return b&&!tc(a)?uc(b):vc()},xc={testMoveRel:function(b,c){for(var d=wc(this),e=0;e<c.length;e++){var f=a(this,b,c[e]);if(tc(this)){if(f.x>0&&f.x+f.w<d.w&&f.y>0&&f.y+f.h<d.h)return c[e]}else if(f.x>d.x&&f.x+f.w<d.w&&f.y>d.y&&f.y+f.h<d.h)return c[e]}return c[0]},moveRel:function(b,c){"string"!=typeof c&&(c=this.testMoveRel(b,c));var d=a(this,b,c);return this.moveTo(d.x,d.y)},moveBy:function(a,b){var c=this,d=c.layoutRect();return c.moveTo(d.x+a,d.y+b),c},moveTo:function(a,b){function c(a,b,c){return a<0?0:a+c>b?(a=b-c,a<0?0:a):a}var d=this;if(d.settings.constrainToViewport){var e=wc(this),f=d.layoutRect();a=c(a,e.w,f.w),b=c(b,e.h,f.h)}var g=Qa.getUiContainer(d);return g&&sc(g)&&!tc(d)&&(a-=g.scrollLeft,b-=g.scrollTop),g&&(a+=1,b+=1),d.state.get("rendered")?d.layoutRect({x:a,y:b}).repaint():(d.settings.x=a,d.settings.y=b),d.fire("move",{x:a,y:b}),d}},yc=tinymce.util.Tools.resolve("tinymce.util.Class"),zc=tinymce.util.Tools.resolve("tinymce.util.EventDispatcher"),Ac={parseBox:function(a){var b;if(a)return"number"==typeof a?(a=a||0,{top:a,left:a,bottom:a,right:a}):(a=a.split(" "),b=a.length,1===b?a[1]=a[2]=a[3]=a[0]:2===b?(a[2]=a[0],a[3]=a[1]):3===b&&(a[3]=a[1]),{top:parseInt(a[0],10)||0,right:parseInt(a[1],10)||0,bottom:parseInt(a[2],10)||0,left:parseInt(a[3],10)||0})},measureBox:function(a,b){function c(b){var c=a.ownerDocument.defaultView;if(c){var d=c.getComputedStyle(a,null);return d?(b=b.replace(/[A-Z]/g,function(a){return"-"+a}),d.getPropertyValue(b)):null}return a.currentStyle[b]}function d(a){var b=parseFloat(c(a));return isNaN(b)?0:b}return{top:d(b+"TopWidth"),right:d(b+"RightWidth"),bottom:d(b+"BottomWidth"),left:d(b+"LeftWidth")}}};M.extend(c.prototype,{add:function(a){return a&&!this.contains(a)&&(this.cls._map[a]=!0,this.cls.push(a),this._change()),this},remove:function(a){if(this.contains(a)){var b=void 0;for(b=0;b<this.cls.length&&this.cls[b]!==a;b++);this.cls.splice(b,1),delete this.cls._map[a],this._change()}return this},toggle:function(a,b){var c=this.contains(a);return c!==b&&(c?this.remove(a):this.add(a),this._change()),this},contains:function(a){return!!this.cls._map[a]},_change:function(){delete this.clsValue,this.onchange.call(this)}}),c.prototype.toString=function(){var a;if(this.clsValue)return this.clsValue;a="";for(var b=0;b<this.cls.length;b++)b>0&&(a+=" "),
a+=this.prefix+this.cls[b];return a};var Bc,Cc,Dc,Ec=/^([\w\\*]+)?(?:#([\w\-\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,Fc=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,Gc=/^\s*|\s*$/g,Hc=yc.extend({init:function(a){function b(a){if(a)return a=a.toLowerCase(),function(b){return"*"===a||b.type===a}}function c(a){if(a)return function(b){return b._name===a}}function d(a){if(a)return a=a.split("."),function(b){for(var c=a.length;c--;)if(!b.classes.contains(a[c]))return!1;return!0}}function e(a,b,c){if(a)return function(d){var e=d[a]?d[a]():"";return b?"="===b?e===c:"*="===b?e.indexOf(c)>=0:"~="===b?(" "+e+" ").indexOf(" "+c+" ")>=0:"!="===b?e!==c:"^="===b?0===e.indexOf(c):"$="===b&&e.substr(e.length-c.length)===c:!!c}}function f(a){var b;if(a)return a=/(?:not\((.+)\))|(.+)/i.exec(a),a[1]?(b=h(a[1],[]),function(a){return!i(a,b)}):(a=a[2],function(b,c,d){return"first"===a?0===c:"last"===a?c===d-1:"even"===a?c%2==0:"odd"===a?c%2==1:!!b[a]&&b[a]()})}function g(a,g,h){function i(a){a&&g.push(a)}var j;return j=Ec.exec(a.replace(Gc,"")),i(b(j[1])),i(c(j[2])),i(d(j[3])),i(e(j[4],j[5],j[6])),i(f(j[7])),g.pseudo=!!j[7],g.direct=h,g}function h(a,b){var c,d,e,f=[];do{if(Fc.exec(""),(d=Fc.exec(a))&&(a=d[3],f.push(d[1]),d[2])){c=d[3];break}}while(d);for(c&&h(c,b),a=[],e=0;e<f.length;e++)">"!==f[e]&&a.push(g(f[e],[],">"===f[e-1]));return b.push(a),b}var i=this.match;this._selectors=h(a,[])},match:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;for(b=b||this._selectors,c=0,d=b.length;c<d;c++){for(g=b[c],f=g.length,o=a,n=0,e=f-1;e>=0;e--)for(j=g[e];o;){if(j.pseudo)for(m=o.parent().items(),k=l=m.length;k--&&m[k]!==o;);for(h=0,i=j.length;h<i;h++)if(!j[h](o,k,l)){h=i+1;break}if(h===i){n++;break}if(e===f-1)break;o=o.parent()}if(n===f)return!0}return!1},find:function(a){function b(a,c,d){var e,g,h,i,j,k=c[d];for(e=0,g=a.length;e<g;e++){for(j=a[e],h=0,i=k.length;h<i;h++)if(!k[h](j,e,g)){h=i+1;break}if(h===i)d===c.length-1?f.push(j):j.items&&b(j.items(),c,d+1);else if(k.direct)return;j.items&&b(j.items(),c,d)}}var c,e,f=[],g=this._selectors;if(a.items){for(c=0,e=g.length;c<e;c++)b(a.items(),g[c],0);e>1&&(f=d(f))}return Bc||(Bc=Hc.Collection),new Bc(f)}}),Ic=Array.prototype.push,Jc=Array.prototype.slice;Dc={length:0,init:function(a){a&&this.add(a)},add:function(a){var b=this;return M.isArray(a)?Ic.apply(b,a):a instanceof Cc?b.add(a.toArray()):Ic.call(b,a),b},set:function(a){var b,c=this,d=c.length;for(c.length=0,c.add(a),b=c.length;b<d;b++)delete c[b];return c},filter:function(a){var b,c,d,e,f=this,g=[];for("string"==typeof a?(a=new Hc(a),e=function(b){return a.match(b)}):e=a,b=0,c=f.length;b<c;b++)d=f[b],e(d)&&g.push(d);return new Cc(g)},slice:function(){return new Cc(Jc.apply(this,arguments))},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},each:function(a){return M.each(this,a),this},toArray:function(){return M.toArray(this)},indexOf:function(a){for(var b=this,c=b.length;c--&&b[c]!==a;);return c},reverse:function(){return new Cc(M.toArray(this).reverse())},hasClass:function(a){return!!this[0]&&this[0].classes.contains(a)},prop:function(a,b){var c,d=this;return void 0!==b?(d.each(function(c){c[a]&&c[a](b)}),d):(c=d[0],c&&c[a]?c[a]():void 0)},exec:function(a){var b=this,c=M.toArray(arguments).slice(1);return b.each(function(b){b[a]&&b[a].apply(b,c)}),b},remove:function(){for(var a=this.length;a--;)this[a].remove();return this},addClass:function(a){return this.each(function(b){b.classes.add(a)})},removeClass:function(a){return this.each(function(b){b.classes.remove(a)})}},M.each("fire on off show hide append prepend before after reflow".split(" "),function(a){Dc[a]=function(){var b=M.toArray(arguments);return this.each(function(c){a in c&&c[a].apply(c,b)}),this}}),M.each("text name disabled active selected checked visible parent value data".split(" "),function(a){Dc[a]=function(b){return this.prop(a,b)}}),Cc=yc.extend(Dc),Hc.Collection=Cc;var Kc=Cc,Lc=function(a){this.create=a.create};Lc.create=function(a,b){return new Lc({create:function(c,d){var e,f=function(a){c.set(d,a.value)},g=function(c){a.set(b,c.value)};return c.on("change:"+d,g),a.on("change:"+b,f),e=c._bindings,e||(e=c._bindings=[],c.on("destroy",function(){for(var a=e.length;a--;)e[a]()})),e.push(function(){a.off("change:"+b,f)}),a.get(b)}})};var Mc,Nc,Oc=tinymce.util.Tools.resolve("tinymce.util.Observable"),Pc=yc.extend({Mixins:[Oc],init:function(a){var b,c;a=a||{};for(b in a)(c=a[b])instanceof Lc&&(a[b]=c.create(this,b));this.data=a},set:function(a,b){var c,d,e=this.data[a];if(b instanceof Lc&&(b=b.create(this,a)),"object"==typeof a){for(c in a)this.set(c,a[c]);return this}return f(e,b)||(this.data[a]=b,d={target:this,name:a,value:b,oldValue:e},this.fire("change:"+a,d),this.fire("change",d)),this},get:function(a){return this.data[a]},has:function(a){return a in this.data},bind:function(a){return Lc.create(this,a)},destroy:function(){this.fire("destroy")}}),Qc={},Rc={add:function(a){var b=a.parent();if(b){if(!b._layout||b._layout.isNative())return;Qc[b._id]||(Qc[b._id]=b),Mc||(Mc=!0,qa.requestAnimationFrame(function(){var a,b;Mc=!1;for(a in Qc)b=Qc[a],b.state.get("rendered")&&b.reflow();Qc={}},document.body))}},remove:function(a){Qc[a._id]&&delete Qc[a._id]}},Sc="onmousewheel"in document,Tc=!1,Uc=0,Vc={Statics:{classPrefix:"mce-"},isRtl:function(){return Nc.rtl},classPrefix:"mce-",init:function(a){function b(a){var b;for(a=a.split(" "),b=0;b<a.length;b++)f.classes.add(a[b])}var d,e,f=this;f.settings=a=M.extend({},f.Defaults,a),f._id=a.id||"mceu_"+Uc++,f._aria={role:a.role},f._elmCache={},f.$=pc,f.state=new Pc({visible:!0,active:!1,disabled:!1,value:""}),f.data=new Pc(a.data),f.classes=new c(function(){f.state.get("rendered")&&(f.getEl().className=this.toString())}),f.classes.prefix=f.classPrefix,d=a.classes,d&&(f.Defaults&&(e=f.Defaults.classes)&&d!==e&&b(e),b(d)),M.each("title text name visible disabled active value".split(" "),function(b){b in a&&f[b](a[b])}),f.on("click",function(){if(f.disabled())return!1}),f.settings=a,f.borderBox=Ac.parseBox(a.border),f.paddingBox=Ac.parseBox(a.padding),f.marginBox=Ac.parseBox(a.margin),a.hidden&&f.hide()},Properties:"parent,name",getContainerElm:function(){var a=Qa.getUiContainer(this);return a||rc.getContainer()},getParentCtrl:function(a){for(var b,c=this.getRoot().controlIdLookup;a&&c&&!(b=c[a.id]);)a=a.parentNode;return b},initLayoutRect:function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.settings,m=k.getEl();a=k.borderBox=k.borderBox||Ac.measureBox(m,"border"),k.paddingBox=k.paddingBox||Ac.measureBox(m,"padding"),k.marginBox=k.marginBox||Ac.measureBox(m,"margin"),j=rc.getSize(m),h=l.minWidth,i=l.minHeight,e=h||j.width,f=i||j.height,c=l.width,d=l.height,g=l.autoResize,g=void 0!==g?g:!c&&!d,c=c||e,d=d||f;var n=a.left+a.right,o=a.top+a.bottom,p=l.maxWidth||65535,q=l.maxHeight||65535;return k._layoutRect=b={x:l.x||0,y:l.y||0,w:c,h:d,deltaW:n,deltaH:o,contentW:c-n,contentH:d-o,innerW:c-n,innerH:d-o,startMinWidth:h||0,startMinHeight:i||0,minW:Math.min(e,p),minH:Math.min(f,q),maxW:p,maxH:q,autoResize:g,scrollW:0},k._lastLayoutRect={},b},layoutRect:function(a){var b,c,d,e,f,g=this,h=g._layoutRect;return h||(h=g.initLayoutRect()),a?(d=h.deltaW,e=h.deltaH,void 0!==a.x&&(h.x=a.x),void 0!==a.y&&(h.y=a.y),void 0!==a.minW&&(h.minW=a.minW),void 0!==a.minH&&(h.minH=a.minH),c=a.w,void 0!==c&&(c=c<h.minW?h.minW:c,c=c>h.maxW?h.maxW:c,h.w=c,h.innerW=c-d),c=a.h,void 0!==c&&(c=c<h.minH?h.minH:c,c=c>h.maxH?h.maxH:c,h.h=c,h.innerH=c-e),c=a.innerW,void 0!==c&&(c=c<h.minW-d?h.minW-d:c,c=c>h.maxW-d?h.maxW-d:c,h.innerW=c,h.w=c+d),c=a.innerH,void 0!==c&&(c=c<h.minH-e?h.minH-e:c,c=c>h.maxH-e?h.maxH-e:c,h.innerH=c,h.h=c+e),void 0!==a.contentW&&(h.contentW=a.contentW),void 0!==a.contentH&&(h.contentH=a.contentH),b=g._lastLayoutRect,b.x===h.x&&b.y===h.y&&b.w===h.w&&b.h===h.h||(f=Nc.repaintControls,f&&f.map&&!f.map[g._id]&&(f.push(g),f.map[g._id]=!0),b.x=h.x,b.y=h.y,b.w=h.w,b.h=h.h),g):h},repaint:function(){var a,b,c,d,e,f,g,h,i,j,k=this;i=document.createRange?function(a){return a}:Math.round,a=k.getEl().style,d=k._layoutRect,h=k._lastRepaintRect||{},e=k.borderBox,f=e.left+e.right,g=e.top+e.bottom,d.x!==h.x&&(a.left=i(d.x)+"px",h.x=d.x),d.y!==h.y&&(a.top=i(d.y)+"px",h.y=d.y),d.w!==h.w&&(j=i(d.w-f),a.width=(j>=0?j:0)+"px",h.w=d.w),d.h!==h.h&&(j=i(d.h-g),a.height=(j>=0?j:0)+"px",h.h=d.h),k._hasBody&&d.innerW!==h.innerW&&(j=i(d.innerW),c=k.getEl("body"),c&&(b=c.style,b.width=(j>=0?j:0)+"px"),h.innerW=d.innerW),k._hasBody&&d.innerH!==h.innerH&&(j=i(d.innerH),c=c||k.getEl("body"),c&&(b=b||c.style,b.height=(j>=0?j:0)+"px"),h.innerH=d.innerH),k._lastRepaintRect=h,k.fire("repaint",{},!1)},updateLayoutRect:function(){var a=this;a.parent()._lastRect=null,rc.css(a.getEl(),{width:"",height:""}),a._layoutRect=a._lastRepaintRect=a._lastLayoutRect=null,a.initLayoutRect()},on:function(a,b){var c=this;return g(c).on(a,function(a){var b,d;return"string"!=typeof a?a:function(e){return b||c.parentsAndSelf().each(function(c){var e=c.settings.callbacks;if(e&&(b=e[a]))return d=c,!1}),b?b.call(d,e):(e.action=a,void this.fire("execute",e))}}(b)),c},off:function(a,b){return g(this).off(a,b),this},fire:function(a,b,c){var d=this;if(b=b||{},b.control||(b.control=d),b=g(d).fire(a,b),!1!==c&&d.parent)for(var e=d.parent();e&&!b.isPropagationStopped();)e.fire(a,b,!1),e=e.parent();return b},hasEventListeners:function(a){return g(this).has(a)},parents:function(a){var b,c=this,d=new Kc;for(b=c.parent();b;b=b.parent())d.add(b);return a&&(d=d.filter(a)),d},parentsAndSelf:function(a){return new Kc(this).add(this.parents(a))},next:function(){var a=this.parent().items();return a[a.indexOf(this)+1]},prev:function(){var a=this.parent().items();return a[a.indexOf(this)-1]},innerHtml:function(a){return this.$el.html(a),this},getEl:function(a){var b=a?this._id+"-"+a:this._id;return this._elmCache[b]||(this._elmCache[b]=pc("#"+b)[0]),this._elmCache[b]},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(a){}return this},blur:function(){return this.getEl().blur(),this},aria:function(a,b){var c=this,d=c.getEl(c.ariaTarget);return void 0===b?c._aria[a]:(c._aria[a]=b,c.state.get("rendered")&&d.setAttribute("role"===a?a:"aria-"+a,b),c)},encode:function(a,b){return!1!==b&&(a=this.translate(a)),(a||"").replace(/[&<>"]/g,function(a){return"&#"+a.charCodeAt(0)+";"})},translate:function(a){return Nc.translate?Nc.translate(a):a},before:function(a){var b=this,c=b.parent();return c&&c.insert(a,c.items().indexOf(b),!0),b},after:function(a){var b=this,c=b.parent();return c&&c.insert(a,c.items().indexOf(b)),b},remove:function(){var a,b,c=this,d=c.getEl(),e=c.parent();if(c.items){var f=c.items().toArray();for(b=f.length;b--;)f[b].remove()}e&&e.items&&(a=[],e.items().each(function(b){b!==c&&a.push(b)}),e.items().set(a),e._lastRect=null),c._eventsRoot&&c._eventsRoot===c&&pc(d).off();var g=c.getRoot().controlIdLookup;return g&&delete g[c._id],d&&d.parentNode&&d.parentNode.removeChild(d),c.state.set("rendered",!1),c.state.destroy(),c.fire("remove"),c},renderBefore:function(a){return pc(a).before(this.renderHtml()),this.postRender(),this},renderTo:function(a){return pc(a||this.getContainerElm()).append(this.renderHtml()),this.postRender(),this},preRender:function(){},render:function(){},renderHtml:function(){return'<div id="'+this._id+'" class="'+this.classes+'"></div>'},postRender:function(){var a,b,c,d,e,f=this,g=f.settings;f.$el=pc(f.getEl()),f.state.set("rendered",!0);for(d in g)0===d.indexOf("on")&&f.on(d.substr(2),g[d]);if(f._eventsRoot){for(c=f.parent();!e&&c;c=c.parent())e=c._eventsRoot;if(e)for(d in e._nativeEvents)f._nativeEvents[d]=!0}h(f),g.style&&(a=f.getEl())&&(a.setAttribute("style",g.style),a.style.cssText=g.style),f.settings.border&&(b=f.borderBox,f.$el.css({"border-top-width":b.top,"border-right-width":b.right,"border-bottom-width":b.bottom,"border-left-width":b.left}));var i=f.getRoot();i.controlIdLookup||(i.controlIdLookup={}),i.controlIdLookup[f._id]=f;for(var j in f._aria)f.aria(j,f._aria[j]);!1===f.state.get("visible")&&(f.getEl().style.display="none"),f.bindStates(),f.state.on("change:visible",function(a){var b,c=a.value;f.state.get("rendered")&&(f.getEl().style.display=!1===c?"none":"",f.getEl().getBoundingClientRect()),b=f.parent(),b&&(b._lastRect=null),f.fire(c?"show":"hide"),Rc.add(f)}),f.fire("postrender",{},!1)},bindStates:function(){},scrollIntoView:function(a){var b,c,d,e,f,g,h=this.getEl(),i=h.parentNode,j=function(a,b){var c,d,e=a;for(c=d=0;e&&e!==b&&e.nodeType;)c+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;return{x:c,y:d}}(h,i);return b=j.x,c=j.y,d=h.offsetWidth,e=h.offsetHeight,f=i.clientWidth,g=i.clientHeight,"end"===a?(b-=f-d,c-=g-e):"center"===a&&(b-=f/2-d/2,c-=g/2-e/2),i.scrollLeft=b,i.scrollTop=c,this},getRoot:function(){for(var a,b=this,c=[];b;){if(b.rootControl){a=b.rootControl;break}c.push(b),a=b,b=b.parent()}a||(a=this);for(var d=c.length;d--;)c[d].rootControl=a;return a},reflow:function(){Rc.remove(this);var a=this.parent();return a&&a._layout&&!a._layout.isNative()&&a.reflow(),this}};M.each("text title visible disabled active value".split(" "),function(a){Vc[a]=function(b){return 0===arguments.length?this.state.get(a):(void 0!==b&&this.state.set(a,b),this)}}),Nc=yc.extend(Vc);var Wc,Xc,Yc,Zc,$c=Nc,_c=function(a){return!!a.getAttribute("data-mce-tabstop")},ad={},bd=$c.extend({init:function(a){var b=this;b._super(a),a=b.settings,a.fixed&&b.state.set("fixed",!0),b._items=new Kc,b.isRtl()&&b.classes.add("rtl"),b.bodyClasses=new c(function(){b.state.get("rendered")&&(b.getEl("body").className=this.toString())}),b.bodyClasses.prefix=b.classPrefix,b.classes.add("container"),b.bodyClasses.add("container-body"),a.containerCls&&b.classes.add(a.containerCls),b._layout=ga.create((a.layout||"")+"layout"),b.settings.items?b.add(b.settings.items):b.add(b.render()),b._hasBody=!0},items:function(){return this._items},find:function(a){return a=ad[a]=ad[a]||new Hc(a),a.find(this)},add:function(a){var b=this;return b.items().add(b.create(a)).parent(b),b},focus:function(a){var b,c,d,e=this;return a&&(c=e.keyboardNav||e.parents().eq(-1)[0].keyboardNav)?void c.focusFirst(e):(d=e.find("*"),e.statusbar&&d.add(e.statusbar.items()),d.each(function(a){if(a.settings.autofocus)return b=null,!1;a.canFocus&&(b=b||a)}),b&&b.focus(),e)},replace:function(a,b){for(var c,d=this.items(),e=d.length;e--;)if(d[e]===a){d[e]=b;break}e>=0&&(c=b.getEl(),c&&c.parentNode.removeChild(c),(c=a.getEl())&&c.parentNode.removeChild(c)),b.parent(this)},create:function(a){var b,c=this,d=[];return M.isArray(a)||(a=[a]),M.each(a,function(a){a&&(a instanceof $c||("string"==typeof a&&(a={type:a}),b=M.extend({},c.settings.defaults,a),a.type=b.type=b.type||a.type||c.settings.defaultType||(b.defaults?b.defaults.type:null),a=ga.create(b)),d.push(a))}),d},renderNew:function(){var a=this;return a.items().each(function(b,c){var d;b.parent(a),b.state.get("rendered")||(d=a.getEl("body"),d.hasChildNodes()&&c<=d.childNodes.length-1?pc(d.childNodes[c]).before(b.renderHtml()):pc(d).append(b.renderHtml()),b.postRender(),Rc.add(b))}),a._layout.applyClasses(a.items().filter(":visible")),a._lastRect=null,a},append:function(a){return this.add(a).renderNew()},prepend:function(a){var b=this;return b.items().set(b.create(a).concat(b.items().toArray())),b.renderNew()},insert:function(a,b,c){var d,e,f,g=this;return a=g.create(a),d=g.items(),!c&&b<d.length-1&&(b+=1),b>=0&&b<d.length&&(e=d.slice(0,b).toArray(),f=d.slice(b).toArray(),d.set(e.concat(a,f))),g.renderNew()},fromJSON:function(a){var b=this;for(var c in a)b.find("#"+c).value(a[c]);return b},toJSON:function(){var a=this,b={};return a.find("*").each(function(a){var c=a.name(),d=a.value();c&&void 0!==d&&(b[c]=d)}),b},renderHtml:function(){var a=this,b=a._layout,c=this.settings.role;return a.preRender(),b.preRender(a),'<div id="'+a._id+'" class="'+a.classes+'"'+(c?' role="'+this.settings.role+'"':"")+'><div id="'+a._id+'-body" class="'+a.bodyClasses+'">'+(a.settings.html||"")+b.renderHtml(a)+"</div></div>"},postRender:function(){var a,b=this;return b.items().exec("postRender"),b._super(),b._layout.postRender(b),b.state.set("rendered",!0),b.settings.style&&b.$el.css(b.settings.style),b.settings.border&&(a=b.borderBox,b.$el.css({"border-top-width":a.top,"border-right-width":a.right,"border-bottom-width":a.bottom,"border-left-width":a.left})),b.parent()||(b.keyboardNav=i({root:b})),b},initLayoutRect:function(){var a=this,b=a._super();return a._layout.recalc(a),b},recalc:function(){var a=this,b=a._layoutRect,c=a._lastRect;if(!c||c.w!==b.w||c.h!==b.h)return a._layout.recalc(a),b=a.layoutRect(),a._lastRect={x:b.x,y:b.y,w:b.w,h:b.h},!0},reflow:function(){var a;if(Rc.remove(this),this.visible()){for($c.repaintControls=[],$c.repaintControls.map={},this.recalc(),a=$c.repaintControls.length;a--;)$c.repaintControls[a].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),$c.repaintControls=[]}return this}}),cd={init:function(){var a=this;a.on("repaint",a.renderScroll)},renderScroll:function(){function a(){function a(a,f,g,h,i,j){var k,l,m,n,o,p,q,r,s;if(l=b.getEl("scroll"+a)){if(r=f.toLowerCase(),s=g.toLowerCase(),pc(b.getEl("absend")).css(r,b.layoutRect()[h]-1),!i)return void pc(l).css("display","none");pc(l).css("display","block"),k=b.getEl("body"),m=b.getEl("scroll"+a+"t"),n=k["client"+g]-2*c,n-=d&&e?l["client"+j]:0,o=k["scroll"+g],p=n/o,q={},q[r]=k["offset"+f]+c,q[s]=n,pc(l).css(q),q={},q[r]=k["scroll"+f]*p,q[s]=n*p,pc(m).css(q)}}var d,e,f;f=b.getEl("body"),d=f.scrollWidth>f.clientWidth,e=f.scrollHeight>f.clientHeight,a("h","Left","Width","contentW",d,"Height"),a("v","Top","Height","contentH",e,"Width")}var b=this,c=2;b.settings.autoScroll&&(b._hasScroll||(b._hasScroll=!0,function(){function a(a,d,e,f,g){var h,i=b._id+"-scroll"+a,j=b.classPrefix;pc(b.getEl()).append('<div id="'+i+'" class="'+j+"scrollbar "+j+"scrollbar-"+a+'"><div id="'+i+'t" class="'+j+'scrollbar-thumb"></div></div>'),b.draghelper=new l(i+"t",{start:function(){h=b.getEl("body")["scroll"+d],pc("#"+i).addClass(j+"active")},drag:function(i){var j,k,l,m,n=b.layoutRect();k=n.contentW>n.innerW,l=n.contentH>n.innerH,m=b.getEl("body")["client"+e]-2*c,m-=k&&l?b.getEl("scroll"+a)["client"+g]:0,j=m/b.getEl("body")["scroll"+e],b.getEl("body")["scroll"+d]=h+i["delta"+f]/j},stop:function(){pc("#"+i).removeClass(j+"active")}})}b.classes.add("scroll"),a("v","Top","Height","Y","Width"),a("h","Left","Width","X","Height")}(),b.on("wheel",function(c){var d=b.getEl("body");d.scrollLeft+=10*(c.deltaX||0),d.scrollTop+=10*c.deltaY,a()}),pc(b.getEl("body")).on("scroll",a)),a())}},dd=bd.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[cd],renderHtml:function(){var a=this,b=a._layout,c=a.settings.html;return a.preRender(),b.preRender(a),void 0===c?c='<div id="'+a._id+'-body" class="'+a.bodyClasses+'">'+b.renderHtml(a)+"</div>":("function"==typeof c&&(c=c.call(a)),a._hasBody=!1),'<div id="'+a._id+'" class="'+a.classes+'" hidefocus="1" tabindex="-1" role="group">'+(a._preBodyHtml||"")+c+"</div>"}}),ed={resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(a,b){if(a<=1||b<=1){var c=rc.getWindowSize();a=a<=1?a*c.w:a,b=b<=1?b*c.h:b}return this._layoutRect.autoResize=!1,this.layoutRect({minW:a,minH:b,w:a,h:b}).reflow()},resizeBy:function(a,b){var c=this,d=c.layoutRect();return c.resizeTo(d.w+a,d.h+b)}},fd=[],gd=[],hd=dd.extend({Mixins:[xc,ed],init:function(a){var b=this;b._super(a),b._eventsRoot=b,b.classes.add("floatpanel"),a.autohide&&(o(),q(),fd.push(b)),a.autofix&&(p(),b.on("move",function(){r(this)})),b.on("postrender show",function(a){if(a.control===b){var c,d=b.classPrefix;b.modal&&!Zc&&(c=pc("#"+d+"modal-block",b.getContainerElm()),c[0]||(c=pc('<div id="'+d+'modal-block" class="'+d+"reset "+d+'fade"></div>').appendTo(b.getContainerElm())),qa.setTimeout(function(){c.addClass(d+"in"),pc(b.getEl()).addClass(d+"in")}),Zc=!0),s(!0,b)}}),b.on("show",function(){b.parents().each(function(a){if(a.state.get("fixed"))return b.fixed(!0),!1})}),a.popover&&(b._preBodyHtml='<div class="'+b.classPrefix+'arrow"></div>',b.classes.add("popover").add("bottom").add(b.isRtl()?"end":"start")),b.aria("label",a.ariaLabel),b.aria("labelledby",b._id),b.aria("describedby",b.describedBy||b._id+"-none")},fixed:function(a){var b=this;if(b.state.get("fixed")!==a){if(b.state.get("rendered")){var c=rc.getViewPort();a?b.layoutRect().y-=c.y:b.layoutRect().y+=c.y}b.classes.toggle("fixed",a),b.state.set("fixed",a)}return b},show:function(){var a,b=this,c=b._super();for(a=fd.length;a--&&fd[a]!==b;);return-1===a&&fd.push(b),c},hide:function(){return t(this),s(!1,this),this._super()},hideAll:function(){hd.hideAll()},close:function(){var a=this;return a.fire("close").isDefaultPrevented()||(a.remove(),s(!1,a)),a},remove:function(){t(this),this._super()},postRender:function(){var a=this;return a.settings.bodyRole&&this.getEl("body").setAttribute("role",a.settings.bodyRole),a._super()}});hd.hideAll=function(){for(var a=fd.length;a--;){var b=fd[a];b&&b.settings.autohide&&(b.hide(),fd.splice(a,1))}};var id=function(a,b){return!(!a||b.settings.ui_container)},jd=function(a,b,c){var d,e,f=fa.DOM,g=T(a);g&&(e=f.select(g)[0]);var h=function(){if(d&&d.moveRel&&d.visible()&&!d._fixed){var b=a.selection.getScrollContainer(),c=a.getBody(),e=0,g=0;if(b){var h=f.getPos(c),i=f.getPos(b);e=Math.max(0,i.x-h.x),g=Math.max(0,i.y-h.y)}d.fixed(!1).moveRel(c,a.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(e,g)}},i=function(){d&&(d.show(),h(),f.addClass(a.getBody(),"mce-edit-focus"))},j=function(){d&&(d.hide(),hd.hideAll(),f.removeClass(a.getBody(),"mce-edit-focus"))},k=function(){if(d)return void(d.visible()||i());d=b.panel=ga.create({type:e?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:id(e,a),fixed:id(e,a),border:1,items:[!1===O(a)?null:{type:"menubar",border:"0 0 1 0",items:Sb.createMenuButtons(a)},Ta.createToolbars(a,R(a))]}),Qa.setUiContainer(a,d),la.fireBeforeRenderUI(a),e?d.renderTo(e).reflow():d.renderTo().reflow(),oa.addKeys(a,d),i(),_a.addContextualToolbars(a),a.on("nodeChange",h),a.on("ResizeWindow",h),a.on("activate",i),a.on("deactivate",j),a.nodeChanged()};return a.settings.content_editable=!0,a.on("focus",function(){!1===_(a)&&c.skinUiCss?f.styleSheetLoader.load(c.skinUiCss,k,k):k()}),a.on("blur hide",j),a.on("remove",function(){d&&(d.remove(),d=null)}),!1===_(a)&&c.skinUiCss?f.styleSheetLoader.load(c.skinUiCss,ic.fireSkinLoaded(a)):ic.fireSkinLoaded(a)(),{}},kd={render:jd},ld=function(a,b){var c;a.on("ProgressState",function(a){c=c||new u(b.panel.getEl("body")),a.state?c.show(a.time):c.hide()})},md={setup:ld},nd=function(a,b,c){var d=ca(a);return d&&(c.skinUiCss=d+"/skin.min.css",a.contentCSS.push(d+"/content"+(a.inline?".inline":"")+".min.css")),md.setup(a,b),aa(a)?kd.render(a,b,c):oc.render(a,b,c)},od={renderUI:nd},pd=$c.extend({Mixins:[xc],Defaults:{classes:"widget tooltip tooltip-n"},renderHtml:function(){var a=this,b=a.classPrefix;return'<div id="'+a._id+'" class="'+a.classes+'" role="presentation"><div class="'+b+'tooltip-arrow"></div><div class="'+b+'tooltip-inner">'+a.encode(a.state.get("text"))+"</div></div>"},bindStates:function(){var a=this;return a.state.on("change:text",function(b){a.getEl().lastChild.innerHTML=a.encode(b.value)}),a._super()},repaint:function(){var a,b,c=this;a=c.getEl().style,b=c._layoutRect,a.left=b.x+"px",a.top=b.y+"px",a.zIndex=131070}}),qd=$c.extend({init:function(a){var b=this;b._super(a),a=b.settings,b.canFocus=!0,a.tooltip&&!1!==qd.tooltips&&(b.on("mouseenter",function(c){var d=b.tooltip().moveTo(-65535);if(c.control===b){var e=d.text(a.tooltip).show().testMoveRel(b.getEl(),["bc-tc","bc-tl","bc-tr"]);d.classes.toggle("tooltip-n","bc-tc"===e),d.classes.toggle("tooltip-nw","bc-tl"===e),d.classes.toggle("tooltip-ne","bc-tr"===e),d.moveRel(b.getEl(),e)}else d.hide()}),b.on("mouseleave mousedown click",function(){b.tooltip().remove(),b._tooltip=null})),b.aria("label",a.ariaLabel||a.tooltip)},tooltip:function(){return this._tooltip||(this._tooltip=new pd({type:"tooltip"}),Qa.inheritUiContainer(this,this._tooltip),this._tooltip.renderTo()),this._tooltip},postRender:function(){var a=this,b=a.settings;a._super(),a.parent()||!b.width&&!b.height||(a.initLayoutRect(),a.repaint()),b.autofocus&&a.focus()},bindStates:function(){function a(a){c.aria("disabled",a),c.classes.toggle("disabled",a)}function b(a){c.aria("pressed",a),c.classes.toggle("active",a)}var c=this;return c.state.on("change:disabled",function(b){a(b.value)}),c.state.on("change:active",function(a){b(a.value)}),c.state.get("disabled")&&a(!0),c.state.get("active")&&b(!0),c._super()},remove:function(){this._super(),this._tooltip&&(this._tooltip.remove(),this._tooltip=null)}}),rd=qd.extend({Defaults:{value:0},init:function(a){var b=this;b._super(a),b.classes.add("progress"),b.settings.filter||(b.settings.filter=function(a){return Math.round(a)})},renderHtml:function(){var a=this,b=a._id,c=this.classPrefix;return'<div id="'+b+'" class="'+a.classes+'"><div class="'+c+'bar-container"><div class="'+c+'bar"></div></div><div class="'+c+'text">0%</div></div>'},postRender:function(){var a=this;return a._super(),a.value(a.settings.value),a},bindStates:function(){function a(a){a=b.settings.filter(a),b.getEl().lastChild.innerHTML=a+"%",b.getEl().firstChild.firstChild.style.width=a+"%"}var b=this;return b.state.on("change:value",function(b){a(b.value)}),a(b.state.get("value")),b._super()}}),sd=function(a,b){a.getEl().lastChild.textContent=b+(a.progressBar?" "+a.progressBar.value()+"%":"")},td=$c.extend({Mixins:[xc],Defaults:{classes:"widget notification"},init:function(a){var b=this;b._super(a),b.maxWidth=a.maxWidth,a.text&&b.text(a.text),a.icon&&(b.icon=a.icon),a.color&&(b.color=a.color),a.type&&b.classes.add("notification-"+a.type),a.timeout&&(a.timeout<0||a.timeout>0)&&!a.closeButton?b.closeButton=!1:(b.classes.add("has-close"),b.closeButton=!0),a.progressBar&&(b.progressBar=new rd),b.on("click",function(a){-1!==a.target.className.indexOf(b.classPrefix+"close")&&b.close()})},renderHtml:function(){var a=this,b=a.classPrefix,c="",d="",e="",f="";return a.icon&&(c='<i class="'+b+"ico "+b+"i-"+a.icon+'"></i>'),f=' style="max-width: '+a.maxWidth+"px;"+(a.color?"background-color: "+a.color+';"':'"'),a.closeButton&&(d='<button type="button" class="'+b+'close" aria-hidden="true"></button>'),a.progressBar&&(e=a.progressBar.renderHtml()),'<div id="'+a._id+'" class="'+a.classes+'"'+f+' role="presentation">'+c+'<div class="'+b+'notification-inner">'+a.state.get("text")+"</div>"+e+d+'<div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div></div>'},postRender:function(){var a=this;return qa.setTimeout(function(){a.$el.addClass(a.classPrefix+"in"),sd(a,a.state.get("text"))},100),a._super()},bindStates:function(){var a=this;return a.state.on("change:text",function(b){a.getEl().firstChild.innerHTML=b.value,sd(a,b.value)}),a.progressBar&&(a.progressBar.bindStates(),a.progressBar.state.on("change:value",function(b){sd(a,a.state.get("text"))})),a._super()},close:function(){var a=this;return a.fire("close").isDefaultPrevented()||a.remove(),a},repaint:function(){var a,b,c=this;a=c.getEl().style,b=c._layoutRect,a.left=b.x+"px",a.top=b.y+"px",a.zIndex=65534}}),ud=[],vd="",wd=hd.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(a){var b=this;b._super(a),b.isRtl()&&b.classes.add("rtl"),b.classes.add("window"),b.bodyClasses.add("window-body"),b.state.set("fixed",!0),a.buttons&&(b.statusbar=new dd({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:b.isRtl()?"start":"end",defaults:{type:"button"},items:a.buttons}),b.statusbar.classes.add("foot"),b.statusbar.parent(b)),b.on("click",function(a){var c=b.classPrefix+"close";(rc.hasClass(a.target,c)||rc.hasClass(a.target.parentNode,c))&&b.close()}),b.on("cancel",function(){b.close()}),b.on("move",function(a){a.control===b&&hd.hideAll()}),b.aria("describedby",b.describedBy||b._id+"-none"),b.aria("label",a.title),b._fullscreen=!1},recalc:function(){var a,b,c,d,e=this,f=e.statusbar;e._fullscreen&&(e.layoutRect(rc.getWindowSize()),e.layoutRect().contentH=e.layoutRect().innerH),e._super(),a=e.layoutRect(),e.settings.title&&!e._fullscreen&&(b=a.headerW)>a.w&&(c=a.x-Math.max(0,b/2),e.layoutRect({w:b,x:c}),d=!0),f&&(f.layoutRect({w:e.layoutRect().innerW}).recalc(),(b=f.layoutRect().minW+a.deltaW)>a.w&&(c=a.x-Math.max(0,b-a.w),e.layoutRect({w:b,x:c}),d=!0)),d&&e.recalc()},initLayoutRect:function(){var a,b=this,c=b._super(),d=0;if(b.settings.title&&!b._fullscreen){a=b.getEl("head");var e=rc.getSize(a);c.headerW=e.width,c.headerH=e.height,d+=c.headerH}b.statusbar&&(d+=b.statusbar.layoutRect().h),c.deltaH+=d,c.minH+=d,c.h+=d;var f=rc.getWindowSize();return c.x=b.settings.x||Math.max(0,f.w/2-c.w/2),c.y=b.settings.y||Math.max(0,f.h/2-c.h/2),c},renderHtml:function(){var a=this,b=a._layout,c=a._id,d=a.classPrefix,e=a.settings,f="",g="",h=e.html;return a.preRender(),b.preRender(a),e.title&&(f='<div id="'+c+'-head" class="'+d+'window-head"><div id="'+c+'-title" class="'+d+'title">'+a.encode(e.title)+'</div><div id="'+c+'-dragh" class="'+d+'dragh"></div><button type="button" class="'+d+'close" aria-hidden="true"><i class="mce-ico mce-i-remove"></i></button></div>'),e.url&&(h='<iframe src="'+e.url+'" tabindex="-1"></iframe>'),void 0===h&&(h=b.renderHtml(a)),a.statusbar&&(g=a.statusbar.renderHtml()),'<div id="'+c+'" class="'+a.classes+'" hidefocus="1"><div class="'+a.classPrefix+'reset" role="application">'+f+'<div id="'+c+'-body" class="'+a.bodyClasses+'">'+h+"</div>"+g+"</div></div>"},fullscreen:function(a){var b,c,d=this,e=document.documentElement,f=d.classPrefix;if(a!==d._fullscreen)if(pc(window).on("resize",function(){var a;if(d._fullscreen)if(b)d._timer||(d._timer=qa.setTimeout(function(){var a=rc.getWindowSize();d.moveTo(0,0).resizeTo(a.w,a.h),d._timer=0},50));else{a=(new Date).getTime();var c=rc.getWindowSize();d.moveTo(0,0).resizeTo(c.w,c.h),(new Date).getTime()-a>50&&(b=!0)}}),c=d.layoutRect(),d._fullscreen=a,a){d._initial={x:c.x,y:c.y,w:c.w,h:c.h},d.borderBox=Ac.parseBox("0"),d.getEl("head").style.display="none",c.deltaH-=c.headerH+2,pc([e,document.body]).addClass(f+"fullscreen"),d.classes.add("fullscreen");var g=rc.getWindowSize();d.moveTo(0,0).resizeTo(g.w,g.h)}else d.borderBox=Ac.parseBox(d.settings.border),d.getEl("head").style.display="",c.deltaH+=c.headerH,pc([e,document.body]).removeClass(f+"fullscreen"),d.classes.remove("fullscreen"),d.moveTo(d._initial.x,d._initial.y).resizeTo(d._initial.w,d._initial.h);return d.reflow()},postRender:function(){var a,b=this;setTimeout(function(){b.classes.add("in"),b.fire("open")},0),b._super(),b.statusbar&&b.statusbar.postRender(),b.focus(),this.dragHelper=new l(b._id+"-dragh",{start:function(){a={x:b.layoutRect().x,y:b.layoutRect().y}},drag:function(c){b.moveTo(a.x+c.deltaX,a.y+c.deltaY)}}),b.on("submit",function(a){a.isDefaultPrevented()||b.close()}),ud.push(b),w(!0)},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var a,b=this;for(b.dragHelper.destroy(),b._super(),b.statusbar&&this.statusbar.remove(),x(b.classPrefix,!1),a=ud.length;a--;)ud[a]===b&&ud.splice(a,1);w(ud.length>0)},getContentWindow:function(){var a=this.getEl().getElementsByTagName("iframe")[0];return a?a.contentWindow:null}});!function(){function a(){var a,b,c=rc.getWindowSize();for(a=0;a<ud.length;a++)b=ud[a].layoutRect(),ud[a].moveTo(ud[a].settings.x||Math.max(0,c.w/2-b.w/2),ud[a].settings.y||Math.max(0,c.h/2-b.h/2))}if(!Yb.desktop){var b={
w:window.innerWidth,h:window.innerHeight};qa.setInterval(function(){var a=window.innerWidth,c=window.innerHeight;b.w===a&&b.h===c||(b={w:a,h:c},pc(window).trigger("resize"))},100)}pc(window).on("resize",a)}();var xd=wd.extend({init:function(a){a={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(a)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(a){function b(a,b,c){return{type:"button",text:a,subtype:c?"primary":"",onClick:function(a){a.control.parents()[1].close(),d(b)}}}var c,d=a.callback||function(){};switch(a.buttons){case xd.OK_CANCEL:c=[b("Ok",!0,!0),b("Cancel",!1)];break;case xd.YES_NO:case xd.YES_NO_CANCEL:c=[b("Yes",1,!0),b("No",0)],a.buttons===xd.YES_NO_CANCEL&&c.push(b("Cancel",-1));break;default:c=[b("Ok",!0,!0)]}return new wd({padding:20,x:a.x,y:a.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:c,title:a.title,role:"alertdialog",items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:a.text},onPostRender:function(){this.aria("describedby",this.items()[0]._id)},onClose:a.onClose,onCancel:function(){d(!1)}}).renderTo(document.body).reflow()},alert:function(a,b){return"string"==typeof a&&(a={text:a}),a.callback=b,xd.msgBox(a)},confirm:function(a,b){return"string"==typeof a&&(a={text:a}),a.callback=b,a.buttons=xd.OK_CANCEL,xd.msgBox(a)}}}),yd=function(a){return{renderUI:function(b){return od.renderUI(a,this,b)},resizeTo:function(b,c){return Xb.resizeTo(a,b,c)},resizeBy:function(b,c){return Xb.resizeBy(a,b,c)},getNotificationManagerImpl:function(){return v(a)},getWindowManagerImpl:function(){return z(a)}}},zd={get:yd},Ad=yc.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(a){this.settings=M.extend({},this.Defaults,a)},preRender:function(a){a.bodyClasses.add(this.settings.containerClass)},applyClasses:function(a){var b,c,d,e,f=this,g=f.settings;b=g.firstControlClass,c=g.lastControlClass,a.each(function(a){a.classes.remove(b).remove(c).add(g.controlClass),a.visible()&&(d||(d=a),e=a)}),d&&d.classes.add(b),e&&e.classes.add(c)},renderHtml:function(a){var b=this,c="";return b.applyClasses(a.items()),a.items().each(function(a){c+=a.renderHtml()}),c},recalc:function(){},postRender:function(){},isNative:function(){return!1}}),Bd=Ad.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(a){a.items().filter(":visible").each(function(a){var b=a.settings;a.layoutRect({x:b.x,y:b.y,w:b.w,h:b.h}),a.recalc&&a.recalc()})},renderHtml:function(a){return'<div id="'+a._id+'-absend" class="'+a.classPrefix+'abs-end"></div>'+this._super(a)}}),Cd=qd.extend({Defaults:{classes:"widget btn",role:"button"},init:function(a){var b,c=this;c._super(a),a=c.settings,b=c.settings.size,c.on("click mousedown",function(a){a.preventDefault()}),c.on("touchstart",function(a){c.fire("click",a),a.preventDefault()}),a.subtype&&c.classes.add(a.subtype),b&&c.classes.add("btn-"+b),a.icon&&c.icon(a.icon)},icon:function(a){return arguments.length?(this.state.set("icon",a),this):this.state.get("icon")},repaint:function(){var a,b=this.getEl().firstChild;b&&(a=b.style,a.width=a.height="100%"),this._super()},renderHtml:function(){var a,b,c=this,d=c._id,e=c.classPrefix,f=c.state.get("icon"),g=c.state.get("text"),h="",i=c.settings;return a=i.image,a?(f="none","string"!=typeof a&&(a=window.getSelection?a[0]:a[1]),a=" style=\"background-image: url('"+a+"')\""):a="",g&&(c.classes.add("btn-has-text"),h='<span class="'+e+'txt">'+c.encode(g)+"</span>"),f=f?e+"ico "+e+"i-"+f:"",b="boolean"==typeof i.active?' aria-pressed="'+i.active+'"':"",'<div id="'+d+'" class="'+c.classes+'" tabindex="-1"'+b+'><button id="'+d+'-button" role="presentation" type="button" tabindex="-1">'+(f?'<i class="'+f+'"'+a+"></i>":"")+h+"</button></div>"},bindStates:function(){function a(a){var e=c("span."+d,b.getEl());a?(e[0]||(c("button:first",b.getEl()).append('<span class="'+d+'"></span>'),e=c("span."+d,b.getEl())),e.html(b.encode(a))):e.remove(),b.classes.toggle("btn-has-text",!!a)}var b=this,c=b.$,d=b.classPrefix+"txt";return b.state.on("change:text",function(b){a(b.value)}),b.state.on("change:icon",function(c){var d=c.value,e=b.classPrefix;b.settings.icon=d,d=d?e+"ico "+e+"i-"+b.settings.icon:"";var f=b.getEl().firstChild,g=f.getElementsByTagName("i")[0];d?(g&&g===f.firstChild||(g=document.createElement("i"),f.insertBefore(g,f.firstChild)),g.className=d):g&&f.removeChild(g),a(b.state.get("text"))}),b._super()}}),Dd=Cd.extend({init:function(a){var b=this;a=M.extend({text:"Browse...",multiple:!1,accept:null},a),b._super(a),b.classes.add("browsebutton"),a.multiple&&b.classes.add("multiple")},postRender:function(){var a=this,b=rc.create("input",{type:"file",id:a._id+"-browse",accept:a.settings.accept});a._super(),pc(b).on("change",function(b){var c=b.target.files;a.value=function(){return c.length?a.settings.multiple?c:c[0]:null},b.preventDefault(),c.length&&a.fire("change",b)}),pc(b).on("click",function(a){a.stopPropagation()}),pc(a.getEl("button")).on("click",function(a){a.stopPropagation(),b.click()}),a.getEl().appendChild(b)},remove:function(){pc(this.getEl("button")).off(),pc(this.getEl("input")).off(),this._super()}}),Ed=bd.extend({Defaults:{defaultType:"button",role:"group"},renderHtml:function(){var a=this,b=a._layout;return a.classes.add("btn-group"),a.preRender(),b.preRender(a),'<div id="'+a._id+'" class="'+a.classes+'"><div id="'+a._id+'-body">'+(a.settings.html||"")+b.renderHtml(a)+"</div></div>"}}),Fd=qd.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(a){var b=this;b._super(a),b.on("click mousedown",function(a){a.preventDefault()}),b.on("click",function(a){a.preventDefault(),b.disabled()||b.checked(!b.checked())}),b.checked(b.settings.checked)},checked:function(a){return arguments.length?(this.state.set("checked",a),this):this.state.get("checked")},value:function(a){return arguments.length?this.checked(a):this.checked()},renderHtml:function(){var a=this,b=a._id,c=a.classPrefix;return'<div id="'+b+'" class="'+a.classes+'" unselectable="on" aria-labelledby="'+b+'-al" tabindex="-1"><i class="'+c+"ico "+c+'i-checkbox"></i><span id="'+b+'-al" class="'+c+'label">'+a.encode(a.state.get("text"))+"</span></div>"},bindStates:function(){function a(a){b.classes.toggle("checked",a),b.aria("checked",a)}var b=this;return b.state.on("change:text",function(a){b.getEl("al").firstChild.data=b.translate(a.value)}),b.state.on("change:checked change:value",function(c){b.fire("change"),a(c.value)}),b.state.on("change:icon",function(a){var c=a.value,d=b.classPrefix;if(void 0===c)return b.settings.icon;b.settings.icon=c,c=c?d+"ico "+d+"i-"+b.settings.icon:"";var e=b.getEl().firstChild,f=e.getElementsByTagName("i")[0];c?(f&&f===e.firstChild||(f=document.createElement("i"),e.insertBefore(f,e.firstChild)),f.className=c):f&&e.removeChild(f)}),b.state.get("checked")&&a(!0),b._super()}}),Gd=tinymce.util.Tools.resolve("tinymce.util.VK"),Hd=qd.extend({init:function(a){var b=this;b._super(a),a=b.settings,b.classes.add("combobox"),b.subinput=!0,b.ariaTarget="inp",a.menu=a.menu||a.values,a.menu&&(a.icon="caret"),b.on("click",function(c){var d=c.target,e=b.getEl();if(pc.contains(e,d)||d===e)for(;d&&d!==e;)d.id&&-1!==d.id.indexOf("-open")&&(b.fire("action"),a.menu&&(b.showMenu(),c.aria&&b.menu.items()[0].focus())),d=d.parentNode}),b.on("keydown",function(a){var c;13===a.keyCode&&"INPUT"===a.target.nodeName&&(a.preventDefault(),b.parents().reverse().each(function(a){if(a.toJSON)return c=a,!1}),b.fire("submit",{data:c.toJSON()}))}),b.on("keyup",function(a){if("INPUT"===a.target.nodeName){var c=b.state.get("value"),d=a.target.value;d!==c&&(b.state.set("value",d),b.fire("autocomplete",a))}}),b.on("mouseover",function(a){var c=b.tooltip().moveTo(-65535);if(b.statusLevel()&&-1!==a.target.className.indexOf(b.classPrefix+"status")){var d=b.statusMessage()||"Ok",e=c.text(d).show().testMoveRel(a.target,["bc-tc","bc-tl","bc-tr"]);c.classes.toggle("tooltip-n","bc-tc"===e),c.classes.toggle("tooltip-nw","bc-tl"===e),c.classes.toggle("tooltip-ne","bc-tr"===e),c.moveRel(a.target,e)}})},statusLevel:function(a){return arguments.length>0&&this.state.set("statusLevel",a),this.state.get("statusLevel")},statusMessage:function(a){return arguments.length>0&&this.state.set("statusMessage",a),this.state.get("statusMessage")},showMenu:function(){var a,b=this,c=b.settings;b.menu||(a=c.menu||[],a.length?a={type:"menu",items:a}:a.type=a.type||"menu",b.menu=ga.create(a).parent(b).renderTo(b.getContainerElm()),b.fire("createmenu"),b.menu.reflow(),b.menu.on("cancel",function(a){a.control===b.menu&&b.focus()}),b.menu.on("show hide",function(a){a.control.items().each(function(a){a.active(a.value()===b.value())})}).fire("show"),b.menu.on("select",function(a){b.value(a.control.value())}),b.on("focusin",function(a){"INPUT"===a.target.tagName.toUpperCase()&&b.menu.hide()}),b.aria("expanded",!0)),b.menu.show(),b.menu.layoutRect({w:b.layoutRect().w}),b.menu.moveRel(b.getEl(),b.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},focus:function(){this.getEl("inp").focus()},repaint:function(){var a,b,c=this,d=c.getEl(),e=c.getEl("open"),f=c.layoutRect(),g=0,h=d.firstChild;c.statusLevel()&&"none"!==c.statusLevel()&&(g=parseInt(rc.getRuntimeStyle(h,"padding-right"),10)-parseInt(rc.getRuntimeStyle(h,"padding-left"),10)),a=e?f.w-rc.getSize(e).width-10:f.w-10;var i=document;return i.all&&(!i.documentMode||i.documentMode<=8)&&(b=c.layoutRect().h-2+"px"),pc(h).css({width:a-g,lineHeight:b}),c._super(),c},postRender:function(){var a=this;return pc(this.getEl("inp")).on("change",function(b){a.state.set("value",b.target.value),a.fire("change",b)}),a._super()},renderHtml:function(){var a,b,c=this,d=c._id,e=c.settings,f=c.classPrefix,g=c.state.get("value")||"",h="",i="",j="";return"spellcheck"in e&&(i+=' spellcheck="'+e.spellcheck+'"'),e.maxLength&&(i+=' maxlength="'+e.maxLength+'"'),e.size&&(i+=' size="'+e.size+'"'),e.subtype&&(i+=' type="'+e.subtype+'"'),j='<i id="'+d+'-status" class="mce-status mce-ico" style="display: none"></i>',c.disabled()&&(i+=' disabled="disabled"'),a=e.icon,a&&"caret"!==a&&(a=f+"ico "+f+"i-"+e.icon),b=c.state.get("text"),(a||b)&&(h='<div id="'+d+'-open" class="'+f+"btn "+f+'open" tabIndex="-1" role="button"><button id="'+d+'-action" type="button" hidefocus="1" tabindex="-1">'+("caret"!==a?'<i class="'+a+'"></i>':'<i class="'+f+'caret"></i>')+(b?(a?" ":"")+b:"")+"</button></div>",c.classes.add("has-open")),'<div id="'+d+'" class="'+c.classes+'"><input id="'+d+'-inp" class="'+f+'textbox" value="'+c.encode(g,!1)+'" hidefocus="1"'+i+' placeholder="'+c.encode(e.placeholder)+'" />'+j+h+"</div>"},value:function(a){return arguments.length?(this.state.set("value",a),this):(this.state.get("rendered")&&this.state.set("value",this.getEl("inp").value),this.state.get("value"))},showAutoComplete:function(a,b){var c=this;if(0===a.length)return void c.hideMenu();var d=function(a,b){return function(){c.fire("selectitem",{title:b,value:a})}};c.menu?c.menu.items().remove():c.menu=ga.create({type:"menu",classes:"combobox-menu",layout:"flow"}).parent(c).renderTo(),M.each(a,function(a){c.menu.add({text:a.title,url:a.previewUrl,match:b,classes:"menu-item-ellipsis",onclick:d(a.value,a.title)})}),c.menu.renderNew(),c.hideMenu(),c.menu.on("cancel",function(a){a.control.parent()===c.menu&&(a.stopPropagation(),c.focus(),c.hideMenu())}),c.menu.on("select",function(){c.focus()});var e=c.layoutRect().w;c.menu.layoutRect({w:e,minW:0,maxW:e}),c.menu.repaint(),c.menu.reflow(),c.menu.show(),c.menu.moveRel(c.getEl(),c.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},hideMenu:function(){this.menu&&this.menu.hide()},bindStates:function(){var a=this;a.state.on("change:value",function(b){a.getEl("inp").value!==b.value&&(a.getEl("inp").value=b.value)}),a.state.on("change:disabled",function(b){a.getEl("inp").disabled=b.value}),a.state.on("change:statusLevel",function(b){var c=a.getEl("status"),d=a.classPrefix,e=b.value;rc.css(c,"display","none"===e?"none":""),rc.toggleClass(c,d+"i-checkmark","ok"===e),rc.toggleClass(c,d+"i-warning","warn"===e),rc.toggleClass(c,d+"i-error","error"===e),a.classes.toggle("has-status","none"!==e),a.repaint()}),rc.on(a.getEl("status"),"mouseleave",function(){a.tooltip().hide()}),a.on("cancel",function(b){a.menu&&a.menu.visible()&&(b.stopPropagation(),a.hideMenu())});var b=function(a,b){b&&b.items().length>0&&b.items().eq(a)[0].focus()};return a.on("keydown",function(c){var d=c.keyCode;"INPUT"===c.target.nodeName&&(d===Gd.DOWN?(c.preventDefault(),a.fire("autocomplete"),b(0,a.menu)):d===Gd.UP&&(c.preventDefault(),b(-1,a.menu)))}),a._super()},remove:function(){pc(this.getEl("inp")).off(),this.menu&&this.menu.remove(),this._super()}}),Id=Hd.extend({init:function(a){var b=this;a.spellcheck=!1,a.onaction&&(a.icon="none"),b._super(a),b.classes.add("colorbox"),b.on("change keyup postrender",function(){b.repaintColor(b.value())})},repaintColor:function(a){var b=this.getEl("open"),c=b?b.getElementsByTagName("i")[0]:null;if(c)try{c.style.background=a}catch(a){}},bindStates:function(){var a=this;return a.state.on("change:value",function(b){a.state.get("rendered")&&a.repaintColor(b.value)}),a._super()}}),Jd=Cd.extend({showPanel:function(){var a=this,b=a.settings;if(a.classes.add("opened"),a.panel)a.panel.show();else{var c=b.panel;c.type&&(c={layout:"grid",items:c}),c.role=c.role||"dialog",c.popover=!0,c.autohide=!0,c.ariaRoot=!0,a.panel=new hd(c).on("hide",function(){a.classes.remove("opened")}).on("cancel",function(b){b.stopPropagation(),a.focus(),a.hidePanel()}).parent(a).renderTo(a.getContainerElm()),a.panel.fire("show"),a.panel.reflow()}var d=["bc-tc","bc-tl","bc-tr"],e=["bc-tc","bc-tr","bc-tl","tc-bc","tc-br","tc-bl"],f=a.panel.testMoveRel(a.getEl(),b.popoverAlign||(a.isRtl()?d:e));a.panel.classes.toggle("start","l"===f.substr(-1)),a.panel.classes.toggle("end","r"===f.substr(-1));var g="t"===f.substr(0,1);a.panel.classes.toggle("bottom",!g),a.panel.classes.toggle("top",g),a.panel.moveRel(a.getEl(),f)},hidePanel:function(){var a=this;a.panel&&a.panel.hide()},postRender:function(){var a=this;return a.aria("haspopup",!0),a.on("click",function(b){b.control===a&&(a.panel&&a.panel.visible()?a.hidePanel():(a.showPanel(),a.panel.focus(!!b.aria)))}),a._super()},remove:function(){return this.panel&&(this.panel.remove(),this.panel=null),this._super()}}),Kd=fa.DOM,Ld=Jd.extend({init:function(a){this._super(a),this.classes.add("splitbtn"),this.classes.add("colorbutton")},color:function(a){return a?(this._color=a,this.getEl("preview").style.backgroundColor=a,this):this._color},resetColor:function(){return this._color=null,this.getEl("preview").style.backgroundColor=null,this},renderHtml:function(){var a=this,b=a._id,c=a.classPrefix,d=a.state.get("text"),e=a.settings.icon?c+"ico "+c+"i-"+a.settings.icon:"",f=a.settings.image?" style=\"background-image: url('"+a.settings.image+"')\"":"",g="";return d&&(a.classes.add("btn-has-text"),g='<span class="'+c+'txt">'+a.encode(d)+"</span>"),'<div id="'+b+'" class="'+a.classes+'" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">'+(e?'<i class="'+e+'"'+f+"></i>":"")+'<span id="'+b+'-preview" class="'+c+'preview"></span>'+g+'</button><button type="button" class="'+c+'open" hidefocus="1" tabindex="-1"> <i class="'+c+'caret"></i></button></div>'},postRender:function(){var a=this,b=a.settings.onclick;return a.on("click",function(c){c.aria&&"down"===c.aria.key||c.control!==a||Kd.getParent(c.target,"."+a.classPrefix+"open")||(c.stopImmediatePropagation(),b.call(a,c))}),delete a.settings.onclick,a._super()}}),Md=tinymce.util.Tools.resolve("tinymce.util.Color"),Nd=qd.extend({Defaults:{classes:"widget colorpicker"},init:function(a){this._super(a)},postRender:function(){function a(a,b){var c,d,e=rc.getPos(a);return c=b.pageX-e.x,d=b.pageY-e.y,c=Math.max(0,Math.min(c/a.clientWidth,1)),d=Math.max(0,Math.min(d/a.clientHeight,1)),{x:c,y:d}}function b(a,b){var c=(360-a.h)/360;rc.css(g,{top:100*c+"%"}),b||rc.css(i,{left:a.s+"%",top:100-a.v+"%"}),h.style.background=Md({s:100,v:100,h:a.h}).toHex(),j.color().parse({s:a.s,v:a.v,h:a.h})}function c(c){var d;d=a(h,c),e.s=100*d.x,e.v=100*(1-d.y),b(e),j.fire("change")}function d(c){var d;d=a(f,c),e=k.toHsv(),e.h=360*(1-d.y),b(e,!0),j.fire("change")}var e,f,g,h,i,j=this,k=j.color();f=j.getEl("h"),g=j.getEl("hp"),h=j.getEl("sv"),i=j.getEl("svp"),j._repaint=function(){e=k.toHsv(),b(e)},j._super(),j._svdraghelper=new l(j._id+"-sv",{start:c,drag:c}),j._hdraghelper=new l(j._id+"-h",{start:d,drag:d}),j._repaint()},rgb:function(){return this.color().toRgb()},value:function(a){var b=this;if(!arguments.length)return b.color().toHex();b.color().parse(a),b._rendered&&b._repaint()},color:function(){return this._color||(this._color=Md()),this._color},renderHtml:function(){var a,b=this,c=b._id,d=b.classPrefix,e="#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000";return a='<div id="'+c+'-h" class="'+d+'colorpicker-h" style="background: -ms-linear-gradient(top,'+e+");background: linear-gradient(to bottom,"+e+');">'+function(){var a,b,c,f,g="";for(c="filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=",f=e.split(","),a=0,b=f.length-1;a<b;a++)g+='<div class="'+d+'colorpicker-h-chunk" style="height:'+100/b+"%;"+c+f[a]+",endColorstr="+f[a+1]+");-ms-"+c+f[a]+",endColorstr="+f[a+1]+')"></div>';return g}()+'<div id="'+c+'-hp" class="'+d+'colorpicker-h-marker"></div></div>','<div id="'+c+'" class="'+b.classes+'"><div id="'+c+'-sv" class="'+d+'colorpicker-sv"><div class="'+d+'colorpicker-overlay1"><div class="'+d+'colorpicker-overlay2"><div id="'+c+'-svp" class="'+d+'colorpicker-selector1"><div class="'+d+'colorpicker-selector2"></div></div></div></div></div>'+a+"</div>"}}),Od=qd.extend({init:function(a){var b=this;a=M.extend({height:100,text:"Drop an image here",multiple:!1,accept:null},a),b._super(a),b.classes.add("dropzone"),a.multiple&&b.classes.add("multiple")},renderHtml:function(){var a,b,c=this,d=c.settings;return a={id:c._id,hidefocus:"1"},b=rc.create("div",a,"<span>"+this.translate(d.text)+"</span>"),d.height&&rc.css(b,"height",d.height+"px"),d.width&&rc.css(b,"width",d.width+"px"),b.className=c.classes,b.outerHTML},postRender:function(){var a=this,b=function(b){b.preventDefault(),a.classes.toggle("dragenter"),a.getEl().className=a.classes},c=function(b){var c=a.settings.accept;if("string"!=typeof c)return b;var d=new RegExp("("+c.split(/\s*,\s*/).join("|")+")$","i");return M.grep(b,function(a){return d.test(a.name)})};a._super(),a.$el.on("dragover",function(a){a.preventDefault()}),a.$el.on("dragenter",b),a.$el.on("dragleave",b),a.$el.on("drop",function(b){if(b.preventDefault(),!a.state.get("disabled")){var d=c(b.dataTransfer.files);a.value=function(){return d.length?a.settings.multiple?d:d[0]:null},d.length&&a.fire("change",b)}})},remove:function(){this.$el.off(),this._super()}}),Pd=qd.extend({init:function(a){var b=this;a.delimiter||(a.delimiter=""),b._super(a),b.classes.add("path"),b.canFocus=!0,b.on("click",function(a){var c;(c=a.target.getAttribute("data-index"))&&b.fire("select",{value:b.row()[c],index:c})}),b.row(b.settings.row)},focus:function(){var a=this;return a.getEl().firstChild.focus(),a},row:function(a){return arguments.length?(this.state.set("row",a),this):this.state.get("row")},renderHtml:function(){var a=this;return'<div id="'+a._id+'" class="'+a.classes+'">'+a._getDataPathHtml(a.state.get("row"))+"</div>"},bindStates:function(){var a=this;return a.state.on("change:row",function(b){a.innerHtml(a._getDataPathHtml(b.value))}),a._super()},_getDataPathHtml:function(a){var b,c,d=this,e=a||[],f="",g=d.classPrefix;for(b=0,c=e.length;b<c;b++)f+=(b>0?'<div class="'+g+'divider" aria-hidden="true"> '+d.settings.delimiter+" </div>":"")+'<div role="button" class="'+g+"path-item"+(b===c-1?" "+g+"last":"")+'" data-index="'+b+'" tabindex="-1" id="'+d._id+"-"+b+'" aria-level="'+(b+1)+'">'+e[b].name+"</div>";return f||(f='<div class="'+g+'path-item"></div>'),f}}),Qd=Pd.extend({postRender:function(){function a(a){if(1===a.nodeType){if("BR"===a.nodeName||a.getAttribute("data-mce-bogus"))return!0;if("bookmark"===a.getAttribute("data-mce-type"))return!0}return!1}var b=this,c=b.settings.editor;return!1!==c.settings.elementpath&&(b.on("select",function(a){c.focus(),c.selection.select(this.row()[a.index].element),c.nodeChanged()}),c.on("nodeChange",function(d){for(var e=[],f=d.parents,g=f.length;g--;)if(1===f[g].nodeType&&!a(f[g])){var h=c.fire("ResolveName",{name:f[g].nodeName.toLowerCase(),target:f[g]});if(h.isDefaultPrevented()||e.push({name:h.name,element:f[g]}),h.isPropagationStopped())break}b.row(e)})),b._super()}}),Rd=bd.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var a=this,b=a._layout,c=a.classPrefix;return a.classes.add("formitem"),b.preRender(a),'<div id="'+a._id+'" class="'+a.classes+'" hidefocus="1" tabindex="-1">'+(a.settings.title?'<div id="'+a._id+'-title" class="'+c+'title">'+a.settings.title+"</div>":"")+'<div id="'+a._id+'-body" class="'+a.bodyClasses+'">'+(a.settings.html||"")+b.renderHtml(a)+"</div></div>"}}),Sd=bd.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:15,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var a=this,b=a.items();a.settings.formItemDefaults||(a.settings.formItemDefaults={layout:"flex",autoResize:"overflow",defaults:{flex:1}}),b.each(function(b){var c,d=b.settings.label;d&&(c=new Rd(M.extend({items:{type:"label",id:b._id+"-l",text:d,flex:0,forId:b._id,disabled:b.disabled()}},a.settings.formItemDefaults)),c.type="formitem",b.aria("labelledby",b._id+"-l"),void 0===b.settings.flex&&(b.settings.flex=1),a.replace(b,c),c.add(b))})},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var a=this;a._super(),a.fromJSON(a.settings.data)},bindStates:function(){function a(){var a,c,d,e=0,f=[];if(!1!==b.settings.labelGapCalc)for(d="children"===b.settings.labelGapCalc?b.find("formitem"):b.items(),d.filter("formitem").each(function(a){var b=a.items()[0],c=b.getEl().clientWidth;e=c>e?c:e,f.push(b)}),c=b.settings.labelGap||0,a=f.length;a--;)f[a].settings.minWidth=e+c}var b=this;b._super(),b.on("show",a),a()}}),Td=Sd.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var a=this,b=a._layout,c=a.classPrefix;return a.preRender(),b.preRender(a),'<fieldset id="'+a._id+'" class="'+a.classes+'" hidefocus="1" tabindex="-1">'+(a.settings.title?'<legend id="'+a._id+'-title" class="'+c+'fieldset-title">'+a.settings.title+"</legend>":"")+'<div id="'+a._id+'-body" class="'+a.bodyClasses+'">'+(a.settings.html||"")+b.renderHtml(a)+"</div></fieldset>"}}),Ud=0,Vd=function(a){var b=new Date,c=b.getTime(),d=Math.floor(1e9*Math.random());return Ud++,a+"_"+d+Ud+String(c)},Wd={generate:Vd},Xd=function(a,b){var c=b||document,d=c.createElement("div");if(d.innerHTML=a,!d.hasChildNodes()||d.childNodes.length>1)throw console.error("HTML does not have a single root node",a),"HTML must have a single root node";return $d(d.childNodes[0])},Yd=function(a,b){var c=b||document,d=c.createElement(a);return $d(d)},Zd=function(a,b){var c=b||document,d=c.createTextNode(a);return $d(d)},$d=function(a){if(null===a||void 0===a)throw new Error("Node cannot be null or undefined");return{dom:Ea.constant(a)}},_d=function(a,b,c){return La.from(a.dom().elementFromPoint(b,c)).map($d)},ae={fromHtml:Xd,fromTag:Yd,fromText:Zd,fromDom:$d,fromPoint:_d},be=function(a){var b,c=!1;return function(){return c||(c=!0,b=a.apply(null,arguments)),b}},ce={cached:be},de={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},ee=function(a){return a.dom().nodeName.toLowerCase()},fe=function(a){return a.dom().nodeType},ge=function(a){return a.dom().nodeValue},he=function(a){return function(b){return fe(b)===a}},ie=function(a){return fe(a)===de.COMMENT||"#comment"===ee(a)},je=he(de.ELEMENT),ke=he(de.TEXT),le=he(de.DOCUMENT),me={name:ee,type:fe,value:ge,isElement:je,isText:ke,isDocument:le,isComment:ie},ne=function(a){var b=me.isText(a)?a.dom().parentNode:a.dom();return void 0!==b&&null!==b&&b.ownerDocument.body.contains(b)},oe=ce.cached(function(){return pe(ae.fromDom(document))}),pe=function(a){var b=a.dom().body;if(null===b||void 0===b)throw"Body is not available yet";return ae.fromDom(b)},qe={body:oe,getBody:pe,inBody:ne},re=function(){var a=Object.keys,b=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};return void 0===a?b:a}(),se=function(a,b){for(var c=re(a),d=0,e=c.length;d<e;d++){var f=c[d];b(a[f],f,a)}},te=function(a,b){return ue(a,function(a,c,d){return{k:c,v:b(a,c,d)}})},ue=function(a,b){var c={};return se(a,function(d,e){var f=b(d,e,a);c[f.k]=f.v}),c},ve=function(a,b){var c={},d={};return se(a,function(a,e){(b(a,e)?c:d)[e]=a}),{t:c,f:d}},we=function(a,b){var c=[];return se(a,function(a,d){c.push(b(a,d))}),c},xe=function(a,b){for(var c=re(a),d=0,e=c.length;d<e;d++){var f=c[d],g=a[f];if(b(g,f,a))return La.some(g)}return La.none()},ye=function(a){return we(a,function(a){return a})},ze=function(a){return ye(a).length},Ae={bifilter:ve,each:se,map:te,mapToArray:we,tupleMap:ue,find:xe,keys:re,values:ye,size:ze},Be=function(a){return a.slice(0).sort()},Ce=function(a,b){throw new Error("All required keys ("+Be(a).join(", ")+") were not specified. Specified keys were: "+Be(b).join(", ")+".")},De=function(a){throw new Error("Unsupported keys for object: "+Be(a).join(", "))},Ee=function(a,b){if(!cb.isArray(b))throw new Error("The "+a+" fields must be an array. Was: "+b+".");Ib.each(b,function(b){if(!cb.isString(b))throw new Error("The value "+b+" in the "+a+" fields was not a string.")})},Fe=function(a,b){throw new Error("All values need to be of type: "+b+". Keys ("+Be(a).join(", ")+") were not.")},Ge=function(a){var b=Be(a);Ib.find(b,function(a,c){return c<b.length-1&&a===b[c+1]}).each(function(a){throw new Error("The field: "+a+" occurs more than once in the combined fields: ["+b.join(", ")+"].")})},He={sort:Be,reqMessage:Ce,unsuppMessage:De,validateStrArr:Ee,invalidTypeMessage:Fe,checkDupes:Ge},Ie={immutable:A,immutableBag:B},Je=function(a,b){var c=[],d=function(a){return c.push(a),b(a)},e=b(a);do{e=e.bind(d)}while(e.isSome());return c},Ke={toArray:Je},Le="undefined"!=typeof window?window:Function("return this;")(),Me=function(a,b){for(var c=void 0!==b&&null!==b?b:Le,d=0;d<a.length&&void 0!==c&&null!==c;++d)c=c[a[d]];return c},Ne=function(a,b){var c=a.split(".");return Me(c,b)},Oe=function(a,b){return void 0!==a[b]&&null!==a[b]||(a[b]={}),a[b]},Pe=function(a,b){for(var c=void 0!==b?b:Le,d=0;d<a.length;++d)c=Oe(c,a[d]);return c},Qe=function(a,b){var c=a.split(".");return Pe(c,b)},Re={path:Me,resolve:Ne,forge:Pe,namespace:Qe},Se=function(a,b){return Re.resolve(a,b)},Te=function(a,b){var c=Se(a,b);if(void 0===c||null===c)throw a+" not available on this browser";return c},Ue={getOrDie:Te},Ve=function(){return Ue.getOrDie("Node")},We=function(a,b,c){return 0!=(a.compareDocumentPosition(b)&c)},Xe=function(a,b){return We(a,b,Ve().DOCUMENT_POSITION_PRECEDING)},Ye=function(a,b){return We(a,b,Ve().DOCUMENT_POSITION_CONTAINED_BY)},Ze={documentPositionPreceding:Xe,documentPositionContainedBy:Ye},$e=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.test(b))return d}},_e=function(a,b){var c=$e(a,b);if(!c)return{major:0,minor:0};var d=function(a){return Number(b.replace(c,"$"+a))};return cf(d(1),d(2))},af=function(a,b){var c=String(b).toLowerCase();return 0===a.length?bf():_e(a,c)},bf=function(){return cf(0,0)},cf=function(a,b){return{major:a,minor:b}},df={nu:cf,detect:af,unknown:bf},ef=function(a,b){return function(){return b===a}},ff=function(){return gf({current:void 0,version:df.unknown()})},gf=function(a){var b=a.current;return{current:b,version:a.version,isEdge:ef("Edge",b),isChrome:ef("Chrome",b),isIE:ef("IE",b),isOpera:ef("Opera",b),isFirefox:ef("Firefox",b),isSafari:ef("Safari",b)}},hf={unknown:ff,nu:gf,edge:Ea.constant("Edge"),chrome:Ea.constant("Chrome"),ie:Ea.constant("IE"),opera:Ea.constant("Opera"),firefox:Ea.constant("Firefox"),safari:Ea.constant("Safari")},jf=function(a,b){return function(){return b===a}},kf=function(){return lf({current:void 0,version:df.unknown()})},lf=function(a){var b=a.current;return{current:b,version:a.version,isWindows:jf("Windows",b),isiOS:jf("iOS",b),isAndroid:jf("Android",b),isOSX:jf("OSX",b),isLinux:jf("Linux",b),isSolaris:jf("Solaris",b),isFreeBSD:jf("FreeBSD",b)}},mf={unknown:kf,nu:lf,windows:Ea.constant("Windows"),ios:Ea.constant("iOS"),android:Ea.constant("Android"),linux:Ea.constant("Linux"),osx:Ea.constant("OSX"),solaris:Ea.constant("Solaris"),freebsd:Ea.constant("FreeBSD")},nf=function(a,b){var c=String(b).toLowerCase();return Ib.find(a,function(a){return a.search(c)})},of=function(a,b){return nf(a,b).map(function(a){var c=df.detect(a.versionRegexes,b);return{current:a.name,version:c}})},pf=function(a,b){return nf(a,b).map(function(a){var c=df.detect(a.versionRegexes,b);return{current:a.name,version:c}})},qf={detectBrowser:of,detectOs:pf},rf=function(a,b){return b+a},sf=function(a,b){return a+b},tf=function(a,b){return a.substring(b)},uf=function(a,b){return a.substring(0,a.length-b)},vf={addToStart:rf,addToEnd:sf,removeFromStart:tf,removeFromEnd:uf},wf=function(a,b){return a.substr(0,b)},xf=function(a,b){return a.substr(a.length-b,a.length)},yf=function(a){return""===a?La.none():La.some(a.substr(0,1))},zf=function(a){return""===a?La.none():La.some(a.substring(1))},Af={first:wf,last:xf,head:yf,tail:zf},Bf=function(a,b,c){return""===b||!(a.length<b.length)&&a.substr(c,c+b.length)===b},Cf=function(a,b){var c=function(a){var b=typeof a;return"string"===b||"number"===b};return a.replace(/\${([^{}]*)}/g,function(a,d){var e=b[d];return c(e)?e:a})},Df=function(a,b){return Jf(a,b)?vf.removeFromStart(a,b.length):a},Ef=function(a,b){return Kf(a,b)?vf.removeFromEnd(a,b.length):a},Ff=function(a,b){return Jf(a,b)?a:vf.addToStart(a,b)},Gf=function(a,b){return Kf(a,b)?a:vf.addToEnd(a,b)},Hf=function(a,b){return-1!==a.indexOf(b)},If=function(a){return Af.head(a).bind(function(b){return Af.tail(a).map(function(a){return b.toUpperCase()+a})}).getOr(a)},Jf=function(a,b){return Bf(a,b,0)},Kf=function(a,b){return Bf(a,b,a.length-b.length)},Lf=function(a){return a.replace(/^\s+|\s+$/g,"")},Mf=function(a){return a.replace(/^\s+/g,"")},Nf=function(a){return a.replace(/\s+$/g,"")},Of={supplant:Cf,startsWith:Jf,removeLeading:Df,removeTrailing:Ef,ensureLeading:Ff,ensureTrailing:Gf,endsWith:Kf,contains:Hf,trim:Lf,lTrim:Mf,rTrim:Nf,capitalize:If},Pf=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Qf=function(a){return function(b){return Of.contains(b,a)}},Rf=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return Of.contains(a,"edge/")&&Of.contains(a,"chrome")&&Of.contains(a,"safari")&&Of.contains(a,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Pf],search:function(a){return Of.contains(a,"chrome")&&!Of.contains(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return Of.contains(a,"msie")||Of.contains(a,"trident")}},{name:"Opera",versionRegexes:[Pf,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Qf("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Qf("firefox")},{name:"Safari",versionRegexes:[Pf,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(Of.contains(a,"safari")||Of.contains(a,"mobile/"))&&Of.contains(a,"applewebkit")}}],Sf=[{name:"Windows",
search:Qf("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return Of.contains(a,"iphone")||Of.contains(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Qf("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Qf("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Qf("linux"),versionRegexes:[]},{name:"Solaris",search:Qf("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Qf("freebsd"),versionRegexes:[]}],Tf={browsers:Ea.constant(Rf),oses:Ea.constant(Sf)},Uf=function(a){var b=Tf.browsers(),c=Tf.oses(),d=qf.detectBrowser(b,a).fold(hf.unknown,hf.nu),e=qf.detectOs(c,a).fold(mf.unknown,mf.nu);return{browser:d,os:e,deviceType:C(e,d,a)}},Vf={detect:Uf},Wf=ce.cached(function(){var a=navigator.userAgent;return Vf.detect(a)}),Xf={detect:Wf},Yf=de.ELEMENT,Zf=de.DOCUMENT,$f=function(a,b){var c=a.dom();if(c.nodeType!==Yf)return!1;if(void 0!==c.matches)return c.matches(b);if(void 0!==c.msMatchesSelector)return c.msMatchesSelector(b);if(void 0!==c.webkitMatchesSelector)return c.webkitMatchesSelector(b);if(void 0!==c.mozMatchesSelector)return c.mozMatchesSelector(b);throw new Error("Browser lacks native selectors")},_f=function(a){return a.nodeType!==Yf&&a.nodeType!==Zf||0===a.childElementCount},ag=function(a,b){var c=void 0===b?document:b.dom();return _f(c)?[]:Ib.map(c.querySelectorAll(a),ae.fromDom)},bg=function(a,b){var c=void 0===b?document:b.dom();return _f(c)?La.none():La.from(c.querySelector(a)).map(ae.fromDom)},cg={all:ag,is:$f,one:bg},dg=function(a,b){return a.dom()===b.dom()},eg=function(a,b){return a.dom().isEqualNode(b.dom())},fg=function(a,b){return Ib.exists(b,Ea.curry(dg,a))},gg=function(a,b){var c=a.dom(),d=b.dom();return c!==d&&c.contains(d)},hg=function(a,b){return Ze.documentPositionContainedBy(a.dom(),b.dom())},ig=Xf.detect().browser,jg=ig.isIE()?hg:gg,kg={eq:dg,isEqualNode:eg,member:fg,contains:jg,is:cg.is},lg=function(a){return ae.fromDom(a.dom().ownerDocument)},mg=function(a){var b=lg(a);return ae.fromDom(b.dom().documentElement)},ng=function(a){var b=a.dom(),c=b.ownerDocument.defaultView;return ae.fromDom(c)},og=function(a){var b=a.dom();return La.from(b.parentNode).map(ae.fromDom)},pg=function(a){return og(a).bind(function(b){var c=xg(b);return Ib.findIndex(c,function(b){return kg.eq(a,b)})})},qg=function(a,b){for(var c=cb.isFunction(b)?b:Ea.constant(!1),d=a.dom(),e=[];null!==d.parentNode&&void 0!==d.parentNode;){var f=d.parentNode,g=ae.fromDom(f);if(e.push(g),!0===c(g))break;d=f}return e},rg=function(a){var b=function(b){return Ib.filter(b,function(b){return!kg.eq(a,b)})};return og(a).map(xg).map(b).getOr([])},sg=function(a){var b=a.dom();return La.from(b.offsetParent).map(ae.fromDom)},tg=function(a){var b=a.dom();return La.from(b.previousSibling).map(ae.fromDom)},ug=function(a){var b=a.dom();return La.from(b.nextSibling).map(ae.fromDom)},vg=function(a){return Ib.reverse(Ke.toArray(a,tg))},wg=function(a){return Ke.toArray(a,ug)},xg=function(a){var b=a.dom();return Ib.map(b.childNodes,ae.fromDom)},yg=function(a,b){var c=a.dom().childNodes;return La.from(c[b]).map(ae.fromDom)},zg=function(a){return yg(a,0)},Ag=function(a){return yg(a,a.dom().childNodes.length-1)},Bg=function(a){return a.dom().childNodes.length},Cg=function(a){return a.dom().hasChildNodes()},Dg=Ie.immutable("element","offset"),Eg=function(a,b){var c=xg(a);return c.length>0&&b<c.length?Dg(c[b],0):Dg(a,b)},Fg={owner:lg,defaultView:ng,documentElement:mg,parent:og,findIndex:pg,parents:qg,siblings:rg,prevSibling:tg,offsetParent:sg,prevSiblings:vg,nextSibling:ug,nextSiblings:wg,children:xg,child:yg,firstChild:zg,lastChild:Ag,childNodesCount:Bg,hasChildNodes:Cg,leaf:Eg},Gg=function(a){return Kg(qe.body(),a)},Hg=function(a,b,c){return Ib.filter(Fg.parents(a,c),b)},Ig=function(a,b){return Ib.filter(Fg.siblings(a),b)},Jg=function(a,b){return Ib.filter(Fg.children(a),b)},Kg=function(a,b){var c=[];return Ib.each(Fg.children(a),function(a){b(a)&&(c=c.concat([a])),c=c.concat(Kg(a,b))}),c},Lg={all:Gg,ancestors:Hg,siblings:Ig,children:Jg,descendants:Kg},Mg=function(a){return cg.all(a)},Ng=function(a,b,c){return Lg.ancestors(a,function(a){return cg.is(a,b)},c)},Og=function(a,b){return Lg.siblings(a,function(a){return cg.is(a,b)})},Pg=function(a,b){return Lg.children(a,function(a){return cg.is(a,b)})},Qg=function(a,b){return cg.all(b,a)},Rg={all:Mg,ancestors:Ng,siblings:Og,children:Pg,descendants:Qg},Sg=M.trim,Tg=function(a){return function(b){if(b&&1===b.nodeType){if(b.contentEditable===a)return!0;if(b.getAttribute("data-mce-contenteditable")===a)return!0}return!1}},Ug=Tg("true"),Vg=Tg("false"),Wg=function(a,b,c,d,e){return{type:a,title:b,url:c,level:d,attach:e}},Xg=function(a){for(;a=a.parentNode;){var b=a.contentEditable;if(b&&"inherit"!==b)return Ug(a)}return!1},Yg=function(a,b){return Ib.map(Rg.descendants(ae.fromDom(b),a),function(a){return a.dom()})},Zg=function(a){return a.innerText||a.textContent},$g=function(a){return a.id?a.id:Wd.generate("h")},_g=function(a){return a&&"A"===a.nodeName&&(a.id||a.name)},ah=function(a){return _g(a)&&ch(a)},bh=function(a){return a&&/^(H[1-6])$/.test(a.nodeName)},ch=function(a){return Xg(a)&&!Vg(a)},dh=function(a){return bh(a)&&ch(a)},eh=function(a){return bh(a)?parseInt(a.nodeName.substr(1),10):0},fh=function(a){var b=$g(a),c=function(){a.id=b};return Wg("header",Zg(a),"#"+b,eh(a),c)},gh=function(a){var b=a.id||a.name,c=Zg(a);return Wg("anchor",c||"#"+b,"#"+b,0,Ea.noop)},hh=function(a){return Ib.map(Ib.filter(a,dh),fh)},ih=function(a){return Ib.map(Ib.filter(a,ah),gh)},jh=function(a){return Yg("h1,h2,h3,h4,h5,h6,a:not([href])",a)},kh=function(a){return Sg(a.title).length>0},lh=function(a){var b=jh(a);return Ib.filter(hh(b).concat(ih(b)),kh)},mh={find:lh},nh=function(){return window.tinymce?window.tinymce.activeEditor:L.activeEditor},oh={},ph=function(){oh={}},qh=function(a){return{title:a.title,value:{title:{raw:a.title},url:a.url,attach:a.attach}}},rh=function(a){return M.map(a,qh)},sh=function(a,b){return{title:a,value:{title:a,url:b,attach:Ea.noop}}},th=function(a,b){return!Ib.exists(b,function(b){return b.url===a})},uh=function(a,b,c){var d=b in a?a[b]:c;return!1===d?null:d},vh=function(a,b,c,d){var e={title:"-"},f=function(a){var d=a.hasOwnProperty(c)?a[c]:[],e=Ib.filter(d,function(a){return th(a,b)});return M.map(e,function(a){return{title:a,value:{title:a,url:a,attach:Ea.noop}}})},g=function(a){var c=Ib.filter(b,function(b){return b.type===a});return rh(c)};return!1===d.typeahead_urls?[]:"file"===c?function(a){return Ib.foldl(a,function(a,b){return 0===a.length||0===b.length?a.concat(b):a.concat(e,b)},[])}([xh(a,f(oh)),xh(a,g("header")),xh(a,function(){var a=g("anchor"),b=uh(d,"anchor_top","#top"),c=uh(d,"anchor_bottom","#bottom");return null!==b&&a.unshift(sh("<top>",b)),null!==c&&a.push(sh("<bottom>",c)),a}())]):xh(a,f(oh))},wh=function(a,b){var c=oh[b];/^https?/.test(a)&&(c?Ib.indexOf(c,a).isNone()&&(oh[b]=c.slice(0,5).concat(a)):oh[b]=[a])},xh=function(a,b){var c=a.toLowerCase(),d=M.grep(b,function(a){return-1!==a.title.toLowerCase().indexOf(c)});return 1===d.length&&d[0].title===a?[]:d},yh=function(a){var b=a.title;return b.raw?b.raw:b},zh=function(a,b,c,d){var e=function(e){var f=mh.find(c),g=vh(e,f,d,b);a.showAutoComplete(g,e)};a.on("autocomplete",function(){e(a.value())}),a.on("selectitem",function(b){var c=b.value;a.value(c.url);var e=yh(c);"image"===d?a.fire("change",{meta:{alt:e,attach:c.attach}}):a.fire("change",{meta:{text:e,attach:c.attach}}),a.focus()}),a.on("click",function(b){0===a.value().length&&"INPUT"===b.target.nodeName&&e("")}),a.on("PostRender",function(){a.getRoot().on("submit",function(b){b.isDefaultPrevented()||wh(a.value(),d)})})},Ah=function(a){var b=a.status,c=a.message;return"valid"===b?{status:"ok",message:c}:"unknown"===b?{status:"warn",message:c}:"invalid"===b?{status:"warn",message:c}:{status:"none",message:""}},Bh=function(a,b,c){var d=b.filepicker_validator_handler;if(d){var e=function(b){if(0===b.length)return void a.statusLevel("none");d({url:b,type:c},function(b){var c=Ah(b);a.statusMessage(c.message),a.statusLevel(c.status)})};a.state.on("change:value",function(a){e(a.value)})}},Ch=Hd.extend({Statics:{clearHistory:ph},init:function(a){var b,c,d,e=this,f=nh(),g=f.settings,h=a.filetype;a.spellcheck=!1,d=g.file_picker_types||g.file_browser_callback_types,d&&(d=M.makeMap(d,/[, ]/)),d&&!d[h]||(c=g.file_picker_callback,!c||d&&!d[h]?!(c=g.file_browser_callback)||d&&!d[h]||(b=function(){c(e.getEl("inp").id,e.value(),h,window)}):b=function(){var a=e.fire("beforecall").meta;a=M.extend({filetype:h},a),c.call(f,function(a,b){e.value(a).fire("change",{meta:b})},e.value(),a)}),b&&(a.icon="browse",a.onaction=b),e._super(a),e.classes.add("filepicker"),zh(e,g,f.getBody(),h),Bh(e,g,h)}}),Dh=Bd.extend({recalc:function(a){var b=a.layoutRect(),c=a.paddingBox;a.items().filter(":visible").each(function(a){a.layoutRect({x:c.left,y:c.top,w:b.innerW-c.right-c.left,h:b.innerH-c.top-c.bottom}),a.recalc&&a.recalc()})}}),Eh=Bd.extend({recalc:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=[],O=Math.max,P=Math.min;for(d=a.items().filter(":visible"),e=a.layoutRect(),f=a.paddingBox,g=a.settings,m=a.isRtl()?g.direction||"row-reversed":g.direction,h=g.align,i=a.isRtl()?g.pack||"end":g.pack,j=g.spacing||0,"row-reversed"!==m&&"column-reverse"!==m||(d=d.set(d.toArray().reverse()),m=m.split("-")[0]),"column"===m?(z="y",x="h",y="minH",A="maxH",C="innerH",B="top",D="deltaH",E="contentH",J="left",H="w",F="x",G="innerW",I="minW",K="right",L="deltaW",M="contentW"):(z="x",x="w",y="minW",A="maxW",C="innerW",B="left",D="deltaW",E="contentW",J="top",H="h",F="y",G="innerH",I="minH",K="bottom",L="deltaH",M="contentH"),l=e[C]-f[B]-f[B],w=k=0,b=0,c=d.length;b<c;b++)n=d[b],o=n.layoutRect(),p=n.settings,q=p.flex,l-=b<c-1?j:0,q>0&&(k+=q,o[A]&&N.push(n),o.flex=q),l-=o[y],(r=f[J]+o[I]+f[K])>w&&(w=r);if(u={},u[y]=l<0?e[y]-l+e[D]:e[C]-l+e[D],u[I]=w+e[L],u[E]=e[C]-l,u[M]=w,u.minW=P(u.minW,e.maxW),u.minH=P(u.minH,e.maxH),u.minW=O(u.minW,e.startMinWidth),u.minH=O(u.minH,e.startMinHeight),!e.autoResize||u.minW===e.minW&&u.minH===e.minH){for(t=l/k,b=0,c=N.length;b<c;b++)n=N[b],o=n.layoutRect(),s=o[A],r=o[y]+o.flex*t,r>s?(l-=o[A]-o[y],k-=o.flex,o.flex=0,o.maxFlexSize=s):o.maxFlexSize=0;for(t=l/k,v=f[B],u={},0===k&&("end"===i?v=l+f[B]:"center"===i?(v=Math.round(e[C]/2-(e[C]-l)/2)+f[B])<0&&(v=f[B]):"justify"===i&&(v=f[B],j=Math.floor(l/(d.length-1)))),u[F]=f[J],b=0,c=d.length;b<c;b++)n=d[b],o=n.layoutRect(),r=o.maxFlexSize||o[y],"center"===h?u[F]=Math.round(e[G]/2-o[H]/2):"stretch"===h?(u[H]=O(o[I]||0,e[G]-f[J]-f[K]),u[F]=f[J]):"end"===h&&(u[F]=e[G]-o[H]-f.top),o.flex>0&&(r+=o.flex*t),u[x]=r,u[z]=v,n.layoutRect(u),n.recalc&&n.recalc(),v+=r+j}else if(u.w=u.minW,u.h=u.minH,a.layoutRect(u),this.recalc(a),null===a._lastRect){var Q=a.parent();Q&&(Q._lastRect=null,Q.recalc())}}}),Fh=Ad.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(a){a.items().filter(":visible").each(function(a){a.recalc&&a.recalc()})},isNative:function(){return!0}}),Gh=function(a){return Lh(qe.body(),a)},Hh=function(a,b,c){for(var d=a.dom(),e=cb.isFunction(c)?c:Ea.constant(!1);d.parentNode;){d=d.parentNode;var f=ae.fromDom(d);if(b(f))return La.some(f);if(e(f))break}return La.none()},Ih=function(a,b,c){return D(function(a){return b(a)},Hh,a,b,c)},Jh=function(a,b){var c=a.dom();return c.parentNode?Kh(ae.fromDom(c.parentNode),function(c){return!kg.eq(a,c)&&b(c)}):La.none()},Kh=function(a,b){return Ib.find(a.dom().childNodes,Ea.compose(b,ae.fromDom)).map(ae.fromDom)},Lh=function(a,b){var c=function(a){for(var d=0;d<a.childNodes.length;d++){if(b(ae.fromDom(a.childNodes[d])))return La.some(ae.fromDom(a.childNodes[d]));var e=c(a.childNodes[d]);if(e.isSome())return e}return La.none()};return c(a.dom())},Mh={first:Gh,ancestor:Hh,closest:Ih,sibling:Jh,child:Kh,descendant:Lh},Nh=function(a){return cg.one(a)},Oh=function(a,b,c){return Mh.ancestor(a,function(a){return cg.is(a,b)},c)},Ph=function(a,b){return Mh.sibling(a,function(a){return cg.is(a,b)})},Qh=function(a,b){return Mh.child(a,function(a){return cg.is(a,b)})},Rh=function(a,b){return cg.one(b,a)},Sh=function(a,b,c){return D(cg.is,Oh,a,b,c)},Th={first:Nh,ancestor:Oh,sibling:Ph,child:Qh,descendant:Rh,closest:Sh},Uh=function(a,b){return function(){a.execCommand("mceToggleFormat",!1,b)}},Vh=function(a,b,c){var d=function(a){c(a,b)};a.formatter?a.formatter.formatChanged(b,d):a.on("init",function(){a.formatter.formatChanged(b,d)})},Wh=function(a,b){return function(c){Vh(a,b,function(a){c.control.active(a)})}},Xh=function(a){var b=["alignleft","aligncenter","alignright","alignjustify"],c=[{text:"Left",icon:"alignleft",onclick:Uh(a,"alignleft")},{text:"Center",icon:"aligncenter",onclick:Uh(a,"aligncenter")},{text:"Right",icon:"alignright",onclick:Uh(a,"alignright")},{text:"Justify",icon:"alignjustify",onclick:Uh(a,"alignjustify")}];a.addMenuItem("align",{text:"Align",menu:c}),a.addButton("align",{type:"menubutton",icon:"alignleft",menu:c,onShowMenu:function(c){var d=c.control.menu;M.each(b,function(b,c){d.items().eq(c).each(function(c){return c.active(a.formatter.match(b))})})},onPostRender:function(c){var d=c.control;M.each(b,function(b,c){Vh(a,b,function(a){d.icon("alignleft"),a&&d.icon(b)})})}}),M.each({alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"],alignnone:["No alignment","JustifyNone"]},function(b,c){a.addButton(c,{active:!1,tooltip:b[0],cmd:b[1],onPostRender:Wh(a,c)})})},Yh={register:Xh},Zh=function(a){return a?a.split(",")[0]:""},$h=function(a,b){var c,d=b?b.toLowerCase():"";return M.each(a,function(a){a.value.toLowerCase()===d&&(c=a.value)}),M.each(a,function(a){c||Zh(a.value).toLowerCase()!==Zh(d).toLowerCase()||(c=a.value)}),c},_h=function(a,b){return function(){var c=this;a.on("init nodeChange",function(d){var e=a.queryCommandValue("FontName"),f=$h(b,e);c.value(f||null),!f&&e&&c.text(Zh(e))})}},ai=function(a){a=a.replace(/;$/,"").split(";");for(var b=a.length;b--;)a[b]=a[b].split("=");return a},bi=function(a){var b=ai(a.settings.font_formats||"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats");return M.map(b,function(a){return{text:{raw:a[0]},value:a[1],textStyle:-1===a[1].indexOf("dings")?"font-family:"+a[1]:""}})},ci=function(a){a.addButton("fontselect",function(){var b=bi(a);return{type:"listbox",text:"Font Family",tooltip:"Font Family",values:b,fixedWidth:!0,onPostRender:_h(a,b),onselect:function(b){b.control.settings.value&&a.execCommand("FontName",!1,b.control.settings.value)}}})},di=function(a){ci(a)},ei={register:di},fi=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},gi=function(a,b){return/[0-9.]+px$/.test(a)?fi(72*parseInt(a,10)/96,b||0)+"pt":a},hi=function(a,b,c){var d;return M.each(a,function(a){a.value===c?d=c:a.value===b&&(d=b)}),d},ii=function(a,b){return function(){var c=this;a.on("init nodeChange",function(d){var e,f,g,h;if(e=a.queryCommandValue("FontSize"))for(g=3;!h&&g>=0;g--)f=gi(e,g),h=hi(b,f,e);c.value(h||null),h||c.text(f)})}},ji=function(a){var b=a.settings.fontsize_formats||"8pt 10pt 12pt 14pt 18pt 24pt 36pt";return M.map(b.split(" "),function(a){var b=a,c=a,d=a.split("=");return d.length>1&&(b=d[0],c=d[1]),{text:b,value:c}})},ki=function(a){a.addButton("fontsizeselect",function(){var b=ji(a);return{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:b,fixedWidth:!0,onPostRender:ii(a,b),onclick:function(b){b.control.settings.value&&a.execCommand("FontSize",!1,b.control.settings.value)}}})},li=function(a){ki(a)},mi={register:li},ni=function(a,b){var c=b.length;return M.each(b,function(b){b.menu&&(b.hidden=0===ni(a,b.menu));var d=b.format;d&&(b.hidden=!a.formatter.canApply(d)),b.hidden&&c--}),c},oi=function(a,b){var c=b.items().length;return b.items().each(function(b){b.menu&&b.visible(oi(a,b.menu)>0),!b.menu&&b.settings.menu&&b.visible(ni(a,b.settings.menu)>0);var d=b.settings.format;d&&b.visible(a.formatter.canApply(d)),b.visible()||c--}),c},pi=function(a){var b=0,c=[],d=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],e=function(a){var d=[];if(a)return M.each(a,function(a){var f={text:a.title,icon:a.icon};if(a.items)f.menu=e(a.items);else{var g=a.format||"custom"+b++;a.format||(a.name=g,c.push(a)),f.format=g,f.cmd=a.cmd}d.push(f)}),d};return a.on("init",function(){M.each(c,function(b){a.formatter.register(b.name,b)})}),{type:"menu",items:function(){return e(a.settings.style_formats_merge?a.settings.style_formats?d.concat(a.settings.style_formats):d:a.settings.style_formats||d)}(),onPostRender:function(b){a.fire("renderFormatsMenu",{control:b.control})},itemDefaults:{preview:!0,textStyle:function(){if(this.settings.format)return a.formatter.getCssText(this.settings.format)},onPostRender:function(){var b=this;b.parent().on("show",function(){var c,d;c=b.settings.format,c&&(b.disabled(!a.formatter.canApply(c)),b.active(a.formatter.match(c))),(d=b.settings.cmd)&&b.active(a.queryCommandState(d))})},onclick:function(){this.settings.format&&Uh(a,this.settings.format)(),this.settings.cmd&&a.execCommand(this.settings.cmd)}}}},qi=function(a,b){a.addMenuItem("formats",{text:"Formats",menu:b})},ri=function(a,b){a.addButton("styleselect",{type:"menubutton",text:"Formats",menu:b,onShowMenu:function(){a.settings.style_formats_autohide&&oi(a,this.menu)}})},si=function(a){var b=pi(a);qi(a,b),ri(a,b)},ti={register:si},ui=function(a){a=a.replace(/;$/,"").split(";");for(var b=a.length;b--;)a[b]=a[b].split("=");return a},vi=function(a,b,c){return function(){var d=this;a.on("nodeChange",function(e){var f=a.formatter,g=null;M.each(e.parents,function(a){if(M.each(b,function(b){if(c?f.matchNode(a,c,{value:b.value})&&(g=b.value):f.matchNode(a,b.value)&&(g=b.value),g)return!1}),g)return!1}),d.value(g)})}},wi=function(a,b){return function(){var c=[];return M.each(b,function(b){c.push({text:b[0],value:b[1],textStyle:function(){return a.formatter.getCssText(b[1])}})}),{type:"listbox",text:b[0][0],values:c,fixedWidth:!0,onselect:function(b){if(b.control){var c=b.control.value();Uh(a,c)()}},onPostRender:vi(a,c)}}},xi=function(a,b){return M.map(b,function(b){return{text:b[0],onclick:Uh(a,b[1]),textStyle:function(){return a.formatter.getCssText(b[1])}}})},yi=function(a){var b=ui(a.settings.block_formats||"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre");a.addMenuItem("blockformats",{text:"Blocks",menu:xi(a,b)}),a.addButton("formatselect",wi(a,b))},zi={register:yi},Ai=function(a,b){var c,d;if("string"==typeof b)d=b.split(" ");else if(M.isArray(b))return Ib.flatten(M.map(b,function(b){return Ai(a,b)}));return c=M.grep(d,function(b){return"|"===b||b in a.menuItems}),M.map(c,function(b){return"|"===b?{text:"-"}:a.menuItems[b]})},Bi=function(a){return a&&"-"===a.text},Ci=function(a){var b=Ib.filter(a,function(a,b,c){return!Bi(a)||!Bi(c[b-1])});return Ib.filter(b,function(a,b,c){return!Bi(a)||b>0&&b<c.length-1})},Di=function(a,b){var c=[{text:"-"}],d=M.grep(a.menuItems,function(a){return a.context===b});return M.each(d,function(a){"before"===a.separator&&c.push({text:"|"}),a.prependToContext?c.unshift(a):c.push(a),"after"===a.separator&&c.push({text:"|"})}),c},Ei=function(a){var b=a.settings.insert_button_items;return Ci(b?Ai(a,b):Di(a,"insert"))},Fi=function(a){a.addButton("insert",{type:"menubutton",icon:"insert",menu:[],oncreatemenu:function(){this.menu.add(Ei(a)),this.menu.renderNew()}})},Gi=function(a){Fi(a)},Hi={register:Gi},Ii=function(a){M.each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(b,c){a.addButton(c,{active:!1,tooltip:b,onPostRender:Wh(a,c),onclick:Uh(a,c)})})},Ji=function(a){M.each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"],removeformat:["Clear formatting","RemoveFormat"],remove:["Remove","Delete"]},function(b,c){a.addButton(c,{tooltip:b[0],cmd:b[1]})})},Ki=function(a){M.each({blockquote:["Blockquote","mceBlockQuote"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"]},function(b,c){a.addButton(c,{active:!1,tooltip:b[0],cmd:b[1],onPostRender:Wh(a,c)})})},Li=function(a){Ii(a),Ji(a),Ki(a)},Mi=function(a){M.each({bold:["Bold","Bold","Meta+B"],italic:["Italic","Italic","Meta+I"],underline:["Underline","Underline","Meta+U"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"],newdocument:["New document","mceNewDocument"],cut:["Cut","Cut","Meta+X"],copy:["Copy","Copy","Meta+C"],paste:["Paste","Paste","Meta+V"],selectall:["Select all","SelectAll","Meta+A"]},function(b,c){a.addMenuItem(c,{text:b[0],icon:c,shortcut:b[2],cmd:b[1]})}),a.addMenuItem("codeformat",{text:"Code",icon:"code",onclick:Uh(a,"code")})},Ni=function(a){Li(a),Mi(a)},Oi={register:Ni},Pi=function(a,b){return function(){var c=this,d=function(){var c="redo"===b?"hasRedo":"hasUndo";return!!a.undoManager&&a.undoManager[c]()};c.disabled(!d()),a.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(){c.disabled(a.readonly||!d())})}},Qi=function(a){a.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onPostRender:Pi(a,"undo"),cmd:"undo"}),a.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onPostRender:Pi(a,"redo"),cmd:"redo"})},Ri=function(a){a.addButton("undo",{tooltip:"Undo",onPostRender:Pi(a,"undo"),cmd:"undo"}),a.addButton("redo",{tooltip:"Redo",onPostRender:Pi(a,"redo"),cmd:"redo"})},Si=function(a){Qi(a),Ri(a)},Ti={register:Si},Ui=function(a){return function(){var b=this;a.on("VisualAid",function(a){b.active(a.hasVisual)}),b.active(a.hasVisual)}},Vi=function(a){a.addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:Ui(a),cmd:"mceToggleVisualAid"})},Wi=function(a){Vi(a)},Xi={register:Wi},Yi=function(){qd.tooltips=!Yb.iOS,$c.translate=function(a){return L.translate(a)}},Zi=function(a){a.settings.ui_container&&(Yb.container=Th.descendant(ae.fromDom(document.body),a.settings.ui_container).fold(Ea.constant(null),function(a){return a.dom()}))},$i=function(a){a.rtl&&($c.rtl=!0)},_i=function(a){a.on("mousedown",function(){hd.hideAll()})},aj=function(a){$i(a),_i(a),Zi(a),Yi(),zi.register(a),Yh.register(a),Oi.register(a),Ti.register(a),mi.register(a),ei.register(a),ti.register(a),Xi.register(a),Hi.register(a)},bj={setup:aj},cj=Bd.extend({recalc:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=[],F=[];b=a.settings,e=a.items().filter(":visible"),f=a.layoutRect(),d=b.columns||Math.ceil(Math.sqrt(e.length)),c=Math.ceil(e.length/d),s=b.spacingH||b.spacing||0,t=b.spacingV||b.spacing||0,u=b.alignH||b.align,v=b.alignV||b.align,q=a.paddingBox,C="reverseRows"in b?b.reverseRows:a.isRtl(),u&&"string"==typeof u&&(u=[u]),v&&"string"==typeof v&&(v=[v]);for(l=0;l<d;l++)E.push(0);for(m=0;m<c;m++)F.push(0);for(m=0;m<c;m++)for(l=0;l<d&&(k=e[m*d+l]);l++)j=k.layoutRect(),y=j.minW,z=j.minH,E[l]=y>E[l]?y:E[l],F[m]=z>F[m]?z:F[m];for(A=f.innerW-q.left-q.right,w=0,l=0;l<d;l++)w+=E[l]+(l>0?s:0),A-=(l>0?s:0)+E[l];for(B=f.innerH-q.top-q.bottom,x=0,m=0;m<c;m++)x+=F[m]+(m>0?t:0),B-=(m>0?t:0)+F[m];if(w+=q.left+q.right,x+=q.top+q.bottom,i={},i.minW=w+(f.w-f.innerW),i.minH=x+(f.h-f.innerH),i.contentW=i.minW-f.deltaW,i.contentH=i.minH-f.deltaH,i.minW=Math.min(i.minW,f.maxW),i.minH=Math.min(i.minH,f.maxH),i.minW=Math.max(i.minW,f.startMinWidth),i.minH=Math.max(i.minH,f.startMinHeight),!f.autoResize||i.minW===f.minW&&i.minH===f.minH){f.autoResize&&(i=a.layoutRect(i),i.contentW=i.minW-f.deltaW,i.contentH=i.minH-f.deltaH);var G;G="start"===b.packV?0:B>0?Math.floor(B/c):0;var H=0,I=b.flexWidths;if(I)for(l=0;l<I.length;l++)H+=I[l];else H=d;var J=A/H;for(l=0;l<d;l++)E[l]+=I?I[l]*J:J;for(o=q.top,m=0;m<c;m++){for(n=q.left,h=F[m]+G,l=0;l<d&&(D=C?m*d+d-1-l:m*d+l,k=e[D]);l++)p=k.settings,j=k.layoutRect(),g=Math.max(E[l],j.startMinWidth),j.x=n,j.y=o,r=p.alignH||(u?u[l]||u[0]:null),"center"===r?j.x=n+g/2-j.w/2:"right"===r?j.x=n+g-j.w:"stretch"===r&&(j.w=g),r=p.alignV||(v?v[l]||v[0]:null),"center"===r?j.y=o+h/2-j.h/2:"bottom"===r?j.y=o+h-j.h:"stretch"===r&&(j.h=h),k.layoutRect(j),n+=g+s,k.recalc&&k.recalc();o+=h+t}}else if(i.w=i.minW,i.h=i.minH,a.layoutRect(i),this.recalc(a),null===a._lastRect){var K=a.parent();K&&(K._lastRect=null,K.recalc())}}}),dj=qd.extend({renderHtml:function(){var a=this;return a.classes.add("iframe"),a.canFocus=!1,'<iframe id="'+a._id+'" class="'+a.classes+'" tabindex="-1" src="'+(a.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(a){this.getEl().src=a},html:function(a,b){var c=this,d=this.getEl().contentWindow.document.body;return d?(d.innerHTML=a,b&&b()):qa.setTimeout(function(){c.html(a)}),this}}),ej=qd.extend({init:function(a){var b=this;b._super(a),b.classes.add("widget").add("infobox"),b.canFocus=!1},severity:function(a){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(a)},help:function(a){this.state.set("help",a)},renderHtml:function(){var a=this,b=a.classPrefix;return'<div id="'+a._id+'" class="'+a.classes+'"><div id="'+a._id+'-body">'+a.encode(a.state.get("text"))+'<button role="button" tabindex="-1"><i class="'+b+"ico "+b+'i-help"></i></button></div></div>'},bindStates:function(){var a=this;return a.state.on("change:text",function(b){a.getEl("body").firstChild.data=a.encode(b.value),a.state.get("rendered")&&a.updateLayoutRect()}),a.state.on("change:help",function(b){a.classes.toggle("has-help",b.value),a.state.get("rendered")&&a.updateLayoutRect()}),a._super()}}),fj=qd.extend({init:function(a){var b=this;b._super(a),b.classes.add("widget").add("label"),b.canFocus=!1,a.multiline&&b.classes.add("autoscroll"),a.strong&&b.classes.add("strong")},initLayoutRect:function(){var a=this,b=a._super();if(a.settings.multiline){rc.getSize(a.getEl()).width>b.maxW&&(b.minW=b.maxW,a.classes.add("multiline")),a.getEl().style.width=b.minW+"px",b.startMinH=b.h=b.minH=Math.min(b.maxH,rc.getSize(a.getEl()).height)}return b},repaint:function(){var a=this;return a.settings.multiline||(a.getEl().style.lineHeight=a.layoutRect().h+"px"),a._super()},severity:function(a){this.classes.remove("error"),this.classes.remove("warning"),this.classes.remove("success"),this.classes.add(a)},renderHtml:function(){var a,b,c=this,d=c.settings.forId,e=c.settings.html?c.settings.html:c.encode(c.state.get("text"));return!d&&(b=c.settings.forName)&&(a=c.getRoot().find("#"+b)[0])&&(d=a._id),d?'<label id="'+c._id+'" class="'+c.classes+'"'+(d?' for="'+d+'"':"")+">"+e+"</label>":'<span id="'+c._id+'" class="'+c.classes+'">'+e+"</span>"},bindStates:function(){var a=this;return a.state.on("change:text",function(b){a.innerHtml(a.encode(b.value)),a.state.get("rendered")&&a.updateLayoutRect()}),a._super()}}),gj=bd.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(a){var b=this;b._super(a),b.classes.add("toolbar")},postRender:function(){var a=this;return a.items().each(function(a){a.classes.add("toolbar-item")}),a._super()}}),hj=gj.extend({Defaults:{role:"menubar",containerCls:"menubar",ariaRoot:!0,defaults:{type:"menubutton"}}}),ij=Cd.extend({init:function(a){var b=this;b._renderOpen=!0,b._super(a),a=b.settings,b.classes.add("menubtn"),a.fixedWidth&&b.classes.add("fixed-width"),b.aria("haspopup",!0),b.state.set("menu",a.menu||b.render())},showMenu:function(a){var b,c=this;if(c.menu&&c.menu.visible()&&!1!==a)return c.hideMenu();c.menu||(b=c.state.get("menu")||[],c.classes.add("opened"),b.length?b={type:"menu",animate:!0,items:b}:(b.type=b.type||"menu",b.animate=!0),b.renderTo?c.menu=b.parent(c).show().renderTo():c.menu=ga.create(b).parent(c).renderTo(),c.fire("createmenu"),c.menu.reflow(),c.menu.on("cancel",function(a){a.control.parent()===c.menu&&(a.stopPropagation(),c.focus(),c.hideMenu())}),c.menu.on("select",function(){c.focus()}),c.menu.on("show hide",function(a){a.control===c.menu&&(c.activeMenu("show"===a.type),c.classes.toggle("opened","show"===a.type)),c.aria("expanded","show"===a.type)}).fire("show")),c.menu.show(),c.menu.layoutRect({w:c.layoutRect().w}),c.menu.repaint(),c.menu.moveRel(c.getEl(),c.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"]),c.fire("showmenu")},hideMenu:function(){var a=this;a.menu&&(a.menu.items().each(function(a){a.hideMenu&&a.hideMenu()}),a.menu.hide())},activeMenu:function(a){this.classes.toggle("active",a)},renderHtml:function(){var a,b=this,c=b._id,d=b.classPrefix,e=b.settings.icon,f=b.state.get("text"),g="";return a=b.settings.image,a?(e="none","string"!=typeof a&&(a=window.getSelection?a[0]:a[1]),a=" style=\"background-image: url('"+a+"')\""):a="",f&&(b.classes.add("btn-has-text"),g='<span class="'+d+'txt">'+b.encode(f)+"</span>"),e=b.settings.icon?d+"ico "+d+"i-"+e:"",b.aria("role",b.parent()instanceof hj?"menuitem":"button"),'<div id="'+c+'" class="'+b.classes+'" tabindex="-1" aria-labelledby="'+c+'"><button id="'+c+'-open" role="presentation" type="button" tabindex="-1">'+(e?'<i class="'+e+'"'+a+"></i>":"")+g+' <i class="'+d+'caret"></i></button></div>'},postRender:function(){var a=this;return a.on("click",function(b){b.control===a&&E(b.target,a.getEl())&&(a.focus(),a.showMenu(!b.aria),b.aria&&a.menu.items().filter(":visible")[0].focus())}),a.on("mouseenter",function(b){var c,d=b.control,e=a.parent();d&&e&&d instanceof ij&&d.parent()===e&&(e.items().filter("MenuButton").each(function(a){a.hideMenu&&a!==d&&(a.menu&&a.menu.visible()&&(c=!0),a.hideMenu())}),c&&(d.focus(),d.showMenu()))}),a._super()},bindStates:function(){var a=this;return a.state.on("change:menu",function(){a.menu&&a.menu.remove(),a.menu=null}),a._super()},remove:function(){this._super(),this.menu&&this.menu.remove()}}),jj=hd.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:!0},init:function(a){var b=this;if(a.autohide=!0,a.constrainToViewport=!0,"function"==typeof a.items&&(a.itemsFactory=a.items,a.items=[]),a.itemDefaults)for(var c=a.items,d=c.length;d--;)c[d]=M.extend({},a.itemDefaults,c[d])
;b._super(a),b.classes.add("menu"),a.animate&&11!==Yb.ie&&b.classes.add("animate")},repaint:function(){return this.classes.toggle("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){var a=this;a.hideAll(),a.fire("select")},load:function(){function a(){d.throbber&&(d.throbber.hide(),d.throbber=null)}var b,c,d=this;(c=d.settings.itemsFactory)&&(d.throbber||(d.throbber=new u(d.getEl("body"),!0),0===d.items().length?(d.throbber.show(),d.fire("loading")):d.throbber.show(100,function(){d.items().remove(),d.fire("loading")}),d.on("hide close",a)),d.requestTime=b=(new Date).getTime(),d.settings.itemsFactory(function(c){if(0===c.length)return void d.hide();d.requestTime===b&&(d.getEl().style.width="",d.getEl("body").style.width="",a(),d.items().remove(),d.getEl("body").innerHTML="",d.add(c),d.renderNew(),d.fire("loaded"))}))},hideAll:function(){var a=this;return this.find("menuitem").exec("hideMenu"),a._super()},preRender:function(){var a=this;return a.items().each(function(b){var c=b.settings;if(c.icon||c.image||c.selectable)return a._hasIcons=!0,!1}),a.settings.itemsFactory&&a.on("postrender",function(){a.settings.itemsFactory&&a.load()}),a.on("show hide",function(b){b.control===a&&("show"===b.type?qa.setTimeout(function(){a.classes.add("in")},0):a.classes.remove("in"))}),a._super()}}),kj=ij.extend({init:function(a){function b(c){for(var f=0;f<c.length;f++){if(d=c[f].selected||a.value===c[f].value)return e=e||c[f].text,g.state.set("value",c[f].value),!0;if(c[f].menu&&b(c[f].menu))return!0}}var c,d,e,f,g=this;g._super(a),a=g.settings,g._values=c=a.values,c&&(void 0!==a.value&&b(c),!d&&c.length>0&&(e=c[0].text,g.state.set("value",c[0].value)),g.state.set("menu",c)),g.state.set("text",a.text||e),g.classes.add("listbox"),g.on("select",function(b){var c=b.control;f&&(b.lastControl=f),a.multiple?c.active(!c.active()):g.value(b.control.value()),f=c})},value:function(a){if(0===arguments.length)return this.state.get("value");if(void 0===a)return this;if(this.settings.values){M.grep(this.settings.values,function(b){return b.value===a}).length>0?this.state.set("value",a):null===a&&this.state.set("value",null)}else this.state.set("value",a);return this},bindStates:function(){function a(a,b){a instanceof jj&&a.items().each(function(a){a.hasMenus()||a.active(a.value()===b)})}function b(a,c){var d;if(a)for(var e=0;e<a.length;e++){if(a[e].value===c)return a[e];if(a[e].menu&&(d=b(a[e].menu,c)))return d}}var c=this;return c.on("show",function(b){a(b.control,c.value())}),c.state.on("change:value",function(a){var d=b(c.state.get("menu"),a.value);d?c.text(d.text):c.text(c.settings.text)}),c._super()}}),lj=function(a,b){var c=a._textStyle;if(c){var d=a.getEl("text");d.setAttribute("style",c),b&&(d.style.color="",d.style.backgroundColor="")}},mj=qd.extend({Defaults:{border:0,role:"menuitem"},init:function(a){var b,c=this;c._super(a),a=c.settings,c.classes.add("menu-item"),a.menu&&c.classes.add("menu-item-expand"),a.preview&&c.classes.add("menu-item-preview"),b=c.state.get("text"),"-"!==b&&"|"!==b||(c.classes.add("menu-item-sep"),c.aria("role","separator"),c.state.set("text","-")),a.selectable&&(c.aria("role","menuitemcheckbox"),c.classes.add("menu-item-checkbox"),a.icon="selected"),a.preview||a.selectable||c.classes.add("menu-item-normal"),c.on("mousedown",function(a){a.preventDefault()}),a.menu&&!a.ariaHideMenu&&c.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var a,b=this,c=b.settings,d=b.parent();if(d.items().each(function(a){a!==b&&a.hideMenu()}),c.menu){a=b.menu,a?a.show():(a=c.menu,a.length?a={type:"menu",items:a}:a.type=a.type||"menu",d.settings.itemDefaults&&(a.itemDefaults=d.settings.itemDefaults),a=b.menu=ga.create(a).parent(b).renderTo(),a.reflow(),a.on("cancel",function(c){c.stopPropagation(),b.focus(),a.hide()}),a.on("show hide",function(a){a.control.items&&a.control.items().each(function(a){a.active(a.settings.selected)})}).fire("show"),a.on("hide",function(c){c.control===a&&b.classes.remove("selected")}),a.submenu=!0),a._parentMenu=d,a.classes.add("menu-sub");var e=a.testMoveRel(b.getEl(),b.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);a.moveRel(b.getEl(),e),a.rel=e,e="menu-sub-"+e,a.classes.remove(a._lastRel).add(e),a._lastRel=e,b.classes.add("selected"),b.aria("expanded",!0)}},hideMenu:function(){var a=this;return a.menu&&(a.menu.items().each(function(a){a.hideMenu&&a.hideMenu()}),a.menu.hide(),a.aria("expanded",!1)),a},renderHtml:function(){function a(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(b){var c=f.match||"";return c?b.replace(new RegExp(a(c),"gi"),function(a){return"!mce~match["+a+"]mce~match!"}):b}function c(b){return b.replace(new RegExp(a("!mce~match["),"g"),"<b>").replace(new RegExp(a("]mce~match!"),"g"),"</b>")}var d=this,e=d._id,f=d.settings,g=d.classPrefix,h=d.state.get("text"),i=d.settings.icon,j="",k=f.shortcut,l=d.encode(f.url),m="";return i&&d.parent().classes.add("menu-has-icons"),f.image&&(j=" style=\"background-image: url('"+f.image+"')\""),k&&(k=function(a){var b,c,d={};for(d=Yb.mac?{alt:"&#x2325;",ctrl:"&#x2318;",shift:"&#x21E7;",meta:"&#x2318;"}:{meta:"Ctrl"},a=a.split("+"),b=0;b<a.length;b++)(c=d[a[b].toLowerCase()])&&(a[b]=c);return a.join("+")}(k)),i=g+"ico "+g+"i-"+(d.settings.icon||"none"),m="-"!==h?'<i class="'+i+'"'+j+"></i>":"",h=c(d.encode(b(h))),l=c(d.encode(b(l))),'<div id="'+e+'" class="'+d.classes+'" tabindex="-1">'+m+("-"!==h?'<span id="'+e+'-text" class="'+g+'text">'+h+"</span>":"")+(k?'<div id="'+e+'-shortcut" class="'+g+'menu-shortcut">'+k+"</div>":"")+(f.menu?'<div class="'+g+'caret"></div>':"")+(l?'<div class="'+g+'menu-item-link">'+l+"</div>":"")+"</div>"},postRender:function(){var a=this,b=a.settings,c=b.textStyle;if("function"==typeof c&&(c=c.call(this)),c){var d=a.getEl("text");d&&(d.setAttribute("style",c),a._textStyle=c)}return a.on("mouseenter click",function(c){c.control===a&&(b.menu||"click"!==c.type?(a.showMenu(),c.aria&&a.menu.focus(!0)):(a.fire("select"),qa.requestAnimationFrame(function(){a.parent().hideAll()})))}),a._super(),a},hover:function(){var a=this;return a.parent().items().each(function(a){a.classes.remove("selected")}),a.classes.toggle("selected",!0),a},active:function(a){return lj(this,a),void 0!==a&&this.aria("checked",a),this._super(a)},remove:function(){this._super(),this.menu&&this.menu.remove()}}),nj=Fd.extend({Defaults:{classes:"radio",role:"radio"}}),oj=qd.extend({renderHtml:function(){var a=this,b=a.classPrefix;return a.classes.add("resizehandle"),"both"===a.settings.direction&&a.classes.add("resizehandle-both"),a.canFocus=!1,'<div id="'+a._id+'" class="'+a.classes+'"><i class="'+b+"ico "+b+'i-resize"></i></div>'},postRender:function(){var a=this;a._super(),a.resizeDragHelper=new l(this._id,{start:function(){a.fire("ResizeStart")},drag:function(b){"both"!==a.settings.direction&&(b.deltaX=0),a.fire("Resize",b)},stop:function(){a.fire("ResizeEnd")}})},remove:function(){return this.resizeDragHelper&&this.resizeDragHelper.destroy(),this._super()}}),pj=qd.extend({Defaults:{classes:"selectbox",role:"selectbox",options:[]},init:function(a){var b=this;b._super(a),b.settings.size&&(b.size=b.settings.size),b.settings.options&&(b._options=b.settings.options),b.on("keydown",function(a){var c;13===a.keyCode&&(a.preventDefault(),b.parents().reverse().each(function(a){if(a.toJSON)return c=a,!1}),b.fire("submit",{data:c.toJSON()}))})},options:function(a){return arguments.length?(this.state.set("options",a),this):this.state.get("options")},renderHtml:function(){var a,b=this,c="";return a=F(b._options),b.size&&(c=' size = "'+b.size+'"'),'<select id="'+b._id+'" class="'+b.classes+'"'+c+">"+a+"</select>"},bindStates:function(){var a=this;return a.state.on("change:options",function(b){a.getEl().innerHTML=F(b.value)}),a._super()}}),qj=qd.extend({init:function(a){var b=this;a.previewFilter||(a.previewFilter=function(a){return Math.round(100*a)/100}),b._super(a),b.classes.add("slider"),"v"===a.orientation&&b.classes.add("vertical"),b._minValue=cb.isNumber(a.minValue)?a.minValue:0,b._maxValue=cb.isNumber(a.maxValue)?a.maxValue:100,b._initValue=b.state.get("value")},renderHtml:function(){var a=this,b=a._id,c=a.classPrefix;return'<div id="'+b+'" class="'+a.classes+'"><div id="'+b+'-handle" class="'+c+'slider-handle" role="slider" tabindex="-1"></div></div>'},reset:function(){this.value(this._initValue).repaint()},postRender:function(){function a(a,b,c){return(c+a)/(b-a)}function b(a,b,c){return c*(b-a)-a}var c,d,e,f,g,h,i=this;c=i._minValue,d=i._maxValue,"v"===i.settings.orientation?(e="screenY",f="top",g="height",h="h"):(e="screenX",f="left",g="width",h="w"),i._super(),function(c,d){function e(e){var f;f=i.value(),f=b(c,d,a(c,d,f)+.05*e),f=G(f,c,d),i.value(f),i.fire("dragstart",{value:f}),i.fire("drag",{value:f}),i.fire("dragend",{value:f})}i.on("keydown",function(a){switch(a.keyCode){case 37:case 38:e(-1);break;case 39:case 40:e(1)}})}(c,d),function(a,b,c){var d,j,k,m,n;i._dragHelper=new l(i._id,{handle:i._id+"-handle",start:function(a){d=a[e],j=parseInt(i.getEl("handle").style[f],10),k=(i.layoutRect()[h]||100)-rc.getSize(c)[g],i.fire("dragstart",{value:n})},drag:function(g){var h=g[e]-d;m=G(j+h,0,k),c.style[f]=m+"px",n=a+m/k*(b-a),i.value(n),i.tooltip().text(""+i.settings.previewFilter(n)).show().moveRel(c,"bc tc"),i.fire("drag",{value:n})},stop:function(){i.tooltip().hide(),i.fire("dragend",{value:n})}})}(c,d,i.getEl("handle"))},repaint:function(){this._super(),I(this,this.value())},bindStates:function(){var a=this;return a.state.on("change:value",function(b){I(a,b.value)}),a._super()}}),rj=qd.extend({renderHtml:function(){var a=this;return a.classes.add("spacer"),a.canFocus=!1,'<div id="'+a._id+'" class="'+a.classes+'"></div>'}}),sj=ij.extend({Defaults:{classes:"widget btn splitbtn",role:"button"},repaint:function(){var a,b,c=this,d=c.getEl(),e=c.layoutRect();return c._super(),a=d.firstChild,b=d.lastChild,pc(a).css({width:e.w-rc.getSize(b).width,height:e.h-2}),pc(b).css({height:e.h-2}),c},activeMenu:function(a){var b=this;pc(b.getEl().lastChild).toggleClass(b.classPrefix+"active",a)},renderHtml:function(){var a,b,c=this,d=c._id,e=c.classPrefix,f=c.state.get("icon"),g=c.state.get("text"),h=c.settings,i="";return a=h.image,a?(f="none","string"!=typeof a&&(a=window.getSelection?a[0]:a[1]),a=" style=\"background-image: url('"+a+"')\""):a="",f=h.icon?e+"ico "+e+"i-"+f:"",g&&(c.classes.add("btn-has-text"),i='<span class="'+e+'txt">'+c.encode(g)+"</span>"),b="boolean"==typeof h.active?' aria-pressed="'+h.active+'"':"",'<div id="'+d+'" class="'+c.classes+'" role="button"'+b+' tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">'+(f?'<i class="'+f+'"'+a+"></i>":"")+i+'</button><button type="button" class="'+e+'open" hidefocus="1" tabindex="-1">'+(c._menuBtnText?(f?"":"")+c._menuBtnText:"")+' <i class="'+e+'caret"></i></button></div>'},postRender:function(){var a=this,b=a.settings.onclick;return a.on("click",function(a){var c=a.target;if(a.control===this)for(;c;){if(a.aria&&"down"!==a.aria.key||"BUTTON"===c.nodeName&&-1===c.className.indexOf("open"))return a.stopImmediatePropagation(),void(b&&b.call(this,a));c=c.parentNode}}),delete a.settings.onclick,a._super()}}),tj=Fh.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"},isNative:function(){return!0}}),uj=dd.extend({Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(a){var b;this.activeTabId&&(b=this.getEl(this.activeTabId),pc(b).removeClass(this.classPrefix+"active"),b.setAttribute("aria-selected","false")),this.activeTabId="t"+a,b=this.getEl("t"+a),b.setAttribute("aria-selected","true"),pc(b).addClass(this.classPrefix+"active"),this.items()[a].show().fire("showtab"),this.reflow(),this.items().each(function(b,c){a!==c&&b.hide()})},renderHtml:function(){var a=this,b=a._layout,c="",d=a.classPrefix;return a.preRender(),b.preRender(a),a.items().each(function(b,e){var f=a._id+"-t"+e;b.aria("role","tabpanel"),b.aria("labelledby",f),c+='<div id="'+f+'" class="'+d+'tab" unselectable="on" role="tab" aria-controls="'+b._id+'" aria-selected="false" tabIndex="-1">'+a.encode(b.settings.title)+"</div>"}),'<div id="'+a._id+'" class="'+a.classes+'" hidefocus="1" tabindex="-1"><div id="'+a._id+'-head" class="'+d+'tabs" role="tablist">'+c+'</div><div id="'+a._id+'-body" class="'+a.bodyClasses+'">'+b.renderHtml(a)+"</div></div>"},postRender:function(){var a=this;a._super(),a.settings.activeTab=a.settings.activeTab||0,a.activateTab(a.settings.activeTab),this.on("click",function(b){var c=b.target.parentNode;if(c&&c.id===a._id+"-head")for(var d=c.childNodes.length;d--;)c.childNodes[d]===b.target&&a.activateTab(d)})},initLayoutRect:function(){var a,b,c,d=this;b=rc.getSize(d.getEl("head")).width,b=b<0?0:b,c=0,d.items().each(function(a){b=Math.max(b,a.layoutRect().minW),c=Math.max(c,a.layoutRect().minH)}),d.items().each(function(a){a.settings.x=0,a.settings.y=0,a.settings.w=b,a.settings.h=c,a.layoutRect({x:0,y:0,w:b,h:c})});var e=rc.getSize(d.getEl("head")).height;return d.settings.minWidth=b,d.settings.minHeight=c+e,a=d._super(),a.deltaH+=e,a.innerH=a.h-a.deltaH,a}}),vj=qd.extend({init:function(a){var b=this;b._super(a),b.classes.add("textbox"),a.multiline?b.classes.add("multiline"):(b.on("keydown",function(a){var c;13===a.keyCode&&(a.preventDefault(),b.parents().reverse().each(function(a){if(a.toJSON)return c=a,!1}),b.fire("submit",{data:c.toJSON()}))}),b.on("keyup",function(a){b.state.set("value",a.target.value)}))},repaint:function(){var a,b,c,d,e,f=this,g=0;a=f.getEl().style,b=f._layoutRect,e=f._lastRepaintRect||{};var h=document;return!f.settings.multiline&&h.all&&(!h.documentMode||h.documentMode<=8)&&(a.lineHeight=b.h-g+"px"),c=f.borderBox,d=c.left+c.right+8,g=c.top+c.bottom+(f.settings.multiline?8:0),b.x!==e.x&&(a.left=b.x+"px",e.x=b.x),b.y!==e.y&&(a.top=b.y+"px",e.y=b.y),b.w!==e.w&&(a.width=b.w-d+"px",e.w=b.w),b.h!==e.h&&(a.height=b.h-g+"px",e.h=b.h),f._lastRepaintRect=e,f.fire("repaint",{},!1),f},renderHtml:function(){var a,b,c=this,d=c.settings;return a={id:c._id,hidefocus:"1"},M.each(["rows","spellcheck","maxLength","size","readonly","min","max","step","list","pattern","placeholder","required","multiple"],function(b){a[b]=d[b]}),c.disabled()&&(a.disabled="disabled"),d.subtype&&(a.type=d.subtype),b=rc.create(d.multiline?"textarea":"input",a),b.value=c.state.get("value"),b.className=c.classes.toString(),b.outerHTML},value:function(a){return arguments.length?(this.state.set("value",a),this):(this.state.get("rendered")&&this.state.set("value",this.getEl().value),this.state.get("value"))},postRender:function(){var a=this;a.getEl().value=a.state.get("value"),a._super(),a.$el.on("change",function(b){a.state.set("value",b.target.value),a.fire("change",b)})},bindStates:function(){var a=this;return a.state.on("change:value",function(b){a.getEl().value!==b.value&&(a.getEl().value=b.value)}),a.state.on("change:disabled",function(b){a.getEl().disabled=b.value}),a._super()},remove:function(){this.$el.off(),this._super()}}),wj=function(){return{Selector:Hc,Collection:Kc,ReflowQueue:Rc,Control:$c,Factory:ga,KeyboardNavigation:i,Container:bd,DragHelper:l,Scrollable:cd,Panel:dd,Movable:xc,Resizable:ed,FloatPanel:hd,Window:wd,MessageBox:xd,Tooltip:pd,Widget:qd,Progress:rd,Notification:td,Layout:Ad,AbsoluteLayout:Bd,Button:Cd,ButtonGroup:Ed,Checkbox:Fd,ComboBox:Hd,ColorBox:Id,PanelButton:Jd,ColorButton:Ld,ColorPicker:Nd,Path:Pd,ElementPath:Qd,FormItem:Rd,Form:Sd,FieldSet:Td,FilePicker:Ch,FitLayout:Dh,FlexLayout:Eh,FlowLayout:Fh,FormatControls:bj,GridLayout:cj,Iframe:dj,InfoBox:ej,Label:fj,Toolbar:gj,MenuBar:hj,MenuButton:ij,MenuItem:mj,Throbber:u,Menu:jj,ListBox:kj,Radio:nj,ResizeHandle:oj,SelectBox:pj,Slider:qj,Spacer:rj,SplitButton:sj,StackLayout:tj,TabPanel:uj,TextBox:vj,DropZone:Od,BrowseButton:Dd}},xj=function(a){a.ui?M.each(wj(),function(b,c){a.ui[c]=b}):a.ui=wj()},yj=function(){M.each(wj(),function(a,b){ga.add(b,a)})},zj={appendTo:xj,registerToFactory:yj};zj.registerToFactory(),zj.appendTo(window.tinymce?window.tinymce:{}),K.add("modern",function(a){return bj.setup(a),zd.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-advlist",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(a,b,c){var d="UL"===b?"InsertUnorderedList":"InsertOrderedList";a.execCommand(d,!1,!1===c?null:{"list-style-type":c})},e={applyListFormat:d},f=function(a){a.addCommand("ApplyUnorderedListStyle",function(b,c){e.applyListFormat(a,"UL",c["list-style-type"])}),a.addCommand("ApplyOrderedListStyle",function(b,c){e.applyListFormat(a,"OL",c["list-style-type"])})},g={register:f},h=function(a){var b=a.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");return b?b.split(/[ ,]/):[]},i=function(a){var b=a.getParam("advlist_bullet_styles","default,circle,disc,square");return b?b.split(/[ ,]/):[]},j={getNumberStyles:h,getBulletStyles:i},k=function(a,b){return a.$.contains(a.getBody(),b)},l=function(a){return a&&/^(TH|TD)$/.test(a.nodeName)},m=function(a){return function(b){return b&&/^(OL|UL|DL)$/.test(b.nodeName)&&k(a,b)}},n=function(a){var b=a.dom.getParent(a.selection.getNode(),"ol,ul");return a.dom.getStyle(b,"listStyleType")||""},o={isTableCellNode:l,isListNode:m,getSelectedStyleType:n},p=function(a){return a.replace(/\-/g," ").replace(/\b\w/g,function(a){return a.toUpperCase()})},q=function(a){return c.map(a,function(a){return{text:p(a),data:"default"===a?"":a}})},r={toMenuItems:q},s=function(a,b){for(var c=0;c<a.length;c++){if(b(a[c]))return c}return-1},t=function(a,b){return function(d){var e=d.control;a.on("NodeChange",function(d){var f=s(d.parents,o.isTableCellNode),g=-1!==f?d.parents.slice(0,f):d.parents,h=c.grep(g,o.isListNode(a));e.active(h.length>0&&h[0].nodeName===b)})}},u=function(a){return function(b){var c=o.getSelectedStyleType(a);b.control.items().each(function(a){a.active(a.settings.data===c)})}},v=function(a,b,c,d,f,g){a.addButton(b,{active:!1,type:"splitbutton",tooltip:c,menu:r.toMenuItems(g),onPostRender:t(a,f),onshow:u(a),onselect:function(b){e.applyListFormat(a,f,b.control.settings.data)},onclick:function(){a.execCommand(d)}})},w=function(a,b,c,d,e,f){a.addButton(b,{active:!1,type:"button",tooltip:c,onPostRender:t(a,e),onclick:function(){a.execCommand(d)}})},x=function(a,b,c,d,e,f){f.length>0?v(a,b,c,d,e,f):w(a,b,c,d,e)},y=function(a){x(a,"numlist","Numbered list","InsertOrderedList","OL",j.getNumberStyles(a)),x(a,"bullist","Bullet list","InsertUnorderedList","UL",j.getBulletStyles(a))},z={register:y};b.add("advlist",function(a){(function(a,b){var d=a.settings.plugins?a.settings.plugins:"";return-1!==c.inArray(d.split(/[ ,]/),b)})(a,"lists")&&(z.register(a),g.register(a))})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-anchor",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(a)},d=function(a){var b=a.selection.getNode();return"A"===b.tagName&&""===a.dom.getAttrib(b,"href")?b.id||b.name:""},e=function(a,b){var c=a.selection.getNode();"A"===c.tagName&&""===a.dom.getAttrib(c,"href")?(c.removeAttribute("name"),c.id=b,a.undoManager.add()):(a.focus(),a.selection.collapse(!0),a.execCommand("mceInsertContent",!1,a.dom.createHTML("a",{id:b})))},f={isValidId:c,getId:d,insert:e},g=function(a,b){return f.isValidId(b)?(f.insert(a,b),!1):(a.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),!0)},h=function(a){var b=f.getId(a);a.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:b},onsubmit:function(b){var c=b.data.id;g(a,c)&&b.preventDefault()}})},i={open:h},j=function(a){a.addCommand("mceAnchor",function(){i.open(a)})},k={register:j},l=function(a){return!a.attr("href")&&(a.attr("id")||a.attr("name"))&&!a.firstChild},m=function(a){return function(b){for(var c=0;c<b.length;c++)l(b[c])&&b[c].attr("contenteditable",a)}},n=function(a){a.on("PreInit",function(){a.parser.addNodeFilter("a",m("false")),a.serializer.addNodeFilter("a",m(null))})},o={setup:n},p=function(a){a.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"}),a.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})},q={register:p};b.add("anchor",function(a){o.setup(a),k.register(a),q.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-autolink",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.Env"),d=function(a){return a.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)},e=function(a){return a.getParam("default_link_target","")},f={getAutoLinkPattern:d,getDefaultLinkTarget:e},g=function(a,b){return a===b||" "===a||160===a.charCodeAt(0)},h=function(a){n(a,-1,"(")},i=function(a){n(a,0,"")},j=function(a){n(a,-1,"")},k=function(a,b){if(b<0&&(b=0),3===a.nodeType){var c=a.data.length;b>c&&(b=c)}return b},l=function(a,b,c){1!==b.nodeType||b.hasChildNodes()?a.setStart(b,k(b,c)):a.setStartBefore(b)},m=function(a,b,c){1!==b.nodeType||b.hasChildNodes()?a.setEnd(b,k(b,c)):a.setEndAfter(b)},n=function(a,b,c){var d,e,h,i,j,k,n,o,p,q,r=f.getAutoLinkPattern(a),s=f.getDefaultLinkTarget(a);if("A"!==a.selection.getNode().tagName){if(d=a.selection.getRng(!0).cloneRange(),d.startOffset<5){if(!(o=d.endContainer.previousSibling)){if(!d.endContainer.firstChild||!d.endContainer.firstChild.nextSibling)return;o=d.endContainer.firstChild.nextSibling}if(p=o.length,l(d,o,p),m(d,o,p),d.endOffset<5)return;e=d.endOffset,i=o}else{if(i=d.endContainer,3!==i.nodeType&&i.firstChild){for(;3!==i.nodeType&&i.firstChild;)i=i.firstChild;3===i.nodeType&&(l(d,i,0),m(d,i,i.nodeValue.length))}e=1===d.endOffset?2:d.endOffset-1-b}h=e;do{l(d,i,e>=2?e-2:0),m(d,i,e>=1?e-1:0),e-=1,q=d.toString()}while(" "!==q&&""!==q&&160!==q.charCodeAt(0)&&e-2>=0&&q!==c);g(d.toString(),c)?(l(d,i,e),m(d,i,h),e+=1):0===d.startOffset?(l(d,i,0),m(d,i,h)):(l(d,i,e),m(d,i,h)),k=d.toString(),"."===k.charAt(k.length-1)&&m(d,i,h-1),k=d.toString().trim(),n=k.match(r),n&&("www."===n[1]?n[1]="http://www.":/@$/.test(n[1])&&!/^mailto:/.test(n[1])&&(n[1]="mailto:"+n[1]),j=a.selection.getBookmark(),a.selection.setRng(d),a.execCommand("createlink",!1,n[1]+n[2]),s&&a.dom.setAttrib(a.selection.getNode(),"target",s),a.selection.moveToBookmark(j),a.nodeChanged())}},o=function(a){var b;if(a.on("keydown",function(b){if(13===b.keyCode)return j(a)}),c.ie)return void a.on("focus",function(){if(!b){b=!0;try{a.execCommand("AutoUrlDetect",!1,!0)}catch(a){}}});a.on("keypress",function(b){if(41===b.keyCode)return h(a)}),a.on("keyup",function(b){if(32===b.keyCode)return i(a)})},p={setup:o};b.add("autolink",function(a){p.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-autoresize",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=tinymce.util.Tools.resolve("tinymce.Env"),e=tinymce.util.Tools.resolve("tinymce.util.Delay"),f=function(a){return parseInt(a.getParam("autoresize_min_height",a.getElement().offsetHeight),10)},g=function(a){return parseInt(a.getParam("autoresize_max_height",0),10)},h=function(a){return a.getParam("autoresize_overflow_padding",1)},i=function(a){return a.getParam("autoresize_bottom_margin",50)},j=function(a){return a.getParam("autoresize_on_init",!0)},k={getAutoResizeMinHeight:f,getAutoResizeMaxHeight:g,getAutoResizeOverflowPadding:h,getAutoResizeBottomMargin:i,shouldAutoResizeOnInit:j},l=function(a){return a.plugins.fullscreen&&a.plugins.fullscreen.isFullscreen()},m=function(a,b,c,d,f){e.setEditorTimeout(a,function(){o(a,b),c--?m(a,b,c,d,f):f&&f()},d)},n=function(a,b){var c=a.getBody();c&&(c.style.overflowY=b?"":"hidden",b||(c.scrollTop=0))},o=function(a,b){var c,e,f,g,h,i,j,m,p,q,r,s=a.dom;if(e=a.getDoc()){if(l(a))return void n(a,!0);f=e.body,g=k.getAutoResizeMinHeight(a),i=s.getStyle(f,"margin-top",!0),j=s.getStyle(f,"margin-bottom",!0),m=s.getStyle(f,"padding-top",!0),p=s.getStyle(f,"padding-bottom",!0),q=s.getStyle(f,"border-top-width",!0),r=s.getStyle(f,"border-bottom-width",!0),h=f.offsetHeight+parseInt(i,10)+parseInt(j,10)+parseInt(m,10)+parseInt(p,10)+parseInt(q,10)+parseInt(r,10),(isNaN(h)||h<=0)&&(h=d.ie?f.scrollHeight:d.webkit&&0===f.clientHeight?0:f.offsetHeight),h>k.getAutoResizeMinHeight(a)&&(g=h);var t=k.getAutoResizeMaxHeight(a);t&&h>t?(g=t,n(a,!0)):n(a,!1),g!==b.get()&&(c=g-b.get(),s.setStyle(a.iframeElement,"height",g+"px"),b.set(g),d.webkit&&c<0&&o(a,b))}},p=function(a,b){a.on("init",function(){var b,c,d=a.dom;b=k.getAutoResizeOverflowPadding(a),c=k.getAutoResizeBottomMargin(a),!1!==b&&d.setStyles(a.getBody(),{paddingLeft:b,paddingRight:b}),!1!==c&&d.setStyles(a.getBody(),{paddingBottom:c})}),a.on("nodechange setcontent keyup FullscreenStateChanged",function(c){o(a,b)}),k.shouldAutoResizeOnInit(a)&&a.on("init",function(){m(a,b,20,100,function(){m(a,b,5,1e3)})})},q={setup:p,resize:o},r=function(a,b){a.addCommand("mceAutoResize",function(){q.resize(a,b)})},s={register:r};c.add("autoresize",function(a){if(!a.inline){var c=b(0);s.register(a,c),q.setup(a,c)}})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-autosave",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),e=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=function(a){return a.fire("RestoreDraft")},g=function(a){return a.fire("StoreDraft")},h=function(a){return a.fire("RemoveDraft")},i={fireRestoreDraft:f,fireStoreDraft:g,fireRemoveDraft:h},j=function(a,b){var c={s:1e3,m:6e4};return a=/^(\d+)([ms]?)$/.exec(""+(a||b)),(a[2]?c[a[2]]:1)*parseInt(a,10)},k={parse:j},l=function(a){return a.getParam("autosave_ask_before_unload",!0)},m=function(a){var b=a.getParam("autosave_prefix","tinymce-autosave-{path}{query}{hash}-{id}-");return b=b.replace(/\{path\}/g,document.location.pathname),b=b.replace(/\{query\}/g,document.location.search),b=b.replace(/\{hash\}/g,document.location.hash),b=b.replace(/\{id\}/g,a.id)},n=function(a){return a.getParam("autosave_restore_when_empty",!1)},o=function(a){return k.parse(a.settings.autosave_interval,"30s")},p=function(a){return k.parse(a.settings.autosave_retention,"20m")},q={shouldAskBeforeUnload:l,getAutoSavePrefix:m,shouldRestoreWhenEmpty:n,getAutoSaveInterval:o,getAutoSaveRetention:p},r=function(a,b){var c=a.settings.forced_root_block;return""===(b=e.trim(void 0===b?a.getBody().innerHTML:b))||new RegExp("^<"+c+"[^>]*>((|&nbsp;|[ \t]|<br[^>]*>)+?|)</"+c+">|<br>$","i").test(b)},s=function(a){var b=parseInt(d.getItem(q.getAutoSavePrefix(a)+"time"),10)||0;return!((new Date).getTime()-b>q.getAutoSaveRetention(a))||(t(a,!1),!1)},t=function(a,b){var c=q.getAutoSavePrefix(a);d.removeItem(c+"draft"),d.removeItem(c+"time"),!1!==b&&i.fireRemoveDraft(a)},u=function(a){var b=q.getAutoSavePrefix(a);!r(a)&&a.isDirty()&&(d.setItem(b+"draft",a.getContent({format:"raw",no_events:!0})),d.setItem(b+"time",(new Date).getTime().toString()),i.fireStoreDraft(a))},v=function(a){var b=q.getAutoSavePrefix(a);s(a)&&(a.setContent(d.getItem(b+"draft"),{format:"raw"}),i.fireRestoreDraft(a))},w=function(a,b){var c=q.getAutoSaveInterval(a);b.get()||(setInterval(function(){a.removed||u(a)},c),b.set(!0))},x=function(a){a.undoManager.transact(function(){v(a),t(a)}),a.focus()},y={isEmpty:r,hasDraft:s,removeDraft:t,storeDraft:u,restoreDraft:v,startStoreDraft:w,restoreLastDraft:x},z=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,[b].concat(c))}},A=function(a){return{hasDraft:z(y.hasDraft,a),storeDraft:z(y.storeDraft,a),restoreDraft:z(y.restoreDraft,a),removeDraft:z(y.removeDraft,a),isEmpty:z(y.isEmpty,a)}},B={get:A},C=tinymce.util.Tools.resolve("tinymce.EditorManager");C._beforeUnloadHandler=function(){var a;return e.each(C.get(),function(b){b.plugins.autosave&&b.plugins.autosave.storeDraft(),!a&&b.isDirty()&&q.shouldAskBeforeUnload(b)&&(a=b.translate("You have unsaved changes are you sure you want to navigate away?"))}),a};var D=function(a){window.onbeforeunload=C._beforeUnloadHandler},E={setup:D},F=function(a,b){return function(c){var d=c.control;d.disabled(!y.hasDraft(a)),a.on("StoreDraft RestoreDraft RemoveDraft",function(){d.disabled(!y.hasDraft(a))}),y.startStoreDraft(a,b)}},G=function(a,b){a.addButton("restoredraft",{title:"Restore last draft",onclick:function(){y.restoreLastDraft(a)},onPostRender:F(a,b)}),a.addMenuItem("restoredraft",{text:"Restore last draft",onclick:function(){y.restoreLastDraft(a)},onPostRender:F(a,b),context:"file"})},H={register:G};c.add("autosave",function(a){var c=b(!1);return E.setup(a),H.register(a,c),B.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-bbcode",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(a){a=c.trim(a);var b=function(b,c){a=a.replace(b,c)};return b(/<a.*?href=\"(.*?)\".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"),b(/<font.*?color=\"(.*?)\".*?class=\"codeStyle\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),b(/<font.*?color=\"(.*?)\".*?class=\"quoteStyle\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),b(/<font.*?class=\"codeStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[code][color=$1]$2[/color][/code]"),b(/<font.*?class=\"quoteStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[quote][color=$1]$2[/color][/quote]"),b(/<span style=\"color: ?(.*?);\">(.*?)<\/span>/gi,"[color=$1]$2[/color]"),b(/<font.*?color=\"(.*?)\".*?>(.*?)<\/font>/gi,"[color=$1]$2[/color]"),b(/<span style=\"font-size:(.*?);\">(.*?)<\/span>/gi,"[size=$1]$2[/size]"),b(/<font>(.*?)<\/font>/gi,"$1"),b(/<img.*?src=\"(.*?)\".*?\/>/gi,"[img]$1[/img]"),b(/<span class=\"codeStyle\">(.*?)<\/span>/gi,"[code]$1[/code]"),b(/<span class=\"quoteStyle\">(.*?)<\/span>/gi,"[quote]$1[/quote]"),b(/<strong class=\"codeStyle\">(.*?)<\/strong>/gi,"[code][b]$1[/b][/code]"),b(/<strong class=\"quoteStyle\">(.*?)<\/strong>/gi,"[quote][b]$1[/b][/quote]"),b(/<em class=\"codeStyle\">(.*?)<\/em>/gi,"[code][i]$1[/i][/code]"),b(/<em class=\"quoteStyle\">(.*?)<\/em>/gi,"[quote][i]$1[/i][/quote]"),b(/<u class=\"codeStyle\">(.*?)<\/u>/gi,"[code][u]$1[/u][/code]"),b(/<u class=\"quoteStyle\">(.*?)<\/u>/gi,"[quote][u]$1[/u][/quote]"),b(/<\/(strong|b)>/gi,"[/b]"),b(/<(strong|b)>/gi,"[b]"),b(/<\/(em|i)>/gi,"[/i]"),b(/<(em|i)>/gi,"[i]"),b(/<\/u>/gi,"[/u]"),b(/<span style=\"text-decoration: ?underline;\">(.*?)<\/span>/gi,"[u]$1[/u]"),b(/<u>/gi,"[u]"),b(/<blockquote[^>]*>/gi,"[quote]"),b(/<\/blockquote>/gi,"[/quote]"),b(/<br \/>/gi,"\n"),b(/<br\/>/gi,"\n"),b(/<br>/gi,"\n"),b(/<p>/gi,""),b(/<\/p>/gi,"\n"),b(/&nbsp;|\u00a0/gi," "),b(/&quot;/gi,'"'),b(/&lt;/gi,"<"),b(/&gt;/gi,">"),b(/&amp;/gi,"&"),a},e=function(a){a=c.trim(a);var b=function(b,c){a=a.replace(b,c)};return b(/\n/gi,"<br />"),b(/\[b\]/gi,"<strong>"),b(/\[\/b\]/gi,"</strong>"),b(/\[i\]/gi,"<em>"),b(/\[\/i\]/gi,"</em>"),b(/\[u\]/gi,"<u>"),b(/\[\/u\]/gi,"</u>"),b(/\[url=([^\]]+)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'),
b(/\[url\](.*?)\[\/url\]/gi,'<a href="$1">$1</a>'),b(/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'),b(/\[color=(.*?)\](.*?)\[\/color\]/gi,'<font color="$1">$2</font>'),b(/\[code\](.*?)\[\/code\]/gi,'<span class="codeStyle">$1</span>&nbsp;'),b(/\[quote.*?\](.*?)\[\/quote\]/gi,'<span class="quoteStyle">$1</span>&nbsp;'),a},f={html2bbcode:d,bbcode2html:e};b.add("bbcode",function(){return{init:function(a){a.on("beforeSetContent",function(a){a.content=f.bbcode2html(a.content)}),a.on("postProcess",function(a){a.set&&(a.content=f.bbcode2html(a.content)),a.get&&(a.content=f.html2bbcode(a.content))})}}})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-charmap",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a,b){return a.fire("insertCustomChar",{chr:b})},d={fireInsertCustomChar:c},e=function(a,b){var c=d.fireInsertCustomChar(a,b).chr;a.execCommand("mceInsertContent",!1,c)},f={insertChar:e},g=tinymce.util.Tools.resolve("tinymce.util.Tools"),h=function(a){return a.settings.charmap},i=function(a){return a.settings.charmap_append},j={getCharMap:h,getCharMapAppend:i},k=g.isArray,l=function(){return[["160","no-break space"],["173","soft hyphen"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["256","A - macron"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["274","E - macron"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["298","I - macron"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["332","O - macron"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["362","U - macron"],["221","Y - acute"],["376","Y - diaeresis"],["562","Y - macron"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["257","a - macron"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["275","e - macron"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["299","i - macron"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["333","o macron"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["363","u - macron"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["563","y - macron"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"]]},m=function(a){return g.grep(a,function(a){return k(a)&&2===a.length})},n=function(a){return k(a)?[].concat(m(a)):"function"==typeof a?a():[]},o=function(a,b){var c=j.getCharMap(a);c&&(b=n(c));var d=j.getCharMapAppend(a);return d?[].concat(b).concat(n(d)):b},p=function(a){return o(a,l())},q={getCharMap:p},r=function(a){return{getCharMap:function(){return q.getCharMap(a)},insertChar:function(b){f.insertChar(a,b)}}},s={get:r},t=function(a){var b,c,d,e=Math.min(a.length,25),f=Math.ceil(a.length/e);for(b='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>',d=0;d<f;d++){for(b+="<tr>",c=0;c<e;c++){var g=d*e+c;if(g<a.length){var h=a[g],i=parseInt(h[0],10),j=h?String.fromCharCode(i):"&nbsp;";b+='<td title="'+h[1]+'"><div tabindex="-1" title="'+h[1]+'" role="button" data-chr="'+i+'">'+j+"</div></td>"}else b+="<td />"}b+="</tr>"}return b+="</tbody></table>"},u={getHtml:t},v=function(a){for(;a;){if("TD"===a.nodeName)return a;a=a.parentNode}},w=function(a){var b,c={type:"container",html:u.getHtml(q.getCharMap(a)),onclick:function(c){var d=c.target;if(/^(TD|DIV)$/.test(d.nodeName)){var e=v(d).firstChild;if(e&&e.hasAttribute("data-chr")){var g=e.getAttribute("data-chr"),h=parseInt(g,10);isNaN(h)||f.insertChar(a,String.fromCharCode(h)),c.ctrlKey||b.close()}}},onmouseover:function(a){var c=v(a.target);c&&c.firstChild?(b.find("#preview").text(c.firstChild.firstChild.data),b.find("#previewTitle").text(c.title)):(b.find("#preview").text(" "),b.find("#previewTitle").text(" "))}};b=a.windowManager.open({title:"Special character",spacing:10,padding:10,items:[c,{type:"container",layout:"flex",direction:"column",align:"center",spacing:5,minWidth:160,minHeight:160,items:[{type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:140,minHeight:80},{type:"spacer",minHeight:20},{type:"label",name:"previewTitle",text:" ",style:"white-space: pre-wrap;",border:1,minWidth:140}]}],buttons:[{text:"Close",onclick:function(){b.close()}}]})},x={open:w},y=function(a){a.addCommand("mceShowCharmap",function(){x.open(a)})},z={register:y},A=function(a){a.addButton("charmap",{icon:"charmap",tooltip:"Special character",cmd:"mceShowCharmap"}),a.addMenuItem("charmap",{icon:"charmap",text:"Special character",cmd:"mceShowCharmap",context:"insert"})},B={register:A};b.add("charmap",function(a){return z.register(a),B.register(a),s.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-code",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),d=function(a){return a.getParam("code_dialog_width",600)},e=function(a){return a.getParam("code_dialog_height",Math.min(c.DOM.getViewPort().h-200,500))},f={getMinWidth:d,getMinHeight:e},g=function(a,b){a.focus(),a.undoManager.transact(function(){a.setContent(b)}),a.selection.setCursorLocation(),a.nodeChanged()},h=function(a){return a.getContent({source_view:!0})},i={setContent:g,getContent:h},j=function(a){var b=f.getMinWidth(a),c=f.getMinHeight(a);a.windowManager.open({title:"Source code",body:{type:"textbox",name:"code",multiline:!0,minWidth:b,minHeight:c,spellcheck:!1,style:"direction: ltr; text-align: left"},onSubmit:function(b){i.setContent(a,b.data.code)}}).find("#code").value(i.getContent(a))},k={open:j},l=function(a){a.addCommand("mceCodeEditor",function(){k.open(a)})},m={register:l},n=function(a){a.addButton("code",{icon:"code",tooltip:"Source code",onclick:function(){k.open(a)}}),a.addMenuItem("code",{icon:"code",text:"Source code",onclick:function(){k.open(a)}})},o={register:n};b.add("code",function(a){return m.register(a),o.register(a),{}})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-colorpicker",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Color"),d=function(a,b){a.find("#preview")[0].getEl().style.background=b},e=function(a,b){var e=c(b),f=e.toRgb();a.fromJSON({r:f.r,g:f.g,b:f.b,hex:e.toHex().substr(1)}),d(a,e.toHex())},f=function(a,b,c){var f=a.windowManager.open({title:"Color",items:{type:"container",layout:"flex",direction:"row",align:"stretch",padding:5,spacing:10,items:[{type:"colorpicker",value:c,onchange:function(){var a=this.rgb();f&&(f.find("#r").value(a.r),f.find("#g").value(a.g),f.find("#b").value(a.b),f.find("#hex").value(this.value().substr(1)),d(f,this.value()))}},{type:"form",padding:0,labelGap:5,defaults:{type:"textbox",size:7,value:"0",flex:1,spellcheck:!1,onchange:function(){var a,b,c=f.find("colorpicker")[0];if(a=this.name(),b=this.value(),"hex"===a)return b="#"+b,e(f,b),void c.value(b);b={r:f.find("#r").value(),g:f.find("#g").value(),b:f.find("#b").value()},c.value(b),e(f,b)}},items:[{name:"r",label:"R",autofocus:1},{name:"g",label:"G"},{name:"b",label:"B"},{name:"hex",label:"#",value:"000000"},{name:"preview",type:"container",border:1}]}]},onSubmit:function(){b("#"+f.toJSON().hex)}});e(f,c)},g={open:f};b.add("colorpicker",function(a){a.settings.color_picker_callback||(a.settings.color_picker_callback=function(b,c){g.open(a,b,c)})})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-contextmenu",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(a){return{isContextMenuVisible:function(){return a.get()}}},e={get:d},f=function(a){return a.settings.contextmenu_never_use_native},g=function(a){return a.getParam("contextmenu","link openlink image inserttable | cell row column deletetable")},h={shouldNeverUseNative:f,getContextMenu:g},i=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),j=function(a){return i.DOM.select(a.settings.ui_container)[0]},k=function(a,b){return{x:a,y:b}},l=function(a,b,c){return k(a.x+b,a.y+c)},m=function(a){return k(a.pageX,a.pageY)},n=function(a){return k(a.clientX,a.clientY)},o=function(a,b){if(a&&"static"!==i.DOM.getStyle(a,"position",!0)){var c=i.DOM.getPos(a),d=c.x-a.scrollLeft,e=c.y-a.scrollTop;return l(b,-d,-e)}return l(b,0,0)},p=function(a,b){var c=i.DOM.getPos(a);return l(b,c.x,c.y)},q=function(a,b){if(a.inline)return o(j(a),m(b));var c=p(a.getContentAreaContainer(),n(b));return o(j(a),c)},r={getPos:q},s=tinymce.util.Tools.resolve("tinymce.ui.Factory"),t=tinymce.util.Tools.resolve("tinymce.util.Tools"),u=function(a,b){var c,d,e=[];d=h.getContextMenu(a),t.each(d.split(/[ ,]/),function(b){var c=a.menuItems[b];"|"===b&&(c={text:b}),c&&(c.shortcut="",e.push(c))});for(var f=0;f<e.length;f++)"|"===e[f].text&&(0!==f&&f!==e.length-1||e.splice(f,1));return c=s.create("menu",{items:e,context:"contextmenu",classes:"contextmenu"}),c.uiContainer=j(a),c.renderTo(j(a)),c.on("hide",function(a){a.control===this&&b.set(!1)}),a.on("remove",function(){c.remove(),c=null}),c},v=function(a,b,c,d){null===d.get()?d.set(u(a,c)):d.get().show(),d.get().moveTo(b.x,b.y),c.set(!0)},w={show:v},x=function(a,b){return b.ctrlKey&&!h.shouldNeverUseNative(a)},y=function(a,b,c){a.on("contextmenu",function(d){x(a,d)||(d.preventDefault(),w.show(a,r.getPos(a,d),b,c))})},z={setup:y};c.add("contextmenu",function(a){var c=b(null),d=b(!1);return z.setup(a,d,c),e.get(d)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-directionality",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(a,b){var d,e=a.dom,f=a.selection.getSelectedBlocks();f.length&&(d=e.getAttrib(f[0],"dir"),c.each(f,function(a){e.getParent(a.parentNode,'*[dir="'+b+'"]',e.getRoot())||e.setAttrib(a,"dir",d!==b?b:null)}),a.nodeChanged())},e={setDir:d},f=function(a){a.addCommand("mceDirectionLTR",function(){e.setDir(a,"ltr")}),a.addCommand("mceDirectionRTL",function(){e.setDir(a,"rtl")})},g={register:f},h=function(a){var b=[];return c.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(c){b.push(c+"[dir="+a+"]")}),b.join(",")},i=function(a){a.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:h("ltr")}),a.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:h("rtl")})},j={register:i};b.add("directionality",function(a){g.register(a),j.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-emoticons",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]],e=function(a){var b;return b='<table role="list" class="mce-grid">',c.each(d,function(d){b+="<tr>",c.each(d,function(c){var d=a+"/img/smiley-"+c+".gif";b+='<td><a href="#" data-mce-url="'+d+'" data-mce-alt="'+c+'" tabindex="-1" role="option" aria-label="'+c+'"><img src="'+d+'" style="width: 18px; height: 18px" role="presentation" /></a></td>'}),b+="</tr>"}),b+="</table>"},f={getHtml:e},g=function(a,b,c){a.insertContent(a.dom.createHTML("img",{src:b,alt:c}))},h=function(a,b){var c=f.getHtml(b);a.addButton("emoticons",{type:"panelbutton",panel:{role:"application",autohide:!0,html:c,onclick:function(b){var c=a.dom.getParent(b.target,"a");c&&(g(a,c.getAttribute("data-mce-url"),c.getAttribute("data-mce-alt")),this.hide())}},tooltip:"Emoticons"})},i={register:h};b.add("emoticons",function(a,b){i.register(a,b)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-fullpage",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=tinymce.util.Tools.resolve("tinymce.util.Tools"),e=tinymce.util.Tools.resolve("tinymce.html.DomParser"),f=tinymce.util.Tools.resolve("tinymce.html.Node"),g=tinymce.util.Tools.resolve("tinymce.html.Serializer"),h=function(a){return a.getParam("fullpage_hide_in_source_view")},i=function(a){return a.getParam("fullpage_default_xml_pi")},j=function(a){return a.getParam("fullpage_default_encoding")},k=function(a){return a.getParam("fullpage_default_font_family")},l=function(a){return a.getParam("fullpage_default_font_size")},m=function(a){return a.getParam("fullpage_default_text_color")},n=function(a){return a.getParam("fullpage_default_title")},o=function(a){return a.getParam("fullpage_default_doctype","<!DOCTYPE html>")},p={shouldHideInSourceView:h,getDefaultXmlPi:i,getDefaultEncoding:j,getDefaultFontFamily:k,getDefaultFontSize:l,getDefaultTextColor:m,getDefaultTitle:n,getDefaultDocType:o},q=function(a){return e({validate:!1,root_name:"#document"}).parse(a)},r=function(a,b){function c(a,b){return a.attr(b)||""}var e,f,g=q(b),h={};return h.fontface=p.getDefaultFontFamily(a),h.fontsize=p.getDefaultFontSize(a),e=g.firstChild,7===e.type&&(h.xml_pi=!0,(f=/encoding="([^"]+)"/.exec(e.value))&&(h.docencoding=f[1])),e=g.getAll("#doctype")[0],e&&(h.doctype="<!DOCTYPE"+e.value+">"),e=g.getAll("title")[0],e&&e.firstChild&&(h.title=e.firstChild.value),d.each(g.getAll("meta"),function(a){var b,c=a.attr("name"),d=a.attr("http-equiv");c?h[c.toLowerCase()]=a.attr("content"):"Content-Type"===d&&(b=/charset\s*=\s*(.*)\s*/gi.exec(a.attr("content")))&&(h.docencoding=b[1])}),e=g.getAll("html")[0],e&&(h.langcode=c(e,"lang")||c(e,"xml:lang")),h.stylesheets=[],d.each(g.getAll("link"),function(a){"stylesheet"===a.attr("rel")&&h.stylesheets.push(a.attr("href"))}),e=g.getAll("body")[0],e&&(h.langdir=c(e,"dir"),h.style=c(e,"style"),h.visited_color=c(e,"vlink"),h.link_color=c(e,"link"),h.active_color=c(e,"alink")),h},s=function(a,b,c){function e(a,b,c){a.attr(b,c||void 0)}function h(a){j.firstChild?j.insert(a,j.firstChild):j.append(a)}var i,j,k,l,m,n=a.dom;i=q(c),j=i.getAll("head")[0],j||(l=i.getAll("html")[0],j=new f("head",1),l.firstChild?l.insert(j,l.firstChild,!0):l.append(j)),l=i.firstChild,b.xml_pi?(m='version="1.0"',b.docencoding&&(m+=' encoding="'+b.docencoding+'"'),7!==l.type&&(l=new f("xml",7),i.insert(l,i.firstChild,!0)),l.value=m):l&&7===l.type&&l.remove(),l=i.getAll("#doctype")[0],b.doctype?(l||(l=new f("#doctype",10),b.xml_pi?i.insert(l,i.firstChild):h(l)),l.value=b.doctype.substring(9,b.doctype.length-1)):l&&l.remove(),l=null,d.each(i.getAll("meta"),function(a){"Content-Type"===a.attr("http-equiv")&&(l=a)}),b.docencoding?(l||(l=new f("meta",1),l.attr("http-equiv","Content-Type"),l.shortEnded=!0,h(l)),l.attr("content","text/html; charset="+b.docencoding)):l&&l.remove(),l=i.getAll("title")[0],b.title?(l?l.empty():(l=new f("title",1),h(l)),l.append(new f("#text",3)).value=b.title):l&&l.remove(),d.each("keywords,description,author,copyright,robots".split(","),function(a){var c,d,e=i.getAll("meta"),g=b[a];for(c=0;c<e.length;c++)if(d=e[c],d.attr("name")===a)return void(g?d.attr("content",g):d.remove());g&&(l=new f("meta",1),l.attr("name",a),l.attr("content",g),l.shortEnded=!0,h(l))});var o={};return d.each(i.getAll("link"),function(a){"stylesheet"===a.attr("rel")&&(o[a.attr("href")]=a)}),d.each(b.stylesheets,function(a){o[a]||(l=new f("link",1),l.attr({rel:"stylesheet",text:"text/css",href:a}),l.shortEnded=!0,h(l)),delete o[a]}),d.each(o,function(a){a.remove()}),l=i.getAll("body")[0],l&&(e(l,"dir",b.langdir),e(l,"style",b.style),e(l,"vlink",b.visited_color),e(l,"link",b.link_color),e(l,"alink",b.active_color),n.setAttribs(a.getBody(),{style:b.style,dir:b.dir,vLink:b.visited_color,link:b.link_color,aLink:b.active_color})),l=i.getAll("html")[0],l&&(e(l,"lang",b.langcode),e(l,"xml:lang",b.langcode)),j.firstChild||j.remove(),k=g({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(i),k.substring(0,k.indexOf("</body>"))},t={parseHeader:q,htmlToData:r,dataToHtml:s},u=function(a,b){var c=t.htmlToData(a,b.get());a.windowManager.open({title:"Document properties",data:c,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(e){var f=t.dataToHtml(a,d.extend(c,e.data),b.get());b.set(f)}})},v={open:u},w=function(a,b){a.addCommand("mceFullPageProperties",function(){v.open(a,b)})},x={register:w},y=function(a,b){return d.each(a,function(a){b=b.replace(a,function(a){return"\x3c!--mce:protected "+escape(a)+"--\x3e"})}),b},z=function(a){return a.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(a,b){return unescape(b)})},A={protectHtml:y,unprotectHtml:z},B=d.each,C=function(a){return a.replace(/<\/?[A-Z]+/g,function(a){return a.toLowerCase()})},D=function(a,b,c,e){var f,g,h,i,j,k="",l=a.dom;if(!(e.selection||(h=A.protectHtml(a.settings.protect,e.content),"raw"===e.format&&b.get()||e.source_view&&p.shouldHideInSourceView(a)))){0!==h.length||e.source_view||(h=d.trim(b.get())+"\n"+d.trim(h)+"\n"+d.trim(c.get())),h=h.replace(/<(\/?)BODY/gi,"<$1body"),f=h.indexOf("<body"),-1!==f?(f=h.indexOf(">",f),b.set(C(h.substring(0,f+1))),g=h.indexOf("</body",f),-1===g&&(g=h.length),e.content=d.trim(h.substring(f+1,g)),c.set(C(h.substring(g)))):(b.set(E(a)),c.set("\n</body>\n</html>")),i=t.parseHeader(b.get()),B(i.getAll("style"),function(a){a.firstChild&&(k+=a.firstChild.value)}),j=i.getAll("body")[0],j&&l.setAttribs(a.getBody(),{style:j.attr("style")||"",dir:j.attr("dir")||"",vLink:j.attr("vlink")||"",link:j.attr("link")||"",aLink:j.attr("alink")||""}),l.remove("fullpage_styles");var m=a.getDoc().getElementsByTagName("head")[0];k&&(l.add(m,"style",{id:"fullpage_styles"},k),j=l.get("fullpage_styles"),j.styleSheet&&(j.styleSheet.cssText=k));var n={};d.each(m.getElementsByTagName("link"),function(a){"stylesheet"===a.rel&&a.getAttribute("data-mce-fullpage")&&(n[a.href]=a)}),d.each(i.getAll("link"),function(a){var b=a.attr("href");if(!b)return!0;n[b]||"stylesheet"!==a.attr("rel")||l.add(m,"link",{rel:"stylesheet",text:"text/css",href:b,"data-mce-fullpage":"1"}),delete n[b]}),d.each(n,function(a){a.parentNode.removeChild(a)})}},E=function(a){var b,c="",d="";if(p.getDefaultXmlPi(a)){var e=p.getDefaultEncoding(a);c+='<?xml version="1.0" encoding="'+(e||"ISO-8859-1")+'" ?>\n'}return c+=p.getDefaultDocType(a),c+="\n<html>\n<head>\n",(b=p.getDefaultTitle(a))&&(c+="<title>"+b+"</title>\n"),(b=p.getDefaultEncoding(a))&&(c+='<meta http-equiv="Content-Type" content="text/html; charset='+b+'" />\n'),(b=p.getDefaultFontFamily(a))&&(d+="font-family: "+b+";"),(b=p.getDefaultFontSize(a))&&(d+="font-size: "+b+";"),(b=p.getDefaultTextColor(a))&&(d+="color: "+b+";"),c+="</head>\n<body"+(d?' style="'+d+'"':"")+">\n"},F=function(a,b,c,e){e.selection||e.source_view&&p.shouldHideInSourceView(a)||(e.content=A.unprotectHtml(d.trim(b)+"\n"+d.trim(e.content)+"\n"+d.trim(c)))},G=function(a,b,c){a.on("BeforeSetContent",function(d){D(a,b,c,d)}),a.on("GetContent",function(d){F(a,b.get(),c.get(),d)})},H={setup:G},I=function(a){a.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),a.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})},J={register:I};c.add("fullpage",function(a){var c=b(""),d=b("");x.register(a,c),J.register(a),H.setup(a,c,d)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-fullscreen",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(a){return{isFullscreen:function(){return null!==a.get()}}},e={get:d},f=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),g=function(a,b){a.fire("FullscreenStateChanged",{state:b})},h={fireFullscreenStateChanged:g},i=f.DOM,j=function(){var a,b,c=window,d=document,e=d.body;return e.offsetWidth&&(a=e.offsetWidth,b=e.offsetHeight),c.innerWidth&&c.innerHeight&&(a=c.innerWidth,b=c.innerHeight),{w:a,h:b}},k=function(){var a=i.getViewPort();return{x:a.x,y:a.y}},l=function(a){window.scrollTo(a.x,a.y)},m=function(a,b){var c,d,e,f,g=document.body,m=document.documentElement,n=b.get(),o=function(){i.setStyle(e,"height",j().h-(d.clientHeight-e.clientHeight))},p=function(){i.unbind(window,"resize",o)};if(d=a.getContainer(),c=d.style,e=a.getContentAreaContainer().firstChild,f=e.style,n)f.width=n.iframeWidth,f.height=n.iframeHeight,n.containerWidth&&(c.width=n.containerWidth),n.containerHeight&&(c.height=n.containerHeight),i.removeClass(g,"mce-fullscreen"),i.removeClass(m,"mce-fullscreen"),i.removeClass(d,"mce-fullscreen"),l(n.scrollPos),i.unbind(window,"resize",n.resizeHandler),a.off("remove",n.removeHandler),b.set(null),h.fireFullscreenStateChanged(a,!1);else{var q={scrollPos:k(),containerWidth:c.width,containerHeight:c.height,iframeWidth:f.width,iframeHeight:f.height,resizeHandler:o,removeHandler:p};f.width=f.height="100%",c.width=c.height="",i.addClass(g,"mce-fullscreen"),i.addClass(m,"mce-fullscreen"),i.addClass(d,"mce-fullscreen"),i.bind(window,"resize",o),a.on("remove",p),o(),b.set(q),h.fireFullscreenStateChanged(a,!0)}},n={toggleFullscreen:m},o=function(a,b){a.addCommand("mceFullScreen",function(){n.toggleFullscreen(a,b)})},p={register:o},q=function(a){return function(b){var c=b.control;a.on("FullscreenStateChanged",function(a){c.active(a.state)})}},r=function(a){a.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Shift+F",selectable:!0,cmd:"mceFullScreen",onPostRender:q(a),context:"view"}),a.addButton("fullscreen",{active:!1,tooltip:"Fullscreen",cmd:"mceFullScreen",onPostRender:q(a)})},s={register:r};c.add("fullscreen",function(a){var c=b(null);return a.settings.inline?e.get(c):(p.register(a,c),s.register(a),a.addShortcut("Ctrl+Shift+F","","mceFullScreen"),e.get(c))})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-hr",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a){a.addCommand("InsertHorizontalRule",function(){a.execCommand("mceInsertContent",!1,"<hr />")})},d={register:c},e=function(a){a.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),a.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})},f={register:e};b.add("hr",function(a){d.register(a),f.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-image",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){return new(E.getOrDie("FileReader"))}function b(){return new(E.getOrDie("XMLHttpRequest"))}function c(a){var c=function(c,d,e,f){var g,h;g=new b,g.open("POST",a.url),g.withCredentials=a.credentials,g.upload.onprogress=function(a){f(a.loaded/a.total*100)},g.onerror=function(){e("Image upload failed due to a XHR Transport error. Code: "+g.status)},g.onload=function(){var b;return g.status<200||g.status>=300?void e("HTTP Error: "+g.status):(b=JSON.parse(g.responseText))&&"string"==typeof b.location?void d(eb(a.basePath,b.location)):void e("Invalid JSON: "+g.responseText)},h=new FormData,h.append("file",c.blob(),c.filename()),g.send(h)},d=function(a,b){return new F(function(c,d){try{b(a,c,d,db)}catch(a){d(a.message)}})},e=function(a){return a===c},f=function(b){return!a.url&&e(a.handler)?F.reject("Upload url missing from the settings."):d(b,a.handler)};return a=G.extend({credentials:!1,handler:c},a),{upload:f}}function d(a){function b(b){var c,d,e=Ea(a);if(b&&(d={type:"listbox",label:"Image list",name:"image-list",values:R.buildListItems(b,function(b){b.value=a.convertURL(b.value||b.url,"src")},[{text:"None",value:""}]),value:e.src&&a.convertURL(e.src,"src"),onselect:function(a){var b=c.find("#alt");(!b.value()||a.lastControl&&b.value()===a.lastControl.text())&&b.value(a.control.text()),c.find("#src").value(a.control.value()).fire("change")},onPostRender:function(){d=this}}),u.hasAdvTab(a)||u.hasUploadUrl(a)||u.hasUploadHandler(a)){var f=[Za.makeTab(a,d)];u.hasAdvTab(a)&&f.push(Na.makeTab(a)),(u.hasUploadUrl(a)||u.hasUploadHandler(a))&&f.push(hb.makeTab(a)),c=a.windowManager.open({title:"Insert/edit image",data:e,bodyType:"tabpanel",body:f,onSubmit:vb.curry(wb,a)})}else c=a.windowManager.open({title:"Insert/edit image",data:e,body:Za.getGeneralItems(a,d),onSubmit:vb.curry(wb,a)});Ua.syncSize(c)}function c(){R.createImageList(a,b)}return{open:c}}function e(){}var f=tinymce.util.Tools.resolve("tinymce.PluginManager"),g=function(a){return!1!==a.settings.image_dimensions},h=function(a){return!0===a.settings.image_advtab},i=function(a){return a.getParam("image_prepend_url","")},j=function(a){return a.getParam("image_class_list")},k=function(a){return!1!==a.settings.image_description},l=function(a){return!0===a.settings.image_title},m=function(a){return!0===a.settings.image_caption},n=function(a){return a.getParam("image_list",!1)},o=function(a){return a.getParam("images_upload_url",!1)},p=function(a){return a.getParam("images_upload_handler",!1)},q=function(a){return a.getParam("images_upload_url")},r=function(a){return a.getParam("images_upload_handler")},s=function(a){return a.getParam("images_upload_base_path")},t=function(a){return a.getParam("images_upload_credentials")},u={hasDimensions:g,hasAdvTab:h,getPrependUrl:i,getClassList:j,hasDescription:k,hasImageTitle:l,hasImageCaption:m,getImageList:n,hasUploadUrl:o,hasUploadHandler:p,getUploadUrl:q,getUploadHandler:r,getUploadBasePath:s,getUploadCredentials:t},v="undefined"!=typeof window?window:Function("return this;")(),w=function(a,b){for(var c=void 0!==b&&null!==b?b:v,d=0;d<a.length&&void 0!==c&&null!==c;++d)c=c[a[d]];return c},x=function(a,b){var c=a.split(".");return w(c,b)},y=function(a,b){return void 0!==a[b]&&null!==a[b]||(a[b]={}),a[b]},z=function(a,b){for(var c=void 0!==b?b:v,d=0;d<a.length;++d)c=y(c,a[d]);return c},A=function(a,b){var c=a.split(".");return z(c,b)},B={path:w,resolve:x,forge:z,namespace:A},C=function(a,b){return B.resolve(a,b)},D=function(a,b){var c=C(a,b);if(void 0===c||null===c)throw a+" not available on this browser";return c},E={getOrDie:D
},F=tinymce.util.Tools.resolve("tinymce.util.Promise"),G=tinymce.util.Tools.resolve("tinymce.util.Tools"),H=tinymce.util.Tools.resolve("tinymce.util.XHR"),I=function(a,b){return Math.max(parseInt(a,10),parseInt(b,10))},J=function(a,b){function c(a,c){d.parentNode&&d.parentNode.removeChild(d),b({width:a,height:c})}var d=document.createElement("img");d.onload=function(){c(I(d.width,d.clientWidth),I(d.height,d.clientHeight))},d.onerror=function(){c(0,0)};var e=d.style;e.visibility="hidden",e.position="fixed",e.bottom=e.left="0px",e.width=e.height="auto",document.body.appendChild(d),d.src=a},K=function(a,b,c){function d(a,c){return c=c||[],G.each(a,function(a){var e={text:a.text||a.title};a.menu?e.menu=d(a.menu):(e.value=a.value,b(e)),c.push(e)}),c}return d(a,c||[])},L=function(a){return a&&(a=a.replace(/px$/,"")),a},M=function(a){return a.length>0&&/^[0-9]+$/.test(a)&&(a+="px"),a},N=function(a){if(a.margin){var b=a.margin.split(" ");switch(b.length){case 1:a["margin-top"]=a["margin-top"]||b[0],a["margin-right"]=a["margin-right"]||b[0],a["margin-bottom"]=a["margin-bottom"]||b[0],a["margin-left"]=a["margin-left"]||b[0];break;case 2:a["margin-top"]=a["margin-top"]||b[0],a["margin-right"]=a["margin-right"]||b[1],a["margin-bottom"]=a["margin-bottom"]||b[0],a["margin-left"]=a["margin-left"]||b[1];break;case 3:a["margin-top"]=a["margin-top"]||b[0],a["margin-right"]=a["margin-right"]||b[1],a["margin-bottom"]=a["margin-bottom"]||b[2],a["margin-left"]=a["margin-left"]||b[1];break;case 4:a["margin-top"]=a["margin-top"]||b[0],a["margin-right"]=a["margin-right"]||b[1],a["margin-bottom"]=a["margin-bottom"]||b[2],a["margin-left"]=a["margin-left"]||b[3]}delete a.margin}return a},O=function(a,b){var c=u.getImageList(a);"string"==typeof c?H.send({url:c,success:function(a){b(JSON.parse(a))}}):"function"==typeof c?c(b):b(c)},P=function(a,b,c){function d(){c.onload=c.onerror=null,a.selection&&(a.selection.select(c),a.nodeChanged())}c.onload=function(){b.width||b.height||!u.hasDimensions(a)||a.dom.setAttribs(c,{width:c.clientWidth,height:c.clientHeight}),d()},c.onerror=d},Q=function(b){return new F(function(c,d){var e=new a;e.onload=function(){c(e.result)},e.onerror=function(){d(a.error.message)},e.readAsDataURL(b)})},R={getImageSize:J,buildListItems:K,removePixelSuffix:L,addPixelSuffix:M,mergeMargins:N,createImageList:O,waitLoadImage:P,blobToDataUri:Q},S=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),T=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&Array.prototype.isPrototypeOf(a)?"array":"object"===b&&String.prototype.isPrototypeOf(a)?"string":b},U=function(a){return function(b){return T(b)===a}},V={isString:U("string"),isObject:U("object"),isArray:U("array"),isNull:U("null"),isBoolean:U("boolean"),isUndefined:U("undefined"),isFunction:U("function"),isNumber:U("number")},W=function(a,b){return b},X=function(a,b){return V.isObject(a)&&V.isObject(b)?Z(a,b):b},Y=function(a){return function(){for(var b=new Array(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];if(0===b.length)throw new Error("Can't merge zero objects");for(var d={},e=0;e<b.length;e++){var f=b[e];for(var g in f)f.hasOwnProperty(g)&&(d[g]=a(d[g],f[g]))}return d}},Z=Y(X),$=Y(W),_={deepMerge:Z,merge:$},aa=S.DOM,ba=function(a){return a.style.marginLeft&&a.style.marginRight&&a.style.marginLeft===a.style.marginRight?R.removePixelSuffix(a.style.marginLeft):""},ca=function(a){return a.style.marginTop&&a.style.marginBottom&&a.style.marginTop===a.style.marginBottom?R.removePixelSuffix(a.style.marginTop):""},da=function(a){return a.style.borderWidth?R.removePixelSuffix(a.style.borderWidth):""},ea=function(a,b){return a.hasAttribute(b)?a.getAttribute(b):""},fa=function(a,b){return a.style[b]?a.style[b]:""},ga=function(a){return null!==a.parentNode&&"FIGURE"===a.parentNode.nodeName},ha=function(a,b,c){a.setAttribute(b,c)},ia=function(a){var b=aa.create("figure",{class:"image"});aa.insertAfter(b,a),b.appendChild(a),b.appendChild(aa.create("figcaption",{contentEditable:!0},"Caption")),b.contentEditable="false"},ja=function(a){var b=a.parentNode;aa.insertAfter(a,b),aa.remove(b)},ka=function(a){ga(a)?ja(a):ia(a)},la=function(a,b){var c=a.getAttribute("style"),d=b(null!==c?c:"");d.length>0?(a.setAttribute("style",d),a.setAttribute("data-mce-style",d)):a.removeAttribute("style")},ma=function(a,b){return function(a,c,d){a.style[c]?(a.style[c]=R.addPixelSuffix(d),la(a,b)):ha(a,c,d)}},na=function(a,b){return a.style[b]?R.removePixelSuffix(a.style[b]):ea(a,b)},oa=function(a,b){var c=R.addPixelSuffix(b);a.style.marginLeft=c,a.style.marginRight=c},pa=function(a,b){var c=R.addPixelSuffix(b);a.style.marginTop=c,a.style.marginBottom=c},qa=function(a,b){var c=R.addPixelSuffix(b);a.style.borderWidth=c},ra=function(a,b){a.style.borderStyle=b},sa=function(a){return fa(a,"borderStyle")},ta=function(a){return"FIGURE"===a.nodeName},ua=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}},va=function(a,b){var c=document.createElement("img");return ha(c,"style",b.style),(ba(c)||""!==b.hspace)&&oa(c,b.hspace),(ca(c)||""!==b.vspace)&&pa(c,b.vspace),(da(c)||""!==b.border)&&qa(c,b.border),(sa(c)||""!==b.borderStyle)&&ra(c,b.borderStyle),a(c.getAttribute("style"))},wa=function(a,b){var c=document.createElement("img");if(Aa(a,_.merge(b,{caption:!1}),c),ha(c,"alt",b.alt),b.caption){var d=aa.create("figure",{class:"image"});return d.appendChild(c),d.appendChild(aa.create("figcaption",{contentEditable:!0},"Caption")),d.contentEditable="false",d}return c},xa=function(a,b){return{src:ea(b,"src"),alt:ea(b,"alt"),title:ea(b,"title"),width:na(b,"width"),height:na(b,"height"),class:ea(b,"class"),style:a(ea(b,"style")),caption:ga(b),hspace:ba(b),vspace:ca(b),border:da(b),borderStyle:fa(b,"borderStyle")}},ya=function(a,b,c,d,e){c[d]!==b[d]&&e(a,d,c[d])},za=function(a,b){return function(c,d,e){a(c,e),la(c,b)}},Aa=function(a,b,c){var d=xa(a,c);ya(c,d,b,"caption",function(a,b,c){return ka(a)}),ya(c,d,b,"src",ha),ya(c,d,b,"alt",ha),ya(c,d,b,"title",ha),ya(c,d,b,"width",ma(0,a)),ya(c,d,b,"height",ma(0,a)),ya(c,d,b,"class",ha),ya(c,d,b,"style",za(function(a,b){return ha(a,"style",b)},a)),ya(c,d,b,"hspace",za(oa,a)),ya(c,d,b,"vspace",za(pa,a)),ya(c,d,b,"border",za(qa,a)),ya(c,d,b,"borderStyle",za(ra,a))},Ba=function(a,b){var c=a.dom.styles.parse(b),d=R.mergeMargins(c),e=a.dom.styles.parse(a.dom.styles.serialize(d));return a.dom.styles.serialize(e)},Ca=function(a){var b=a.selection.getNode(),c=a.dom.getParent(b,"figure.image");return c?a.dom.select("img",c)[0]:b&&("IMG"!==b.nodeName||b.getAttribute("data-mce-object")||b.getAttribute("data-mce-placeholder"))?null:b},Da=function(a,b){var c=a.dom,d=c.getParent(b.parentNode,function(b){return a.schema.getTextBlockElements()[b.nodeName]});return d?c.split(d,b):b},Ea=function(a){var b=Ca(a);return b?xa(function(b){return Ba(a,b)},b):ua()},Fa=function(a,b){var c=wa(function(b){return Ba(a,b)},b);a.dom.setAttrib(c,"data-mce-id","__mcenew"),a.focus(),a.selection.setContent(c.outerHTML);var d=a.dom.select('*[data-mce-id="__mcenew"]')[0];if(a.dom.setAttrib(d,"data-mce-id",null),ta(d)){var e=Da(a,d);a.selection.select(e)}else a.selection.select(d)},Ga=function(a,b){a.dom.setAttrib(b,"src",b.getAttribute("src"))},Ha=function(a,b){if(b){var c=a.dom.is(b.parentNode,"figure.image")?b.parentNode:b;a.dom.remove(c),a.focus(),a.nodeChanged(),a.dom.isEmpty(a.getBody())&&(a.setContent(""),a.selection.setCursorLocation())}},Ia=function(a,b){var c=Ca(a);if(Aa(function(b){return Ba(a,b)},b,c),Ga(a,c),ta(c.parentNode)){var d=c.parentNode;Da(a,d),a.selection.select(c.parentNode)}else a.selection.select(c),R.waitLoadImage(a,b,c)},Ja=function(a,b){var c=Ca(a);c?b.src?Ia(a,b):Ha(a,c):b.src&&Fa(a,b)},Ka=function(a){return function(b){var c=a.dom,d=b.control.rootControl;if(u.hasAdvTab(a)){var e=d.toJSON(),f=c.parseStyle(e.style);d.find("#vspace").value(""),d.find("#hspace").value(""),f=R.mergeMargins(f),(f["margin-top"]&&f["margin-bottom"]||f["margin-right"]&&f["margin-left"])&&(f["margin-top"]===f["margin-bottom"]?d.find("#vspace").value(R.removePixelSuffix(f["margin-top"])):d.find("#vspace").value(""),f["margin-right"]===f["margin-left"]?d.find("#hspace").value(R.removePixelSuffix(f["margin-right"])):d.find("#hspace").value("")),f["border-width"]?d.find("#border").value(R.removePixelSuffix(f["border-width"])):d.find("#border").value(""),f["border-style"]?d.find("#borderStyle").value(f["border-style"]):d.find("#borderStyle").value(""),d.find("#style").value(c.serializeStyle(c.parseStyle(c.serializeStyle(f))))}}},La=function(a,b){b.find("#style").each(function(c){var d=va(function(b){return Ba(a,b)},_.merge(ua(),b.toJSON()));c.value(d)})},Ma=function(a){return{title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox",onchange:Ka(a)},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,defaults:{type:"textbox",maxWidth:50,onchange:function(b){La(a,b.control.rootControl)}},items:[{label:"Vertical space",name:"vspace"},{label:"Border width",name:"border"},{label:"Horizontal space",name:"hspace"},{label:"Border style",type:"listbox",name:"borderStyle",width:90,maxWidth:90,onselect:function(b){La(a,b.control.rootControl)},values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},Na={makeTab:Ma},Oa=function(a,b){a.state.set("oldVal",a.value()),b.state.set("oldVal",b.value())},Pa=function(a,b){var c=a.find("#width")[0],d=a.find("#height")[0],e=a.find("#constrain")[0];c&&d&&e&&b(c,d,e.checked())},Qa=function(a,b,c){var d=a.state.get("oldVal"),e=b.state.get("oldVal"),f=a.value(),g=b.value();c&&d&&e&&f&&g&&(f!==d?(g=Math.round(f/d*g),isNaN(g)||b.value(g)):(f=Math.round(g/e*f),isNaN(f)||a.value(f))),Oa(a,b)},Ra=function(a){Pa(a,Oa)},Sa=function(a){Pa(a,Qa)},Ta=function(){var a=function(a){Sa(a.control.rootControl)};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:a,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:a,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},Ua={createUi:Ta,syncSize:Ra,updateSize:Sa},Va=function(a,b){var c,d,e,f=a.meta||{},g=a.control,h=g.rootControl,i=h.find("#image-list")[0];i&&i.value(b.convertURL(g.value(),"src")),G.each(f,function(a,b){h.find("#"+b).value(a)}),f.width||f.height||(c=b.convertURL(g.value(),"src"),d=u.getPrependUrl(b),e=new RegExp("^(?:[a-z]+:)?//","i"),d&&!e.test(c)&&c.substring(0,d.length)!==d&&(c=d+c),g.value(c),R.getImageSize(b.documentBaseURI.toAbsolute(g.value()),function(a){a.width&&a.height&&u.hasDimensions(b)&&(h.find("#width").value(a.width),h.find("#height").value(a.height),Ua.syncSize(h))}))},Wa=function(a){a.meta=a.control.rootControl.toJSON()},Xa=function(a,b){var c=[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0,onchange:function(b){Va(b,a)},onbeforecall:Wa},b];return u.hasDescription(a)&&c.push({name:"alt",type:"textbox",label:"Image description"}),u.hasImageTitle(a)&&c.push({name:"title",type:"textbox",label:"Image Title"}),u.hasDimensions(a)&&c.push(Ua.createUi()),u.getClassList(a)&&c.push({name:"class",type:"listbox",label:"Class",values:R.buildListItems(u.getClassList(a),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({inline:"img",classes:[b.value]})})})}),u.hasImageCaption(a)&&c.push({name:"caption",type:"checkbox",label:"Caption"}),c},Ya=function(a,b){return{title:"General",type:"form",items:Xa(a,b)}},Za={makeTab:Ya,getGeneralItems:Xa},$a=function(){return E.getOrDie("URL")},_a=function(a){return $a().createObjectURL(a)},ab=function(a){$a().revokeObjectURL(a)},bb={createObjectURL:_a,revokeObjectURL:ab},cb=tinymce.util.Tools.resolve("tinymce.ui.Factory"),db=function(){},eb=function(a,b){return a?a.replace(/\/$/,"")+"/"+b.replace(/^\//,""):b},fb=function(a){return function(b){var d=cb.get("Throbber"),e=b.control.rootControl,f=new d(e.getEl()),g=b.control.value(),h=bb.createObjectURL(g),i=c({url:u.getUploadUrl(a),basePath:u.getUploadBasePath(a),credentials:u.getUploadCredentials(a),handler:u.getUploadHandler(a)}),j=function(){f.hide(),bb.revokeObjectURL(h)};return f.show(),R.blobToDataUri(g).then(function(b){var c=a.editorUpload.blobCache.create({blob:g,blobUri:h,name:g.name?g.name.replace(/\.[^\.]+$/,""):null,base64:b.split(",")[1]});return i.upload(c).then(function(a){var b=e.find("#src");return b.value(a),e.find("tabpanel")[0].activateTab(0),b.fire("change"),j(),a})}).catch(function(b){a.windowManager.alert(b),j()})}},gb=function(a){return{title:"Upload",type:"form",layout:"flex",direction:"column",align:"stretch",padding:"20 20 20 20",items:[{type:"container",layout:"flex",direction:"column",align:"center",spacing:10,items:[{text:"Browse for an image",type:"browsebutton",accept:".jpg,.jpeg,.png,.gif",onchange:fb(a)},{text:"OR",type:"label"}]},{text:"Drop an image here",type:"dropzone",accept:".jpg,.jpeg,.png,.gif",height:100,onchange:fb(a)}]}},hb={makeTab:gb},ib=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},jb=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},kb=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},lb=function(a){return function(){return a}},mb=function(a){return a},nb=function(a,b){return a===b},ob=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},pb=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},qb=function(a){return function(){throw new Error(a)}},rb=function(a){return a()},sb=function(a){a()},tb=lb(!1),ub=lb(!0),vb={noop:ib,noarg:jb,compose:kb,constant:lb,identity:mb,tripleEquals:nb,curry:ob,not:pb,die:qb,apply:rb,call:sb,never:tb,always:ub},wb=function(a,b){var c=b.control.getRoot();Ua.updateSize(c),a.undoManager.transact(function(){var b=_.merge(Ea(a),c.toJSON());Ja(a,b)}),a.editorUpload.uploadImagesAuto()},xb=function(a){a.addCommand("mceImage",d(a).open)},yb={register:xb},zb=function(a){var b=a.attr("class");return b&&/\bimage\b/.test(b)},Ab=function(a){return function(b){for(var c,d=b.length,e=function(b){b.attr("contenteditable",a?"true":null)};d--;)c=b[d],zb(c)&&(c.attr("contenteditable",a?"false":null),G.each(c.getAll("figcaption"),e))}},Bb=function(a){a.on("preInit",function(){a.parser.addNodeFilter("figure",Ab(!0)),a.serializer.addNodeFilter("figure",Ab(!1))})},Cb={setup:Bb},Db=function(a){a.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:d(a).open,stateSelector:"img:not([data-mce-object],[data-mce-placeholder]),figure.image"}),a.addMenuItem("image",{icon:"image",text:"Image",onclick:d(a).open,context:"insert",prependToContext:!0})},Eb={register:Db};f.add("image",function(a){Cb.setup(a),Eb.register(a),yb.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-importcss",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),d=tinymce.util.Tools.resolve("tinymce.EditorManager"),e=tinymce.util.Tools.resolve("tinymce.Env"),f=tinymce.util.Tools.resolve("tinymce.util.Tools"),g=function(a){return a.getParam("importcss_merge_classes")},h=function(a){return a.getParam("importcss_exclusive")},i=function(a){return a.getParam("importcss_selector_converter")},j=function(a){return a.getParam("importcss_selector_filter")},k=function(a){return a.getParam("importcss_groups")},l=function(a){return a.getParam("importcss_append")},m=function(a){return a.getParam("importcss_file_filter")},n={shouldMergeClasses:g,shouldImportExclusive:h,getSelectorConverter:i,getSelectorFilter:j,getCssGroups:k,shouldAppend:l,getFileFilter:m},o=function(a){var b=e.cacheSuffix;return"string"==typeof a&&(a=a.replace("?"+b,"").replace("&"+b,"")),a},p=function(a,b){var c=a.settings,e=!1!==c.skin&&(c.skin||"lightgray");if(e){return b===(c.skin_url?a.documentBaseURI.toAbsolute(c.skin_url):d.baseURL+"/skins/"+e)+"/content"+(a.inline?".inline":"")+".min.css"}return!1},q=function(a){return"string"==typeof a?function(b){return-1!==b.indexOf(a)}:a instanceof RegExp?function(b){return a.test(b)}:a},r=function(a,b,c){function d(b,g){var h,i=b.href;if((i=o(i))&&c(i,g)&&!p(a,i)){f.each(b.imports,function(a){d(a,!0)});try{h=b.cssRules||b.rules}catch(a){}f.each(h,function(a){a.styleSheet?d(a.styleSheet,!0):a.selectorText&&f.each(a.selectorText.split(","),function(a){e.push(f.trim(a))})})}}var e=[],g={};f.each(a.contentCSS,function(a){g[a]=!0}),c||(c=function(a,b){return b||g[a]});try{f.each(b.styleSheets,function(a){d(a)})}catch(a){}return e},s=function(a,b){var c,d=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(b);if(d){var e=d[1],g=d[2].substr(1).split(".").join(" "),h=f.makeMap("a,img");return d[1]?(c={title:b},a.schema.getTextBlockElements()[e]?c.block=e:a.schema.getBlockElements()[e]||h[e.toLowerCase()]?c.selector=e:c.inline=e):d[2]&&(c={inline:"span",title:b.substr(1),classes:g}),!1!==n.shouldMergeClasses(a)?c.classes=g:c.attributes={class:g},c}},t=function(a,b){return f.grep(a,function(a){return!a.filter||a.filter(b)})},u=function(a){return f.map(a,function(a){return f.extend({},a,{original:a,selectors:{},filter:q(a.filter),item:{text:a.title,menu:[]}})})},v=function(a,b){return null===b||!1!==n.shouldImportExclusive(a)},w=function(a,b,c,d){return!(v(a,c)?b in d:b in c.selectors)},x=function(a,b,c,d){v(a,c)?d[b]=!0:c.selectors[b]=!0},y=function(a,b,c,d){var e;return e=d&&d.selector_converter?d.selector_converter:n.getSelectorConverter(a)?n.getSelectorConverter(a):function(){return s(a,c)},e.call(b,c,d)},z=function(a){a.on("renderFormatsMenu",function(b){var d={},e=q(n.getSelectorFilter(a)),g=b.control,h=u(n.getCssGroups(a)),i=function(b,e){if(w(a,b,e,d)){x(a,b,e,d);var h=y(a,a.plugins.importcss,b,e);if(h){var i=h.name||c.DOM.uniqueId();return a.formatter.register(i,h),f.extend({},g.settings.itemDefaults,{text:h.title,format:i})}}return null};n.shouldAppend(a)||g.items().remove(),f.each(r(a,b.doc||a.getDoc(),q(n.getFileFilter(a))),function(a){if(-1===a.indexOf(".mce-")&&(!e||e(a))){var b=t(h,a);if(b.length>0)f.each(b,function(b){var c=i(a,b);c&&b.item.menu.push(c)});else{var c=i(a,null);c&&g.add(c)}}}),f.each(h,function(a){a.item.menu.length>0&&g.add(a.item)}),b.control.renderNew()})},A={defaultConvertSelectorToFormat:s,setup:z},B=function(a){return{convertSelectorToFormat:function(b){return A.defaultConvertSelectorToFormat(a,b)}}},C={get:B};b.add("importcss",function(a){return A.setup(a),C.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-insertdatetime",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(a){return a.getParam("insertdatetime_dateformat",a.translate("%Y-%m-%d"))},e=function(a){return a.getParam("insertdatetime_timeformat",a.translate("%H:%M:%S"))},f=function(a){return a.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])},g=function(a){var b=f(a);return b.length>0?b[0]:e(a)},h=function(a){return a.getParam("insertdatetime_element",!1)},i={getDateFormat:d,getTimeFormat:e,getFormats:f,getDefaultDateTime:g,shouldInsertTimeElement:h},j="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),k="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),m="January February March April May June July August September October November December".split(" "),n=function(a,b){if(a=""+a,a.length<b)for(var c=0;c<b-a.length;c++)a="0"+a;return a},o=function(a,b,c){return c=c||new Date,b=b.replace("%D","%m/%d/%Y"),b=b.replace("%r","%I:%M:%S %p"),b=b.replace("%Y",""+c.getFullYear()),b=b.replace("%y",""+c.getYear()),b=b.replace("%m",n(c.getMonth()+1,2)),b=b.replace("%d",n(c.getDate(),2)),b=b.replace("%H",""+n(c.getHours(),2)),b=b.replace("%M",""+n(c.getMinutes(),2)),b=b.replace("%S",""+n(c.getSeconds(),2)),b=b.replace("%I",""+((c.getHours()+11)%12+1)),b=b.replace("%p",c.getHours()<12?"AM":"PM"),b=b.replace("%B",""+a.translate(m[c.getMonth()])),b=b.replace("%b",""+a.translate(l[c.getMonth()])),b=b.replace("%A",""+a.translate(k[c.getDay()])),b=b.replace("%a",""+a.translate(j[c.getDay()])),b=b.replace("%%","%")},p=function(a,b,c,d){var e=a.dom.create("time",{datetime:c},d);b.parentNode.insertBefore(e,b),a.dom.remove(b),a.selection.select(e,!0),a.selection.collapse(!1)},q=function(a,b){if(i.shouldInsertTimeElement(a)){var c=o(a,b),d=void 0;d=/%[HMSIp]/.test(b)?o(a,"%Y-%m-%dT%H:%M"):o(a,"%Y-%m-%d");var e=a.dom.getParent(a.selection.getStart(),"time");e?p(a,e,d,c):a.insertContent('<time datetime="'+d+'">'+c+"</time>")}else a.insertContent(o(a,b))},r={insertDateTime:q,getDateTime:o},s=function(a){a.addCommand("mceInsertDate",function(){r.insertDateTime(a,i.getDateFormat(a))}),a.addCommand("mceInsertTime",function(){r.insertDateTime(a,i.getTimeFormat(a))})},t={register:s},u=tinymce.util.Tools.resolve("tinymce.util.Tools"),v=function(a,b){var c=i.getFormats(a);return u.map(c,function(c){return{text:r.getDateTime(a,c),onclick:function(){b.set(c),r.insertDateTime(a,c)}}})},w=function(a,b){var c=v(a,b);a.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",menu:c,onclick:function(){var c=b.get();r.insertDateTime(a,c||i.getDefaultDateTime(a))}}),a.addMenuItem("insertdatetime",{icon:"date",text:"Date/time",menu:c,context:"insert"})},x={register:w};c.add("insertdatetime",function(a){var c=b(null);t.register(a),x.register(a,c)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-legacyoutput",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(a){var b="p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img",d=c.explode(a.settings.font_size_style_values),e=a.schema;a.formatter.register({alignleft:{selector:b,attributes:{align:"left"}},aligncenter:{selector:b,attributes:{align:"center"}},alignright:{selector:b,attributes:{align:"right"}},alignjustify:{selector:b,attributes:{align:"justify"}},bold:[{inline:"b",remove:"all"},{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"i",remove:"all"},{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"strike",remove:"all"},{inline:"span",styles:{textDecoration:"line-through"},exact:!0}],fontname:{inline:"font",attributes:{face:"%value"}},fontsize:{inline:"font",attributes:{size:function(a){return c.inArray(d,a.value)+1}}},forecolor:{inline:"font",attributes:{color:"%value"}},hilitecolor:{inline:"font",styles:{backgroundColor:"%value"}}}),c.each("b,i,u,strike".split(","),function(a){e.addValidElements(a+"[*]")}),e.getElementRule("font")||e.addValidElements("font[face|size|color|style]"),c.each(b.split(","),function(a){var b=e.getElementRule(a);b&&(b.attributes.align||(b.attributes.align={},b.attributesOrder.push("align")))})},e=function(a){a.settings.inline_styles=!1,a.on("init",function(){d(a)})},f={setup:e},g=function(a){a.addButton("fontsizeselect",function(){var b=[],c=a.settings.fontsizeFormats||"8pt=1 10pt=2 12pt=3 14pt=4 18pt=5 24pt=6 36pt=7";return a.$.each(c.split(" "),function(a,c){var d=c,e=c,f=c.split("=");f.length>1&&(d=f[0],e=f[1]),b.push({text:d,value:e})}),{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:b,fixedWidth:!0,onPostRender:function(){var b=this;a.on("NodeChange",function(){var c;c=a.dom.getParent(a.selection.getNode(),"font"),c?b.value(c.size):b.value("")})},onclick:function(b){b.control.settings.value&&a.execCommand("FontSize",!1,b.control.settings.value)}}}),a.addButton("fontselect",function(){var b=[],c=function(a){a=a.replace(/;$/,"").split(";");for(var b=a.length;b--;)a[b]=a[b].split("=");return a}(a.settings.font_formats||"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats");return a.$.each(c,function(a,c){b.push({text:{raw:c[0]},value:c[1],textStyle:-1===c[1].indexOf("dings")?"font-family:"+c[1]:""})}),{type:"listbox",text:"Font Family",tooltip:"Font Family",values:b,fixedWidth:!0,onPostRender:function(){var b=this;a.on("NodeChange",function(){var c;c=a.dom.getParent(a.selection.getNode(),"font"),c?b.value(c.face):b.value("")})},onselect:function(b){b.control.settings.value&&a.execCommand("FontName",!1,b.control.settings.value)}}})},h={register:g};b.add("legacyoutput",function(a){f.setup(a),h.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-link",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.VK"),d=function(a){return"boolean"==typeof a.link_assume_external_targets&&a.link_assume_external_targets},e=function(a){return"boolean"==typeof a.link_context_toolbar&&a.link_context_toolbar},f=function(a){return a.link_list},g=function(a){return"string"==typeof a.default_link_target},h=function(a){return a.default_link_target},i=function(a){return a.target_list},j=function(a,b){a.settings.target_list=b},k=function(a){return!1!==i(a)},l=function(a){return a.rel_list},m=function(a){return void 0!==l(a)},n=function(a){return a.link_class_list},o=function(a){return void 0!==n(a)},p=function(a){return!1!==a.link_title},q=function(a){return"boolean"==typeof a.allow_unsafe_link_target&&a.allow_unsafe_link_target},r={assumeExternalTargets:d,hasContextToolbar:e,getLinkList:f,hasDefaultLinkTarget:g,getDefaultLinkTarget:h,getTargetList:i,setTargetList:j,shouldShowTargetList:k,getRelList:l,hasRelList:m,getLinkClassList:n,hasLinkClassList:o,shouldShowLinkTitle:p,allowUnsafeLinkTarget:q},s=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),t=tinymce.util.Tools.resolve("tinymce.Env"),u=function(a,b){document.body.appendChild(a),a.dispatchEvent(b),document.body.removeChild(a)},v=function(a){if(!t.ie||t.ie>10){var b=document.createElement("a");b.target="_blank",b.href=a,b.rel="noreferrer noopener";var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),u(b,c)}else{var d=window.open("","_blank");if(d){d.opener=null;var e=d.document;e.open(),e.write('<meta http-equiv="refresh" content="0; url='+s.DOM.encode(a)+'">'),e.close()}}},w={open:v},x=tinymce.util.Tools.resolve("tinymce.util.Tools"),y=function(a,b){var c=["noopener"],d=a?a.split(/\s+/):[],e=function(a){return a.filter(function(a){return-1===x.inArray(c,a)})};return d=b?function(a){return a=e(a),a.length?a.concat(c):c}(d):e(d),d.length?function(a){return x.trim(a.sort().join(" "))}(d):null},z=function(a){return a.replace(/\uFEFF/g,"")},A=function(a,b){return b=b||a.selection.getNode(),F(b)?a.dom.select("a[href]",b)[0]:a.dom.getParent(b,"a[href]")},B=function(a,b){var c=b?b.innerText||b.textContent:a.getContent({format:"text"});return z(c)},C=function(a){return a&&"A"===a.nodeName&&a.href},D=function(a){return x.grep(a,C).length>0},E=function(a){return!(/</.test(a)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(a)||-1===a.indexOf("href=")))},F=function(a){return a&&"FIGURE"===a.nodeName&&/\bimage\b/i.test(a.className)},G=function(a,b){return function(c){a.undoManager.transact(function(){var d=a.selection.getNode(),e=A(a,d),f={href:c.href,target:c.target?c.target:null,rel:c.rel?c.rel:null,class:c.class?c.class:null,title:c.title?c.title:null};r.hasRelList(a.settings)||!1!==r.allowUnsafeLinkTarget(a.settings)||(f.rel=y(f.rel,"_blank"===f.target)),c.href===b.href&&(b.attach(),b={}),e?(a.focus(),c.hasOwnProperty("text")&&("innerText"in e?e.innerText=c.text:e.textContent=c.text),a.dom.setAttribs(e,f),a.selection.select(e),a.undoManager.add()):F(d)?J(a,d,f):c.hasOwnProperty("text")?a.insertContent(a.dom.createHTML("a",f,a.dom.encode(c.text))):a.execCommand("mceInsertLink",!1,f)})}},H=function(a){return function(){a.undoManager.transact(function(){var b=a.selection.getNode();F(b)?I(a,b):a.execCommand("unlink")})}},I=function(a,b){var c,d;(d=a.dom.select("img",b)[0])&&(c=a.dom.getParents(d,"a[href]",b)[0])&&(c.parentNode.insertBefore(d,c),a.dom.remove(c))},J=function(a,b,c){var d,e;(e=a.dom.select("img",b)[0])&&(d=a.dom.create("a",c),e.parentNode.insertBefore(d,e),d.appendChild(e))},K={link:G,unlink:H,isLink:C,hasLinks:D,isOnlyTextSelected:E,getAnchorElement:A,getAnchorText:B,toggleTargetRules:y},L=tinymce.util.Tools.resolve("tinymce.util.Delay"),M=tinymce.util.Tools.resolve("tinymce.util.XHR"),N={},O=function(a,b){var c=r.getLinkList(a.settings);"string"==typeof c?M.send({url:c,success:function(c){b(a,JSON.parse(c))}}):"function"==typeof c?c(function(c){b(a,c)}):b(a,c)},P=function(a,b,c){var d=function(a,c){return c=c||[],x.each(a,function(a){var e={text:a.text||a.title};a.menu?e.menu=d(a.menu):(e.value=a.value,b&&b(e)),c.push(e)}),c};return d(a,c||[])},Q=function(a,b,c){var d=a.selection.getRng();L.setEditorTimeout(a,function(){a.windowManager.confirm(b,function(b){a.selection.setRng(d),c(b)})})},R=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n={},o=a.selection,p=a.dom,q=function(a){var b=e.find("#text");(!b.value()||a.lastControl&&b.value()===a.lastControl.text())&&b.value(a.control.text()),e.find("#href").value(a.control.value())},s=function(){d||!f||n.text||this.parent().parent().find("#text")[0].value(this.value())},t=function(b){var c=b.meta||{};h&&h.value(a.convertURL(this.value(),"href")),x.each(b.meta,function(a,b){var c=e.find("#"+b);"text"===b?0===d.length&&(c.value(a),n.text=a):c.value(a)}),c.attach&&(N={href:this.value(),attach:c.attach}),c.text||s.call(this)},u=function(a){a.meta=e.toJSON()};f=K.isOnlyTextSelected(o.getContent()),c=K.getAnchorElement(a),n.text=d=K.getAnchorText(a.selection,c),n.href=c?p.getAttrib(c,"href"):"",c?n.target=p.getAttrib(c,"target"):r.hasDefaultLinkTarget(a.settings)&&(n.target=r.getDefaultLinkTarget(a.settings)),(m=p.getAttrib(c,"rel"))&&(n.rel=m),(m=p.getAttrib(c,"class"))&&(n.class=m),(m=p.getAttrib(c,"title"))&&(n.title=m),f&&(g={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){n.text=this.value()}}),b&&(h={type:"listbox",label:"Link list",values:P(b,function(b){b.value=a.convertURL(b.value||b.url,"href")},[{text:"None",value:""}]),onselect:q,value:a.convertURL(n.href,"href"),onPostRender:function(){h=this}}),r.shouldShowTargetList(a.settings)&&(void 0===r.getTargetList(a.settings)&&r.setTargetList(a,[{text:"None",value:""},{text:"New window",value:"_blank"}]),j={name:"target",
type:"listbox",label:"Target",values:P(r.getTargetList(a.settings))}),r.hasRelList(a.settings)&&(i={name:"rel",type:"listbox",label:"Rel",values:P(r.getRelList(a.settings),function(b){!1===r.allowUnsafeLinkTarget(a.settings)&&(b.value=K.toggleTargetRules(b.value,"_blank"===n.target))})}),r.hasLinkClassList(a.settings)&&(k={name:"class",type:"listbox",label:"Class",values:P(r.getLinkClassList(a.settings),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({inline:"a",classes:[b.value]})})})}),r.shouldShowLinkTitle(a.settings)&&(l={name:"title",type:"textbox",label:"Title",value:n.title}),e=a.windowManager.open({title:"Insert link",data:n,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:t,onkeyup:s,onpaste:s,onbeforecall:u},g,l,function(b){var c=[];if(x.each(a.dom.select("a:not([href])"),function(a){var d=a.name||a.id;d&&c.push({text:d,value:"#"+d,selected:-1!==b.indexOf("#"+d)})}),c.length)return c.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:c,onselect:q}}(n.href),h,i,j,k],onSubmit:function(b){var c=r.assumeExternalTargets(a.settings),e=K.link(a,N),g=K.unlink(a),h=x.extend({},n,b.data),i=h.href;return i?(f&&h.text!==d||delete h.text,i.indexOf("@")>0&&-1===i.indexOf("//")&&-1===i.indexOf("mailto:")?void Q(a,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(a){a&&(h.href="mailto:"+i),e(h)}):!0===c&&!/^\w+:/i.test(i)||!1===c&&/^\s*www[\.|\d\.]/i.test(i)?void Q(a,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(a){a&&(h.href="http://"+i),e(h)}):void e(h)):void g()}})},S=function(a){O(a,R)},T={open:S},U=function(a,b){return a.dom.getParent(b,"a[href]")},V=function(a){return U(a,a.selection.getStart())},W=function(a){var b=a.getAttribute("data-mce-href");return b||a.getAttribute("href")},X=function(a){var b=a.plugins.contextmenu;return!!b&&b.isContextMenuVisible()},Y=function(a){return!0===a.altKey&&!1===a.shiftKey&&!1===a.ctrlKey&&!1===a.metaKey},Z=function(a,b){if(b){var c=W(b);if(/^#/.test(c)){var d=a.$(c);d.length&&a.selection.scrollIntoView(d[0],!0)}else w.open(b.href)}},$=function(a){return function(){T.open(a)}},_=function(a){return function(){Z(a,V(a))}},aa=function(a){return function(b){var c,d,e;return!!(r.hasContextToolbar(a.settings)&&!X(a)&&K.isLink(b)&&(c=a.selection,d=c.getRng(),e=d.startContainer,3===e.nodeType&&c.isCollapsed()&&d.startOffset>0&&d.startOffset<e.data.length))}},ba=function(a){a.on("click",function(b){var d=U(a,b.target);d&&c.metaKeyPressed(b)&&(b.preventDefault(),Z(a,d))}),a.on("keydown",function(b){var c=V(a);c&&13===b.keyCode&&Y(b)&&(b.preventDefault(),Z(a,c))})},ca=function(a){return function(){var b=this;a.on("nodechange",function(c){b.active(!a.readonly&&!!K.getAnchorElement(a,c.element))})}},da=function(a){return function(){var b=this,c=function(a){K.hasLinks(a.parents)?b.show():b.hide()};K.hasLinks(a.dom.getParents(a.selection.getStart()))||b.hide(),a.on("nodechange",c),b.on("remove",function(){a.off("nodechange",c)})}},ea={openDialog:$,gotoSelectedLink:_,leftClickedOnAHref:aa,setupGotoLinks:ba,toggleActiveState:ca,toggleViewLinkState:da},fa=function(a){a.addCommand("mceLink",ea.openDialog(a))},ga={register:fa},ha=function(a){a.addShortcut("Meta+K","",ea.openDialog(a))},ia={setup:ha},ja=function(a){a.addButton("link",{active:!1,icon:"link",tooltip:"Insert/edit link",onclick:ea.openDialog(a),onpostrender:ea.toggleActiveState(a)}),a.addButton("unlink",{active:!1,icon:"unlink",tooltip:"Remove link",onclick:K.unlink(a),onpostrender:ea.toggleActiveState(a)}),a.addContextToolbar&&a.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:ea.gotoSelectedLink(a)})},ka=function(a){a.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:ea.gotoSelectedLink(a),onPostRender:ea.toggleViewLinkState(a),prependToContext:!0}),a.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:ea.openDialog(a),stateSelector:"a[href]",context:"insert",prependToContext:!0}),a.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onclick:K.unlink(a),stateSelector:"a[href]"})},la=function(a){a.addContextToolbar&&a.addContextToolbar(ea.leftClickedOnAHref(a),"openlink | link unlink")},ma={setupButtons:ja,setupMenuItems:ka,setupContextToolbars:la};b.add("link",function(a){ma.setupButtons(a),ma.setupMenuItems(a),ma.setupContextToolbars(a),ea.setupGotoLinks(a),ga.register(a),ia.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-lists",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),d=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),e=tinymce.util.Tools.resolve("tinymce.util.VK"),f=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),g=tinymce.util.Tools.resolve("tinymce.util.Tools"),h=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=function(a){return a&&3===a.nodeType},j=function(a){return a&&/^(OL|UL|DL)$/.test(a.nodeName)},k=function(a){return a&&/^(LI|DT|DD)$/.test(a.nodeName)},l=function(a){return a&&/^(TH|TD)$/.test(a.nodeName)},m=function(a){return a&&"BR"===a.nodeName},n=function(a){return a.parentNode.firstChild===a},o=function(a){return a.parentNode.lastChild===a},p=function(a,b){return b&&!!a.schema.getTextBlockElements()[b.nodeName]},q=function(a,b){return a&&a.nodeName in b},r=function(a,b){return!!m(b)&&!(!a.isBlock(b.nextSibling)||m(b.previousSibling))},s=function(a,b,c){var d=a.isEmpty(b);return!(c&&a.select("span[data-mce-type=bookmark]",b).length>0)&&d},t=function(a,b){return a.isChildOf(b,a.getRoot())},u={isTextNode:i,isListNode:j,isListItemNode:k,isTableCellNode:l,isBr:m,isFirstChild:n,isLastChild:o,isTextBlock:p,isBlock:q,isBogusBr:r,isEmpty:s,isChildOfBody:t},v=function(a,b){var d=c.getNode(a,b);if(u.isListItemNode(a)&&u.isTextNode(d)){return{container:d,offset:b>=a.childNodes.length?d.data.length:0}}return{container:a,offset:b}},w=function(a){var b=a.cloneRange(),c=v(a.startContainer,a.startOffset);b.setStart(c.container,c.offset);var d=v(a.endContainer,a.endOffset);return b.setEnd(d.container,d.offset),b},x={getNormalizedEndPoint:v,normalizeRange:w},y=h.DOM,z=function(a){var b={},c=function(c){var d,e,f;e=a[c?"startContainer":"endContainer"],f=a[c?"startOffset":"endOffset"],1===e.nodeType&&(d=y.create("span",{"data-mce-type":"bookmark"}),e.hasChildNodes()?(f=Math.min(f,e.childNodes.length-1),c?e.insertBefore(d,e.childNodes[f]):y.insertAfter(d,e.childNodes[f])):e.appendChild(d),e=d,f=0),b[c?"startContainer":"endContainer"]=e,b[c?"startOffset":"endOffset"]=f};return c(!0),a.collapsed||c(),b},A=function(a){function b(b){var c,d,e;c=e=a[b?"startContainer":"endContainer"],d=a[b?"startOffset":"endOffset"],c&&(1===c.nodeType&&(d=function(a){for(var b=a.parentNode.firstChild,c=0;b;){if(b===a)return c;1===b.nodeType&&"bookmark"===b.getAttribute("data-mce-type")||c++,b=b.nextSibling}return-1}(c),c=c.parentNode,y.remove(e),!c.hasChildNodes()&&y.isBlock(c)&&c.appendChild(y.create("br"))),a[b?"startContainer":"endContainer"]=c,a[b?"startOffset":"endOffset"]=d)}b(!0),b();var c=y.createRng();return c.setStart(a.startContainer,a.startOffset),a.endContainer&&c.setEnd(a.endContainer,a.endOffset),x.normalizeRange(c)},B={createBookmark:z,resolveBookmark:A},C=h.DOM,D=function(a,b){var c,d=b.parentNode;"LI"===d.nodeName&&d.firstChild===b&&(c=d.previousSibling,c&&"LI"===c.nodeName?(c.appendChild(b),u.isEmpty(a,d)&&C.remove(d)):C.setStyle(d,"listStyleType","none")),u.isListNode(d)&&(c=d.previousSibling)&&"LI"===c.nodeName&&c.appendChild(b)},E=function(a,b){g.each(g.grep(a.select("ol,ul",b)),function(b){D(a,b)})},F={normalizeList:D,normalizeLists:E},G=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),H=function(a){var b=a.selection.getStart(!0);return a.dom.getParent(b,"OL,UL,DL",N(a,b))},I=function(a,b){return a&&1===b.length&&b[0]===a},J=function(a){return g.grep(a.querySelectorAll("ol,ul,dl"),function(a){return u.isListNode(a)})},K=function(a){var b=H(a),c=a.selection.getSelectedBlocks();return I(b,c)?J(b):g.grep(c,function(a){return u.isListNode(a)&&b!==a})},L=function(a,b){var c=g.map(b,function(b){var c=a.dom.getParent(b,"li,dd,dt",N(a,b));return c||b});return G.unique(c)},M=function(a){var b=a.selection.getSelectedBlocks();return g.grep(L(a,b),function(a){return u.isListItemNode(a)})},N=function(a,b){var c=a.dom.getParents(b,"TD,TH");return c.length>0?c[0]:a.getBody()},O={getParentList:H,getSelectedSubLists:K,getSelectedListItems:M,getClosestListRootElm:N},P=tinymce.util.Tools.resolve("tinymce.Env"),Q=h.DOM,R=function(a,b,c){var d,e,f,g=Q.createFragment(),h=a.schema.getBlockElements();if(a.settings.forced_root_block&&(c=c||a.settings.forced_root_block),c&&(e=Q.create(c),e.tagName===a.settings.forced_root_block&&Q.setAttribs(e,a.settings.forced_root_block_attrs),u.isBlock(b.firstChild,h)||g.appendChild(e)),b)for(;d=b.firstChild;){var i=d.nodeName;f||"SPAN"===i&&"bookmark"===d.getAttribute("data-mce-type")||(f=!0),u.isBlock(d,h)?(g.appendChild(d),e=null):c?(e||(e=Q.create(c),g.appendChild(e)),e.appendChild(d)):g.appendChild(d)}return a.settings.forced_root_block?f||P.ie&&!(P.ie>10)||e.appendChild(Q.create("br",{"data-mce-bogus":"1"})):g.appendChild(Q.create("br")),g},S={createNewTextBlock:R},T=h.DOM,U=function(a,b,c,d){var e,f,h,i;for(h=T.select('span[data-mce-type="bookmark"]',b),d=d||S.createNewTextBlock(a,c),e=T.createRng(),e.setStartAfter(c),e.setEndAfter(b),f=e.extractContents(),i=f.firstChild;i;i=i.firstChild)if("LI"===i.nodeName&&a.dom.isEmpty(i)){T.remove(i);break}a.dom.isEmpty(f)||T.insertAfter(f,b),T.insertAfter(d,b),u.isEmpty(a.dom,c.parentNode)&&function(a){g.each(h,function(b){a.parentNode.insertBefore(b,c.parentNode)}),T.remove(a)}(c.parentNode),T.remove(c),u.isEmpty(a.dom,b)&&T.remove(b)},V={splitList:U},W=h.DOM,X=function(a,b){u.isEmpty(a,b)&&W.remove(b)},Y=function(a,b){var c,d,e=b.parentNode;return e?(c=e.parentNode,e===a.getBody()||("DD"===b.nodeName?(W.rename(b,"DT"),!0):u.isFirstChild(b)&&u.isLastChild(b)?("LI"===c.nodeName?(W.insertAfter(b,c),X(a.dom,c),W.remove(e)):u.isListNode(c)?W.remove(e,!0):(c.insertBefore(S.createNewTextBlock(a,b),e),W.remove(e)),!0):u.isFirstChild(b)?("LI"===c.nodeName?(W.insertAfter(b,c),b.appendChild(e),X(a.dom,c)):u.isListNode(c)?c.insertBefore(b,e):(c.insertBefore(S.createNewTextBlock(a,b),e),W.remove(b)),!0):u.isLastChild(b)?("LI"===c.nodeName?W.insertAfter(b,c):u.isListNode(c)?W.insertAfter(b,e):(W.insertAfter(S.createNewTextBlock(a,b),e),W.remove(b)),!0):("LI"===c.nodeName?(e=c,d=S.createNewTextBlock(a,b,"LI")):d=u.isListNode(c)?S.createNewTextBlock(a,b,"LI"):S.createNewTextBlock(a,b),V.splitList(a,e,b,d),F.normalizeLists(a.dom,e.parentNode),!0))):(X(a.dom,b),!0)},Z=function(a){var b=O.getSelectedListItems(a);if(b.length){var c=B.createBookmark(a.selection.getRng()),d=void 0,e=void 0,f=O.getClosestListRootElm(a,a.selection.getStart(!0));for(d=b.length;d--;)for(var g=b[d].parentNode;g&&g!==f;){for(e=b.length;e--;)if(b[e]===g){b.splice(d,1);break}g=g.parentNode}for(d=0;d<b.length&&(Y(a,b[d])||0!==d);d++);return a.selection.setRng(B.resolveBookmark(c)),a.nodeChanged(),!0}},$={outdent:Y,outdentSelection:Z},_=function(a,b,c){var d=c["list-style-type"]?c["list-style-type"]:null;a.setStyle(b,"list-style-type",d)},aa=function(a,b){g.each(b,function(b,c){a.setAttribute(c,b)})},ba=function(a,b,c){aa(b,c["list-attributes"]),g.each(a.select("li",b),function(a){aa(a,c["list-item-attributes"])})},ca=function(a,b,c){_(a,b,c),ba(a,b,c)},da=function(a,b,c){g.each(c,function(c){return a.setStyle(b,(d={},d[c]="",d));var d})},ea=function(a,b,c,d){var e,f;for(e=b[c?"startContainer":"endContainer"],f=b[c?"startOffset":"endOffset"],1===e.nodeType&&(e=e.childNodes[Math.min(f,e.childNodes.length-1)]||e),!c&&u.isBr(e.nextSibling)&&(e=e.nextSibling);e.parentNode!==d;){if(u.isTextBlock(a,e))return e;if(/^(TD|TH)$/.test(e.parentNode.nodeName))return e;e=e.parentNode}return e},fa=function(a,b,c){for(var d,e=[],h=a.dom,i=ea(a,b,!0,c),j=ea(a,b,!1,c),k=[],l=i;l&&(k.push(l),l!==j);l=l.nextSibling);return g.each(k,function(b){if(u.isTextBlock(a,b))return e.push(b),void(d=null);if(h.isBlock(b)||u.isBr(b))return u.isBr(b)&&h.remove(b),void(d=null);var g=b.nextSibling;if(f.isBookmarkNode(b)&&(u.isTextBlock(a,g)||!g&&b.parentNode===c))return void(d=null);d||(d=h.create("p"),b.parentNode.insertBefore(d,b),e.push(d)),d.appendChild(b)}),e},ga=function(a,b,c){var d=a.getStyle(b,"list-style-type"),e=c?c["list-style-type"]:"";return e=null===e?"":e,d===e},ha=function(a,b,c){void 0===c&&(c={});var d,e=a.selection.getRng(!0),f="LI",h=O.getClosestListRootElm(a,a.selection.getStart(!0)),i=a.dom;"false"!==i.getContentEditable(a.selection.getNode())&&(b=b.toUpperCase(),"DL"===b&&(f="DT"),d=B.createBookmark(e),g.each(fa(a,e,h),function(d){var e,g;g=d.previousSibling,g&&u.isListNode(g)&&g.nodeName===b&&ga(i,g,c)?(e=g,d=i.rename(d,f),g.appendChild(d)):(e=i.create(b),d.parentNode.insertBefore(e,d),e.appendChild(d),d=i.rename(d,f)),da(i,d,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),ca(i,e,c),na(a.dom,e)}),a.selection.setRng(B.resolveBookmark(d)))},ia=function(a){var b=B.createBookmark(a.selection.getRng(!0)),c=O.getClosestListRootElm(a,a.selection.getStart(!0)),d=O.getSelectedListItems(a),e=g.grep(d,function(b){return a.dom.isEmpty(b)});d=g.grep(d,function(b){return!a.dom.isEmpty(b)}),g.each(e,function(b){if(u.isEmpty(a.dom,b))return void $.outdent(a,b)}),g.each(d,function(b){var d,e;if(b.parentNode!==a.getBody()){for(d=b;d&&d!==c;d=d.parentNode)u.isListNode(d)&&(e=d);V.splitList(a,e,b),F.normalizeLists(a.dom,e.parentNode)}}),a.selection.setRng(B.resolveBookmark(b))},ja=function(a,b){return a&&b&&u.isListNode(a)&&a.nodeName===b.nodeName},ka=function(a,b,c){return a.getStyle(b,"list-style-type",!0)===a.getStyle(c,"list-style-type",!0)},la=function(a,b){return a.className===b.className},ma=function(a,b,c){return ja(b,c)&&ka(a,b,c)&&la(b,c)},na=function(a,b){var c,d;if(c=b.nextSibling,ma(a,b,c)){for(;d=c.firstChild;)b.appendChild(d);a.remove(c)}if(c=b.previousSibling,ma(a,b,c)){for(;d=c.lastChild;)b.insertBefore(d,b.firstChild);a.remove(c)}},oa=function(a,b,c,d){if(b.nodeName!==c){var e=a.rename(b,c);ca(a,e,d)}else ca(a,b,d)},pa=function(a,b,c,d,e){if(b.nodeName!==d||qa(e)){var f=B.createBookmark(a.selection.getRng(!0));g.each([b].concat(c),function(b){oa(a.dom,b,d,e)}),a.selection.setRng(B.resolveBookmark(f))}else ia(a)},qa=function(a){return"list-style-type"in a},ra=function(a,b,c,d){if(b!==a.getBody())if(b)if(b.nodeName!==c||qa(d)){var e=B.createBookmark(a.selection.getRng(!0));ca(a.dom,b,d),na(a.dom,a.dom.rename(b,c)),a.selection.setRng(B.resolveBookmark(e))}else ia(a);else ha(a,c,d)},sa=function(a,b,c){var d=O.getParentList(a),e=O.getSelectedSubLists(a);c=c||{},d&&e.length>0?pa(a,d,e,b,c):ra(a,d,b,c)},ta={toggleList:sa,removeList:ia,mergeWithAdjacentLists:na},ua=function(a,b,e,f){var g,h,i=b.startContainer,j=b.startOffset;if(3===i.nodeType&&(e?j<i.data.length:j>0))return i;for(g=a.schema.getNonEmptyElements(),1===i.nodeType&&(i=c.getNode(i,j)),h=new d(i,f),e&&u.isBogusBr(a.dom,i)&&h.next();i=h[e?"next":"prev2"]();){if("LI"===i.nodeName&&!i.hasChildNodes())return i;if(g[i.nodeName])return i;if(3===i.nodeType&&i.data.length>0)return i}},va=function(a,b){var c=b.childNodes;return 1===c.length&&!u.isListNode(c[0])&&a.isBlock(c[0])},wa=function(a,b){va(a,b)&&a.remove(b.firstChild,!0)},xa=function(a,b,c){var d,e;if(e=va(a,c)?c.firstChild:c,wa(a,b),!u.isEmpty(a,b,!0))for(;d=b.firstChild;)e.appendChild(d)},ya=function(a,b,c){var d,e,f=b.parentNode;u.isChildOfBody(a,b)&&u.isChildOfBody(a,c)&&(u.isListNode(c.lastChild)&&(e=c.lastChild),f===c.lastChild&&u.isBr(f.previousSibling)&&a.remove(f.previousSibling),d=c.lastChild,d&&u.isBr(d)&&b.hasChildNodes()&&a.remove(d),u.isEmpty(a,c,!0)&&a.$(c).empty(),xa(a,b,c),e&&c.appendChild(e),a.remove(b),u.isEmpty(a,f)&&f!==a.getRoot()&&a.remove(f))},za=function(a,b,c){a.dom.$(c).empty(),ya(a.dom,b,c),a.selection.setCursorLocation(c)},Aa=function(a,b,c,d){var e=a.dom;if(e.isEmpty(d))za(a,c,d);else{var f=B.createBookmark(b);ya(e,c,d),a.selection.setRng(B.resolveBookmark(f))}},Ba=function(a,b,c,d){var e=B.createBookmark(b);ya(a.dom,c,d);var f=B.resolveBookmark(e);a.selection.setRng(f)},Ca=function(a,b){var c,d,e,f=a.dom,g=a.selection,h=g.getStart(),i=O.getClosestListRootElm(a,h),j=f.getParent(g.getStart(),"LI",i);if(j){if((c=j.parentNode)===a.getBody()&&u.isEmpty(f,c))return!0;if(d=x.normalizeRange(g.getRng(!0)),(e=f.getParent(ua(a,d,b,i),"LI",i))&&e!==j)return b?Aa(a,d,e,j):Ba(a,d,j,e),!0;if(!e&&!b&&ta.removeList(a))return!0}return!1},Da=function(a,b,c){var d=a.getParent(b.parentNode,a.isBlock,c);a.remove(b),d&&a.isEmpty(d)&&a.remove(d)},Ea=function(a,b){var c=a.dom,d=a.selection.getStart(),e=O.getClosestListRootElm(a,d),f=c.getParent(d,c.isBlock,e);if(f&&c.isEmpty(f)){var g=x.normalizeRange(a.selection.getRng(!0)),h=c.getParent(ua(a,g,b,e),"LI",e);if(h)return a.undoManager.transact(function(){Da(c,f,e),ta.mergeWithAdjacentLists(c,h.parentNode),a.selection.select(h,!0),a.selection.collapse(b)}),!0}return!1},Fa=function(a,b){return Ca(a,b)||Ea(a,b)},Ga=function(a){var b=a.selection.getStart(),c=O.getClosestListRootElm(a,b);return!!(a.dom.getParent(b,"LI,DT,DD",c)||O.getSelectedListItems(a).length>0)&&(a.undoManager.transact(function(){a.execCommand("Delete"),F.normalizeLists(a.dom,a.getBody())}),!0)},Ha=function(a,b){return a.selection.isCollapsed()?Fa(a,b):Ga(a)},Ia=function(a){a.on("keydown",function(b){b.keyCode===e.BACKSPACE?Ha(a,!1)&&b.preventDefault():b.keyCode===e.DELETE&&Ha(a,!0)&&b.preventDefault()})},Ja={setup:Ia,backspaceDelete:Ha},Ka=function(a){return{backspaceDelete:function(b){Ja.backspaceDelete(a,b)}}},La={get:Ka},Ma=h.DOM,Na=function(a,b){var c;if(u.isListNode(a)){for(;c=a.firstChild;)b.appendChild(c);Ma.remove(a)}},Oa=function(a){var b,c,d;return"DT"===a.nodeName?(Ma.rename(a,"DD"),!0):(b=a.previousSibling)&&u.isListNode(b)?(b.appendChild(a),!0):b&&"LI"===b.nodeName&&u.isListNode(b.lastChild)?(b.lastChild.appendChild(a),Na(a.lastChild,b.lastChild),!0):(b=a.nextSibling)&&u.isListNode(b)?(b.insertBefore(a,b.firstChild),!0):!(!(b=a.previousSibling)||"LI"!==b.nodeName)&&(c=Ma.create(a.parentNode.nodeName),d=Ma.getStyle(a.parentNode,"listStyleType"),d&&Ma.setStyle(c,"listStyleType",d),b.appendChild(c),c.appendChild(a),Na(a.lastChild,c),!0)},Pa=function(a){var b=O.getSelectedListItems(a);if(b.length){for(var c=B.createBookmark(a.selection.getRng(!0)),d=0;d<b.length&&(Oa(b[d])||0!==d);d++);return a.selection.setRng(B.resolveBookmark(c)),a.nodeChanged(),!0}},Qa={indentSelection:Pa},Ra=function(a,b){return function(){var c=a.dom.getParent(a.selection.getStart(),"UL,OL,DL");return c&&c.nodeName===b}},Sa=function(a){a.on("BeforeExecCommand",function(b){var c,d=b.command.toLowerCase();if("indent"===d?Qa.indentSelection(a)&&(c=!0):"outdent"===d&&$.outdentSelection(a)&&(c=!0),c)return a.fire("ExecCommand",{command:b.command}),b.preventDefault(),!0}),a.addCommand("InsertUnorderedList",function(b,c){ta.toggleList(a,"UL",c)}),a.addCommand("InsertOrderedList",function(b,c){ta.toggleList(a,"OL",c)}),a.addCommand("InsertDefinitionList",function(b,c){ta.toggleList(a,"DL",c)}),a.addQueryStateHandler("InsertUnorderedList",Ra(a,"UL")),a.addQueryStateHandler("InsertOrderedList",Ra(a,"OL")),a.addQueryStateHandler("InsertDefinitionList",Ra(a,"DL"))},Ta={register:Sa},Ua=function(a){return a.getParam("lists_indent_on_tab",!0)},Va={shouldIndentOnTab:Ua},Wa=function(a){a.on("keydown",function(b){b.keyCode!==e.TAB||e.metaKeyPressed(b)||a.dom.getParent(a.selection.getStart(),"LI,DT,DD")&&(b.preventDefault(),b.shiftKey?$.outdentSelection(a):Qa.indentSelection(a))})},Xa=function(a){Va.shouldIndentOnTab(a)&&Wa(a),Ja.setup(a)},Ya={setup:Xa},Za=function(a,b){for(var c=0;c<a.length;c++){if(b(a[c]))return c}return-1},$a=function(a,b){return function(c){var d=c.control;a.on("NodeChange",function(a){var c=Za(a.parents,u.isTableCellNode),e=-1!==c?a.parents.slice(0,c):a.parents,f=g.grep(e,u.isListNode);d.active(f.length>0&&f[0].nodeName===b)})}},_a=function(a){return function(b){var c=b.control;a.on("nodechange",function(){var b=O.getSelectedListItems(a),d=b.length>0&&u.isFirstChild(b[0]);c.disabled(d)})}},ab=function(a){(function(a,b){var c=a.settings.plugins?a.settings.plugins:"";return-1!==g.inArray(c.split(/[ ,]/),b)})(a,"advlist")||(a.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:$a(a,"OL")}),a.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:$a(a,"UL")})),a.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:_a(a)})},bb={register:ab};b.add("lists",function(a){return Ya.setup(a),bb.register(a),Ta.register(a),La.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-media",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.Env"),d=tinymce.util.Tools.resolve("tinymce.util.Tools"),e=function(a){return a.getParam("media_scripts")},f=function(a){return a.getParam("audio_template_callback")},g=function(a){return a.getParam("video_template_callback")},h=function(a){return a.getParam("media_live_embeds",!0)},i=function(a){return a.getParam("media_filter_html",!0)},j=function(a){return a.getParam("media_url_resolver")},k=function(a){return a.getParam("media_alt_source",!0)},l=function(a){return a.getParam("media_poster",!0)},m=function(a){return a.getParam("media_dimensions",!0)},n={getScripts:e,getAudioTemplateCallback:f,getVideoTemplateCallback:g,hasLiveEmbeds:h,shouldFilterHtml:i,getUrlResolver:j,hasAltSource:k,hasPoster:l,hasDimensions:m},o=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),p=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),q=function(a,b){if(a)for(var c=0;c<a.length;c++)if(-1!==b.indexOf(a[c].filter))return a[c]},r={getVideoScriptMatch:q},s=function(a){return a.replace(/px$/,"")},t=function(a){return/^[0-9.]+$/.test(a)?a+"px":a},u=function(a){return function(b){return b?s(b.style[a]):""}},v=function(a){return function(b,c){b&&(b.style[a]=t(c))}},w={getMaxWidth:u("maxWidth"),getMaxHeight:u("maxHeight"),setMaxWidth:v("maxWidth"),setMaxHeight:v("maxHeight")},x=p.DOM,y=function(a){return x.getAttrib(a,"data-ephox-embed-iri")},z=function(a){var b=x.createFragment(a);return""!==y(b.firstChild)},A=function(a,b){var c={};return o({validate:!1,allow_conditional_comments:!0,special:"script,noscript",start:function(b,e){if(c.source1||"param"!==b||(c.source1=e.map.movie),"iframe"!==b&&"object"!==b&&"embed"!==b&&"video"!==b&&"audio"!==b||(c.type||(c.type=b),c=d.extend(e.map,c)),"script"===b){var f=r.getVideoScriptMatch(a,e.map.src);if(!f)return;c={type:"script",source1:e.map.src,width:f.width,height:f.height}}"source"===b&&(c.source1?c.source2||(c.source2=e.map.src):c.source1=e.map.src),"img"!==b||c.poster||(c.poster=e.map.src)}}).parse(b),c.source1=c.source1||c.src||c.data,c.source2=c.source2||"",c.poster=c.poster||"",c},B=function(a){var b=x.createFragment(a),c=b.firstChild;return{type:"ephox-embed-iri",source1:y(c),source2:"",poster:"",width:w.getMaxWidth(c),height:w.getMaxHeight(c)}},C=function(a,b){return z(b)?B(b):A(a,b)},D={htmlToData:C},E=tinymce.util.Tools.resolve("tinymce.util.Promise"),F=function(a){var b={mp3:"audio/mpeg",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},c=a.toLowerCase().split(".").pop(),d=b[c];return d||""},G={guess:F},H=tinymce.util.Tools.resolve("tinymce.html.Writer"),I=tinymce.util.Tools.resolve("tinymce.html.Schema"),J=p.DOM,K=function(a,b){var c,d,e,f;for(c in b)if(e=""+b[c],a.map[c])for(d=a.length;d--;)f=a[d],f.name===c&&(e?(a.map[c]=e,f.value=e):(delete a.map[c],a.splice(d,1)));else e&&(a.push({name:c,value:e}),a.map[c]=e)},L=function(a){var b=H();return o(b).parse(a),b.getContent()},M=function(a,b,c){var d,e=H(),f=0;return o({validate:!1,allow_conditional_comments:!0,special:"script,noscript",comment:function(a){e.comment(a)},cdata:function(a){e.cdata(a)},text:function(a,b){e.text(a,b)},start:function(a,g,h){switch(a){case"video":case"object":case"embed":case"img":case"iframe":void 0!==b.height&&void 0!==b.width&&K(g,{width:b.width,height:b.height})}if(c)switch(a){case"video":K(g,{poster:b.poster,src:""}),b.source2&&K(g,{src:""});break;case"iframe":K(g,{src:b.source1});break;case"source":if(++f<=2&&(K(g,{src:b["source"+f],type:b["source"+f+"mime"]}),!b["source"+f]))return;break;case"img":if(!b.poster)return;d=!0}e.start(a,g,h)},end:function(a){if("video"===a&&c)for(var g=1;g<=2;g++)if(b["source"+g]){var h=[];h.map={},f<g&&(K(h,{src:b["source"+g],type:b["source"+g+"mime"]}),e.start("source",h,!0))}if(b.poster&&"object"===a&&c&&!d){var i=[];i.map={},K(i,{src:b.poster,width:b.width,height:b.height}),e.start("img",i,!0)}e.end(a)}},I({})).parse(a),e.getContent()},N=function(a){var b=J.createFragment(a);return""!==J.getAttrib(b.firstChild,"data-ephox-embed-iri")},O=function(a,b){var c=J.createFragment(a),d=c.firstChild;return w.setMaxWidth(d,b.width),w.setMaxHeight(d,b.height),L(d.outerHTML)},P=function(a,b,c){return N(a)?O(a,b):M(a,b,c)},Q={updateHtml:P},R=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'//maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],S=function(a,b){for(var c=a.regex.exec(b),d=a.url,e=0;e<c.length;e++)!function(a){d=d.replace("$"+a,function(){return c[a]?c[a]:""})}(e);return d.replace(/\?$/,"")},T=function(a){var b=R.filter(function(b){return b.regex.test(a)});return b.length>0?d.extend({},b[0],{url:S(b[0],a)}):null},U=function(a){var b=a.allowFullscreen?' allowFullscreen="1"':"";return'<iframe src="'+a.source1+'" width="'+a.width+'" height="'+a.height+'"'+b+"></iframe>"},V=function(a){var b='<object data="'+a.source1+'" width="'+a.width+'" height="'+a.height+'" type="application/x-shockwave-flash">';return a.poster&&(b+='<img src="'+a.poster+'" width="'+a.width+'" height="'+a.height+'" />'),b+="</object>"},W=function(a,b){return b?b(a):'<audio controls="controls" src="'+a.source1+'">'+(a.source2?'\n<source src="'+a.source2+'"'+(a.source2mime?' type="'+a.source2mime+'"':"")+" />\n":"")+"</audio>"},X=function(a,b){return b?b(a):'<video width="'+a.width+'" height="'+a.height+'"'+(a.poster?' poster="'+a.poster+'"':"")+' controls="controls">\n<source src="'+a.source1+'"'+(a.source1mime?' type="'+a.source1mime+'"':"")+" />\n"+(a.source2?'<source src="'+a.source2+'"'+(a.source2mime?' type="'+a.source2mime+'"':"")+" />\n":"")+"</video>"},Y=function(a){return'<script src="'+a.source1+'"><\/script>'},Z=function(a,b){var c=d.extend({},b);if(!c.source1&&(d.extend(c,D.htmlToData(n.getScripts(a),c.embed)),!c.source1))return"";c.source2||(c.source2=""),c.poster||(c.poster=""),c.source1=a.convertURL(c.source1,"source"),c.source2=a.convertURL(c.source2,"source"),c.source1mime=G.guess(c.source1),c.source2mime=G.guess(c.source2),c.poster=a.convertURL(c.poster,"poster");var e=T(c.source1);if(e&&(c.source1=e.url,c.type=e.type,c.allowFullscreen=e.allowFullscreen,c.width=c.width||e.w,c.height=c.height||e.h),c.embed)return Q.updateHtml(c.embed,c,!0);var f=r.getVideoScriptMatch(n.getScripts(a),c.source1);f&&(c.type="script",c.width=f.width,c.height=f.height);var g=n.getAudioTemplateCallback(a),h=n.getVideoTemplateCallback(a);return c.width=c.width||300,c.height=c.height||150,d.each(c,function(b,d){c[d]=a.dom.encode(b)}),"iframe"===c.type?U(c):"application/x-shockwave-flash"===c.source1mime?V(c):-1!==c.source1mime.indexOf("audio")?W(c,g):"script"===c.type?Y(c):X(c,h)},$={dataToHtml:Z},_={},aa=function(a,b,c){return new E(function(d,e){var f=function(c){return c.html&&(_[a.source1]=c),d({url:a.source1,html:c.html?c.html:b(a)})};_[a.source1]?f(_[a.source1]):c({url:a.source1},f,e)})},ba=function(a,b){return new E(function(c){c({html:b(a),url:a.source1})})},ca=function(a){return function(b){return $.dataToHtml(a,b)}},da=function(a,b){var c=n.getUrlResolver(a);return c?aa(b,ca(a),c):ba(b,ca(a))},ea=function(a){return _.hasOwnProperty(a)},fa={getEmbedHtml:da,isCached:ea},ga=function(a,b){a.state.set("oldVal",a.value()),b.state.set("oldVal",b.value())},ha=function(a,b){var c=a.find("#width")[0],d=a.find("#height")[0],e=a.find("#constrain")[0];c&&d&&e&&b(c,d,e.checked())},ia=function(a,b,c){var d=a.state.get("oldVal"),e=b.state.get("oldVal"),f=a.value(),g=b.value();c&&d&&e&&f&&g&&(f!==d?(g=Math.round(f/d*g),isNaN(g)||b.value(g)):(f=Math.round(g/e*f),isNaN(f)||a.value(f))),ga(a,b)},ja=function(a){ha(a,ga)},ka=function(a){ha(a,ia)},la=function(a){var b=function(){a(function(a){ka(a)})};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:b,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:b,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},ma={createUi:la,syncSize:ja,updateSize:ka},na=c.ie&&c.ie<=8?"onChange":"onInput",oa=function(a){return function(b){var c=b&&b.msg?"Media embed handler error: "+b.msg:"Media embed handler threw unknown error.";a.notificationManager.open({type:"error",text:c})}},pa=function(a){var b=a.selection.getNode(),c=b.getAttribute("data-ephox-embed-iri");return c?{source1:c,"data-ephox-embed-iri":c,width:w.getMaxWidth(b),height:w.getMaxHeight(b)}:b.getAttribute("data-mce-object")?D.htmlToData(n.getScripts(a),a.serializer.serialize(b,{selection:!0})):{}},qa=function(a){var b=a.selection.getNode();if(b.getAttribute("data-mce-object")||b.getAttribute("data-ephox-embed-iri"))return a.selection.getContent()},ra=function(a,b){return function(c){var e=c.html,f=a.find("#embed")[0],g=d.extend(D.htmlToData(n.getScripts(b),e),{source1:c.url});a.fromJSON(g),f&&(f.value(e),ma.updateSize(a))}},sa=function(a,b){var c,d,e=a.dom.select("img[data-mce-object]");for(c=0;c<b.length;c++)for(d=e.length-1;d>=0;d--)b[c]===e[d]&&e.splice(d,1);a.selection.select(e[0])},ta=function(a,b){var c=a.dom.select("img[data-mce-object]");a.insertContent(b),sa(a,c),a.nodeChanged()},ua=function(a,b){var c=a.toJSON();c.embed=Q.updateHtml(c.embed,c),c.embed&&fa.isCached(c.source1)?ta(b,c.embed):fa.getEmbedHtml(b,c).then(function(a){ta(b,a.html)}).catch(oa(b))},va=function(a,b){d.each(b,function(b,c){a.find("#"+c).value(b)})},wa=function(a){var b,c,e=[{name:"source1",type:"filepicker",filetype:"media",size:40,autofocus:!0,label:"Source",onpaste:function(){setTimeout(function(){fa.getEmbedHtml(a,b.toJSON()).then(ra(b,a)).catch(oa(a))},1)},onchange:function(c){fa.getEmbedHtml(a,b.toJSON()).then(ra(b,a)).catch(oa(a)),va(b,c.meta)},onbeforecall:function(a){a.meta=b.toJSON()}}],f=[],g=function(a){a(b),c=b.toJSON(),b.find("#embed").value(Q.updateHtml(c.embed,c))}
;if(n.hasAltSource(a)&&f.push({name:"source2",type:"filepicker",filetype:"media",size:40,label:"Alternative source"}),n.hasPoster(a)&&f.push({name:"poster",type:"filepicker",filetype:"image",size:40,label:"Poster"}),n.hasDimensions(a)){var h=ma.createUi(g);e.push(h)}c=pa(a);var i={id:"mcemediasource",type:"textbox",flex:1,name:"embed",value:qa(a),multiline:!0,rows:5,label:"Source"},j=function(){c=d.extend({},D.htmlToData(n.getScripts(a),this.value())),this.parent().parent().fromJSON(c)};i[na]=j;var k=[{title:"General",type:"form",items:e},{title:"Embed",type:"container",layout:"flex",direction:"column",align:"stretch",padding:10,spacing:10,items:[{type:"label",text:"Paste your embed code below:",forId:"mcemediasource"},i]}];f.length>0&&k.push({title:"Advanced",type:"form",items:f}),b=a.windowManager.open({title:"Insert/edit media",data:c,bodyType:"tabpanel",body:k,onSubmit:function(){ma.updateSize(b),ua(b,a)}}),ma.syncSize(b)},xa={showDialog:wa},ya=function(a){return{showDialog:function(){xa.showDialog(a)}}},za={get:ya},Aa=function(a){var b=function(){xa.showDialog(a)};a.addCommand("mceMedia",b)},Ba={register:Aa},Ca=tinymce.util.Tools.resolve("tinymce.html.Node"),Da=function(a,b){if(!1===n.shouldFilterHtml(a))return b;var c,d=H();return o({validate:!1,allow_conditional_comments:!1,special:"script,noscript",comment:function(a){d.comment(a)},cdata:function(a){d.cdata(a)},text:function(a,b){d.text(a,b)},start:function(b,e,f){if(c=!0,"script"!==b&&"noscript"!==b){for(var g=0;g<e.length;g++){if(0===e[g].name.indexOf("on"))return;"style"===e[g].name&&(e[g].value=a.dom.serializeStyle(a.dom.parseStyle(e[g].value),b))}d.start(b,e,f),c=!1}},end:function(a){c||d.end(a)}},I({})).parse(b),d.getContent()},Ea={sanitize:Da},Fa=function(a,b){var d,e=b.name;return d=new Ca("img",1),d.shortEnded=!0,Ha(a,b,d),d.attr({width:b.attr("width")||"300",height:b.attr("height")||("audio"===e?"30":"150"),style:b.attr("style"),src:c.transparentSrc,"data-mce-object":e,class:"mce-object mce-object-"+e}),d},Ga=function(a,b){var c,d,e,f=b.name;return c=new Ca("span",1),c.attr({contentEditable:"false",style:b.attr("style"),"data-mce-object":f,class:"mce-preview-object mce-object-"+f}),Ha(a,b,c),d=new Ca(f,1),d.attr({src:b.attr("src"),allowfullscreen:b.attr("allowfullscreen"),style:b.attr("style"),class:b.attr("class"),width:b.attr("width"),height:b.attr("height"),frameborder:"0"}),e=new Ca("span",1),e.attr("class","mce-shim"),c.append(d),c.append(e),c},Ha=function(a,b,c){var d,e,f,g,h;for(f=b.attributes,g=f.length;g--;)d=f[g].name,e=f[g].value,"width"!==d&&"height"!==d&&"style"!==d&&("data"!==d&&"src"!==d||(e=a.convertURL(e,d)),c.attr("data-mce-p-"+d,e));(h=b.firstChild&&b.firstChild.value)&&(c.attr("data-mce-html",escape(Ea.sanitize(a,h))),c.firstChild=null)},Ia=function(a){for(;a=a.parent;)if(a.attr("data-ephox-embed-iri"))return!0;return!1},Ja=function(a){return function(b){for(var d,e,f=b.length;f--;)d=b[f],d.parent&&(d.parent.attr("data-mce-object")||("script"!==d.name||(e=r.getVideoScriptMatch(n.getScripts(a),d.attr("src"))))&&(e&&(e.width&&d.attr("width",e.width.toString()),e.height&&d.attr("height",e.height.toString())),"iframe"===d.name&&n.hasLiveEmbeds(a)&&c.ceFalse?Ia(d)||d.replace(Ga(a,d)):Ia(d)||d.replace(Fa(a,d))))}},Ka={createPreviewIframeNode:Ga,createPlaceholderNode:Fa,placeHolderConverter:Ja},La=function(a){a.on("preInit",function(){var b=a.schema.getSpecialElements();d.each("video audio iframe object".split(" "),function(a){b[a]=new RegExp("</"+a+"[^>]*>","gi")});var c=a.schema.getBoolAttrs();d.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(a){c[a]={}}),a.parser.addNodeFilter("iframe,video,audio,object,embed,script",Ka.placeHolderConverter(a)),a.serializer.addAttributeFilter("data-mce-object",function(b,c){for(var d,e,f,g,h,i,j,k,l=b.length;l--;)if(d=b[l],d.parent){for(j=d.attr(c),e=new Ca(j,1),"audio"!==j&&"script"!==j&&(k=d.attr("class"),k&&-1!==k.indexOf("mce-preview-object")?e.attr({width:d.firstChild.attr("width"),height:d.firstChild.attr("height")}):e.attr({width:d.attr("width"),height:d.attr("height")})),e.attr({style:d.attr("style")}),g=d.attributes,f=g.length;f--;){var m=g[f].name;0===m.indexOf("data-mce-p-")&&e.attr(m.substr(11),g[f].value)}"script"===j&&e.attr("type","text/javascript"),h=d.attr("data-mce-html"),h&&(i=new Ca("#text",3),i.raw=!0,i.value=Ea.sanitize(a,unescape(h)),e.append(i)),d.replace(e)}})}),a.on("setContent",function(){a.$("span.mce-preview-object").each(function(b,c){var d=a.$(c);0===d.find("span.mce-shim",c).length&&d.append('<span class="mce-shim"></span>')})})},Ma={setup:La},Na=function(a){a.on("ResolveName",function(a){var b;1===a.target.nodeType&&(b=a.target.getAttribute("data-mce-object"))&&(a.name=b)})},Oa={setup:Na},Pa=function(a){a.on("click keyup",function(){var b=a.selection.getNode();b&&a.dom.hasClass(b,"mce-preview-object")&&a.dom.getAttrib(b,"data-mce-selected")&&b.setAttribute("data-mce-selected","2")}),a.on("ObjectSelected",function(a){var b=a.target.getAttribute("data-mce-object");"audio"!==b&&"script"!==b||a.preventDefault()}),a.on("objectResized",function(a){var b,c=a.target;c.getAttribute("data-mce-object")&&(b=c.getAttribute("data-mce-html"))&&(b=unescape(b),c.setAttribute("data-mce-html",escape(Q.updateHtml(b,{width:a.width,height:a.height}))))})},Qa={setup:Pa},Ra=function(a){a.addButton("media",{tooltip:"Insert/edit media",cmd:"mceMedia",stateSelector:["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"]}),a.addMenuItem("media",{icon:"media",text:"Media",cmd:"mceMedia",context:"insert",prependToContext:!0})},Sa={register:Ra};b.add("media",function(a){return Ba.register(a),Sa.register(a),Oa.setup(a),Ma.setup(a),Qa.setup(a),za.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-nonbreaking",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a,b){for(var c="",d=0;d<b;d++)c+=a;return c},d=function(a){return!!a.plugins.visualchars&&a.plugins.visualchars.isEnabled()},e=function(a,b){var e=d(a)?'<span class="mce-nbsp">&nbsp;</span>':"&nbsp;";a.insertContent(c(e,b)),a.dom.setAttrib(a.dom.select("span.mce-nbsp"),"data-mce-bogus","1")},f={insertNbsp:e},g=function(a){a.addCommand("mceNonBreaking",function(){f.insertNbsp(a,1)})},h={register:g},i=tinymce.util.Tools.resolve("tinymce.util.VK"),j=function(a){var b=a.getParam("nonbreaking_force_tab",0);return"boolean"==typeof b?!0===b?3:0:b},k={getKeyboardSpaces:j},l=function(a){var b=k.getKeyboardSpaces(a);b>0&&a.on("keydown",function(c){if(c.keyCode===i.TAB&&!c.isDefaultPrevented()){if(c.shiftKey)return;c.preventDefault(),c.stopImmediatePropagation(),f.insertNbsp(a,b)}})},m={setup:l},n=function(a){a.addButton("nonbreaking",{title:"Nonbreaking space",cmd:"mceNonBreaking"}),a.addMenuItem("nonbreaking",{icon:"nonbreaking",text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"})},o={register:n};b.add("nonbreaking",function(a){h.register(a),o.register(a),m.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-noneditable",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(a){return a.getParam("noneditable_noneditable_class","mceNonEditable")},e=function(a){return a.getParam("noneditable_editable_class","mceEditable")},f=function(a){var b=a.getParam("noneditable_regexp",[]);return b&&b.constructor===RegExp?[b]:b},g={getNonEditableClass:d,getEditableClass:e,getNonEditableRegExps:f},h=function(a){return function(b){return-1!==(" "+b.attr("class")+" ").indexOf(a)}},i=function(a,b,c){return function(d){var e=arguments,f=e[e.length-2],g=f>0?b.charAt(f-1):"";if('"'===g)return d;if(">"===g){var h=b.lastIndexOf("<",f);if(-1!==h){if(-1!==b.substring(h,f).indexOf('contenteditable="false"'))return d}}return'<span class="'+c+'" data-mce-content="'+a.dom.encode(e[0])+'">'+a.dom.encode("string"==typeof e[1]?e[1]:e[0])+"</span>"}},j=function(a,b,c){var d=b.length,e=c.content;if("raw"!==c.format){for(;d--;)e=e.replace(b[d],i(a,e,g.getNonEditableClass(a)));c.content=e}},k=function(a){var b,d;b=" "+c.trim(g.getEditableClass(a))+" ",d=" "+c.trim(g.getNonEditableClass(a))+" ";var e=h(b),f=h(d),i=g.getNonEditableRegExps(a);a.on("PreInit",function(){i.length>0&&a.on("BeforeSetContent",function(b){j(a,i,b)}),a.parser.addAttributeFilter("class",function(a){for(var b,c=a.length;c--;)b=a[c],e(b)?b.attr("contenteditable","true"):f(b)&&b.attr("contenteditable","false")}),a.serializer.addAttributeFilter("contenteditable",function(a){for(var b,c=a.length;c--;)b=a[c],(e(b)||f(b))&&(i.length>0&&b.attr("data-mce-content")?(b.name="#text",b.type=3,b.raw=!0,b.value=b.attr("data-mce-content")):b.attr("contenteditable",null))})})},l={setup:k};b.add("noneditable",function(a){l.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-pagebreak",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.Env"),d=function(a){return a.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},e=function(a){return a.getParam("pagebreak_split_block",!1)},f={getSeparatorHtml:d,shouldSplitBlock:e},g=function(){return"mce-pagebreak"},h=function(){return'<img src="'+c.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},i=function(a){var b=f.getSeparatorHtml(a),c=new RegExp(b.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");a.on("BeforeSetContent",function(a){a.content=a.content.replace(c,h())}),a.on("PreInit",function(){a.serializer.addNodeFilter("img",function(c){for(var d,e,g=c.length;g--;)if(d=c[g],(e=d.attr("class"))&&-1!==e.indexOf("mce-pagebreak")){var h=d.parent;if(a.schema.getBlockElements()[h.name]&&f.shouldSplitBlock(a)){h.type=3,h.value=b,h.raw=!0,d.remove();continue}d.type=3,d.value=b,d.raw=!0}})})},j={setup:i,getPlaceholderHtml:h,getPageBreakClass:g},k=function(a){a.addCommand("mcePageBreak",function(){a.settings.pagebreak_split_block?a.insertContent("<p>"+j.getPlaceholderHtml()+"</p>"):a.insertContent(j.getPlaceholderHtml())})},l={register:k},m=function(a){a.on("ResolveName",function(b){"IMG"===b.target.nodeName&&a.dom.hasClass(b.target,j.getPageBreakClass())&&(b.name="pagebreak")})},n={setup:m},o=function(a){a.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),a.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})},p={register:o};b.add("pagebreak",function(a){l.register(a),p.register(a),j.setup(a),n.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-paste",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(a,b){return Y.each(b,function(b){a=b.constructor===RegExp?a.replace(b,""):a.replace(b[0],b[1])}),a}function b(b){function c(a){var b=a.name,d=a;if("br"===b)return void(f+="\n");if(g[b]&&(f+=" "),h[b])return void(f+=" ");if(3===a.type&&(f+=a.value),!a.shortEnded&&(a=a.firstChild))do{c(a)}while(a=a.next);i[b]&&d.next&&(f+="\n","p"===b&&(f+="\n"))}var d=ma(),e=ka({},d),f="",g=d.getShortEndedElements(),h=Y.makeMap("script noscript style textarea video audio iframe object"," "),i=d.getBlockElements();return b=a(b,[/<!\[[^\]]+\]>/g]),c(e.parse(b)),f}function c(b){function c(a,b,c){return b||c?"":" "}return b=a(b,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,c],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function d(a){var b=0;return function(){return a+b++}}function e(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function f(a){var b,c;return c=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],a=a.replace(/^[\u00a0 ]+/,""),Y.each(c,function(c){if(c.test(a))return b=!0,!1}),b}function g(a){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(a)}function h(a){function b(a){var c="";if(3===a.type)return a.value;if(a=a.firstChild)do{c+=b(a)}while(a=a.next);return c}function c(a,b){if(3===a.type&&b.test(a.value))return a.value=a.value.replace(b,""),!1;if(a=a.firstChild)do{if(!c(a,b))return!1}while(a=a.next);return!0}function d(a){if(a._listIgnore)return void a.remove();if(a=a.firstChild)do{d(a)}while(a=a.next)}function e(a,b,e){var f=a._listLevel||j;f!==j&&(f<j?h&&(h=h.parent.parent):(i=h,h=null)),h&&h.name===b?h.append(a):(i=i||h,h=new la(b,1),e>1&&h.attr("start",""+e),a.wrap(h)),a.name="li",f>j&&i&&i.lastChild.append(h),j=f,d(a),c(a,/^\u00a0+/),c(a,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),c(a,/^\u00a0+/)}for(var h,i,j=1,k=[],l=a.firstChild;void 0!==l&&null!==l;)if(k.push(l),null!==(l=l.walk()))for(;void 0!==l&&l.parent!==a;)l=l.walk();for(var m=0;m<k.length;m++)if(a=k[m],"p"===a.name&&a.firstChild){var n=b(a);if(g(n)){e(a,"ul");continue}if(f(n)){var o=/([0-9]+)\./.exec(n),p=1;o&&(p=parseInt(o[1],10)),e(a,"ol",p);continue}if(a._listLevel){e(a,"ul",1);continue}h=null}else i=h,h=null}function i(a,b,c,d){var e,f={},g=a.dom.parseStyle(d);return Y.each(g,function(g,h){switch(h){case"mso-list":e=/\w+ \w+([0-9]+)/i.exec(d),e&&(c._listLevel=parseInt(e[1],10)),/Ignore/i.test(g)&&c.firstChild&&(c._listIgnore=!0,c.firstChild._listIgnore=!0);break;case"horiz-align":h="text-align";break;case"vert-align":h="vertical-align";break;case"font-color":case"mso-foreground":h="color";break;case"mso-background":case"mso-highlight":h="background";break;case"font-weight":case"font-style":return void("normal"!==g&&(f[h]=g));case"mso-element":if(/^(comment|comment-list)$/i.test(g))return void c.remove()}if(0===h.indexOf("mso-comment"))return void c.remove();0!==h.indexOf("mso-")&&("all"===P.getRetainStyleProps(a)||b&&b[h])&&(f[h]=g)}),/(bold)/i.test(f["font-weight"])&&(delete f["font-weight"],c.wrap(new la("b",1))),/(italic)/i.test(f["font-style"])&&(delete f["font-style"],c.wrap(new la("i",1))),(f=a.dom.serializeStyle(f,c.name))||null}function j(a,b){a.on("PastePreProcess",function(c){c.content=b(a,c.content,c.internal,c.wordContent)})}function k(a,b){a.on("PastePostProcess",function(c){b(a,c.node)})}function l(a,b){if(!sa.isWordContent(b))return b;var c=[];Y.each(a.schema.getBlockElements(),function(a,b){c.push(b)});var d=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+c.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return b=pa.filter(b,[[d,"$1"]]),b=pa.filter(b,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function m(a,b,c,d){if(d||c)return b;var e,f=P.getWebkitStyles(a);if(!1===P.shouldRemoveWebKitStyles(a)||"all"===f)return b;if(f&&(e=f.split(/[, ]/)),e){var g=a.dom,h=a.selection.getNode();b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,b,c,d){var f=g.parseStyle(g.decode(c)),i={};if("none"===e)return b+d;for(var j=0;j<e.length;j++){var k=f[e[j]],l=g.getStyle(h,e[j],!0);/color/.test(e[j])&&(k=g.toHex(k),l=g.toHex(l)),l!==k&&(i[e[j]]=k)}return i=g.serializeStyle(i,"span"),i?b+' style="'+i+'"'+d:b+d})}else b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return b=b.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,b,c,d){return b+' style="'+c+'"'+d})}function n(a,b){a.$("a",b).find("font,u").each(function(b,c){a.dom.remove(c,!0)})}function o(){}var p=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return p(c())}}},q=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(a){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(a.settings.plugins)||!q.get("powerpaste"))&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},s={hasProPlugin:r},t=function(a,b){return{clipboard:a,quirks:b}},u={get:t},v=function(a,b,c,d){return a.fire("PastePreProcess",{content:b,internal:c,wordContent:d})},w=function(a,b,c,d){return a.fire("PastePostProcess",{node:b,internal:c,wordContent:d})},x=function(a,b){return a.fire("PastePlainTextToggle",{state:b})},y=function(a,b){return a.fire("paste",{ieFake:b})},z={firePastePreProcess:v,firePastePostProcess:w,firePastePlainTextToggle:x,firePaste:y},A=function(a){return a.getParam("paste_plaintext_inform",!0)},B=function(a){return a.getParam("paste_block_drop",!1)},C=function(a){return a.getParam("paste_data_images",!1)},D=function(a){return a.getParam("paste_filter_drop",!0)},E=function(a){return a.getParam("paste_preprocess")},F=function(a){return a.getParam("paste_postprocess")},G=function(a){return a.getParam("paste_webkit_styles")},H=function(a){return a.getParam("paste_remove_styles_if_webkit",!0)},I=function(a){return a.getParam("paste_merge_formats",!0)},J=function(a){return a.getParam("smart_paste",!0)},K=function(a){return a.getParam("paste_as_text",!1)},L=function(a){return a.getParam("paste_retain_style_properties")},M=function(a){return a.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")},N=function(a){return a.getParam("paste_convert_word_fake_lists",!0)},O=function(a){return a.getParam("paste_enable_default_filters",!0)},P={shouldPlainTextInform:A,shouldBlockDrop:B,shouldPasteDataImages:C,shouldFilterDrop:D,getPreProcess:E,getPostProcess:F,getWebkitStyles:G,shouldRemoveWebKitStyles:H,shouldMergeFormats:I,isSmartPasteEnabled:J,isPasteAsTextEnabled:K,getRetainStyleProps:L,getWordValidElements:M,shouldConvertWordFakeLists:N,shouldUseDefaultFilters:O},Q=function(a,b){return!1===b.get()&&P.shouldPlainTextInform(a)},R=function(a,b){a.notificationManager.open({text:a.translate(b),type:"info"})},S=function(a,b,c){"text"===b.pasteFormat.get()?(b.pasteFormat.set("html"),z.firePastePlainTextToggle(a,!1)):(b.pasteFormat.set("text"),z.firePastePlainTextToggle(a,!0),Q(a,c)&&(R(a,"Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),c.set(!0))),a.focus()},T={togglePlainTextPaste:S},U=function(a,b,c){a.addCommand("mceTogglePlainTextPaste",function(){T.togglePlainTextPaste(a,b,c)}),a.addCommand("mceInsertClipboardContent",function(a,c){c.content&&b.pasteHtml(c.content,c.internal),c.text&&b.pasteText(c.text)})},V={register:U},W=tinymce.util.Tools.resolve("tinymce.Env"),X=tinymce.util.Tools.resolve("tinymce.util.Delay"),Y=tinymce.util.Tools.resolve("tinymce.util.Tools"),Z=tinymce.util.Tools.resolve("tinymce.util.VK"),$="\x3c!-- x-tinymce/html --\x3e",_=function(a){return $+a},aa=function(a){return a.replace($,"")},ba=function(a){return-1!==a.indexOf($)},ca={mark:_,unmark:aa,isMarked:ba,internalHtmlMime:function(){return"x-tinymce/html"}},da=tinymce.util.Tools.resolve("tinymce.html.Entities"),ea=function(a){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a)},fa=function(a){return a.replace(/\r?\n/g,"<br>")},ga=function(a,b){var c,d=[],e="<"+a;if("object"==typeof b){for(c in b)b.hasOwnProperty(c)&&d.push(c+'="'+da.encodeAllRaw(b[c])+'"');d.length&&(e+=" "+d.join(" "))}return e+">"},ha=function(a,b,c){var d=a.split(/\n\n/),e=ga(b,c),f="</"+b+">",g=Y.map(d,function(a){return a.split(/\n/).join("<br />")}),h=function(a){return e+a+f};return 1===g.length?g[0]:Y.map(g,h).join("")},ia=function(a,b,c){return b?ha(a,b,c):fa(a)},ja={isPlainText:ea,convert:ia,toBRs:fa,toBlockElements:ha},ka=tinymce.util.Tools.resolve("tinymce.html.DomParser"),la=tinymce.util.Tools.resolve("tinymce.html.Node"),ma=tinymce.util.Tools.resolve("tinymce.html.Schema"),na=tinymce.util.Tools.resolve("tinymce.html.Serializer"),oa=function(){return-1!==navigator.userAgent.indexOf(" Edge/")},pa={filter:a,innerText:b,trimHtml:c,createIdGenerator:d,isMsEdge:oa},qa=function(a,b){var c,d;c=P.getRetainStyleProps(a),c&&(d=Y.makeMap(c.split(/[, ]/))),b=pa.filter(b,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join(""):""}]]);var e=P.getWordValidElements(a),f=ma({valid_elements:e,valid_children:"-li[p]"});Y.each(f.elements,function(a){a.attributes.class||(a.attributes.class={},a.attributesOrder.push("class")),a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});var g=ka({},f);g.addAttributeFilter("style",function(b){for(var c,e=b.length;e--;)c=b[e],c.attr("style",i(a,d,c,c.attr("style"))),"span"===c.name&&c.parent&&!c.attributes.length&&c.unwrap()}),g.addAttributeFilter("class",function(a){for(var b,c,d=a.length;d--;)b=a[d],c=b.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(c)&&b.remove(),b.attr("class",null)}),g.addNodeFilter("del",function(a){for(var b=a.length;b--;)a[b].remove()}),g.addNodeFilter("a",function(a){for(var b,c,d,e=a.length;e--;)if(b=a[e],c=b.attr("href"),d=b.attr("name"),c&&-1!==c.indexOf("#_msocom_"))b.remove();else if(c&&0===c.indexOf("file://")&&(c=c.split("#")[1])&&(c="#"+c),c||d){if(d&&!/^_?(?:toc|edn|ftn)/i.test(d)){b.unwrap();continue}b.attr({href:c,name:d})}else b.unwrap()});var j=g.parse(b);return P.shouldConvertWordFakeLists(a)&&h(j),b=na({validate:a.settings.validate},f).serialize(j)},ra=function(a,b){return P.shouldUseDefaultFilters(a)?qa(a,b):b},sa={preProcess:ra,isWordContent:e},ta=function(a,b){return{content:a,cancelled:b}},ua=function(a,b,c,d){var e=a.dom.create("div",{style:"display:none"},b),f=z.firePastePostProcess(a,e,c,d);return ta(f.node.innerHTML,f.isDefaultPrevented())},va=function(a,b,c,d){var e=z.firePastePreProcess(a,b,c,d);return a.hasEventListeners("PastePostProcess")&&!e.isDefaultPrevented()?ua(a,e.content,c,d):ta(e.content,e.isDefaultPrevented())},wa=function(a,b,c){var d=sa.isWordContent(b),e=d?sa.preProcess(a,b):b;return va(a,e,c,d)},xa={process:wa},ya=function(a,b){return a.insertContent(b,{merge:P.shouldMergeFormats(a),paste:!0}),!0},za=function(a){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(a)},Aa=function(a){return za(a)&&/.(gif|jpe?g|png)$/.test(a)},Ba=function(a,b,c){return a.undoManager.extra(function(){c(a,b)},function(){a.insertContent('<img src="'+b+'">')}),!0},Ca=function(a,b,c){return a.undoManager.extra(function(){c(a,b)},function(){a.execCommand("mceInsertLink",!1,b)}),!0},Da=function(a,b,c){return!(!1!==a.selection.isCollapsed()||!za(b))&&Ca(a,b,c)},Ea=function(a,b,c){return!!Aa(b)&&Ba(a,b,c)},Fa=function(a,b){Y.each([Da,Ea,ya],function(c){return!0!==c(a,b,ya)})},Ga=function(a,b){!1===P.isSmartPasteEnabled(a)?ya(a,b):Fa(a,b)},Ha={isImageUrl:Aa,isAbsoluteUrl:za,insertContent:Ga},Ia=function(a,b,c){var d=c||ca.isMarked(b),e=xa.process(a,ca.unmark(b),d);!1===e.cancelled&&Ha.insertContent(a,e.content)},Ja=function(a,b){b=a.dom.encode(b).replace(/\r\n/g,"\n"),b=ja.convert(b,a.settings.forced_root_block,a.settings.forced_root_block_attrs),Ia(a,b,!1)},Ka=function(a){var b={};if(a){if(a.getData){var c=a.getData("Text");c&&c.length>0&&-1===c.indexOf("data:text/mce-internal,")&&(b["text/plain"]=c)}if(a.types)for(var d=0;d<a.types.length;d++){var e=a.types[d];try{b[e]=a.getData(e)}catch(a){b[e]=""}}}return b},La=function(a,b){var c=Ka(b.clipboardData||a.getDoc().dataTransfer);return pa.isMsEdge()?Y.extend(c,{"text/html":""}):c},Ma=function(a,b){return b in a&&a[b].length>0},Na=function(a){return Ma(a,"text/html")||Ma(a,"text/plain")},Oa=function(a){var b;return b=a.indexOf(","),-1!==b?a.substr(b+1):null},Pa=function(a,b){return!a.images_dataimg_filter||a.images_dataimg_filter(b)},Qa=function(a,b){var c=b.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return c?a.dom.encode(c[1]):null},Ra=pa.createIdGenerator("mceclip"),Sa=function(a,b,c,d){b&&(a.selection.setRng(b),b=null);var e=c.result,f=Oa(e),g=Ra(),h=a.settings.images_reuse_filename&&d.name?Qa(a,d.name):g,i=new Image;if(i.src=e,Pa(a.settings,i)){var j=a.editorUpload.blobCache,k=void 0,l=void 0;l=j.findFirst(function(a){return a.base64()===f}),l?k=l:(k=j.create(g,d,f,h),j.add(k)),Ia(a,'<img src="'+k.blobUri()+'">',!1)}else Ia(a,'<img src="'+e+'">',!1)},Ta=function(a){return"paste"===a.type},Ua=function(a,b,c){function d(d){var e,f,g,h=!1;if(d)for(e=0;e<d.length;e++)if(f=d[e],/^image\/(jpeg|png|gif|bmp)$/.test(f.type)){var i=f.getAsFile?f.getAsFile():f;g=new window.FileReader,g.onload=Sa.bind(null,a,c,g,i),g.readAsDataURL(i),b.preventDefault(),h=!0}return h}var e=Ta(b)?b.clipboardData:b.dataTransfer;if(a.settings.paste_data_images&&e)return d(e.items)||d(e.files)},Va=function(a){var b=a.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&b&&b.items&&0===b.items.length},Wa=function(a){return Z.metaKeyPressed(a)&&86===a.keyCode||a.shiftKey&&45===a.keyCode},Xa=function(a,b,c){function d(c,d,e,f){var g,h;if(Ma(c,"text/html")?g=c["text/html"]:(g=b.getHtml(),f=f||ca.isMarked(g),b.isDefaultContent(g)&&(e=!0)),g=pa.trimHtml(g),b.remove(),h=!1===f&&ja.isPlainText(g),g.length&&!h||(e=!0),e&&(g=Ma(c,"text/plain")&&h?c["text/plain"]:pa.innerText(g)),b.isDefaultContent(g))return void(d||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."));e?Ja(a,g):Ia(a,g,f)}var e,f=0;a.on("keydown",function(c){function d(a){Wa(a)&&!a.isDefaultPrevented()&&b.remove()}if(Wa(c)&&!c.isDefaultPrevented()){if((e=c.shiftKey&&86===c.keyCode)&&W.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(c.stopImmediatePropagation(),f=(new Date).getTime(),W.ie&&e)return c.preventDefault(),void z.firePaste(a,!0);b.remove(),b.create(),a.once("keyup",d),a.once("paste",function(){a.off("keyup",d)})}});var g=function(){return b.getLastRng()||a.selection.getRng()};a.on("paste",function(h){var i=(new Date).getTime(),j=La(a,h),k=(new Date).getTime()-i,l=(new Date).getTime()-f-k<1e3,m="text"===c.get()||e,n=Ma(j,ca.internalHtmlMime());return e=!1,h.isDefaultPrevented()||Va(h)?void b.remove():!Na(j)&&Ua(a,h,g())?void b.remove():(l||h.preventDefault(),!W.ie||l&&!h.ieFake||Ma(j,"text/html")||(b.create(),a.dom.bind(b.getEl(),"paste",function(a){a.stopPropagation()}),a.getDoc().execCommand("Paste",!1,null),j["text/html"]=b.getHtml()),void(Ma(j,"text/html")?(h.preventDefault(),n||(n=ca.isMarked(j["text/html"])),d(j,l,m,n)):X.setEditorTimeout(a,function(){d(j,l,m,n)},0)))})},Ya=function(a,b,c){Xa(a,b,c);var d;a.parser.addNodeFilter("img",function(b,c,e){var f=function(a){a.attr("data-mce-object")||d===W.transparentSrc||a.remove()};if(!a.settings.paste_data_images&&function(a){return a.data&&!0===a.data.paste}(e))for(var g=b.length;g--;)(d=b[g].attributes.map.src)&&(!function(a){return 0===a.indexOf("webkit-fake-url")}(d)?!a.settings.allow_html_data_urls&&function(a){return 0===a.indexOf("data:")}(d)&&f(b[g]):f(b[g]))})},Za=function(a){return W.ie&&a.inline?document.body:a.getBody()},$a=function(a){return Za(a)!==a.getBody()},_a=function(a,b){$a(a)&&a.dom.bind(b,"paste keyup",function(b){setTimeout(function(){a.fire("paste")},0)})},ab=function(a,b,c){var d,e=a.dom,f=a.getBody();b.set(a.selection.getRng()),d=a.dom.add(Za(a),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},c),(W.ie||W.gecko)&&e.setStyle(d,"left","rtl"===e.getStyle(f,"direction",!0)?65535:-65535),e.bind(d,"beforedeactivate focusin focusout",function(a){a.stopPropagation()}),_a(a,d),d.focus(),a.selection.select(d,!0)},bb=function(a,b){if(cb(a)){for(var c=void 0,d=b.get();c=a.dom.get("mcepastebin");)a.dom.remove(c),a.dom.unbind(c);d&&a.selection.setRng(d)}b.set(null)},cb=function(a){return a.dom.get("mcepastebin")},db=function(a){var b,c,d,e,f,g=function(b,c){b.appendChild(c),a.dom.remove(c,!0)};for(c=Y.grep(Za(a).childNodes,function(a){return"mcepastebin"===a.id}),b=c.shift(),Y.each(c,function(a){g(b,a)}),e=a.dom.select("div[id=mcepastebin]",b),d=e.length-1;d>=0;d--)f=a.dom.create("div"),b.insertBefore(f,e[d]),g(f,e[d]);return b?b.innerHTML:""},eb=function(a){return a.get()},fb=function(a,b){return b===a},gb=function(a){return a&&"mcepastebin"===a.id},hb=function(a,b){var c=cb(a);return gb(c)&&fb(b,c.innerHTML)},ib=function(a){var b=p(null);return{create:function(){return ab(a,b,"%MCEPASTEBIN%")},remove:function(){return bb(a,b)},getEl:function(){return cb(a)},getHtml:function(){return db(a)},getLastRng:function(){return eb(b)},isDefault:function(){return hb(a,"%MCEPASTEBIN%")},isDefaultContent:function(a){return fb("%MCEPASTEBIN%",a)}}},jb=function(a,b){var c=ib(a);return a.on("preInit",function(){return Ya(a,c,b)}),{pasteFormat:b,pasteHtml:function(b,c){return Ia(a,b,c)},pasteText:function(b){return Ja(a,b)},pasteImageData:function(b,c){return Ua(a,b,c)},getDataTransferItems:Ka,hasHtmlOrText:Na,hasContentType:Ma}},kb=function(){},lb=function(a){return!1===W.iOS&&void 0!==a&&"function"==typeof a.setData&&!0!==pa.isMsEdge()},mb=function(a,b,c){if(!lb(a))return!1;try{return a.clearData(),a.setData("text/html",b),a.setData("text/plain",c),a.setData(ca.internalHtmlMime(),b),!0}catch(a){return!1}},nb=function(a,b,c,d){mb(a.clipboardData,b.html,b.text)?(a.preventDefault(),d()):c(b.html,d)},ob=function(a){return function(b,c){var d=ca.mark(b),e=a.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),f=a.dom.create("div",{contenteditable:"true"},d);a.dom.setStyles(e,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),e.appendChild(f),a.dom.add(a.getBody(),e);var g=a.selection.getRng();f.focus();var h=a.dom.createRng();h.selectNodeContents(f),a.selection.setRng(h),setTimeout(function(){a.selection.setRng(g),e.parentNode.removeChild(e),c()},0)}},pb=function(a){return{html:a.selection.getContent({contextual:!0}),text:a.selection.getContent({format:"text"})}},qb=function(a){return function(b){!1===a.selection.isCollapsed()&&nb(b,pb(a),ob(a),function(){setTimeout(function(){a.execCommand("Delete")},0)})}},rb=function(a){return function(b){!1===a.selection.isCollapsed()&&nb(b,pb(a),ob(a),kb)}},sb=function(a){a.on("cut",qb(a)),a.on("copy",rb(a))},tb={register:sb},ub=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),vb=function(a,b){return ub.getCaretRangeFromPoint(b.clientX,b.clientY,a.getDoc())},wb=function(a){var b=a["text/plain"];return!!b&&0===b.indexOf("file://")},xb=function(a,b){a.focus(),a.selection.setRng(b)},yb=function(a,b,c){P.shouldBlockDrop(a)&&a.on("dragend dragover draggesture dragdrop drop drag",function(a){a.preventDefault(),a.stopPropagation()}),P.shouldPasteDataImages(a)||a.on("drop",function(a){var b=a.dataTransfer;b&&b.files&&b.files.length>0&&a.preventDefault()}),a.on("drop",function(d){var e,f;if(f=vb(a,d),!d.isDefaultPrevented()&&!c.get()){e=b.getDataTransferItems(d.dataTransfer);var g=b.hasContentType(e,ca.internalHtmlMime());if((b.hasHtmlOrText(e)&&!wb(e)||!b.pasteImageData(d,f))&&f&&P.shouldFilterDrop(a)){var h=e["mce-internal"]||e["text/html"]||e["text/plain"];h&&(d.preventDefault(),X.setEditorTimeout(a,function(){a.undoManager.transact(function(){e["mce-internal"]&&a.execCommand("Delete"),xb(a,f),h=pa.trimHtml(h),e["text/html"]?b.pasteHtml(h,g):b.pasteText(h)})}))}}}),a.on("dragstart",function(a){c.set(!0)}),a.on("dragover dragend",function(b){P.shouldPasteDataImages(a)&&!1===c.get()&&(b.preventDefault(),xb(a,vb(a,b))),
"dragend"===b.type&&c.set(!1)})},zb={setup:yb},Ab=function(a){var b=a.plugins.paste,c=P.getPreProcess(a);c&&a.on("PastePreProcess",function(a){c.call(b,b,a)});var d=P.getPostProcess(a);d&&a.on("PastePostProcess",function(a){d.call(b,b,a)})},Bb={setup:Ab},Cb=function(a){W.webkit&&j(a,m),W.ie&&(j(a,l),k(a,n))},Db={setup:Cb},Eb=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},Fb=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},Gb=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},Hb=function(a){return function(){return a}},Ib=function(a){return a},Jb=function(a,b){return a===b},Kb=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},Lb=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},Mb=function(a){return function(){throw new Error(a)}},Nb=function(a){return a()},Ob=function(a){a()},Pb=Hb(!1),Qb=Hb(!0),Rb={noop:Eb,noarg:Fb,compose:Gb,constant:Hb,identity:Ib,tripleEquals:Jb,curry:Kb,not:Lb,die:Mb,apply:Nb,call:Ob,never:Pb,always:Qb},Sb=function(a,b,c){var d=c.control;d.active("text"===b.pasteFormat.get()),a.on("PastePlainTextToggle",function(a){d.active(a.state)})},Tb=function(a,b){var c=Rb.curry(Sb,a,b);a.addButton("pastetext",{active:!1,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:c}),a.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:b.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:c})},Ub={register:Tb};q.add("paste",function(a){if(!1===s.hasProPlugin(a)){var b=p(!1),c=p(!1),d=p(P.isPasteAsTextEnabled(a)?"text":"html"),e=jb(a,d),f=Db.setup(a);return Ub.register(a,e),V.register(a,e,b),Bb.setup(a),tb.register(a),zb.setup(a,e,c),u.get(e,f)}})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-preview",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.Env"),d=function(a){return parseInt(a.getParam("plugin_preview_width","650"),10)},e=function(a){return parseInt(a.getParam("plugin_preview_height","500"),10)},f=function(a){return a.getParam("content_style","")},g={getPreviewDialogWidth:d,getPreviewDialogHeight:e,getContentStyle:f},h=tinymce.util.Tools.resolve("tinymce.util.Tools"),i=function(a){var b="",c=a.dom.encode,d=g.getContentStyle(a);b+='<base href="'+c(a.documentBaseURI.getURI())+'">',d&&(b+='<style type="text/css">'+d+"</style>"),h.each(a.contentCSS,function(d){b+='<link type="text/css" rel="stylesheet" href="'+c(a.documentBaseURI.toAbsolute(d))+'">'});var e=a.settings.body_id||"tinymce";-1!==e.indexOf("=")&&(e=a.getParam("body_id","","hash"),e=e[a.id]||e);var f=a.settings.body_class||"";-1!==f.indexOf("=")&&(f=a.getParam("body_class","","hash"),f=f[a.id]||"");var i=a.settings.directionality?' dir="'+a.settings.directionality+'"':"";return"<!DOCTYPE html><html><head>"+b+'</head><body id="'+c(e)+'" class="mce-content-body '+c(f)+'"'+c(i)+">"+a.getContent()+'<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> </body></html>'},j=function(a,b,c){var d=i(a);if(c)b.src="data:text/html;charset=utf-8,"+encodeURIComponent(d);else{var e=b.contentWindow.document;e.open(),e.write(d),e.close()}},k={getPreviewHtml:i,injectIframeContent:j},l=function(a){var b=!c.ie,d='<iframe src="" frameborder="0"'+(b?' sandbox="allow-scripts"':"")+"></iframe>",e=g.getPreviewDialogWidth(a),f=g.getPreviewDialogHeight(a);a.windowManager.open({title:"Preview",width:e,height:f,html:d,buttons:{text:"Close",onclick:function(a){a.control.parent().parent().close()}},onPostRender:function(c){var d=c.control.getEl("body").firstChild;k.injectIframeContent(a,d,b)}})},m={open:l},n=function(a){a.addCommand("mcePreview",function(){m.open(a)})},o={register:n},p=function(a){a.addButton("preview",{title:"Preview",cmd:"mcePreview"}),a.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})},q={register:p};b.add("preview",function(a){o.register(a),q.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-print",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a){a.addCommand("mcePrint",function(){a.getWin().print()})},d={register:c},e=function(a){a.addButton("print",{title:"Print",cmd:"mcePrint"}),a.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print"})},f={register:e};b.add("print",function(a){d.register(a),f.register(a),a.addShortcut("Meta+P","","mcePrint")})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-save",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),d=tinymce.util.Tools.resolve("tinymce.util.Tools"),e=function(a){return a.getParam("save_enablewhendirty",!0)},f=function(a){return!!a.getParam("save_onsavecallback")},g=function(a){return!!a.getParam("save_oncancelcallback")},h={enableWhenDirty:e,hasOnSaveCallback:f,hasOnCancelCallback:g},i=function(a,b){a.notificationManager.open({text:a.translate(b),type:"error"})},j=function(a){var b;if(b=c.DOM.getParent(a.id,"form"),!h.enableWhenDirty(a)||a.isDirty()){if(a.save(),h.hasOnSaveCallback(a))return a.execCallback("save_onsavecallback",a),void a.nodeChanged();b?(a.setDirty(!1),b.onsubmit&&!b.onsubmit()||("function"==typeof b.submit?b.submit():i(a,"Error: Form submit field collision.")),a.nodeChanged()):i(a,"Error: No form element found.")}},k=function(a){var b=d.trim(a.startContent);if(h.hasOnCancelCallback(a))return void a.execCallback("save_oncancelcallback",a);a.setContent(b),a.undoManager.clear(),a.nodeChanged()},l={save:j,cancel:k},m=function(a){a.addCommand("mceSave",function(){l.save(a)}),a.addCommand("mceCancel",function(){l.cancel(a)})},n={register:m},o=function(a){return function(b){var c=b.control;a.on("nodeChange dirty",function(){c.disabled(h.enableWhenDirty(a)&&!a.isDirty())})}},p=function(a){a.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:o(a)}),a.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:o(a)}),a.addShortcut("Meta+S","","mceSave")},q={register:p};b.add("save",function(a){q.register(a),n.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-searchreplace",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(a){return a&&1===a.nodeType&&"false"===a.contentEditable}function b(b,c,d,e,f){function g(a,b){if(b=b||0,!a[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var c=a.index;if(b>0){var d=a[b];if(!d)throw new Error("Invalid capture group");c+=a[0].indexOf(d),a[0]=d}return[c,c+a[0].length,[a[0]]]}function h(b){var c;if(3===b.nodeType)return b.data;if(m[b.nodeName]&&!l[b.nodeName])return"";if(c="",a(b))return"\n";if((l[b.nodeName]||n[b.nodeName])&&(c+="\n"),b=b.firstChild)do{c+=h(b)}while(b=b.nextSibling);return c}var i,j,k,l,m,n,o=[],p=0;if(k=c.ownerDocument,l=f.getBlockElements(),m=f.getWhiteSpaceElements(),n=f.getShortEndedElements(),j=h(c)){if(b.global)for(;i=b.exec(j);)o.push(g(i,e));else i=j.match(b),o.push(g(i,e));return o.length&&(p=o.length,function(b,c,d){var e,f,g,h,i=[],j=0,k=b,o=c.shift(),p=0;a:for(;;){if((l[k.nodeName]||n[k.nodeName]||a(k))&&j++,3===k.nodeType&&(!f&&k.length+j>=o[1]?(f=k,h=o[1]-j):e&&i.push(k),!e&&k.length+j>o[0]&&(e=k,g=o[0]-j),j+=k.length),e&&f){if(k=d({startNode:e,startNodeIndex:g,endNode:f,endNodeIndex:h,innerNodes:i,match:o[2],matchIndex:p}),j-=f.length-h,e=null,f=null,i=[],o=c.shift(),p++,!o)break}else if(m[k.nodeName]&&!l[k.nodeName]||!k.firstChild){if(k.nextSibling){k=k.nextSibling;continue}}else if(!a(k)){k=k.firstChild;continue}for(;;){if(k.nextSibling){k=k.nextSibling;break}if(k.parentNode===b)break a;k=k.parentNode}}}(c,o,function(a){var b;if("function"!=typeof a){var c=a.nodeType?a:k.createElement(a);b=function(a,b){var d=c.cloneNode(!1);return d.setAttribute("data-mce-index",b),a&&d.appendChild(k.createTextNode(a)),d}}else b=a;return function(a){var c,d,e,f=a.startNode,g=a.endNode,h=a.matchIndex;if(f===g){var i=f;e=i.parentNode,a.startNodeIndex>0&&(c=k.createTextNode(i.data.substring(0,a.startNodeIndex)),e.insertBefore(c,i));var j=b(a.match[0],h);return e.insertBefore(j,i),a.endNodeIndex<i.length&&(d=k.createTextNode(i.data.substring(a.endNodeIndex)),e.insertBefore(d,i)),i.parentNode.removeChild(i),j}c=k.createTextNode(f.data.substring(0,a.startNodeIndex)),d=k.createTextNode(g.data.substring(a.endNodeIndex));for(var l=b(f.data.substring(a.startNodeIndex),h),m=[],n=0,o=a.innerNodes.length;n<o;++n){var p=a.innerNodes[n],q=b(p.data,h);p.parentNode.replaceChild(q,p),m.push(q)}var r=b(g.data.substring(0,a.endNodeIndex),h);return e=f.parentNode,e.insertBefore(c,f),e.insertBefore(l,f),e.removeChild(f),e=g.parentNode,e.insertBefore(r,g),e.insertBefore(d,g),e.removeChild(g),r}}(d))),p}}function c(){}var d=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return d(c())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=tinymce.util.Tools.resolve("tinymce.util.Tools"),g={findAndReplaceDOMText:b},h=function(a){var b=a.getAttribute("data-mce-index");return"number"==typeof b?""+b:b},i=function(a,b,c){var d,e;return e=a.dom.create("span",{"data-mce-bogus":1}),e.className="mce-match-marker",d=a.getBody(),s(a,b,!1),g.findAndReplaceDOMText(c,d,e,!1,a.schema)},j=function(a){var b=a.parentNode;a.firstChild&&b.insertBefore(a.firstChild,a),a.parentNode.removeChild(a)},k=function(a,b){var c,d=[];if(c=f.toArray(a.getBody().getElementsByTagName("span")),c.length)for(var e=0;e<c.length;e++){var g=h(c[e]);null!==g&&g.length&&(g===b.toString()&&d.push(c[e]))}return d},l=function(a,b,c){var d=b.get(),e=a.dom;c=!1!==c,c?d++:d--,e.removeClass(k(a,b.get()),"mce-match-marker-selected");var f=k(a,d);return f.length?(e.addClass(k(a,d),"mce-match-marker-selected"),a.selection.scrollIntoView(f[0]),d):-1},m=function(a,b){var c=b.parentNode;a.remove(b),a.isEmpty(c)&&a.remove(c)},n=function(a,b,c,d,e){c=c.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c=c.replace(/\s/g,"\\s"),c=e?"\\b"+c+"\\b":c;var f=i(a,b,new RegExp(c,d?"g":"gi"));return f&&(b.set(-1),b.set(l(a,b,!0))),f},o=function(a,b){var c=l(a,b,!0);-1!==c&&b.set(c)},p=function(a,b){var c=l(a,b,!1);-1!==c&&b.set(c)},q=function(a){var b=h(a);return null!==b&&b.length>0},r=function(a,b,c,d,e){var g,i,k,l,n,r,s=b.get();for(d=!1!==d,k=a.getBody(),i=f.grep(f.toArray(k.getElementsByTagName("span")),q),g=0;g<i.length;g++){var v=h(i[g]);if(l=n=parseInt(v,10),e||l===b.get()){for(c.length?(i[g].firstChild.nodeValue=c,j(i[g])):m(a.dom,i[g]);i[++g];){if((l=parseInt(h(i[g]),10))!==n){g--;break}m(a.dom,i[g])}d&&s--}else n>b.get()&&i[g].setAttribute("data-mce-index",n-1)}return b.set(s),d?(r=t(a,b),o(a,b)):(r=u(a,b),p(a,b)),!e&&r},s=function(a,b,c){var d,e,g,i;for(e=f.toArray(a.getBody().getElementsByTagName("span")),d=0;d<e.length;d++){var k=h(e[d]);null!==k&&k.length&&(k===b.get().toString()&&(g||(g=e[d].firstChild),i=e[d].firstChild),j(e[d]))}if(g&&i){var l=a.dom.createRng();return l.setStart(g,0),l.setEnd(i,i.data.length),!1!==c&&a.selection.setRng(l),l}},t=function(a,b){return k(a,b.get()+1).length>0},u=function(a,b){return k(a,b.get()-1).length>0},v={done:s,find:n,next:o,prev:p,replace:r,hasNext:t,hasPrev:u},w=function(a,b){return{done:function(c){return v.done(a,b,c)},find:function(c,d,e){return v.find(a,b,c,d,e)},next:function(){return v.next(a,b)},prev:function(){return v.prev(a,b)},replace:function(c,d,e){return v.replace(a,b,c,d,e)}}},x={get:w},y=function(a,b){function c(){h.statusbar.find("#next").disabled(!1===v.hasNext(a,b)),h.statusbar.find("#prev").disabled(!1===v.hasPrev(a,b))}function d(){a.windowManager.alert("Could not find the specified string.",function(){h.find("#find")[0].focus()})}var e,g={};a.undoManager.add(),e=f.trim(a.selection.getContent({format:"text"}));var h=a.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){a.focus(),v.done(a,b),a.undoManager.add()},onSubmit:function(e){var f,i,j,k;return e.preventDefault(),i=h.find("#case").checked(),k=h.find("#words").checked(),j=h.find("#find").value(),j.length?g.text===j&&g.caseState===i&&g.wholeWord===k?v.hasNext(a,b)?(v.next(a,b),void c()):void d():(f=v.find(a,b,j,i,k),f||d(),h.statusbar.items().slice(1).disabled(0===f),c(),void(g={text:j,caseState:i,wholeWord:k})):(v.done(a,b,!1),void h.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){h.submit()}},{text:"Replace",disabled:!0,onclick:function(){v.replace(a,b,h.find("#replace").value())||(h.statusbar.items().slice(1).disabled(!0),b.set(-1),g={})}},{text:"Replace all",disabled:!0,onclick:function(){v.replace(a,b,h.find("#replace").value(),!0,!0),h.statusbar.items().slice(1).disabled(!0),g={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){v.prev(a,b),c()}},{text:"Next",name:"next",disabled:!0,onclick:function(){v.next(a,b),c()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:e},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})},z={open:y},A=function(a,b){a.addCommand("SearchReplace",function(){z.open(a,b)})},B={register:A},C=function(a,b){return function(){z.open(a,b)}},D=function(a,b){a.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:C(a,b),separator:"before",context:"edit"}),a.addButton("searchreplace",{tooltip:"Find and replace",onclick:C(a,b)}),a.shortcuts.add("Meta+F","",C(a,b))},E={register:D};e.add("searchreplace",function(a){var b=d(-1);return B.register(a,b),E.register(a,b),x.get(a,b)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-spellchecker",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(a){return a&&1===a.nodeType&&"false"===a.contentEditable}function b(){}var c,d=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return d(c())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=function(a){return!(!/(^|[ ,])tinymcespellchecker([, ]|$)/.test(a.settings.plugins)||!e.get("tinymcespellchecker"))&&(void 0!==window.console&&window.console.log&&window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),!0)},g={hasProPlugin:f},h=function(a){return a.getParam("spellchecker_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")},i=function(a){var b=a.getParam("language","en");return a.getParam("spellchecker_language",b)},j=function(a){return a.getParam("spellchecker_rpc_url")},k=function(a){return a.getParam("spellchecker_callback")},l=function(a){var b=new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`]+',"g");return a.getParam("spellchecker_wordchar_pattern",b)},m={getLanguages:h,getLanguage:i,getRpcUrl:j,getSpellcheckerCallback:k,getSpellcheckerWordcharPattern:l},n=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=tinymce.util.Tools.resolve("tinymce.util.URI"),p=tinymce.util.Tools.resolve("tinymce.util.XHR"),q=function(a){return a.fire("SpellcheckStart")},r=function(a){return a.fire("SpellcheckEnd")},s={fireSpellcheckStart:q,fireSpellcheckEnd:r},t=function(b,c){function d(a,b){if(!a[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return{start:a.index,end:a.index+a[0].length,text:a[0],data:b}}function e(b){var c;if(3===b.nodeType)return b.data;if(z[b.nodeName]&&!y[b.nodeName])return"";if(a(b))return"\n";if(c="",(y[b.nodeName]||A[b.nodeName])&&(c+="\n"),b=b.firstChild)do{c+=e(b)}while(b=b.nextSibling);return c}function f(b,c,d){var e,f,g,h,i,j=[],k=0,l=b,m=0;c=c.slice(0),c.sort(function(a,b){return a.start-b.start}),i=c.shift();a:for(;;){if((y[l.nodeName]||A[l.nodeName]||a(l))&&k++,3===l.nodeType&&(!f&&l.length+k>=i.end?(f=l,h=i.end-k):e&&j.push(l),!e&&l.length+k>i.start&&(e=l,g=i.start-k),k+=l.length),e&&f){if(l=d({startNode:e,startNodeIndex:g,endNode:f,endNodeIndex:h,innerNodes:j,match:i.text,matchIndex:m}),k-=f.length-h,e=null,f=null,j=[],i=c.shift(),m++,!i)break}else if(z[l.nodeName]&&!y[l.nodeName]||!l.firstChild){if(l.nextSibling){l=l.nextSibling;continue}}else if(!a(l)){l=l.firstChild;continue}for(;;){if(l.nextSibling){l=l.nextSibling;break}if(l.parentNode===b)break a;l=l.parentNode}}}function g(a){function b(b,c){var d=B[c];d.stencil||(d.stencil=a(d));var e=d.stencil.cloneNode(!1);return e.setAttribute("data-mce-index",c),b&&e.appendChild(C.doc.createTextNode(b)),e}return function(a){var c,d,e,f=a.startNode,g=a.endNode,h=a.matchIndex,i=C.doc;if(f===g){var j=f;e=j.parentNode,a.startNodeIndex>0&&(c=i.createTextNode(j.data.substring(0,a.startNodeIndex)),e.insertBefore(c,j));var k=b(a.match,h);return e.insertBefore(k,j),a.endNodeIndex<j.length&&(d=i.createTextNode(j.data.substring(a.endNodeIndex)),e.insertBefore(d,j)),j.parentNode.removeChild(j),k}c=i.createTextNode(f.data.substring(0,a.startNodeIndex)),d=i.createTextNode(g.data.substring(a.endNodeIndex));for(var l=b(f.data.substring(a.startNodeIndex),h),m=[],n=0,o=a.innerNodes.length;n<o;++n){var p=a.innerNodes[n],q=b(p.data,h);p.parentNode.replaceChild(q,p),m.push(q)}var r=b(g.data.substring(0,a.endNodeIndex),h);return e=f.parentNode,e.insertBefore(c,f),e.insertBefore(l,f),e.removeChild(f),e=g.parentNode,e.insertBefore(r,g),e.insertBefore(d,g),e.removeChild(g),r}}function h(a){a.parentNode.insertBefore(a.firstChild,a),a.parentNode.removeChild(a)}function i(a){return-1!==a.className.indexOf("mce-spellchecker-word")}function j(a){var c=b.getElementsByTagName("*"),d=[];a="number"==typeof a?""+a:null;for(var e=0;e<c.length;e++){var f=c[e],g=f.getAttribute("data-mce-index");null!==g&&g.length&&i(f)&&(g!==a&&null!==a||d.push(f))}return d}function k(a){for(var b=B.length;b--;)if(B[b]===a)return b;return-1}function l(a){var b=[];return m(function(c,d){a(c,d)&&b.push(c)}),B=b,this}function m(a){for(var b=0,c=B.length;b<c&&!1!==a(B[b],b);b++);return this}function n(a){return B.length&&f(b,B,g(a)),this}function o(a,b){if(x&&a.global)for(;w=a.exec(x);)B.push(d(w,b));return this}function p(a){var b,c=j(a?k(a):null);for(b=c.length;b--;)h(c[b]);return this}function q(a){return B[a.getAttribute("data-mce-index")]}function r(a){return j(k(a))[0]}function s(a,b,c){return B.push({start:a,end:a+b,text:x.substr(a,b),data:c}),this}function t(a){var b=j(k(a)),d=c.dom.createRng();return d.setStartBefore(b[0]),d.setEndAfter(b[b.length-1]),d}function u(a,b){var d=t(a);return d.deleteContents(),b.length>0&&d.insertNode(c.dom.doc.createTextNode(b)),d}function v(){return B.splice(0,B.length),p(),this}var w,x,y,z,A,B=[],C=c.dom;return y=c.schema.getBlockElements(),z=c.schema.getWhiteSpaceElements(),A=c.schema.getShortEndedElements(),x=e(b),{text:x,matches:B,each:m,filter:l,reset:v,matchFromElement:q,elementFromMatch:r,find:o,add:s,wrap:n,unwrap:p,replace:u,rangeFromMatch:t,indexOf:k}},u=function(a,b){if(!b.get()){var c=t(a.getBody(),a);b.set(c)}return b.get()},v=function(a){for(var b in a)return!1;return!0},w=function(a,b,c){return function(d,e,f,g){var h={method:d,lang:c.get()},i="";h["addToDictionary"===d?"word":"text"]=e,n.each(h,function(a,b){i&&(i+="&"),i+=b+"="+encodeURIComponent(a)}),p.send({url:new o(b).toAbsolute(m.getRpcUrl(a)),type:"post",content_type:"application/x-www-form-urlencoded",data:i,success:function(b){if(b=JSON.parse(b))b.error?g(b.error):f(b);else{var c=a.translate("Server response wasn't proper JSON.");g(c)}},error:function(){var b=a.translate("The spelling service was not found: (")+m.getRpcUrl(a)+a.translate(")");g(b)}})}},x=function(a,b,c,d,e,f,g){var h=m.getSpellcheckerCallback(a);(h||w(a,b,c)).call(a.plugins.spellchecker,d,e,f,g)},y=function(a,b,c,d,e,f){if(!C(a,c,d)){var g=function(b){a.notificationManager.open({text:b,type:"error"}),a.setProgressState(!1),C(a,c,d)},h=function(b){F(a,c,d,e,b)};a.setProgressState(!0),x(a,b,f,"spellcheck",u(a,d).text,h,g),a.focus()}},z=function(a,b,c){a.dom.select("span.mce-spellchecker-word").length||C(a,b,c)},A=function(a,b,c,d,e,f,g){a.setProgressState(!0),x(a,b,e,"addToDictionary",f,function(){a.setProgressState(!1),a.dom.remove(g,!0),z(a,c,d)},function(b){a.notificationManager.open({text:b,type:"error"}),a.setProgressState(!1)})},B=function(a,b,c,d,e,f){a.selection.collapse(),f?n.each(a.dom.select("span.mce-spellchecker-word"),function(b){b.getAttribute("data-mce-word")===d&&a.dom.remove(b,!0)}):a.dom.remove(e,!0),z(a,b,c)},C=function(a,b,c){if(u(a,c).reset(),c.set(null),b.get())return b.set(!1),s.fireSpellcheckEnd(a),!0},D=function(a){var b=a.getAttribute("data-mce-index");return"number"==typeof b?""+b:b},E=function(a,b){var c,d=[];if(c=n.toArray(a.getBody().getElementsByTagName("span")),c.length)for(var e=0;e<c.length;e++){var f=D(c[e]);null!==f&&f.length&&(f===b.toString()&&d.push(c[e]))}return d},F=function(a,b,c,d,e){var f,g;if("string"!=typeof e&&e.words?(g=!!e.dictionary,f=e.words):f=e,a.setProgressState(!1),v(f)){var h=a.translate("No misspellings found.");return a.notificationManager.open({text:h,type:"info"}),void b.set(!1)}d.set({suggestions:f,hasDictionarySupport:g}),u(a,c).find(m.getSpellcheckerWordcharPattern(a)).filter(function(a){return!!f[a.text]}).wrap(function(b){return a.dom.create("span",{class:"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":b.text})}),b.set(!0),s.fireSpellcheckStart(a)},G={spellcheck:y,checkIfFinished:z,addToDictionary:A,ignoreWord:B,findSpansByIndex:E,getElmIndex:D,markErrors:F},H=function(a,b,c,d,e,f){var g=function(){return e.get()},h=function(){return m.getSpellcheckerWordcharPattern(a)},i=function(e){G.markErrors(a,b,d,c,e)};return{getTextMatcher:function(){return d.get()},getWordCharPattern:h,markErrors:i,getLanguage:g}},I={get:H},J=function(a,b,c,d,e,f){a.addCommand("mceSpellCheck",function(){G.spellcheck(a,b,c,d,e,f)})},K={register:J},L=function(a,b){var c=[];return n.each(b,function(a){c.push({selectable:!0,text:a.name,data:a.value})}),c},M=function(a,b){return function(a){var c=b.get();a.control.items().each(function(a){a.active(a.settings.data===c)})}},N=function(a){return n.map(m.getLanguages(a).split(","),function(a){return a=a.split("="),{name:a[0],value:a[1]}})},O=function(a,b,c,d,e,f){var g=L(0,N(a)),h=function(){G.spellcheck(a,b,c,d,f,e)},i={tooltip:"Spellcheck",onclick:h,onPostRender:function(b){var d=b.control;a.on("SpellcheckStart SpellcheckEnd",function(){d.active(c.get())})}};g.length>1&&(i.type="splitbutton",i.menu=g,i.onshow=M(0,e),i.onselect=function(a){e.set(a.control.settings.data)}),a.addButton("spellchecker",i),a.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:h,selectable:!0,onPostRender:function(){var b=this;b.active(c.get()),a.on("SpellcheckStart SpellcheckEnd",function(){b.active(c.get())})}})},P={register:O},Q=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),R=tinymce.util.Tools.resolve("tinymce.ui.Factory"),S=function(a,b,d,e,f,g,h,i){var j=[],k=d.get().suggestions[h];n.each(k,function(b){j.push({text:b,onclick:function(){a.insertContent(a.dom.encode(b)),a.dom.remove(i),G.checkIfFinished(a,e,f)}})}),j.push({text:"-"}),d.get().hasDictionarySupport&&j.push({text:"Add to Dictionary",onclick:function(){G.addToDictionary(a,b,e,f,g,h,i)}}),j.push.apply(j,[{text:"Ignore",onclick:function(){G.ignoreWord(a,e,f,h,i)}},{text:"Ignore all",onclick:function(){G.ignoreWord(a,e,f,h,i,!0)}}]),c=R.create("menu",{items:j,context:"contextmenu",onautohide:function(a){-1!==a.target.className.indexOf("spellchecker")&&a.preventDefault()},onhide:function(){c.remove(),c=null}}),c.renderTo(document.body);var l=Q.DOM.getPos(a.getContentAreaContainer()),m=a.dom.getPos(i[0]),o=a.dom.getRoot();"BODY"===o.nodeName?(m.x-=o.ownerDocument.documentElement.scrollLeft||o.scrollLeft,m.y-=o.ownerDocument.documentElement.scrollTop||o.scrollTop):(m.x-=o.scrollLeft,m.y-=o.scrollTop),l.x+=m.x,l.y+=m.y,c.moveTo(l.x,l.y+i[0].offsetHeight)},T=function(a,b,c,d,e,f){a.on("click",function(g){var h=g.target;if("mce-spellchecker-word"===h.className){g.preventDefault();var i=G.findSpansByIndex(a,G.getElmIndex(h));if(i.length>0){var j=a.dom.createRng();j.setStartBefore(i[0]),j.setEndAfter(i[i.length-1]),a.selection.setRng(j),S(a,b,c,d,e,f,h.getAttribute("data-mce-word"),i)}}})},U={setup:T};e.add("spellchecker",function(a,b){if(!1===g.hasProPlugin(a)){var c=d(!1),e=d(m.getLanguage(a)),f=d(null),h=d(null);return P.register(a,b,c,f,e,h),U.setup(a,b,h,c,f,e),K.register(a,b,c,f,h,e),I.get(a,c,h,f,e,b)}})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-tabfocus",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),d=tinymce.util.Tools.resolve("tinymce.EditorManager"),e=tinymce.util.Tools.resolve("tinymce.Env"),f=tinymce.util.Tools.resolve("tinymce.util.Delay"),g=tinymce.util.Tools.resolve("tinymce.util.Tools"),h=tinymce.util.Tools.resolve("tinymce.util.VK"),i=function(a){return a.getParam("tabfocus_elements",":prev,:next")},j=function(a){return a.getParam("tab_focus",i(a))},k={getTabFocus:j},l=c.DOM,m=function(a){a.keyCode!==h.TAB||a.ctrlKey||a.altKey||a.metaKey||a.preventDefault()},n=function(a){function b(b){function c(c){function e(a){return"BODY"===a.nodeName||"hidden"!==a.type&&"none"!==a.style.display&&"hidden"!==a.style.visibility&&e(a.parentNode)}function f(a){return/INPUT|TEXTAREA|BUTTON/.test(a.tagName)&&d.get(b.id)&&-1!==a.tabIndex&&e(a)}if(j=l.select(":input:enabled,*[tabindex]:not(iframe)"),g.each(j,function(b,c){if(b.id===a.id)return i=c,!1}),c>0){for(n=i+1;n<j.length;n++)if(f(j[n]))return j[n]}else for(n=i-1;n>=0;n--)if(f(j[n]))return j[n];return null}var i,j,m,n;if(!(b.keyCode!==h.TAB||b.ctrlKey||b.altKey||b.metaKey||b.isDefaultPrevented())&&(m=g.explode(k.getTabFocus(a)),1===m.length&&(m[1]=m[0],m[0]=":prev"),j=b.shiftKey?":prev"===m[0]?c(-1):l.get(m[0]):":next"===m[1]?c(1):l.get(m[1]))){var o=d.get(j.id||j.name);j.id&&o?o.focus():f.setTimeout(function(){e.webkit||window.focus(),j.focus()},10),b.preventDefault()}}a.on("init",function(){a.inline&&l.setAttrib(a.getBody(),"tabIndex",null),a.on("keyup",m),e.gecko?a.on("keypress keydown",b):a.on("keydown",b)})},o={setup:n};b.add("tabfocus",function(a){o.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-table",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];if(a.length!==b.length)throw new Error('Wrong number of arguments to struct. Expected "['+a.length+']", got '+b.length+" arguments");var d={};return Aa.each(a,function(a,c){d[a]=M.constant(b[c])}),d}}function b(a,b){var c=a.concat(b);if(0===c.length)throw new Error("You must specify at least one required or optional field.");return Ra.validateStrArr("required",a),Ra.validateStrArr("optional",b),Ra.checkDupes(c),function(d){var e=Ka.keys(d);Aa.forall(a,function(a){return Aa.contains(e,a)})||Ra.reqMessage(a,e);var f=Aa.filter(e,function(a){return!Aa.contains(c,a)});f.length>0&&Ra.unsuppMessage(f);var g={};return Aa.each(a,function(a){g[a]=M.constant(d[a])}),Aa.each(b,function(a){g[a]=M.constant(Object.prototype.hasOwnProperty.call(d,a)?T.some(d[a]):T.none())}),g}}function c(a,b,c){var d=a.isiOS()&&!0===/ipad/i.test(c),e=a.isiOS()&&!d,f=a.isAndroid()&&3===a.version.major,g=a.isAndroid()&&4===a.version.major,h=d||f||g&&!0===/mobile/i.test(c),i=a.isiOS()||a.isAndroid(),j=i&&!h,k=b.isSafari()&&a.isiOS()&&!1===/safari/i.test(c);return{isiPad:M.constant(d),isiPhone:M.constant(e),isTablet:M.constant(h),isPhone:M.constant(j),isTouch:M.constant(i),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:M.constant(k)}}function d(a,b,c,d,e){return a(c,d)?T.some(c):W.isFunction(e)&&e(c)?T.none():b(c,d,e)}function e(){var a=function(a){return kb.fromDom(a.dom().cloneNode(!1))},b=function(a){return!!vd.isElement(a)&&("body"===vd.name(a)||Aa.contains(eg,vd.name(a)))},c=function(a){return!!vd.isElement(a)&&Aa.contains(["br","img","hr","input"],vd.name(a))},d=function(a,b){return a.dom().compareDocumentPosition(b.dom())},e=function(a,b){var c=Gd.clone(a);Gd.setAll(b,c)};return{up:M.constant({selector:ie.ancestor,closest:ie.closest,predicate:be.ancestor,all:jd.parents}),down:M.constant({selector:Wd.descendants,predicate:Qd.descendants}),styles:M.constant({get:Ze.get,getRaw:Ze.getRaw,set:Ze.set,remove:Ze.remove}),attrs:M.constant({get:Gd.get,set:Gd.set,remove:Gd.remove,copyTo:e}),insert:M.constant({before:ef.before,after:ef.after,afterAll:kf.after,append:ef.append,appendAll:kf.append,prepend:ef.prepend,wrap:ef.wrap}),remove:M.constant({unwrap:of.unwrap,remove:of.remove}),create:M.constant({nu:kb.fromTag,clone:a,text:kb.fromText}),query:M.constant({comparePosition:d,prevSibling:jd.prevSibling,nextSibling:jd.nextSibling}),property:M.constant({children:jd.children,name:vd.name,parent:jd.parent,isText:vd.isText,isComment:vd.isComment,isElement:vd.isElement,getText:Hf.get,setText:Hf.set,isBoundary:b,isEmptyTag:c}),eq:Qc.eq,is:Qc.is}}function f(a,b){var c=function(b,c){if(!W.isNumber(c)&&!c.match(/^[0-9]+$/))throw a+".set accepts only positive integer values. Value was "+c;var d=b.dom();Ie.isSupported(d)&&(d.style[a]=c+"px")},d=function(c){var d=b(c);if(d<=0||null===d){var e=Ze.get(c,a);return parseFloat(e)||0}return d},e=d,f=function(a,b){return Aa.foldl(b,function(b,c){var d=Ze.get(a,c),e=void 0===d?0:parseInt(d,10);return isNaN(e)?b:b+e},0)};return{set:c,get:d,getOuter:e,aggregate:f,max:function(a,b,c){var d=f(a,c);return b>d?b-d:0}}}function g(a){var b=function(b){return a(b).isRtl()?Xi.rtl:Xi.ltr},c=function(a,c){return b(c).delta(a,c)},d=function(a,c){return b(c).positions(a,c)};return{delta:c,edge:function(a){return b(a).edge(a)},positions:d}}function h(a,b,c){var d=c||!1,e=function(){b(),d=!0},f=function(){a(),d=!1};return{on:e,off:f,toggle:function(){(d?f:e)()},isOn:function(){return d}}}function i(a,b,c,d){function e(a,b,c){c&&g.setAttrib(a,b,c)}function f(a,b,c){c&&g.setStyle(a,b,c)}var g=a.dom;po.updateStyleField(a,d);var h=d.control.rootControl.toJSON();a.undoManager.transact(function(){eo.each(b,function(b){e(b,"scope",h.scope),e(b,"style",h.style),e(b,"class",h.class),f(b,"height",un(h.height)),h.type!==b.parentNode.nodeName.toLowerCase()&&wo(a.dom,b,h.type),h.align!==c.align&&(ko.unApplyAlign(a,b),ko.applyAlign(a,b,h.align))}),a.focus()})}function j(a,b,c,d){if("TD"===b.tagName||"TH"===b.tagName)a.setStyle(b,c,d);else if(b.children)for(var e=0;e<b.children.length;e++)j(a,b.children[e],c,d)}function k(a){var b=Sa.immutable.apply(null,a),c=[];return{bind:function(a){if(void 0===a)throw"Event bind error: undefined handler";c.push(a)},unbind:function(a){c=Aa.filter(c,function(b){return b!==a})},trigger:function(){var a=b.apply(null,arguments);Aa.each(c,function(b){b(a)})}}}function l(a){var b=Lj.merge({layerClass:ip.resolve("blocker")},a),c=kb.fromTag("div");return Gd.set(c,"role","presentation"),
Ze.setAll(c,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Ok.add(c,ip.resolve("blocker")),Ok.add(c,b.layerClass),{element:function(){return c},destroy:function(){of.remove(c)}}}function m(){var a=T.none(),b=function(){a=T.none()},c=function(b,c){var d=a.map(function(a){return b.compare(a,c)});return a=T.some(c),d},d=function(a,b){b.extract(a).each(function(a){c(b,a).each(function(a){e.trigger.move(a)})})},e=cp.create({move:k(["info"])});return{onEvent:d,reset:b,events:e.registry}}function n(a){return{onEvent:function(a,b){},reset:M.noop}}function o(){var a=n(),b=m(),c=a,d=function(){c.reset(),c=b},e=function(){c.reset(),c=a},f=function(a,b){c.onEvent(a,b)};return{on:d,off:e,isOn:function(){return c===b},onEvent:f,events:b.events}}function p(){var a=cp.create({drag:k(["xDelta","yDelta"])});return{mutate:function(b,c){a.trigger.drag(b,c)},events:a.registry}}function q(){var a=cp.create({drag:k(["xDelta","yDelta","target"])}),b=T.none(),c=p();return c.events.drag.bind(function(c){b.each(function(b){a.trigger.drag(c.xDelta(),c.yDelta(),b)})}),{assign:function(a){b=T.some(a)},get:function(){return b},mutate:c.mutate,events:a.registry}}function r(a,b,c){var d=q(),e=Gp.transform(d,{}),f=T.none(),g=function(a,b){return T.from(Gd.get(a,b))};d.events.drag.bind(function(a){g(a.target(),"data-row").each(function(b){var c=hm.getInt(a.target(),"top");Ze.set(a.target(),"top",c+a.yDelta()+"px")}),g(a.target(),"data-column").each(function(b){var c=hm.getInt(a.target(),"left");Ze.set(a.target(),"left",c+a.xDelta()+"px")})});var h=function(a,b){return hm.getInt(a,b)-parseInt(Gd.get(a,"data-initial-"+b),10)};e.events.stop.bind(function(){d.get().each(function(d){f.each(function(e){g(d,"data-row").each(function(a){var b=h(d,"top");Gd.remove(d,"data-initial-top"),p.trigger.adjustHeight(e,b,parseInt(a,10))}),g(d,"data-column").each(function(a){var b=h(d,"left");Gd.remove(d,"data-initial-left"),p.trigger.adjustWidth(e,b,parseInt(a,10))}),bl.refresh(a,e,c,b)})})});var i=function(b,c){p.trigger.startAdjust(),d.assign(b),Gd.set(b,"data-initial-"+c,parseInt(Ze.get(b,c),10)),Ok.add(b,Op),Ze.set(b,"opacity","0.2"),e.go(a.parent())},j=tp.bind(a.parent(),"mousedown",function(a){bl.isRowBar(a.target())&&i(a.target(),"top"),bl.isColBar(a.target())&&i(a.target(),"left")}),l=function(b){return Qc.eq(b,a.view())},m=tp.bind(a.view(),"mouseover",function(d){"table"===vd.name(d.target())||Np.closest(d.target(),"table",l)?(f="table"===vd.name(d.target())?T.some(d.target()):ie.ancestor(d.target(),"table",l),f.each(function(d){bl.refresh(a,d,c,b)})):Kd.inBody(d.target())&&bl.destroy(a)}),n=function(){j.unbind(),m.unbind(),e.destroy(),bl.destroy(a)},o=function(d){bl.refresh(a,d,c,b)},p=cp.create({adjustHeight:k(["table","delta","row"]),adjustWidth:k(["table","delta","column"]),startAdjust:k([])});return{destroy:n,refresh:o,on:e.on,off:e.off,hideBars:M.curry(bl.hide,a),showBars:M.curry(bl.show,a),events:p.registry}}function s(a,b){var c=Wi.height,d=r(a,b,c),e=cp.create({beforeResize:k(["table"]),afterResize:k(["table"]),startDrag:k([])});return d.events.adjustHeight.bind(function(a){e.trigger.beforeResize(a.table());var b=c.delta(a.delta(),a.table());Km.adjustHeight(a.table(),b,a.row(),c),e.trigger.afterResize(a.table())}),d.events.startAdjust.bind(function(a){e.trigger.startDrag()}),d.events.adjustWidth.bind(function(a){e.trigger.beforeResize(a.table());var c=b.delta(a.delta(),a.table());Km.adjustWidth(a.table(),c,a.column(),b),e.trigger.afterResize(a.table())}),{on:d.on,off:d.off,hideBars:d.hideBars,showBars:d.showBars,destroy:d.destroy,events:e.registry}}function t(a){var b=function(b,c){return kb.fromPoint(kb.fromDom(a.document),b,c)},c=function(a){return a.dom().getBoundingClientRect()},d=function(b,c,d,e){var f=lq.exact(b,c,d,e);return Or.getFirstRect(a,f).map(function(a){return Ka.map(a,M.apply)})},e=function(){return Or.get(a).map(function(b){return fs.convertToRange(a,b)})},f=function(b){var c=lq.relative(b.start(),b.finish());return fs.convertToRange(a,c)},g=function(b,c){return Or.getAtPoint(a,b,c).map(function(a){return{start:M.constant(fq.on(a.start(),a.soffset())),finish:M.constant(fq.on(a.finish(),a.foffset()))}})},h=function(){Or.clear(a)},i=function(b){Or.setToElement(a,b)};return{elementFromPoint:b,getRect:c,getRangedRect:d,getSelection:e,fromSitus:f,situsFromPoint:g,clearSelection:h,setSelection:function(b){Or.setExact(a,b.start(),b.soffset(),b.finish(),b.foffset())},setRelativeSelection:function(b,c){Or.setRelative(a,b,c)},selectContents:i,getInnerHeight:function(){return a.innerHeight},getScrollY:function(){return qs.get(kb.fromDom(a.document)).top()},scrollBy:function(b,c){qs.by(b,c,kb.fromDom(a.document))}}}function u(a,b,c,d){var e=T.none(),f=function(){e=T.none()};return{mousedown:function(a){d.clear(b),e=Au(a.target(),c)},mouseover:function(f){e.each(function(e){d.clear(b),Au(f.target(),c).each(function(f){ih.identify(e,f,c).each(function(c){var g=c.boxes().getOr([]);(g.length>1||1===g.length&&!Qc.eq(e,f))&&(d.selectRange(b,g,c.start(),c.finish()),a.selectContents(f))})})})},mouseup:function(){e.each(f)}}}function v(a,b){var c=Sa.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),d=T.none(),e=Vu.byAttr(nh);a.on("init",function(f){var g=a.getWin(),h=pn(a),i=sn(a),j=function(){var b=a.selection,c=kb.fromDom(b.getStart()),d=kb.fromDom(b.getEnd());Jg.sharedOne(we.table,[c,d]).fold(function(){e.clear(h)},M.noop)},k=Fu.mouse(g,h,i,e),l=Fu.keyboard(g,h,i,e),m=function(a){return!0===a.raw().shiftKey},n=function(b,c){m(b)&&(c.kill()&&b.kill(),c.selection().each(function(b){var c=lq.relative(b.start(),b.finish()),d=Oq.asLtrRange(g,c);a.selection.setRng(d)}))},o=function(b){var c=r(b);if(c.raw().shiftKey&&cs.isNavigation(c.raw().which)){var d=a.selection.getRng(),e=kb.fromDom(d.startContainer),f=kb.fromDom(d.endContainer);l.keyup(c,e,d.startOffset,f,d.endOffset).each(function(a){n(c,a)})}},p=function(c){var d=r(c);b().each(function(a){a.hideBars()});var e=a.selection.getRng(),f=kb.fromDom(a.selection.getStart()),g=kb.fromDom(e.startContainer),h=kb.fromDom(e.endContainer),i=Cn.directionAt(f).isRtl()?cs.rtl:cs.ltr;l.keydown(d,g,e.startOffset,h,e.endOffset,i).each(function(a){n(d,a)}),b().each(function(a){a.showBars()})},q=function(a){return a.hasOwnProperty("x")&&a.hasOwnProperty("y")},r=function(a){var b=kb.fromDom(a.target),c=function(){a.stopPropagation()},d=function(){a.preventDefault()},e=M.compose(d,c);return{target:M.constant(b),x:M.constant(q(a)?a.x:null),y:M.constant(q(a)?a.y:null),stop:c,prevent:d,kill:e,raw:M.constant(a)}},s=function(a){return 0===a.button},t=function(a){return void 0===a.buttons||0!=(1&a.buttons)},u=function(a){s(a)&&Wu(a)&&k.mousedown(r(a))},v=function(a){t(a)&&Wu(a)&&k.mouseover(r(a))},w=function(a){s(a)&&Wu(a)&&k.mouseup(r(a))};a.on("mousedown",u),a.on("mouseover",v),a.on("mouseup",w),a.on("keyup",o),a.on("keydown",p),a.on("nodechange",j),d=T.some(c({mousedown:u,mouseover:v,mouseup:w,keyup:o,keydown:p}))});var f=function(){d.each(function(a){})};return{clear:e.clear,destroy:f}}function w(a){var b=Tp(a),c=v(a,b.lazyResize),d=ao(a,b.lazyWire),e=Xu(a),f=$i(T.none());return Yo.registerCommands(a,d,c,e,f),Gh.registerEvents(a,e,d,c),bv.addMenuItems(a,e),_u.addButtons(a),_u.addToolbars(a),a.on("PreInit",function(){a.serializer.addTempAttr(nh.firstSelected()),a.serializer.addTempAttr(nh.lastSelected())}),Jn(a)&&a.on("keydown",function(c){Xr.handle(c,a,d,b.lazyWire)}),a.on("remove",function(){b.destroy(),c.destroy()}),ev(a,f)}function x(){}var y=tinymce.util.Tools.resolve("tinymce.PluginManager"),z=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},A=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},B=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},C=function(a){return function(){return a}},D=function(a){return a},E=function(a,b){return a===b},F=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},G=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},H=function(a){return function(){throw new Error(a)}},I=function(a){return a()},J=function(a){a()},K=C(!1),L=C(!0),M={noop:z,noarg:A,compose:B,constant:C,identity:D,tripleEquals:E,curry:F,not:G,die:H,apply:I,call:J,never:K,always:L},N=M.never,O=M.always,P=function(){return Q},Q=function(){var a=function(a){return a.isNone()},b=function(a){return a()},c=function(a){return a},d=function(){},e={fold:function(a,b){return a()},is:N,isSome:N,isNone:O,getOr:c,getOrThunk:b,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:c,orThunk:b,map:P,ap:P,each:d,bind:P,flatten:P,exists:N,forall:O,filter:P,equals:a,equals_:a,toArray:function(){return[]},toString:M.constant("none()")};return Object.freeze&&Object.freeze(e),e}(),R=function(a){var b=function(){return a},c=function(){return f},d=function(b){return R(b(a))},e=function(b){return b(a)},f={fold:function(b,c){return c(a)},is:function(b){return a===b},isSome:O,isNone:N,getOr:b,getOrThunk:b,getOrDie:b,or:c,orThunk:c,map:d,ap:function(b){return b.fold(P,function(b){return R(b(a))})},each:function(b){b(a)},bind:e,flatten:b,exists:e,forall:e,filter:function(b){return b(a)?f:Q},equals:function(b){return b.is(a)},equals_:function(b,c){return b.fold(N,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return f},S=function(a){return null===a||void 0===a?Q:R(a)},T={some:R,none:P,from:S},U=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&Array.prototype.isPrototypeOf(a)?"array":"object"===b&&String.prototype.isPrototypeOf(a)?"string":b},V=function(a){return function(b){return U(b)===a}},W={isString:V("string"),isObject:V("object"),isArray:V("array"),isNull:V("null"),isBoolean:V("boolean"),isUndefined:V("undefined"),isFunction:V("function"),isNumber:V("number")},X=function(){var a=Array.prototype.indexOf,b=function(b,c){return a.call(b,c)},c=function(a,b){return la(a,b)};return void 0===a?c:b}(),Y=function(a,b){var c=X(a,b);return-1===c?T.none():T.some(c)},Z=function(a,b){return X(a,b)>-1},$=function(a,b){return ka(a,b).isSome()},_=function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},aa=function(a,b){for(var c=[],d=0;d<a.length;d+=b){var e=a.slice(d,d+b);c.push(e)}return c},ba=function(a,b){for(var c=a.length,d=new Array(c),e=0;e<c;e++){var f=a[e];d[e]=b(f,e,a)}return d},ca=function(a,b){for(var c=0,d=a.length;c<d;c++){b(a[c],c,a)}},da=function(a,b){for(var c=a.length-1;c>=0;c--){b(a[c],c,a)}},ea=function(a,b){for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];(b(g,e,a)?c:d).push(g)}return{pass:c,fail:d}},fa=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d];b(f,d,a)&&c.push(f)}return c},ga=function(a,b){if(0===a.length)return[];for(var c=b(a[0]),d=[],e=[],f=0,g=a.length;f<g;f++){var h=a[f],i=b(h);i!==c&&(d.push(e),e=[]),c=i,e.push(h)}return 0!==e.length&&d.push(e),d},ha=function(a,b,c){return da(a,function(a){c=b(c,a)}),c},ia=function(a,b,c){return ca(a,function(a){c=b(c,a)}),c},ja=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e,c,a))return T.some(e)}return T.none()},ka=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b(a[c],c,a))return T.some(c)}return T.none()},la=function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1},ma=Array.prototype.push,na=function(a){for(var b=[],c=0,d=a.length;c<d;++c){if(!Array.prototype.isPrototypeOf(a[c]))throw new Error("Arr.flatten item "+c+" was not an array, input: "+a);ma.apply(b,a[c])}return b},oa=function(a,b){var c=ba(a,b);return na(c)},pa=function(a,b){for(var c=0,d=a.length;c<d;++c){if(!0!==b(a[c],c,a))return!1}return!0},qa=function(a,b){return a.length===b.length&&pa(a,function(a,c){return a===b[c]})},ra=Array.prototype.slice,sa=function(a){var b=ra.call(a,0);return b.reverse(),b},ta=function(a,b){return fa(a,function(a){return!Z(b,a)})},ua=function(a,b){for(var c={},d=0,e=a.length;d<e;d++){var f=a[d];c[String(f)]=b(f,d)}return c},va=function(a){return[a]},wa=function(a,b){var c=ra.call(a,0);return c.sort(b),c},xa=function(a){return 0===a.length?T.none():T.some(a[0])},ya=function(a){return 0===a.length?T.none():T.some(a[a.length-1])},za=W.isFunction(Array.from)?Array.from:function(a){return ra.call(a)},Aa={map:ba,each:ca,eachr:da,partition:ea,filter:fa,groupBy:ga,indexOf:Y,foldr:ha,foldl:ia,find:ja,findIndex:ka,flatten:na,bind:oa,forall:pa,exists:$,contains:Z,equal:qa,reverse:sa,chunk:aa,difference:ta,mapToObject:ua,pure:va,sort:wa,range:_,head:xa,last:ya,from:za},Ba=function(){var a=Object.keys,b=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};return void 0===a?b:a}(),Ca=function(a,b){for(var c=Ba(a),d=0,e=c.length;d<e;d++){var f=c[d];b(a[f],f,a)}},Da=function(a,b){return Ea(a,function(a,c,d){return{k:c,v:b(a,c,d)}})},Ea=function(a,b){var c={};return Ca(a,function(d,e){var f=b(d,e,a);c[f.k]=f.v}),c},Fa=function(a,b){var c={},d={};return Ca(a,function(a,e){(b(a,e)?c:d)[e]=a}),{t:c,f:d}},Ga=function(a,b){var c=[];return Ca(a,function(a,d){c.push(b(a,d))}),c},Ha=function(a,b){for(var c=Ba(a),d=0,e=c.length;d<e;d++){var f=c[d],g=a[f];if(b(g,f,a))return T.some(g)}return T.none()},Ia=function(a){return Ga(a,function(a){return a})},Ja=function(a){return Ia(a).length},Ka={bifilter:Fa,each:Ca,map:Da,mapToArray:Ga,tupleMap:Ea,find:Ha,keys:Ba,values:Ia,size:Ja},La=function(a){return a.slice(0).sort()},Ma=function(a,b){throw new Error("All required keys ("+La(a).join(", ")+") were not specified. Specified keys were: "+La(b).join(", ")+".")},Na=function(a){throw new Error("Unsupported keys for object: "+La(a).join(", "))},Oa=function(a,b){if(!W.isArray(b))throw new Error("The "+a+" fields must be an array. Was: "+b+".");Aa.each(b,function(b){if(!W.isString(b))throw new Error("The value "+b+" in the "+a+" fields was not a string.")})},Pa=function(a,b){throw new Error("All values need to be of type: "+b+". Keys ("+La(a).join(", ")+") were not.")},Qa=function(a){var b=La(a);Aa.find(b,function(a,c){return c<b.length-1&&a===b[c+1]}).each(function(a){throw new Error("The field: "+a+" occurs more than once in the combined fields: ["+b.join(", ")+"].")})},Ra={sort:La,reqMessage:Ma,unsuppMessage:Na,validateStrArr:Oa,invalidTypeMessage:Pa,checkDupes:Qa},Sa={immutable:a,immutableBag:b},Ta=Sa.immutable("width","height"),Ua=Sa.immutable("rows","columns"),Va=Sa.immutable("row","column"),Wa=Sa.immutable("x","y"),Xa=Sa.immutable("element","rowspan","colspan"),Ya=Sa.immutable("element","rowspan","colspan","isNew"),Za=Sa.immutable("element","rowspan","colspan","row","column"),$a=Sa.immutable("element","cells","section"),_a=Sa.immutable("element","isNew"),ab=Sa.immutable("element","cells","section","isNew"),bb=Sa.immutable("cells","section"),cb=Sa.immutable("details","section"),db=Sa.immutable("startRow","startCol","finishRow","finishCol"),eb={dimensions:Ta,grid:Ua,address:Va,coords:Wa,extended:Za,detail:Xa,detailnew:Ya,rowdata:$a,elementnew:_a,rowdatanew:ab,rowcells:bb,rowdetails:cb,bounds:db},fb=function(a,b){var c=b||document,d=c.createElement("div");if(d.innerHTML=a,!d.hasChildNodes()||d.childNodes.length>1)throw console.error("HTML does not have a single root node",a),"HTML must have a single root node";return ib(d.childNodes[0])},gb=function(a,b){var c=b||document,d=c.createElement(a);return ib(d)},hb=function(a,b){var c=b||document,d=c.createTextNode(a);return ib(d)},ib=function(a){if(null===a||void 0===a)throw new Error("Node cannot be null or undefined");return{dom:M.constant(a)}},jb=function(a,b,c){return T.from(a.dom().elementFromPoint(b,c)).map(ib)},kb={fromHtml:fb,fromTag:gb,fromText:hb,fromDom:ib,fromPoint:jb},lb={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},mb=lb.ELEMENT,nb=lb.DOCUMENT,ob=function(a,b){var c=a.dom();if(c.nodeType!==mb)return!1;if(void 0!==c.matches)return c.matches(b);if(void 0!==c.msMatchesSelector)return c.msMatchesSelector(b);if(void 0!==c.webkitMatchesSelector)return c.webkitMatchesSelector(b);if(void 0!==c.mozMatchesSelector)return c.mozMatchesSelector(b);throw new Error("Browser lacks native selectors")},pb=function(a){return a.nodeType!==mb&&a.nodeType!==nb||0===a.childElementCount},qb=function(a,b){var c=void 0===b?document:b.dom();return pb(c)?[]:Aa.map(c.querySelectorAll(a),kb.fromDom)},rb=function(a,b){var c=void 0===b?document:b.dom();return pb(c)?T.none():T.from(c.querySelector(a)).map(kb.fromDom)},sb={all:qb,is:ob,one:rb},tb=function(a,b){var c=[],d=function(a){return c.push(a),b(a)},e=b(a);do{e=e.bind(d)}while(e.isSome());return c},ub={toArray:tb},vb="undefined"!=typeof window?window:Function("return this;")(),wb=function(a,b){for(var c=void 0!==b&&null!==b?b:vb,d=0;d<a.length&&void 0!==c&&null!==c;++d)c=c[a[d]];return c},xb=function(a,b){var c=a.split(".");return wb(c,b)},yb=function(a,b){return void 0!==a[b]&&null!==a[b]||(a[b]={}),a[b]},zb=function(a,b){for(var c=void 0!==b?b:vb,d=0;d<a.length;++d)c=yb(c,a[d]);return c},Ab=function(a,b){var c=a.split(".");return zb(c,b)},Bb={path:wb,resolve:xb,forge:zb,namespace:Ab},Cb=function(a,b){return Bb.resolve(a,b)},Db=function(a,b){var c=Cb(a,b);if(void 0===c||null===c)throw a+" not available on this browser";return c},Eb={getOrDie:Db},Fb=function(){return Eb.getOrDie("Node")},Gb=function(a,b,c){return 0!=(a.compareDocumentPosition(b)&c)},Hb=function(a,b){return Gb(a,b,Fb().DOCUMENT_POSITION_PRECEDING)},Ib=function(a,b){return Gb(a,b,Fb().DOCUMENT_POSITION_CONTAINED_BY)},Jb={documentPositionPreceding:Hb,documentPositionContainedBy:Ib},Kb=function(a){var b,c=!1;return function(){return c||(c=!0,b=a.apply(null,arguments)),b}},Lb={cached:Kb},Mb=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.test(b))return d}},Nb=function(a,b){var c=Mb(a,b);if(!c)return{major:0,minor:0};var d=function(a){return Number(b.replace(c,"$"+a))};return Qb(d(1),d(2))},Ob=function(a,b){var c=String(b).toLowerCase();return 0===a.length?Pb():Nb(a,c)},Pb=function(){return Qb(0,0)},Qb=function(a,b){return{major:a,minor:b}},Rb={nu:Qb,detect:Ob,unknown:Pb},Sb=function(a,b){return function(){return b===a}},Tb=function(){return Ub({current:void 0,version:Rb.unknown()})},Ub=function(a){var b=a.current;return{current:b,version:a.version,isEdge:Sb("Edge",b),isChrome:Sb("Chrome",b),isIE:Sb("IE",b),isOpera:Sb("Opera",b),isFirefox:Sb("Firefox",b),isSafari:Sb("Safari",b)}},Vb={unknown:Tb,nu:Ub,edge:M.constant("Edge"),chrome:M.constant("Chrome"),ie:M.constant("IE"),opera:M.constant("Opera"),firefox:M.constant("Firefox"),safari:M.constant("Safari")},Wb=function(a,b){return function(){return b===a}},Xb=function(){return Yb({current:void 0,version:Rb.unknown()})},Yb=function(a){var b=a.current;return{current:b,version:a.version,isWindows:Wb("Windows",b),isiOS:Wb("iOS",b),isAndroid:Wb("Android",b),isOSX:Wb("OSX",b),isLinux:Wb("Linux",b),isSolaris:Wb("Solaris",b),isFreeBSD:Wb("FreeBSD",b)}},Zb={unknown:Xb,nu:Yb,windows:M.constant("Windows"),ios:M.constant("iOS"),android:M.constant("Android"),linux:M.constant("Linux"),osx:M.constant("OSX"),solaris:M.constant("Solaris"),freebsd:M.constant("FreeBSD")},$b=function(a,b){var c=String(b).toLowerCase();return Aa.find(a,function(a){return a.search(c)})},_b=function(a,b){return $b(a,b).map(function(a){var c=Rb.detect(a.versionRegexes,b);return{current:a.name,version:c}})},ac=function(a,b){return $b(a,b).map(function(a){var c=Rb.detect(a.versionRegexes,b);return{current:a.name,version:c}})},bc={detectBrowser:_b,detectOs:ac},cc=function(a,b){return b+a},dc=function(a,b){return a+b},ec=function(a,b){return a.substring(b)},fc=function(a,b){return a.substring(0,a.length-b)},gc={addToStart:cc,addToEnd:dc,removeFromStart:ec,removeFromEnd:fc},hc=function(a,b){return a.substr(0,b)},ic=function(a,b){return a.substr(a.length-b,a.length)},jc=function(a){return""===a?T.none():T.some(a.substr(0,1))},kc=function(a){return""===a?T.none():T.some(a.substring(1))},lc={first:hc,last:ic,head:jc,tail:kc},mc=function(a,b,c){return""===b||!(a.length<b.length)&&a.substr(c,c+b.length)===b},nc=function(a,b){var c=function(a){var b=typeof a;return"string"===b||"number"===b};return a.replace(/\${([^{}]*)}/g,function(a,d){var e=b[d];return c(e)?e:a})},oc=function(a,b){return uc(a,b)?gc.removeFromStart(a,b.length):a},pc=function(a,b){return vc(a,b)?gc.removeFromEnd(a,b.length):a},qc=function(a,b){return uc(a,b)?a:gc.addToStart(a,b)},rc=function(a,b){return vc(a,b)?a:gc.addToEnd(a,b)},sc=function(a,b){return-1!==a.indexOf(b)},tc=function(a){return lc.head(a).bind(function(b){return lc.tail(a).map(function(a){return b.toUpperCase()+a})}).getOr(a)},uc=function(a,b){return mc(a,b,0)},vc=function(a,b){return mc(a,b,a.length-b.length)},wc=function(a){return a.replace(/^\s+|\s+$/g,"")},xc=function(a){return a.replace(/^\s+/g,"")},yc=function(a){return a.replace(/\s+$/g,"")},zc={supplant:nc,startsWith:uc,removeLeading:oc,removeTrailing:pc,ensureLeading:qc,ensureTrailing:rc,endsWith:vc,contains:sc,trim:wc,lTrim:xc,rTrim:yc,capitalize:tc},Ac=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Bc=function(a){return function(b){return zc.contains(b,a)}},Cc=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return zc.contains(a,"edge/")&&zc.contains(a,"chrome")&&zc.contains(a,"safari")&&zc.contains(a,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ac],search:function(a){return zc.contains(a,"chrome")&&!zc.contains(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return zc.contains(a,"msie")||zc.contains(a,"trident")}},{name:"Opera",versionRegexes:[Ac,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Bc("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Bc("firefox")},{name:"Safari",versionRegexes:[Ac,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(zc.contains(a,"safari")||zc.contains(a,"mobile/"))&&zc.contains(a,"applewebkit")}}],Dc=[{name:"Windows",search:Bc("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return zc.contains(a,"iphone")||zc.contains(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Bc("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Bc("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Bc("linux"),versionRegexes:[]},{name:"Solaris",search:Bc("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Bc("freebsd"),versionRegexes:[]}],Ec={browsers:M.constant(Cc),oses:M.constant(Dc)},Fc=function(a){var b=Ec.browsers(),d=Ec.oses(),e=bc.detectBrowser(b,a).fold(Vb.unknown,Vb.nu),f=bc.detectOs(d,a).fold(Zb.unknown,Zb.nu);return{browser:e,os:f,deviceType:c(f,e,a)}},Gc={detect:Fc},Hc=Lb.cached(function(){var a=navigator.userAgent;return Gc.detect(a)}),Ic={detect:Hc},Jc=function(a,b){return a.dom()===b.dom()},Kc=function(a,b){return a.dom().isEqualNode(b.dom())},Lc=function(a,b){return Aa.exists(b,M.curry(Jc,a))},Mc=function(a,b){var c=a.dom(),d=b.dom();return c!==d&&c.contains(d)},Nc=function(a,b){return Jb.documentPositionContainedBy(a.dom(),b.dom())},Oc=Ic.detect().browser,Pc=Oc.isIE()?Nc:Mc,Qc={eq:Jc,isEqualNode:Kc,member:Lc,contains:Pc,is:sb.is},Rc=function(a){return kb.fromDom(a.dom().ownerDocument)},Sc=function(a){var b=Rc(a);return kb.fromDom(b.dom().documentElement)},Tc=function(a){var b=a.dom(),c=b.ownerDocument.defaultView;return kb.fromDom(c)},Uc=function(a){var b=a.dom();return T.from(b.parentNode).map(kb.fromDom)},Vc=function(a){return Uc(a).bind(function(b){var c=bd(b);return Aa.findIndex(c,function(b){return Qc.eq(a,b)})})},Wc=function(a,b){for(var c=W.isFunction(b)?b:M.constant(!1),d=a.dom(),e=[];null!==d.parentNode&&void 0!==d.parentNode;){var f=d.parentNode,g=kb.fromDom(f);if(e.push(g),!0===c(g))break;d=f}return e},Xc=function(a){var b=function(b){return Aa.filter(b,function(b){return!Qc.eq(a,b)})};return Uc(a).map(bd).map(b).getOr([])},Yc=function(a){var b=a.dom();return T.from(b.offsetParent).map(kb.fromDom)},Zc=function(a){var b=a.dom();return T.from(b.previousSibling).map(kb.fromDom)},$c=function(a){var b=a.dom();return T.from(b.nextSibling).map(kb.fromDom)},_c=function(a){return Aa.reverse(ub.toArray(a,Zc))},ad=function(a){return ub.toArray(a,$c)},bd=function(a){var b=a.dom();return Aa.map(b.childNodes,kb.fromDom)},cd=function(a,b){var c=a.dom().childNodes;return T.from(c[b]).map(kb.fromDom)},dd=function(a){return cd(a,0)},ed=function(a){return cd(a,a.dom().childNodes.length-1)},fd=function(a){return a.dom().childNodes.length},gd=function(a){return a.dom().hasChildNodes()},hd=Sa.immutable("element","offset"),id=function(a,b){var c=bd(a);return c.length>0&&b<c.length?hd(c[b],0):hd(a,b)},jd={owner:Rc,defaultView:Tc,documentElement:Sc,parent:Uc,findIndex:Vc,parents:Wc,siblings:Xc,prevSibling:Zc,offsetParent:Yc,prevSiblings:_c,nextSibling:$c,nextSiblings:ad,children:bd,child:cd,firstChild:dd,lastChild:ed,childNodesCount:fd,hasChildNodes:gd,leaf:id},kd=function(a,b){return ld(a,b,M.constant(!0))},ld=function(a,b,c){return Aa.bind(jd.children(a),function(a){return sb.is(a,b)?c(a)?[a]:[]:ld(a,b,c)})},md={firstLayer:kd,filterFirstLayer:ld},nd=function(a){return a.dom().nodeName.toLowerCase()},od=function(a){return a.dom().nodeType},pd=function(a){return a.dom().nodeValue},qd=function(a){return function(b){return od(b)===a}},rd=function(a){return od(a)===lb.COMMENT||"#comment"===nd(a)},sd=qd(lb.ELEMENT),td=qd(lb.TEXT),ud=qd(lb.DOCUMENT),vd={name:nd,type:od,value:pd,isElement:sd,isText:td,isDocument:ud,isComment:rd},wd=function(a,b,c){if(!(W.isString(c)||W.isBoolean(c)||W.isNumber(c)))throw console.error("Invalid call to Attr.set. Key ",b,":: Value ",c,":: Element ",a),new Error("Attribute value was not simple");a.setAttribute(b,c+"")},xd=function(a,b,c){wd(a.dom(),b,c)},yd=function(a,b){var c=a.dom();Ka.each(b,function(a,b){wd(c,b,a)})},zd=function(a,b){var c=a.dom().getAttribute(b);return null===c?void 0:c},Ad=function(a,b){var c=a.dom();return!(!c||!c.hasAttribute)&&c.hasAttribute(b)},Bd=function(a,b){a.dom().removeAttribute(b)},Cd=function(a){var b=a.dom().attributes;return void 0===b||null===b||0===b.length},Dd=function(a){return Aa.foldl(a.dom().attributes,function(a,b){return a[b.name]=b.value,a},{})},Ed=function(a,b,c){Ad(a,c)&&!Ad(b,c)&&xd(b,c,zd(a,c))},Fd=function(a,b,c){vd.isElement(a)&&vd.isElement(b)&&Aa.each(c,function(c){Ed(a,b,c)})},Gd={clone:Dd,set:xd,setAll:yd,get:zd,has:Ad,remove:Bd,hasNone:Cd,transfer:Fd},Hd=function(a){var b=vd.isText(a)?a.dom().parentNode:a.dom();return void 0!==b&&null!==b&&b.ownerDocument.body.contains(b)},Id=Lb.cached(function(){return Jd(kb.fromDom(document))}),Jd=function(a){var b=a.dom().body;if(null===b||void 0===b)throw"Body is not available yet";return kb.fromDom(b)},Kd={body:Id,getBody:Jd,inBody:Hd},Ld=function(a){return Pd(Kd.body(),a)},Md=function(a,b,c){return Aa.filter(jd.parents(a,c),b)},Nd=function(a,b){return Aa.filter(jd.siblings(a),b)},Od=function(a,b){return Aa.filter(jd.children(a),b)},Pd=function(a,b){var c=[];return Aa.each(jd.children(a),function(a){b(a)&&(c=c.concat([a])),c=c.concat(Pd(a,b))}),c},Qd={all:Ld,ancestors:Md,siblings:Nd,children:Od,descendants:Pd},Rd=function(a){return sb.all(a)},Sd=function(a,b,c){return Qd.ancestors(a,function(a){return sb.is(a,b)},c)},Td=function(a,b){return Qd.siblings(a,function(a){return sb.is(a,b)})},Ud=function(a,b){return Qd.children(a,function(a){return sb.is(a,b)})},Vd=function(a,b){return sb.all(b,a)},Wd={all:Rd,ancestors:Sd,siblings:Td,children:Ud,descendants:Vd},Xd=function(a){return ae(Kd.body(),a)},Yd=function(a,b,c){for(var d=a.dom(),e=W.isFunction(c)?c:M.constant(!1);d.parentNode;){d=d.parentNode;var f=kb.fromDom(d);if(b(f))return T.some(f);if(e(f))break}return T.none()},Zd=function(a,b,c){return d(function(a){return b(a)},Yd,a,b,c)},$d=function(a,b){var c=a.dom();return c.parentNode?_d(kb.fromDom(c.parentNode),function(c){return!Qc.eq(a,c)&&b(c)}):T.none()},_d=function(a,b){return Aa.find(a.dom().childNodes,M.compose(b,kb.fromDom)).map(kb.fromDom)},ae=function(a,b){var c=function(a){for(var d=0;d<a.childNodes.length;d++){if(b(kb.fromDom(a.childNodes[d])))return T.some(kb.fromDom(a.childNodes[d]));var e=c(a.childNodes[d]);if(e.isSome())return e}return T.none()};return c(a.dom())},be={first:Xd,ancestor:Yd,closest:Zd,sibling:$d,child:_d,descendant:ae},ce=function(a){return sb.one(a)},de=function(a,b,c){return be.ancestor(a,function(a){return sb.is(a,b)},c)},ee=function(a,b){return be.sibling(a,function(a){return sb.is(a,b)})},fe=function(a,b){return be.child(a,function(a){return sb.is(a,b)})},ge=function(a,b){return sb.one(b,a)},he=function(a,b,c){return d(sb.is,de,a,b,c)},ie={first:ce,ancestor:de,sibling:ee,child:fe,descendant:ge,closest:he},je=function(a,b,c){var d=void 0!==c?c:M.constant(!1);if(d(b))return T.none();if(Aa.contains(a,vd.name(b)))return T.some(b);var e=function(a){return sb.is(a,"table")||d(a)};return ie.ancestor(b,a.join(","),e)},ke=function(a,b){return je(["td","th"],a,b)},le=function(a){return md.firstLayer(a,"th,td")},me=function(a,b){return je(["caption","tr","tbody","tfoot","thead"],a,b)},ne=function(a,b){return jd.parent(b).map(function(b){return Wd.children(b,a)})},oe=M.curry(ne,"th,td"),pe=M.curry(ne,"tr"),qe=function(a){return ie.descendant(a,"th,td")},re=function(a,b){return ie.closest(a,"table",b)},se=function(a,b){return je(["tr"],a,b)},te=function(a){return md.firstLayer(a,"tr")},ue=function(a,b){return parseInt(Gd.get(a,b),10)},ve=function(a,b,c){var d=ue(a,b),e=ue(a,c);return eb.grid(d,e)},we={cell:ke,firstCell:qe,cells:le,neighbourCells:oe,table:re,row:se,rows:te,notCell:me,neighbourRows:pe,attr:ue,grid:ve},xe=function(a){var b=we.rows(a);return Aa.map(b,function(a){var b=a,c=jd.parent(b),d=c.bind(function(a){var b=vd.name(a);return"tfoot"===b||"thead"===b||"tbody"===b?b:"tbody"}),e=Aa.map(we.cells(a),function(a){var b=Gd.has(a,"rowspan")?parseInt(Gd.get(a,"rowspan"),10):1,c=Gd.has(a,"colspan")?parseInt(Gd.get(a,"colspan"),10):1;return eb.detail(a,b,c)});return eb.rowdata(b,e,d)})},ye=function(a,b){return Aa.map(a,function(a){var c=Aa.map(we.cells(a),function(a){var b=Gd.has(a,"rowspan")?parseInt(Gd.get(a,"rowspan"),10):1,c=Gd.has(a,"colspan")?parseInt(Gd.get(a,"colspan"),10):1;return eb.detail(a,b,c)});return eb.rowdata(a,c,b.section())})},ze={fromTable:xe,fromPastedRows:ye},Ae=function(a,b){return a+","+b},Be=function(a,b,c){var d=a.access()[Ae(b,c)];return void 0!==d?T.some(d):T.none()},Ce=function(a,b,c){var d=De(a,function(a){return c(b,a.element())});return d.length>0?T.some(d[0]):T.none()},De=function(a,b){var c=Aa.bind(a.all(),function(a){return a.cells()});return Aa.filter(c,b)},Ee=function(a){var b={},c=[],d=a.length,e=0;Aa.each(a,function(a,d){var f=[];Aa.each(a.cells(),function(a,c){for(var g=0;void 0!==b[Ae(d,g)];)g++;for(var h=eb.extended(a.element(),a.rowspan(),a.colspan(),d,g),i=0;i<a.colspan();i++)for(var j=0;j<a.rowspan();j++){var k=d+j,l=g+i,m=Ae(k,l);b[m]=h,e=Math.max(e,l+1)}f.push(h)}),c.push(eb.rowdata(a.element(),f,a.section()))});var f=eb.grid(d,e);return{grid:M.constant(f),access:M.constant(b),all:M.constant(c)}},Fe=function(a){var b=Aa.map(a.all(),function(a){return a.cells()});return Aa.flatten(b)},Ge={generate:Ee,getAt:Be,findItem:Ce,filterItems:De,justCells:Fe},He=function(a){return void 0!==a.style},Ie={isSupported:He},Je=function(a,b,c){
if(!W.isString(c))throw console.error("Invalid call to CSS.set. Property ",b,":: Value ",c,":: Element ",a),new Error("CSS value must be a string: "+c);Ie.isSupported(a)&&a.style.setProperty(b,c)},Ke=function(a,b){Ie.isSupported(a)&&a.style.removeProperty(b)},Le=function(a,b,c){var d=a.dom();Je(d,b,c)},Me=function(a,b){var c=a.dom();Ka.each(b,function(a,b){Je(c,b,a)})},Ne=function(a,b){var c=a.dom();Ka.each(b,function(a,b){a.fold(function(){Ke(c,b)},function(a){Je(c,b,a)})})},Oe=function(a,b){var c=a.dom(),d=window.getComputedStyle(c),e=d.getPropertyValue(b),f=""!==e||Kd.inBody(a)?e:Pe(c,b);return null===f?void 0:f},Pe=function(a,b){return Ie.isSupported(a)?a.style.getPropertyValue(b):""},Qe=function(a,b){var c=a.dom(),d=Pe(c,b);return T.from(d).filter(function(a){return a.length>0})},Re=function(a){var b={},c=a.dom();if(Ie.isSupported(c))for(var d=0;d<c.style.length;d++){var e=c.style.item(d);b[e]=c.style[e]}return b},Se=function(a,b,c){var d=kb.fromTag(a);return Le(d,b,c),Qe(d,b).isSome()},Te=function(a,b){var c=a.dom();Ke(c,b),Gd.has(a,"style")&&""===zc.trim(Gd.get(a,"style"))&&Gd.remove(a,"style")},Ue=function(a,b){var c=Gd.get(a,"style"),d=b(a);return(void 0===c?Gd.remove:Gd.set)(a,"style",c),d},Ve=function(a,b){var c=a.dom(),d=b.dom();Ie.isSupported(c)&&Ie.isSupported(d)&&(d.style.cssText=c.style.cssText)},We=function(a){return a.dom().offsetWidth},Xe=function(a,b,c){Qe(a,c).each(function(a){Qe(b,c).isNone()&&Le(b,c,a)})},Ye=function(a,b,c){vd.isElement(a)&&vd.isElement(b)&&Aa.each(c,function(c){Xe(a,b,c)})},Ze={copy:Ve,set:Le,preserve:Ue,setAll:Me,setOptions:Ne,remove:Te,get:Oe,getRaw:Qe,getAllRaw:Re,isValidValue:Se,reflow:We,transfer:Ye},$e=function(a,b){jd.parent(a).each(function(c){c.dom().insertBefore(b.dom(),a.dom())})},_e=function(a,b){jd.nextSibling(a).fold(function(){jd.parent(a).each(function(a){bf(a,b)})},function(a){$e(a,b)})},af=function(a,b){jd.firstChild(a).fold(function(){bf(a,b)},function(c){a.dom().insertBefore(b.dom(),c.dom())})},bf=function(a,b){a.dom().appendChild(b.dom())},cf=function(a,b,c){jd.child(a,c).fold(function(){bf(a,b)},function(a){$e(a,b)})},df=function(a,b){$e(a,b),bf(b,a)},ef={before:$e,after:_e,prepend:af,append:bf,appendAt:cf,wrap:df},ff=function(a,b){Aa.each(b,function(b){ef.before(a,b)})},gf=function(a,b){Aa.each(b,function(c,d){var e=0===d?a:b[d-1];ef.after(e,c)})},hf=function(a,b){Aa.each(b.slice().reverse(),function(b){ef.prepend(a,b)})},jf=function(a,b){Aa.each(b,function(b){ef.append(a,b)})},kf={before:ff,after:gf,prepend:hf,append:jf},lf=function(a){a.dom().textContent="",Aa.each(jd.children(a),function(a){mf(a)})},mf=function(a){var b=a.dom();null!==b.parentNode&&b.parentNode.removeChild(b)},nf=function(a){var b=jd.children(a);b.length>0&&kf.before(a,b),mf(a)},of={empty:lf,remove:mf,unwrap:nf},pf=Sa.immutable("minRow","minCol","maxRow","maxCol"),qf=function(a,b){var c=a.grid().columns(),d=a.grid().rows(),e=d,f=c,g=0,h=0;return Ka.each(a.access(),function(a){if(b(a)){var c=a.row(),d=c+a.rowspan()-1,i=a.column(),j=i+a.colspan()-1;c<e?e=c:d>g&&(g=d),i<f?f=i:j>h&&(h=j)}}),pf(e,f,g,h)},rf=function(a,b,c){var d=a[c].element(),e=kb.fromTag("td");ef.append(e,kb.fromTag("br")),(b?ef.append:ef.prepend)(d,e)},sf=function(a,b,c,d){for(var e=b.grid().columns(),f=b.grid().rows(),g=0;g<f;g++)for(var h=!1,i=0;i<e;i++)if(!(g<c.minRow()||g>c.maxRow()||i<c.minCol()||i>c.maxCol())){var j=Ge.getAt(b,g,i).filter(d).isNone();j?rf(a,h,g):h=!0}},tf=function(a,b){var c=Aa.filter(md.firstLayer(a,"tr"),function(a){return 0===a.dom().childElementCount});Aa.each(c,of.remove),b.minCol()!==b.maxCol()&&b.minRow()!==b.maxRow()||Aa.each(md.firstLayer(a,"th,td"),function(a){Gd.remove(a,"rowspan"),Gd.remove(a,"colspan")}),Gd.remove(a,"width"),Gd.remove(a,"height"),Ze.remove(a,"width"),Ze.remove(a,"height")},uf=function(a,b){var c=function(a){return sb.is(a.element(),b)},d=ze.fromTable(a),e=Ge.generate(d),f=qf(e,c),g="th:not("+b+"),td:not("+b+")",h=md.filterFirstLayer(a,"th,td",function(a){return sb.is(a,g)});return Aa.each(h,of.remove),sf(d,e,f,c),tf(a,f),a},vf={extract:uf},wf=function(a,b){return kb.fromDom(a.dom().cloneNode(b))},xf=function(a){return wf(a,!1)},yf=function(a){return wf(a,!0)},zf=function(a,b){var c=kb.fromTag(b),d=Gd.clone(a);return Gd.setAll(c,d),c},Af=function(a,b){var c=zf(a,b),d=jd.children(yf(a));return kf.append(c,d),c},Bf=function(a,b){var c=zf(a,b);ef.before(a,c);var d=jd.children(a);return kf.append(c,d),of.remove(a),c},Cf={shallow:xf,shallowAs:zf,deep:yf,copy:Af,mutate:Bf},Df=function(a,b){var c=function(c){if(!a(c))throw new Error("Can only get "+b+" value of a "+b+" node");return g(c).getOr("")},d=function(a){try{return e(a)}catch(a){return T.none()}},e=function(b){return a(b)?T.from(b.dom().nodeValue):T.none()},f=Ic.detect().browser,g=f.isIE()&&10===f.version.major?d:e;return{get:c,getOption:g,set:function(c,d){if(!a(c))throw new Error("Can only set raw "+b+" value of a "+b+" node");c.dom().nodeValue=d}}}(vd.isText,"text"),Ef=function(a){return Df.get(a)},Ff=function(a){return Df.getOption(a)},Gf=function(a,b){Df.set(a,b)},Hf={get:Ef,getOption:Ff,set:Gf},If=function(a){return"img"===vd.name(a)?1:Hf.getOption(a).fold(function(){return jd.children(a).length},function(a){return a.length})},Jf=function(a,b){return If(a)===b},Kf=function(a,b){return 0===b},Lf=function(a){return Hf.getOption(a).filter(function(a){return 0!==a.trim().length||a.indexOf("")>-1}).isSome()},Mf=["img","br"],Nf=function(a){return Lf(a)||Aa.contains(Mf,vd.name(a))},Of={getEnd:If,isEnd:Jf,isStart:Kf,isCursorPosition:Nf},Pf=function(a){return be.descendant(a,Of.isCursorPosition)},Qf=function(a){return Rf(a,Of.isCursorPosition)},Rf=function(a,b){var c=function(a){for(var d=jd.children(a),e=d.length-1;e>=0;e--){var f=d[e];if(b(f))return T.some(f);var g=c(f);if(g.isSome())return g}return T.none()};return c(a)},Sf={first:Pf,last:Qf},Tf=function(){var a=kb.fromTag("td");return ef.append(a,kb.fromTag("br")),a},Uf=function(a,b,c){var d=Cf.copy(a,b);return Ka.each(c,function(a,b){null===a?Gd.remove(d,b):Gd.set(d,b,a)}),d},Vf=function(a){return a},Wf=function(a){return function(){return kb.fromTag("tr",a.dom())}},Xf=function(a,b,c){return Sf.first(a).map(function(d){var e=c.join(","),f=Wd.ancestors(d,e,function(b){return Qc.eq(b,a)});return Aa.foldr(f,function(a,b){var c=Cf.shallow(b);return ef.append(a,c),c},b)}).getOr(b)},Yf=function(a,b,c){var d=function(b){var d=jd.owner(b.element()),e=kb.fromTag(vd.name(b.element()),d.dom()),f=c.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),g=f.length>0?Xf(b.element(),e,f):e;return ef.append(g,kb.fromTag("br")),Ze.copy(b.element(),e),Ze.remove(e,"height"),1!==b.colspan()&&Ze.remove(b.element(),"width"),a(b.element(),e),e};return{row:Wf(b),cell:d,replace:Uf,gap:Tf}},Zf=function(a){return{row:Wf(a),cell:Tf,replace:Vf,gap:Tf}},$f={cellOperations:Yf,paste:Zf},_f=function(a,b){var c=b||document,d=c.createElement("div");return d.innerHTML=a,jd.children(kb.fromDom(d))},ag=function(a,b){return Aa.map(a,function(a){return kb.fromTag(a,b)})},bg=function(a,b){return Aa.map(a,function(a){return kb.fromText(a,b)})},cg=function(a){return Aa.map(a,kb.fromDom)},dg={fromHtml:_f,fromTags:ag,fromText:bg,fromDom:cg},eg=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],fg=Sa.immutable("left","right"),gg=function(a,b,c){var d=a.property().children(b);return Aa.findIndex(d,M.curry(a.eq,c)).map(function(a){return{before:M.constant(d.slice(0,a)),after:M.constant(d.slice(a+1))}})},hg=function(a,b,c){return gg(a,b,c).map(function(c){var d=a.create().clone(b);return a.insert().appendAll(d,c.after()),a.insert().after(b,d),fg(b,d)})},ig=function(a,b,c){return gg(a,b,c).map(function(d){var e=a.create().clone(b);return a.insert().appendAll(e,d.before().concat([c])),a.insert().appendAll(b,d.after()),a.insert().before(b,e),fg(e,b)})},jg=function(a,b,c,d){var e=Sa.immutable("first","second","splits"),f=function(b,g,h){var i=e(b,T.none(),h);return c(b)?e(b,g,h):a.property().parent(b).bind(function(e){return d(a,e,b).map(function(a){var b=[{first:a.left,second:a.right}],d=c(e)?e:a.left();return f(d,T.some(a.right()),h.concat(b))}).getOr(i)})};return f(b,T.none(),[])},kg={breakToLeft:ig,breakToRight:hg,breakPath:jg},lg=function(a,b,c,d){return d(a,b,c[0],c.slice(1))},mg=function(a,b,c){return c.length>0?lg(a,b,c,ng):T.none()},ng=function(a,b,c,d){var e=b(a,c);return Aa.foldr(d,function(c,d){var e=b(a,d);return og(a,c,e)},e)},og=function(a,b,c){return b.bind(function(b){return c.filter(M.curry(a.eq,b))})},pg={oneAll:mg},qg=function(a,b){return M.curry(a.eq,b)},rg=function(a,b,c,d){var e=a.property().children(b);if(a.eq(b,c[0]))return T.some([c[0]]);if(a.eq(b,d[0]))return T.some([d[0]]);var f=function(c){var d=Aa.reverse(c),f=Aa.findIndex(d,qg(a,b)).getOr(-1),g=f<d.length-1?d[f+1]:d[f];return Aa.findIndex(e,qg(a,g))},g=f(c),h=f(d);return g.bind(function(a){return h.map(function(b){var c=Math.min(a,b),d=Math.max(a,b);return e.slice(c,d+1)})})},sg=function(a,b,c,d){var e=void 0!==d?d:M.constant(!1),f=[b].concat(a.up().all(b)),g=[c].concat(a.up().all(c)),h=function(a){return Aa.findIndex(a,e).fold(function(){return a},function(b){return a.slice(0,b+1)})},i=h(f),j=h(g),k=Aa.find(i,function(b){return Aa.exists(j,qg(a,b))});return{firstpath:M.constant(i),secondpath:M.constant(j),shared:M.constant(k)}},tg=function(a,b,c){var d=sg(a,b,c);return d.shared().bind(function(b){return rg(a,b,d.firstpath(),d.secondpath())})},ug={subset:tg,ancestors:sg},vg=function(a,b,c){return pg.oneAll(a,b,c)},wg=function(a,b,c){return ug.subset(a,b,c)},xg=function(a,b,c,d){return ug.ancestors(a,b,c,d)},yg=function(a,b,c){return kg.breakToLeft(a,b,c)},zg=function(a,b,c){return kg.breakToRight(a,b,c)},Ag=function(a,b,c,d){return kg.breakPath(a,b,c,d)},Bg={sharedOne:vg,subset:wg,ancestors:xg,breakToLeft:yg,breakToRight:zg,breakPath:Ag},Cg=e(),Dg=function(a,b){return Bg.sharedOne(Cg,function(b,c){return a(c)},b)},Eg=function(a,b){return Bg.subset(Cg,a,b)},Fg=function(a,b,c){return Bg.ancestors(Cg,a,b,c)},Gg=function(a,b){return Bg.breakToLeft(Cg,a,b)},Hg=function(a,b){return Bg.breakToRight(Cg,a,b)},Ig=function(a,b,c){return Bg.breakPath(Cg,a,b,function(a,b,d){return c(b,d)})},Jg={sharedOne:Dg,subset:Eg,ancestors:Fg,breakToLeft:Gg,breakToRight:Hg,breakPath:Ig},Kg=function(a,b){var c=b.column(),d=b.column()+b.colspan()-1,e=b.row(),f=b.row()+b.rowspan()-1;return c<=a.finishCol()&&d>=a.startCol()&&e<=a.finishRow()&&f>=a.startRow()},Lg=function(a,b){return b.column()>=a.startCol()&&b.column()+b.colspan()-1<=a.finishCol()&&b.row()>=a.startRow()&&b.row()+b.rowspan()-1<=a.finishRow()},Mg=function(a,b){for(var c=!0,d=M.curry(Lg,b),e=b.startRow();e<=b.finishRow();e++)for(var f=b.startCol();f<=b.finishCol();f++)c=c&&Ge.getAt(a,e,f).exists(d);return c?T.some(b):T.none()},Ng={inSelection:Kg,isWithin:Lg,isRectangular:Mg},Og=function(a,b){return eb.bounds(Math.min(a.row(),b.row()),Math.min(a.column(),b.column()),Math.max(a.row()+a.rowspan()-1,b.row()+b.rowspan()-1),Math.max(a.column()+a.colspan()-1,b.column()+b.colspan()-1))},Pg=function(a,b,c){var d=Ge.findItem(a,b,Qc.eq),e=Ge.findItem(a,c,Qc.eq);return d.bind(function(a){return e.map(function(b){return Og(a,b)})})},Qg=function(a,b,c){return Pg(a,b,c).bind(function(b){return Ng.isRectangular(a,b)})},Rg={getAnyBox:Pg,getBox:Qg},Sg=function(a,b,c,d){return Ge.findItem(a,b,Qc.eq).bind(function(b){var e=c>0?b.row()+b.rowspan()-1:b.row(),f=d>0?b.column()+b.colspan()-1:b.column();return Ge.getAt(a,e+c,f+d).map(function(a){return a.element()})})},Tg=function(a,b,c){return Rg.getAnyBox(a,b,c).map(function(b){var c=Ge.filterItems(a,M.curry(Ng.inSelection,b));return Aa.map(c,function(a){return a.element()})})},Ug=function(a,b){var c=function(a,b){return Qc.contains(b,a)};return Ge.findItem(a,b,c).bind(function(a){return a.element()})},Vg={moveBy:Sg,intercepts:Tg,parentCell:Ug},Wg=function(a,b,c){return we.table(a).bind(function(d){var e=$g(d);return Vg.moveBy(e,a,b,c)})},Xg=function(a,b,c){var d=$g(a);return Vg.intercepts(d,b,c)},Yg=function(a,b,c,d,e){var f=$g(a),g=Qc.eq(a,c)?b:Vg.parentCell(f,b),h=Qc.eq(a,e)?d:Vg.parentCell(f,d);return Vg.intercepts(f,g,h)},Zg=function(a,b,c){var d=$g(a);return Rg.getBox(d,b,c)},$g=function(a){var b=ze.fromTable(a);return Ge.generate(b)},_g={moveBy:Wg,intercepts:Xg,nestedIntercepts:Yg,getBox:Zg},ah=function(a,b){return ie.ancestor(a,"table")},bh=Sa.immutableBag(["boxes","start","finish"],[]),ch=function(a,b,c){var d=function(a){return function(b){return c(b)||Qc.eq(b,a)}};return Qc.eq(a,b)?T.some(bh({boxes:T.some([a]),start:a,finish:b})):ah(a).bind(function(e){return ah(b).bind(function(f){if(Qc.eq(e,f))return T.some(bh({boxes:_g.intercepts(e,a,b),start:a,finish:b}));if(Qc.contains(e,f)){var g=Wd.ancestors(b,"td,th",d(e)),h=g.length>0?g[g.length-1]:b;return T.some(bh({boxes:_g.nestedIntercepts(e,a,e,b,f),start:a,finish:h}))}if(Qc.contains(f,e)){var g=Wd.ancestors(a,"td,th",d(f)),i=g.length>0?g[g.length-1]:a;return T.some(bh({boxes:_g.nestedIntercepts(f,a,e,b,f),start:a,finish:i}))}return Jg.ancestors(a,b).shared().bind(function(g){return ie.closest(g,"table",c).bind(function(c){var g=Wd.ancestors(b,"td,th",d(c)),h=g.length>0?g[g.length-1]:b,i=Wd.ancestors(a,"td,th",d(c)),j=i.length>0?i[i.length-1]:a;return T.some(bh({boxes:_g.nestedIntercepts(c,a,e,b,f),start:j,finish:h}))})})})})},dh=function(a,b){var c=Wd.descendants(a,b);return c.length>0?T.some(c):T.none()},eh=function(a,b){return Aa.find(a,function(a){return sb.is(a,b)})},fh=function(a,b,c){return ie.descendant(a,b).bind(function(b){return ie.descendant(a,c).bind(function(a){return Jg.sharedOne(ah,[b,a]).map(function(c){return{first:M.constant(b),last:M.constant(a),table:M.constant(c)}})})})},gh=function(a,b){return ie.ancestor(a,"table").bind(function(c){return ie.descendant(c,b).bind(function(b){return ch(b,a).bind(function(a){return a.boxes().map(function(b){return{boxes:M.constant(b),start:M.constant(a.start()),finish:M.constant(a.finish())}})})})})},hh=function(a,b,c,d,e){return eh(a,e).bind(function(a){return _g.moveBy(a,b,c).bind(function(a){return gh(a,d)})})},ih={identify:ch,retrieve:dh,shiftSelection:hh,getEdges:fh},jh=function(a,b){return ih.retrieve(a,b)},kh=function(a,b,c){return ih.getEdges(a,b,c).bind(function(b){var c=function(b){return Qc.eq(a,b)},d=ie.ancestor(b.first(),"thead,tfoot,tbody,table",c),e=ie.ancestor(b.last(),"thead,tfoot,tbody,table",c);return d.bind(function(a){return e.bind(function(c){return Qc.eq(a,c)?_g.getBox(b.table(),b.first(),b.last()):T.none()})})})},lh={retrieve:jh,retrieveBox:kh},mh="data-mce-selected",nh={selected:M.constant(mh),selectedSelector:M.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:M.constant("[data-mce-selected]"),firstSelected:M.constant("data-mce-first-selected"),firstSelectedSelector:M.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:M.constant("data-mce-last-selected"),lastSelectedSelector:M.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},oh=function(a){if(!W.isArray(a))throw new Error("cases must be an array");if(0===a.length)throw new Error("there must be at least one case");var b=[],c={};return Aa.each(a,function(d,e){var f=Ka.keys(d);if(1!==f.length)throw new Error("one and only one name per case");var g=f[0],h=d[g];if(void 0!==c[g])throw new Error("duplicate key detected:"+g);if("cata"===g)throw new Error("cannot have a case named cata (sorry)");if(!W.isArray(h))throw new Error("case arguments must be an array");b.push(g),c[g]=function(){var c=arguments.length;if(c!==h.length)throw new Error("Wrong number of arguments to case "+g+". Expected "+h.length+" ("+h+"), got "+c);for(var d=new Array(c),f=0;f<d.length;f++)d[f]=arguments[f];var i=function(a){var c=Ka.keys(a);if(b.length!==c.length)throw new Error("Wrong number of arguments to match. Expected: "+b.join(",")+"\nActual: "+c.join(","));if(!Aa.forall(b,function(a){return Aa.contains(c,a)}))throw new Error("Not all branches were specified when using match. Specified: "+c.join(", ")+"\nRequired: "+b.join(", "));return a[g].apply(null,d)};return{fold:function(){if(arguments.length!==a.length)throw new Error("Wrong number of arguments to fold. Expected "+a.length+", got "+arguments.length);return arguments[e].apply(null,d)},match:i,log:function(a){console.log(a,{constructors:b,constructor:g,params:d})}}}}),c},ph={generate:oh},qh=ph.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),rh=function(a,b,c,d){return a.fold(b,c,d)},sh={cata:rh,none:qh.none,multiple:qh.multiple,single:qh.single},th=function(a,b){return sh.cata(b.get(),M.constant([]),M.identity,M.constant([a]))},uh=function(a,b){var c=function(a){return Gd.has(a,"rowspan")&&parseInt(Gd.get(a,"rowspan"),10)>1||Gd.has(a,"colspan")&&parseInt(Gd.get(a,"colspan"),10)>1},d=th(a,b);return d.length>0&&Aa.forall(d,c)?T.some(d):T.none()},vh=function(a,b){return sh.cata(b.get(),T.none,function(b,c){return 0===b.length?T.none():lh.retrieveBox(a,nh.firstSelectedSelector(),nh.lastSelectedSelector()).bind(function(a){return b.length>1?T.some({bounds:M.constant(a),cells:M.constant(b)}):T.none()})},T.none)},wh={mergable:vh,unmergable:uh,selection:th},xh=function(a){return{element:M.constant(a),mergable:T.none,unmergable:T.none,selection:M.constant([a])}},yh=function(a,b,c){return{element:M.constant(c),mergable:M.constant(wh.mergable(b,a)),unmergable:M.constant(wh.unmergable(c,a)),selection:M.constant(wh.selection(c,a))}},zh=function(a){return xh(a)},Ah=Sa.immutable("element","clipboard","generators"),Bh=function(a,b,c,d,e){return{element:M.constant(c),mergable:T.none,unmergable:T.none,selection:M.constant(wh.selection(c,a)),clipboard:M.constant(d),generators:M.constant(e)}},Ch={noMenu:xh,forMenu:yh,notCell:zh,paste:Ah,pasteRows:Bh},Dh=function(a){return we.table(a[0]).map(Cf.deep).map(function(a){return[vf.extract(a,nh.attributeSelector())]})},Eh=function(a,b){return a.selection.serializer.serialize(b.dom(),{})},Fh=function(a,b,c,d){a.on("BeforeGetContent",function(c){var d=function(b){c.preventDefault(),Dh(b).each(function(b){c.content=Aa.map(b,function(b){return Eh(a,b)}).join("")})};!0===c.selection&&sh.cata(b.get(),M.noop,d,M.noop)}),a.on("BeforeSetContent",function(b){if(!0===b.selection&&!0===b.paste){T.from(a.dom.getParent(a.selection.getStart(),"th,td")).each(function(e){var f=kb.fromDom(e);we.table(f).bind(function(e){var g=Aa.filter(dg.fromHtml(b.content),function(a){return"meta"!==vd.name(a)});if(1===g.length&&"table"===vd.name(g[0])){b.preventDefault();var h=kb.fromDom(a.getDoc()),i=$f.paste(h),j=Ch.paste(f,g[0],i);c.pasteCells(e,j).each(function(b){a.selection.setRng(b),a.focus(),d.clear(e)})}})})}})},Gh={registerEvents:Fh},Hh=f("height",function(a){return Kd.inBody(a)?a.dom().getBoundingClientRect().height:a.dom().offsetHeight}),Ih=function(a,b){Hh.set(a,b)},Jh=function(a){return Hh.get(a)},Kh=function(a){return Hh.getOuter(a)},Lh=function(a,b){var c=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],d=Hh.max(a,b,c);Ze.set(a,"max-height",d+"px")},Mh={set:Ih,get:Jh,getOuter:Kh,setMax:Lh},Nh=f("width",function(a){return a.dom().offsetWidth}),Oh=function(a,b){Nh.set(a,b)},Ph=function(a){return Nh.get(a)},Qh=function(a){return Nh.getOuter(a)},Rh=function(a,b){var c=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],d=Nh.max(a,b,c);Ze.set(a,"max-width",d+"px")},Sh={set:Oh,get:Ph,getOuter:Qh,setMax:Rh},Th=Ic.detect(),Uh=function(){return Th.browser.isIE()||Th.browser.isEdge()},Vh=function(a,b){var c=parseFloat(a);return isNaN(c)?b:c},Wh=function(a,b,c){return Vh(Ze.get(a,b),c)},Xh=function(a){var b=Wh(a,"padding-top",0),c=Wh(a,"padding-bottom",0),d=Wh(a,"border-top-width",0),e=Wh(a,"border-bottom-width",0),f=a.dom().getBoundingClientRect().height,g=Ze.get(a,"box-sizing"),h=d+e;return"border-box"===g?f:f-b-c-h},Yh=function(a){return Wh(a,"width",Sh.get(a))},Zh=function(a){return Uh()?Xh(a):Wh(a,"height",Mh.get(a))},$h={getWidth:Yh,getHeight:Zh},_h=/(\d+(\.\d+)?)(\w|%)*/,ai=/(\d+(\.\d+)?)%/,bi=/(\d+(\.\d+)?)px|em/,ci=function(a,b){Ze.set(a,"width",b+"px")},di=function(a,b){Ze.set(a,"width",b+"%")},ei=function(a,b){Ze.set(a,"height",b+"px")},fi=function(a){return Ze.getRaw(a,"height").getOrThunk(function(){return $h.getHeight(a)+"px"})},gi=function(a,b,c,d){var e=we.table(a).map(function(a){var d=c(a);return Math.floor(b/100*d)}).getOr(b);return d(a,e),e},hi=function(a,b,c,d){var e=parseInt(a,10);return zc.endsWith(a,"%")&&"table"!==vd.name(b)?gi(b,e,c,d):e},ii=function(a){var b=fi(a);return b?hi(b,a,Mh.get,ei):Mh.get(a)},ji=function(a,b,c){return c(a)/ki(a,b)},ki=function(a,b){return Gd.has(a,b)?parseInt(Gd.get(a,b),10):1},li=function(a){return Ze.getRaw(a,"width").fold(function(){return T.from(Gd.get(a,"width"))},function(a){return T.some(a)})},mi=function(a,b){return a/b.pixelWidth()*100},ni=function(a,b,c){if(ai.test(b)){var d=ai.exec(b);return parseFloat(d[1])}var e=Sh.get(a),f=parseInt(e,10);return mi(f,c)},oi=function(a,b){return li(a).fold(function(){var c=Sh.get(a),d=parseInt(c,10);return mi(d,b)},function(c){return ni(a,c,b)})},pi=function(a,b){return a/100*b.pixelWidth()},qi=function(a,b,c){if(bi.test(b)){var d=bi.exec(b);return parseInt(d[1],10)}if(ai.test(b)){var e=ai.exec(b),f=parseFloat(e[1]);return pi(f,c)}var g=Sh.get(a);return parseInt(g,10)},ri=function(a,b){return li(a).fold(function(){var b=Sh.get(a);return parseInt(b,10)},function(c){return qi(a,c,b)})},si=function(a){return ji(a,"rowspan",ii)},ti=function(a){return li(a).bind(function(a){if(_h.test(a)){var b=_h.exec(a);return T.some({width:M.constant(b[1]),unit:M.constant(b[3])})}return T.none()})},ui=function(a,b,c){Ze.set(a,"width",b+c)},vi={percentageBasedSizeRegex:M.constant(ai),pixelBasedSizeRegex:M.constant(bi),setPixelWidth:ci,setPercentageWidth:di,setHeight:ei,getPixelWidth:ri,getPercentageWidth:oi,getGenericWidth:ti,setGenericWidth:ui,getHeight:si,getRawWidth:li},wi=function(a,b){vi.getGenericWidth(a).each(function(c){var d=c.width()/2;vi.setGenericWidth(a,d,c.unit()),vi.setGenericWidth(b,d,c.unit())})},xi={halve:wi},yi=function(a,b){var c=b||kb.fromDom(document.documentElement);return be.ancestor(a,M.curry(Qc.eq,c)).isSome()},zi=function(a){var b=a.dom();return b===b.window?a:vd.isDocument(a)?b.defaultView||b.parentWindow:null},Ai={attached:yi,windowOf:zi},Bi=function(a,b){var c=function(c,d){return Bi(a+c,b+d)};return{left:M.constant(a),top:M.constant(b),translate:c}},Ci=function(a){var b=a.getBoundingClientRect();return Bi(b.left,b.top)},Di=function(a,b){return void 0!==a?a:void 0!==b?b:0},Ei=function(a){var b=a.dom().ownerDocument,c=b.body,d=Ai.windowOf(kb.fromDom(b)),e=b.documentElement,f=Di(d.pageYOffset,e.scrollTop),g=Di(d.pageXOffset,e.scrollLeft),h=Di(e.clientTop,c.clientTop),i=Di(e.clientLeft,c.clientLeft);return Gi(a).translate(g-i,f-h)},Fi=function(a){var b=a.dom();return Bi(b.offsetLeft,b.offsetTop)},Gi=function(a){var b=a.dom(),c=b.ownerDocument,d=c.body,e=kb.fromDom(c.documentElement);return d===b?Bi(d.offsetLeft,d.offsetTop):Ai.attached(a,e)?Ci(b):Bi(0,0)},Hi={absolute:Ei,relative:Fi,viewport:Gi},Ii=Sa.immutable("row","y"),Ji=Sa.immutable("col","x"),Ki=function(a){return Hi.absolute(a).left()+Sh.getOuter(a)},Li=function(a){return Hi.absolute(a).left()},Mi=function(a,b){return Ji(a,Li(b))},Ni=function(a,b){return Ji(a,Ki(b))},Oi=function(a){return Hi.absolute(a).top()},Pi=function(a,b){return Ii(a,Oi(b))},Qi=function(a,b){return Ii(a,Oi(b)+Mh.getOuter(b))},Ri=function(a,b,c){if(0===c.length)return[];var d=Aa.map(c.slice(1),function(b,c){return b.map(function(b){return a(c,b)})}),e=c[c.length-1].map(function(a){return b(c.length-1,a)});return d.concat([e])},Si=function(a,b){return-a},Ti={delta:M.identity,positions:M.curry(Ri,Pi,Qi),edge:Oi},Ui={delta:M.identity,edge:Li,positions:M.curry(Ri,Mi,Ni)},Vi={delta:Si,edge:Ki,positions:M.curry(Ri,Ni,Mi)},Wi={height:Ti,rtl:Vi,ltr:Ui},Xi={ltr:Wi.ltr,rtl:Wi.rtl},Yi=function(a){var b=ze.fromTable(a);return Ge.generate(b).grid()},Zi={getGridSize:Yi},$i=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return $i(c())}}},_i=function(a,b){return aj(a,b,{validate:W.isFunction,label:"function"})},aj=function(a,b,c){if(0===b.length)throw new Error("You must specify at least one required field.");return Ra.validateStrArr("required",b),Ra.checkDupes(b),function(d){var e=Ka.keys(d);Aa.forall(b,function(a){return Aa.contains(e,a)})||Ra.reqMessage(b,e),a(b,e);var f=Aa.filter(b,function(a){return!c.validate(d[a],a)});return f.length>0&&Ra.invalidTypeMessage(f,c.label),d}},bj=function(a,b){var c=Aa.filter(b,function(b){return!Aa.contains(a,b)});c.length>0&&Ra.unsuppMessage(c)},cj=M.noop,dj={exactly:M.curry(_i,bj),ensure:M.curry(_i,cj),ensureWith:M.curry(aj,cj)},ej=function(a){var b=Gd.has(a,"colspan")?parseInt(Gd.get(a,"colspan"),10):1,c=Gd.has(a,"rowspan")?parseInt(Gd.get(a,"rowspan"),10):1;return{element:M.constant(a),colspan:M.constant(b),rowspan:M.constant(c)}},fj=function(a,b){ij(a);var c=$i(T.none()),d=void 0!==b?b:ej,e=function(b){return a.cell(b)},f=function(a){var b=d(a);return e(b)},g=function(a){var b=f(a);return c.get().isNone()&&c.set(T.some(b)),h=T.some({item:a,replacement:b}),b},h=T.none();return{getOrInit:function(a,b){return h.fold(function(){return g(a)},function(c){return b(a,c.item)?c.replacement:g(a)})},cursor:c.get}},gj=function(a,b){return function(c){var d=$i(T.none());ij(c);var e=[],f=function(a,b){return Aa.find(e,function(c){return b(c.item,a)})},g=function(f){var g=c.replace(f,b,{scope:a});return e.push({item:f,sub:g}),d.get().isNone()&&d.set(T.some(g)),g};return{replaceOrInit:function(a,b){return f(a,b).fold(function(){return g(a)},function(c){return b(a,c.item)?c.sub:g(a)})},cursor:d.get}}},hj=function(a){ij(a);var b=$i(T.none());return{combine:function(c){return b.get().isNone()&&b.set(T.some(c)),function(){var b=a.cell({element:M.constant(c),colspan:M.constant(1),rowspan:M.constant(1)});return Ze.remove(b,"width"),Ze.remove(c,"width"),b}},cursor:b.get}},ij=dj.exactly(["cell","row","replace","gap"]),jj={modification:fj,transform:gj,merging:hj},kj=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lj=function(a,b){var c=a.property().name(b);return Aa.contains(["ol","ul"],c)},mj=function(a,b){var c=a.property().name(b);return Aa.contains(kj,c)},nj=function(a,b){var c=a.property().name(b);return Aa.contains(["address","pre","p","h1","h2","h3","h4","h5","h6"],c)},oj=function(a,b){var c=a.property().name(b);return Aa.contains(["h1","h2","h3","h4","h5","h6"],c)},pj=function(a,b){return Aa.contains(["div","li","td","th","blockquote","body","caption"],a.property().name(b))},qj=function(a,b){return Aa.contains(["br","img","hr","input"],a.property().name(b))},rj=function(a,b){return"iframe"===a.property().name(b)},sj=function(a,b){return!(mj(a,b)||qj(a,b))&&"li"!==a.property().name(b)},tj={isBlock:mj,isList:lj,isFormatting:nj,isHeading:oj,isContainer:pj,isEmptyTag:qj,isFrame:rj,isInline:sj},uj=e(),vj=function(a){return tj.isBlock(uj,a)},wj=function(a){return tj.isList(uj,a)},xj=function(a){return tj.isFormatting(uj,a)},yj=function(a){return tj.isHeading(uj,a)},zj=function(a){return tj.isContainer(uj,a)},Aj=function(a){return tj.isEmptyTag(uj,a)},Bj=function(a){return tj.isFrame(uj,a)},Cj=function(a){return tj.isInline(uj,a)},Dj={isBlock:vj,isList:wj,isFormatting:xj,isHeading:yj,isContainer:zj,isEmptyTag:Aj,isFrame:Bj,isInline:Cj},Ej=function(a){var b=function(a){return"br"===vd.name(a)},c=function(a){return Aa.forall(a,function(a){return b(a)||vd.isText(a)&&0===Hf.get(a).trim().length})},d=function(a){return"li"===vd.name(a)||be.ancestor(a,Dj.isList).isSome()},e=function(a){return jd.nextSibling(a).map(function(a){return!!Dj.isBlock(a)||(Dj.isEmptyTag(a)?"img"!==vd.name(a):void 0)}).getOr(!1)},f=function(a){return Sf.last(a).bind(function(c){var f=e(c);return jd.parent(c).map(function(e){return!0===f||d(e)||b(c)||Dj.isBlock(e)&&!Qc.eq(a,e)?[]:[kb.fromTag("br")]})}).getOr([])},g=function(){var b=Aa.bind(a,function(a){var b=jd.children(a);return c(b)?[]:b.concat(f(a))});return 0===b.length?[kb.fromTag("br")]:b}();of.empty(a[0]),kf.append(a[0],g)},Fj={merge:Ej},Gj=function(a,b){return b},Hj=function(a,b){return W.isObject(a)&&W.isObject(b)?Jj(a,b):b},Ij=function(a){return function(){for(var b=new Array(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];if(0===b.length)throw new Error("Can't merge zero objects");for(var d={},e=0;e<b.length;e++){var f=b[e];for(var g in f)f.hasOwnProperty(g)&&(d[g]=a(d[g],f[g]))}return d}},Jj=Ij(Hj),Kj=Ij(Gj),Lj={deepMerge:Jj,merge:Kj},Mj=function(a){for(var b=[],c=function(a){b.push(a)},d=0;d<a.length;d++)a[d].each(c);return b},Nj=function(a,b){for(var c=0;c<a.length;c++){var d=b(a[c],c);if(d.isSome())return d}return T.none()},Oj=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];if(!e.isSome())return T.none();c.push(e.getOrDie())}return T.some(b.apply(null,c))},Pj={cat:Mj,findMap:Nj,liftN:Oj},Qj=function(a,b,c){var d=a.cells(),e=d.slice(0,b),f=d.slice(b),g=e.concat([c]).concat(f);return Sj(a,g)},Rj=function(a,b,c){a.cells()[b]=c},Sj=function(a,b){return eb.rowcells(b,a.section())},Tj=function(a,b){var c=a.cells(),d=Aa.map(c,b);return eb.rowcells(d,a.section())},Uj=function(a,b){return a.cells()[b]},Vj=function(a,b){return Uj(a,b).element()},Wj=function(a){return a.cells().length},Xj={addCell:Qj,setCells:Sj,mutateCell:Rj,getCell:Uj,getCellElement:Vj,mapCells:Tj,cellLength:Wj},Yj=function(a,b){return Aa.map(a,function(a){return Xj.getCell(a,b)})},Zj=function(a,b){return a[b]},$j=function(a,b){if(0===a.length)return 0;var c=a[0];return Aa.findIndex(a,function(a){return!b(c.element(),a.element())}).fold(function(){return a.length},function(a){return a})},_j=function(a,b,c,d){var e=Zj(a,b).cells().slice(c),f=$j(e,d),g=Yj(a,c).slice(b),h=$j(g,d);return{colspan:M.constant(f),rowspan:M.constant(h)}},ak={subgrid:_j},bk=function(a,b){var c=Aa.map(a,function(a,b){return Aa.map(a.cells(),function(a,b){return!1})}),d=function(a,b,d,e){for(var f=a;f<a+d;f++)for(var g=b;g<b+e;g++)c[f][g]=!0};return Aa.map(a,function(e,f){var g=Aa.bind(e.cells(),function(e,g){if(!1===c[f][g]){var h=ak.subgrid(a,f,g,b);return d(f,g,h.rowspan(),h.colspan()),[eb.detailnew(e.element(),h.rowspan(),h.colspan(),e.isNew())]}return[]});return eb.rowdetails(g,e.section())})},ck=function(a,b,c){for(var d=[],e=0;e<a.grid().rows();e++){for(var f=[],g=0;g<a.grid().columns();g++){var h=Ge.getAt(a,e,g).map(function(a){return eb.elementnew(a.element(),c)}).getOrThunk(function(){return eb.elementnew(b.gap(),!0)});f.push(h)}var i=eb.rowcells(f,a.all()[e].section());d.push(i)}return d},dk={toDetails:bk,toGrid:ck},ek=function(a,b,c,d){c===d?Gd.remove(a,b):Gd.set(a,b,c)},fk=function(a,b){var c=[],d=[],e=function(b,e){var f=ie.child(a,e).getOrThunk(function(){var b=kb.fromTag(e,jd.owner(a).dom());return ef.append(a,b),b});of.empty(f);var g=Aa.map(b,function(a){a.isNew()&&c.push(a.element());var b=a.element();return of.empty(b),Aa.each(a.cells(),function(a){a.isNew()&&d.push(a.element()),ek(a.element(),"colspan",a.colspan(),1),ek(a.element(),"rowspan",a.rowspan(),1),ef.append(b,a.element())}),b});kf.append(f,g)},f=function(b){ie.child(a,b).bind(of.remove)},g=function(a,b){a.length>0?e(a,b):f(b)},h=[],i=[],j=[];return Aa.each(b,function(a){switch(a.section()){case"thead":h.push(a);break;case"tbody":i.push(a);break;case"tfoot":j.push(a)}}),g(h,"thead"),g(i,"tbody"),g(j,"tfoot"),{newRows:M.constant(c),newCells:M.constant(d)}},gk=function(a){return Aa.map(a,function(a){var b=Cf.shallow(a.element());return Aa.each(a.cells(),function(a){var c=Cf.deep(a.element());ek(c,"colspan",a.colspan(),1),
ek(c,"rowspan",a.rowspan(),1),ef.append(b,c)}),b})},hk={render:fk,copy:gk},ik=function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},jk=function(a,b){for(var c=[],d=a;d<b;d++)c.push(d);return c},kk=function(a,b){var c=[];return Aa.each(a,function(d,e){e<a.length-1&&!b(d,a[e+1])?c.push(d):e===a.length-1&&c.push(d)}),c},lk=function(a,b){if(b<0||b>=a.length-1)return T.none();var c=a[b].fold(function(){var c=Aa.reverse(a.slice(0,b));return Pj.findMap(c,function(a,b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return T.some({value:a,delta:0})}),d=a[b+1].fold(function(){var c=a.slice(b+1);return Pj.findMap(c,function(a,b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return T.some({value:a,delta:1})});return c.bind(function(a){return d.map(function(b){var c=b.delta+a.delta;return Math.abs(b.value-a.value)/c})})},mk={repeat:ik,range:jk,unique:kk,deduce:lk},nk=function(a){var b=a.grid(),c=mk.range(0,b.columns()),d=mk.range(0,b.rows());return Aa.map(c,function(b){return ok(function(){return Aa.bind(d,function(c){return Ge.getAt(a,c,b).filter(function(a){return a.column()===b}).fold(M.constant([]),function(a){return[a]})})},function(a){return 1===a.colspan()},function(){return Ge.getAt(a,0,b)})})},ok=function(a,b,c){var d=a();return Aa.find(d,b).orThunk(function(){return T.from(d[0]).orThunk(c)}).map(function(a){return a.element()})},pk=function(a){var b=a.grid(),c=mk.range(0,b.rows()),d=mk.range(0,b.columns());return Aa.map(c,function(b){return ok(function(){return Aa.bind(d,function(c){return Ge.getAt(a,b,c).filter(function(a){return a.row()===b}).fold(M.constant([]),function(a){return[a]})})},function(a){return 1===a.rowspan()},function(){return Ge.getAt(a,b,0)})})},qk={columns:nk,rows:pk},rk=function(a,b,c,d,e){var f=kb.fromTag("div");return Ze.setAll(f,{position:"absolute",left:b-d/2+"px",top:c+"px",height:e+"px",width:d+"px"}),Gd.setAll(f,{"data-column":a,role:"presentation"}),f},sk=function(a,b,c,d,e){var f=kb.fromTag("div");return Ze.setAll(f,{position:"absolute",left:b+"px",top:c-e/2+"px",height:e+"px",width:d+"px"}),Gd.setAll(f,{"data-row":a,role:"presentation"}),f},tk={col:rk,row:sk},uk=function(a){var b=a.replace(/\./g,"-");return{resolve:function(a){return b+"-"+a}}},vk={css:uk},wk=vk.css("ephox-snooker"),xk={resolve:wk.resolve},yk=function(a,b){var c=Gd.get(a,b);return void 0===c||""===c?[]:c.split(" ")},zk=function(a,b,c){var d=yk(a,b),e=d.concat([c]);Gd.set(a,b,e.join(" "))},Ak=function(a,b,c){var d=Aa.filter(yk(a,b),function(a){return a!==c});d.length>0?Gd.set(a,b,d.join(" ")):Gd.remove(a,b)},Bk={read:yk,add:zk,remove:Ak},Ck=function(a){return void 0!==a.dom().classList},Dk=function(a){return Bk.read(a,"class")},Ek=function(a,b){return Bk.add(a,"class",b)},Fk=function(a,b){return Bk.remove(a,"class",b)},Gk=function(a,b){Aa.contains(Dk(a),b)?Fk(a,b):Ek(a,b)},Hk={get:Dk,add:Ek,remove:Fk,toggle:Gk,supports:Ck},Ik=function(a,b){Hk.supports(a)?a.dom().classList.add(b):Hk.add(a,b)},Jk=function(a){0===(Hk.supports(a)?a.dom().classList:Hk.get(a)).length&&Gd.remove(a,"class")},Kk=function(a,b){if(Hk.supports(a)){a.dom().classList.remove(b)}else Hk.remove(a,b);Jk(a)},Lk=function(a,b){return Hk.supports(a)?a.dom().classList.toggle(b):Hk.toggle(a,b)},Mk=function(a,b){var c=Hk.supports(a),d=a.dom().classList;return h(function(){c?d.remove(b):Hk.remove(a,b)},function(){c?d.add(b):Hk.add(a,b)},Nk(a,b))},Nk=function(a,b){return Hk.supports(a)&&a.dom().classList.contains(b)},Ok={add:Ik,remove:Kk,toggle:Lk,toggler:Mk,has:Nk},Pk=xk.resolve("resizer-bar"),Qk=xk.resolve("resizer-rows"),Rk=xk.resolve("resizer-cols"),Sk=function(a){var b=Wd.descendants(a.parent(),"."+Pk);Aa.each(b,of.remove)},Tk=function(a,b,c){var d=a.origin();Aa.each(b,function(b,e){b.each(function(b){var e=c(d,b);Ok.add(e,Pk),ef.append(a.parent(),e)})})},Uk=function(a,b,c,d){Tk(a,b,function(a,b){var e=tk.col(b.col(),b.x()-a.left(),c.top()-a.top(),7,d);return Ok.add(e,Rk),e})},Vk=function(a,b,c,d){Tk(a,b,function(a,b){var e=tk.row(b.row(),c.left()-a.left(),b.y()-a.top(),d,7);return Ok.add(e,Qk),e})},Wk=function(a,b,c,d,e,f){var g=Hi.absolute(b),h=c.length>0?e.positions(c,b):[];Vk(a,h,g,Sh.getOuter(b));var i=d.length>0?f.positions(d,b):[];Uk(a,i,g,Mh.getOuter(b))},Xk=function(a,b,c,d){Sk(a);var e=ze.fromTable(b),f=Ge.generate(e),g=qk.rows(f),h=qk.columns(f);Wk(a,b,g,h,c,d)},Yk=function(a,b){var c=Wd.descendants(a.parent(),"."+Pk);Aa.each(c,b)},Zk=function(a){Yk(a,function(a){Ze.set(a,"display","none")})},$k=function(a){Yk(a,function(a){Ze.set(a,"display","block")})},_k=function(a){return Ok.has(a,Qk)},al=function(a){return Ok.has(a,Rk)},bl={refresh:Xk,hide:Zk,show:$k,destroy:Sk,isRowBar:_k,isColBar:al},cl=function(a,b){return dk.toGrid(a,b,!1)},dl=function(a,b){var c=function(a){return Pj.findMap(a,function(a){return jd.parent(a.element()).map(function(a){var b=jd.parent(a).isNone();return eb.elementnew(a,b)})}).getOrThunk(function(){return eb.elementnew(b.row(),!0)})};return Aa.map(a,function(a){var b=c(a.details());return eb.rowdatanew(b.element(),a.details(),a.section(),b.isNew())})},el=function(a,b){var c=dk.toDetails(a,Qc.eq);return dl(c,b)},fl=function(a,b){var c=Aa.flatten(Aa.map(a.all(),function(a){return a.cells()}));return Aa.find(c,function(a){return Qc.eq(b,a.element())})},gl=function(a,b,c,d,e){return function(f,g,h,i,j){var k=ze.fromTable(g),l=Ge.generate(k);return b(l,h).map(function(b){var c=cl(l,i),d=a(c,b,Qc.eq,e(i)),f=el(d.grid(),i);return{grid:M.constant(f),cursor:d.cursor}}).fold(function(){return T.none()},function(a){var b=hk.render(g,a.grid());return c(g,a.grid(),j),d(g),bl.refresh(f,g,Wi.height,j),T.some({cursor:a.cursor,newRows:b.newRows,newCells:b.newCells})})}},hl=function(a,b){return we.cell(b.element()).bind(function(b){return fl(a,b)})},il=function(a,b){return we.cell(b.element()).bind(function(c){return fl(a,c).map(function(a){return Lj.merge(a,{generators:b.generators,clipboard:b.clipboard})})})},jl=function(a,b){var c=Aa.map(b.selection(),function(b){return we.cell(b).bind(function(b){return fl(a,b)})}),d=Pj.cat(c);return d.length>0?T.some(Lj.merge({cells:d},{generators:b.generators,clipboard:b.clipboard})):T.none()},kl=function(a,b){return b.mergable()},ll=function(a,b){return b.unmergable()},ml=function(a,b){var c=Aa.map(b.selection(),function(b){return we.cell(b).bind(function(b){return fl(a,b)})}),d=Pj.cat(c);return d.length>0?T.some(d):T.none()},nl={run:gl,toDetailList:el,onCell:hl,onCells:ml,onPaste:il,onPasteRows:jl,onMergable:kl,onUnmergable:ll},ol=function(a){var b=function(b){return a===b},c=function(b){return ol(a)},d=function(b){return ol(a)},e=function(b){return ol(b(a))},f=function(b){b(a)},g=function(b){return b(a)},h=function(b,c){return c(a)},i=function(b){return b(a)},j=function(b){return b(a)},k=function(){return T.some(a)};return{is:b,isValue:M.always,isError:M.never,getOr:M.constant(a),getOrThunk:M.constant(a),getOrDie:M.constant(a),or:c,orThunk:d,fold:h,map:e,each:f,bind:g,exists:i,forall:j,toOption:k}},pl=function(a){var b=function(a){return a()},c=function(){return M.die(String(a))()},d=function(a){return a},e=function(a){return a()},f=function(b){return pl(a)},g=function(b){return pl(a)},h=function(b,c){return b(a)};return{is:M.never,isValue:M.never,isError:M.always,getOr:M.identity,getOrThunk:b,getOrDie:c,or:d,orThunk:e,fold:h,map:f,each:M.noop,bind:g,exists:M.never,forall:M.always,toOption:T.none}},ql={value:ol,error:pl},rl=function(a,b,c){if(a.row()>=b.length||a.column()>Xj.cellLength(b[0]))return ql.error("invalid start address out of table bounds, row: "+a.row()+", column: "+a.column());var d=b.slice(a.row()),e=d[0].cells().slice(a.column()),f=Xj.cellLength(c[0]),g=c.length;return ql.value({rowDelta:M.constant(d.length-g),colDelta:M.constant(e.length-f)})},sl=function(a,b){var c=Xj.cellLength(a[0]),d=Xj.cellLength(b[0]);return{rowDelta:M.constant(0),colDelta:M.constant(c-d)}},tl=function(a,b){return Aa.map(a,function(){return eb.elementnew(b.cell(),!0)})},ul=function(a,b,c){return a.concat(mk.repeat(b,function(b){return Xj.setCells(a[a.length-1],tl(a[a.length-1].cells(),c))}))},vl=function(a,b,c){return Aa.map(a,function(a){return Xj.setCells(a,a.cells().concat(tl(mk.range(0,b),c)))})},wl=function(a,b,c){var d=b.colDelta()<0?vl:M.identity;return(b.rowDelta()<0?ul:M.identity)(d(a,Math.abs(b.colDelta()),c),Math.abs(b.rowDelta()),c)},xl={measure:rl,measureWidth:sl,tailor:wl},yl=function(a,b,c,d){if(0===a.length)return a;for(var e=b.startRow();e<=b.finishRow();e++)for(var f=b.startCol();f<=b.finishCol();f++)Xj.mutateCell(a[e],f,eb.elementnew(d(),!1));return a},zl=function(a,b,c,d){for(var e=!0,f=0;f<a.length;f++)for(var g=0;g<Xj.cellLength(a[0]);g++){var h=Xj.getCellElement(a[f],g),i=c(h,b);!0===i&&!1===e?Xj.mutateCell(a[f],g,eb.elementnew(d(),!0)):!0===i&&(e=!1)}return a},Al=function(a,b){return Aa.foldl(a,function(a,c){return Aa.exists(a,function(a){return b(a.element(),c.element())})?a:a.concat([c])},[])},Bl=function(a,b,c,d){if(b>0&&b<a.length){var e=a[b-1].cells(),f=Al(e,c);Aa.each(f,function(e){for(var f=T.none(),g=b;g<a.length;g++)for(var h=0;h<Xj.cellLength(a[0]);h++){var i=a[g].cells()[h],j=c(i.element(),e.element());j&&(f.isNone()&&(f=T.some(d())),f.each(function(b){Xj.mutateCell(a[g],h,eb.elementnew(b,!0))}))}})}return a},Cl={merge:yl,unmerge:zl,splitRows:Bl},Dl=function(a,b,c,d){var e=Xj.getCell(a[b],c),f=M.curry(d,e.element()),g=a[b];return a.length>1&&Xj.cellLength(g)>1&&(c>0&&f(Xj.getCellElement(g,c-1))||c<g.length-1&&f(Xj.getCellElement(g,c+1))||b>0&&f(Xj.getCellElement(a[b-1],c))||b<a.length-1&&f(Xj.getCellElement(a[b+1],c)))},El=function(a,b,c,d,e){for(var f=a.row(),g=a.column(),h=c.length,i=Xj.cellLength(c[0]),j=f+h,k=g+i,l=f;l<j;l++)for(var m=g;m<k;m++){Dl(b,l,m,e)&&Cl.unmerge(b,Xj.getCellElement(b[l],m),e,d.cell);var n=Xj.getCellElement(c[l-f],m-g),o=d.replace(n);Xj.mutateCell(b[l],m,eb.elementnew(o,!0))}return b},Fl=function(a,b,c,d,e){return xl.measure(a,b,c).map(function(f){var g=xl.tailor(b,f,d);return El(a,g,c,d,e)})},Gl=function(a,b,c,d,e){Cl.splitRows(b,a,e,d.cell);var f=xl.measureWidth(c,b),g=xl.tailor(c,f,d),h=xl.measureWidth(b,g),i=xl.tailor(b,h,d);return i.slice(0,a).concat(g).concat(i.slice(a,i.length))},Hl={merge:Fl,insert:Gl},Il=function(a,b,c,d,e){var f=a.slice(0,b),g=a.slice(b),h=Xj.mapCells(a[c],function(c,f){return b>0&&b<a.length&&d(Xj.getCellElement(a[b-1],f),Xj.getCellElement(a[b],f))?Xj.getCell(a[b],f):eb.elementnew(e(c.element(),d),!0)});return f.concat([h]).concat(g)},Jl=function(a,b,c,d,e){return Aa.map(a,function(a){var f=b>0&&b<Xj.cellLength(a)&&d(Xj.getCellElement(a,b-1),Xj.getCellElement(a,b)),g=f?Xj.getCell(a,b):eb.elementnew(e(Xj.getCellElement(a,c),d),!0);return Xj.addCell(a,b,g)})},Kl=function(a,b,c,d,e){var f=c+1;return Aa.map(a,function(a,g){var h=g===b,i=h?eb.elementnew(e(Xj.getCellElement(a,c),d),!0):Xj.getCell(a,c);return Xj.addCell(a,f,i)})},Ll=function(a,b,c,d,e){var f=b+1,g=a.slice(0,f),h=a.slice(f),i=Xj.mapCells(a[b],function(a,b){return b===c?eb.elementnew(e(a.element(),d),!0):a});return g.concat([i]).concat(h)},Ml=function(a,b,c){var d=Aa.map(a,function(a){var d=a.cells().slice(0,b).concat(a.cells().slice(c+1));return eb.rowcells(d,a.section())});return Aa.filter(d,function(a){return a.cells().length>0})},Nl=function(a,b,c){return a.slice(0,b).concat(a.slice(c+1))},Ol={insertRowAt:Il,insertColumnAt:Jl,splitCellIntoColumns:Kl,splitCellIntoRows:Ll,deleteRowsAt:Nl,deleteColumnsAt:Ml},Pl=function(a,b,c,d){var e=function(a){return Aa.exists(b,function(b){return c(a.element(),b.element())})};return Aa.map(a,function(a){return Xj.mapCells(a,function(a){return e(a)?eb.elementnew(d(a.element(),c),!0):a})})},Ql=function(a,b,c,d){return void 0!==Xj.getCellElement(a[b],c)&&b>0&&d(Xj.getCellElement(a[b-1],c),Xj.getCellElement(a[b],c))},Rl=function(a,b,c){return b>0&&c(Xj.getCellElement(a,b-1),Xj.getCellElement(a,b))},Sl=function(a,b,c,d){var e=Aa.bind(a,function(d,e){return Ql(a,e,b,c)||Rl(d,b,c)?[]:[Xj.getCell(d,b)]});return Pl(a,e,c,d)},Tl=function(a,b,c,d){var e=a[b],f=Aa.bind(e.cells(),function(d,f){return Ql(a,b,f,c)||Rl(e,f,c)?[]:[d]});return Pl(a,f,c,d)},Ul={replaceColumn:Sl,replaceRow:Tl},Vl=function(){return $l(function(a,b,c,d,e){return a()})},Wl=function(a){return $l(function(b,c,d,e,f){return c(a)})},Xl=function(a,b){return $l(function(c,d,e,f,g){return e(a,b)})},Yl=function(a,b,c){return $l(function(d,e,f,g,h){return g(a,b,c)})},Zl=function(a,b){return $l(function(c,d,e,f,g){return g(a,b)})},$l=function(a){return{fold:a}},_l={none:Vl,only:Wl,left:Xl,middle:Yl,right:Zl},am=function(a,b){return 0===a.length?_l.none():1===a.length?_l.only(0):0===b?_l.left(0,1):b===a.length-1?_l.right(b-1,b):b>0&&b<a.length-1?_l.middle(b-1,b,b+1):_l.none()},bm=function(a,b,c,d){var e=a.slice(0),f=am(a,b),g=function(a){return Aa.map(a,M.constant(0))},h=M.constant(g(e)),i=function(a){return d.singleColumnWidth(e[a],c)},j=function(a,b){if(c>=0){var f=Math.max(d.minCellWidth(),e[b]-c);return g(e.slice(0,a)).concat([c,f-e[b]]).concat(g(e.slice(b+1)))}var h=Math.max(d.minCellWidth(),e[a]+c),i=e[a]-h;return g(e.slice(0,a)).concat([h-e[a],i]).concat(g(e.slice(b+1)))},k=j,l=function(a,b,c){return j(b,c)},m=function(a,b){if(c>=0)return g(e.slice(0,b)).concat([c]);var f=Math.max(d.minCellWidth(),e[b]+c);return g(e.slice(0,b)).concat([f-e[b]])};return f.fold(h,i,k,l,m)},cm={determine:bm},dm=function(a,b){return Gd.has(a,b)&&parseInt(Gd.get(a,b),10)>1},em=function(a){return dm(a,"colspan")},fm=function(a){return dm(a,"rowspan")},gm=function(a,b){return parseInt(Ze.get(a,b),10)},hm={hasColspan:em,hasRowspan:fm,minWidth:M.constant(10),minHeight:M.constant(10),getInt:gm},im=function(a,b,c){return Ze.getRaw(a,b).fold(function(){return c(a)+"px"},function(a){return a})},jm=function(a){return im(a,"width",vi.getPixelWidth)},km=function(a){return im(a,"height",vi.getHeight)},lm=function(a,b,c,d,e){var f=qk.columns(a),g=Aa.map(f,function(a){return a.map(b.edge)});return Aa.map(f,function(a,b){return a.filter(M.not(hm.hasColspan)).fold(function(){var a=mk.deduce(g,b);return d(a)},function(a){return c(a,e)})})},mm=function(a){return a.map(function(a){return a+"px"}).getOr("")},nm=function(a,b){return lm(a,b,jm,mm)},om=function(a,b,c){return lm(a,b,vi.getPercentageWidth,function(a){return a.fold(function(){return c.minCellWidth()},function(a){return a/c.pixelWidth()*100})},c)},pm=function(a,b,c){return lm(a,b,vi.getPixelWidth,function(a){return a.getOrThunk(c.minCellWidth)},c)},qm=function(a,b,c,d){var e=qk.rows(a),f=Aa.map(e,function(a){return a.map(b.edge)});return Aa.map(e,function(a,b){return a.filter(M.not(hm.hasRowspan)).fold(function(){var a=mk.deduce(f,b);return d(a)},function(a){return c(a)})})},rm=function(a,b){return qm(a,b,vi.getHeight,function(a){return a.getOrThunk(hm.minHeight)})},sm=function(a,b){return qm(a,b,km,mm)},tm={getRawWidths:nm,getPixelWidths:pm,getPercentageWidths:om,getPixelHeights:rm,getRawHeights:sm},um=function(a,b,c){for(var d=0,e=a;e<b;e++)d+=void 0!==c[e]?c[e]:0;return d},vm=function(a,b){var c=Ge.justCells(a);return Aa.map(c,function(a){var c=um(a.column(),a.column()+a.colspan(),b);return{element:a.element,width:M.constant(c),colspan:a.colspan}})},wm=function(a,b){var c=Ge.justCells(a);return Aa.map(c,function(a){var c=um(a.row(),a.row()+a.rowspan(),b);return{element:a.element,height:M.constant(c),rowspan:a.rowspan}})},xm=function(a,b){return Aa.map(a.all(),function(a,c){return{element:a.element,height:M.constant(b[c])}})},ym={recalculateWidth:vm,recalculateHeight:wm,matchRowHeight:xm},zm=function(a,b){var c=parseFloat(a),d=Sh.get(b),e=function(a){return a/d*100},f=function(a,b){return[100-a]},g=function(){return hm.minWidth()/d*100},h=function(a,b,d){var e=c+d;vi.setPercentageWidth(a,e)};return{width:M.constant(c),pixelWidth:M.constant(d),getWidths:tm.getPercentageWidths,getCellDelta:e,singleColumnWidth:f,minCellWidth:g,setElementWidth:vi.setPercentageWidth,setTableWidth:h}},Am=function(a){var b=parseInt(a,10),c=M.identity,d=function(a,b){return[Math.max(hm.minWidth(),a+b)-a]},e=function(a,b,c){var d=Aa.foldr(b,function(a,b){return a+b},0);vi.setPixelWidth(a,d)};return{width:M.constant(b),pixelWidth:M.constant(b),getWidths:tm.getPixelWidths,getCellDelta:c,singleColumnWidth:d,minCellWidth:hm.minWidth,setElementWidth:vi.setPixelWidth,setTableWidth:e}},Bm=function(a,b){if(vi.percentageBasedSizeRegex().test(b)){var c=vi.percentageBasedSizeRegex().exec(b);return zm(c[1],a)}if(vi.pixelBasedSizeRegex().test(b)){var d=vi.pixelBasedSizeRegex().exec(b);return Am(d[1])}var e=Sh.get(a);return Am(e)},Cm=function(a){return vi.getRawWidth(a).fold(function(){var b=Sh.get(a);return Am(b)},function(b){return Bm(a,b)})},Dm={getTableSize:Cm},Em=function(a){return Ge.generate(a)},Fm=function(a){return Aa.foldr(a,function(a,b){return a+b},0)},Gm=function(a){var b=ze.fromTable(a);return Em(b)},Hm=function(a,b,c,d){var e=Dm.getTableSize(a),f=e.getCellDelta(b),g=Gm(a),h=e.getWidths(g,d,e),i=cm.determine(h,c,f,e),j=Aa.map(i,function(a,b){return a+h[b]}),k=ym.recalculateWidth(g,j);Aa.each(k,function(a){e.setElementWidth(a.element(),a.width())}),c===g.grid().columns()-1&&e.setTableWidth(a,j,f)},Im=function(a,b,c,d){var e=Gm(a),f=tm.getPixelHeights(e,d),g=Aa.map(f,function(a,d){return c===d?Math.max(b+a,hm.minHeight()):a}),h=ym.recalculateHeight(e,g),i=ym.matchRowHeight(e,g);Aa.each(i,function(a){vi.setHeight(a.element(),a.height())}),Aa.each(h,function(a){vi.setHeight(a.element(),a.height())});var j=Fm(g);vi.setHeight(a,j)},Jm=function(a,b,c){var d=Dm.getTableSize(a),e=Em(b),f=d.getWidths(e,c,d),g=ym.recalculateWidth(e,f);Aa.each(g,function(a){d.setElementWidth(a.element(),a.width())});var h=Aa.foldr(f,function(a,b){return b+a},0);g.length>0&&d.setElementWidth(a,h)},Km={adjustWidth:Hm,adjustHeight:Im,adjustWidthTo:Jm},Lm=function(a){0===we.cells(a).length&&of.remove(a)},Mm=Sa.immutable("grid","cursor"),Nm=function(a,b,c){return Om(a,b,c).orThunk(function(){return Om(a,0,0)})},Om=function(a,b,c){return T.from(a[b]).bind(function(a){return T.from(a.cells()[c]).bind(function(a){return T.from(a.element())})})},Pm=function(a,b,c){return Mm(a,Om(a,b,c))},Qm=function(a){return Aa.foldl(a,function(a,b){return Aa.exists(a,function(a){return a.row()===b.row()})?a:a.concat([b])},[]).sort(function(a,b){return a.row()-b.row()})},Rm=function(a){return Aa.foldl(a,function(a,b){return Aa.exists(a,function(a){return a.column()===b.column()})?a:a.concat([b])},[]).sort(function(a,b){return a.column()-b.column()})},Sm=function(a,b,c,d){var e=b.row(),f=b.row(),g=Ol.insertRowAt(a,f,e,c,d.getOrInit);return Pm(g,f,b.column())},Tm=function(a,b,c,d){var e=b[0].row(),f=b[0].row(),g=Qm(b),h=Aa.foldl(g,function(a,b){return Ol.insertRowAt(a,f,e,c,d.getOrInit)},a);return Pm(h,f,b[0].column())},Um=function(a,b,c,d){var e=b.row(),f=b.row()+b.rowspan(),g=Ol.insertRowAt(a,f,e,c,d.getOrInit);return Pm(g,f,b.column())},Vm=function(a,b,c,d){var e=Qm(b),f=e[e.length-1].row(),g=e[e.length-1].row()+e[e.length-1].rowspan(),h=Aa.foldl(e,function(a,b){return Ol.insertRowAt(a,g,f,c,d.getOrInit)},a);return Pm(h,g,b[0].column())},Wm=function(a,b,c,d){var e=b.column(),f=b.column(),g=Ol.insertColumnAt(a,f,e,c,d.getOrInit);return Pm(g,b.row(),f)},Xm=function(a,b,c,d){var e=Rm(b),f=e[0].column(),g=e[0].column(),h=Aa.foldl(e,function(a,b){return Ol.insertColumnAt(a,g,f,c,d.getOrInit)},a);return Pm(h,b[0].row(),g)},Ym=function(a,b,c,d){var e=b.column(),f=b.column()+b.colspan(),g=Ol.insertColumnAt(a,f,e,c,d.getOrInit);return Pm(g,b.row(),f)},Zm=function(a,b,c,d){var e=b[b.length-1].column(),f=b[b.length-1].column()+b[b.length-1].colspan(),g=Rm(b),h=Aa.foldl(g,function(a,b){return Ol.insertColumnAt(a,f,e,c,d.getOrInit)},a);return Pm(h,b[0].row(),f)},$m=function(a,b,c,d){var e=Ul.replaceRow(a,b.row(),c,d.replaceOrInit);return Pm(e,b.row(),b.column())},_m=function(a,b,c,d){var e=Ul.replaceColumn(a,b.column(),c,d.replaceOrInit);return Pm(e,b.row(),b.column())},an=function(a,b,c,d){var e=Ul.replaceRow(a,b.row(),c,d.replaceOrInit);return Pm(e,b.row(),b.column())},bn=function(a,b,c,d){var e=Ul.replaceColumn(a,b.column(),c,d.replaceOrInit);return Pm(e,b.row(),b.column())},cn=function(a,b,c,d){var e=Ol.splitCellIntoColumns(a,b.row(),b.column(),c,d.getOrInit);return Pm(e,b.row(),b.column())},dn=function(a,b,c,d){var e=Ol.splitCellIntoRows(a,b.row(),b.column(),c,d.getOrInit);return Pm(e,b.row(),b.column())},en=function(a,b,c,d){var e=Rm(b),f=Ol.deleteColumnsAt(a,e[0].column(),e[e.length-1].column()),g=Nm(f,b[0].row(),b[0].column());return Mm(f,g)},fn=function(a,b,c,d){var e=Qm(b),f=Ol.deleteRowsAt(a,e[0].row(),e[e.length-1].row()),g=Nm(f,b[0].row(),b[0].column());return Mm(f,g)},gn=function(a,b,c,d){var e=b.cells();Fj.merge(e);var f=Cl.merge(a,b.bounds(),c,M.constant(e[0]));return Mm(f,T.from(e[0]))},hn=function(a,b,c,d){var e=Aa.foldr(b,function(a,b){return Cl.unmerge(a,b,c,d.combine(b))},a);return Mm(e,T.from(b[0]))},jn=function(a,b,c,d){var e=function(a,b){var c=ze.fromTable(a),d=Ge.generate(c);return dk.toGrid(d,b,!0)}(b.clipboard(),b.generators()),f=eb.address(b.row(),b.column());return Hl.merge(f,a,e,b.generators(),c).fold(function(){return Mm(a,T.some(b.element()))},function(a){var c=Nm(a,b.row(),b.column());return Mm(a,c)})},kn=function(a,b,c){var d=ze.fromPastedRows(a,c),e=Ge.generate(d);return dk.toGrid(e,b,!0)},ln=function(a,b,c,d){var e=a[b.cells[0].row()],f=b.cells[0].row(),g=kn(b.clipboard(),b.generators(),e),h=Hl.insert(f,a,g,b.generators(),c),i=Nm(h,b.cells[0].row(),b.cells[0].column());return Mm(h,i)},mn=function(a,b,c,d){var e=a[b.cells[0].row()],f=b.cells[b.cells.length-1].row()+b.cells[b.cells.length-1].rowspan(),g=kn(b.clipboard(),b.generators(),e),h=Hl.insert(f,a,g,b.generators(),c),i=Nm(h,b.cells[0].row(),b.cells[0].column());return Mm(h,i)},nn=Km.adjustWidthTo,on={insertRowBefore:nl.run(Sm,nl.onCell,M.noop,M.noop,jj.modification),insertRowsBefore:nl.run(Tm,nl.onCells,M.noop,M.noop,jj.modification),insertRowAfter:nl.run(Um,nl.onCell,M.noop,M.noop,jj.modification),insertRowsAfter:nl.run(Vm,nl.onCells,M.noop,M.noop,jj.modification),insertColumnBefore:nl.run(Wm,nl.onCell,nn,M.noop,jj.modification),insertColumnsBefore:nl.run(Xm,nl.onCells,nn,M.noop,jj.modification),insertColumnAfter:nl.run(Ym,nl.onCell,nn,M.noop,jj.modification),insertColumnsAfter:nl.run(Zm,nl.onCells,nn,M.noop,jj.modification),splitCellIntoColumns:nl.run(cn,nl.onCell,nn,M.noop,jj.modification),splitCellIntoRows:nl.run(dn,nl.onCell,M.noop,M.noop,jj.modification),eraseColumns:nl.run(en,nl.onCells,nn,Lm,jj.modification),eraseRows:nl.run(fn,nl.onCells,M.noop,Lm,jj.modification),makeColumnHeader:nl.run(_m,nl.onCell,M.noop,M.noop,jj.transform("row","th")),unmakeColumnHeader:nl.run(bn,nl.onCell,M.noop,M.noop,jj.transform(null,"td")),makeRowHeader:nl.run($m,nl.onCell,M.noop,M.noop,jj.transform("col","th")),unmakeRowHeader:nl.run(an,nl.onCell,M.noop,M.noop,jj.transform(null,"td")),mergeCells:nl.run(gn,nl.onMergable,M.noop,M.noop,jj.merging),unmergeCells:nl.run(hn,nl.onUnmergable,nn,M.noop,jj.merging),pasteCells:nl.run(jn,nl.onPaste,nn,M.noop,jj.modification),pasteRowsBefore:nl.run(ln,nl.onPasteRows,M.noop,M.noop,jj.modification),pasteRowsAfter:nl.run(mn,nl.onPasteRows,M.noop,M.noop,jj.modification)},pn=function(a){return kb.fromDom(a.getBody())},qn=function(a){return a.getBoundingClientRect().width},rn=function(a){return a.getBoundingClientRect().height},sn=function(a){return function(b){return Qc.eq(b,pn(a))}},tn=function(a){return a?a.replace(/px$/,""):""},un=function(a){return/^[0-9]+$/.test(a)&&(a+="px"),a},vn=function(a){var b=Wd.descendants(a,"td[data-mce-style],th[data-mce-style]");Gd.remove(a,"data-mce-style"),Aa.each(b,function(a){Gd.remove(a,"data-mce-style")})},wn=function(a,b){return function(c){return"rtl"===xn(c)?b:a}},xn=function(a){return"rtl"===Ze.get(a,"direction")?"rtl":"ltr"},yn={onDirection:wn,getDirection:xn},zn={isRtl:M.constant(!1)},An={isRtl:M.constant(!0)},Bn=function(a){return"rtl"===yn.getDirection(a)?An:zn},Cn={directionAt:Bn},Dn=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],En={"border-collapse":"collapse",width:"100%"},Fn={border:"1"},Gn=function(a){return a.getParam("table_default_attributes",Fn,"object")},Hn=function(a){return a.getParam("table_default_styles",En,"object")},In=function(a){return a.getParam("table_resize_bars",!0,"boolean")},Jn=function(a){return a.getParam("table_tab_navigation",!0,"boolean")},Kn=function(a){return a.getParam("table_cell_advtab",!0,"boolean")},Ln=function(a){return a.getParam("table_row_advtab",!0,"boolean")},Mn=function(a){return a.getParam("table_advtab",!0,"boolean")},Nn=function(a){return a.getParam("table_appearance_options",!0,"boolean")},On=function(a){return a.getParam("table_grid",!0,"boolean")},Pn=function(a){return a.getParam("table_style_by_css",!1,"boolean")},Qn=function(a){return a.getParam("table_cell_class_list",[],"array")},Rn=function(a){return a.getParam("table_row_class_list",[],"array")},Sn=function(a){return a.getParam("table_class_list",[],"array")},Tn=function(a){return a.getParam("color_picker_callback")},Un=function(a){return!1===a.getParam("table_responsive_width")},Vn=function(a){var b=a.getParam("table_clone_elements");return W.isString(b)?T.some(b.split(/[ ,]/)):Array.isArray(b)?T.some(b):T.none()},Wn=function(a){var b=a.getParam("object_resizing",!0);return"table"===b||b},Xn=function(a){var b=a.getParam("table_toolbar",Dn);return""===b||!1===b?[]:W.isString(b)?b.split(/[ ,]/):W.isArray(b)?b:[]},Yn=function(a,b){return a.fire("newrow",{node:b})},Zn=function(a,b){return a.fire("newcell",{node:b})},$n=function(a,b,c,d){a.fire("ObjectResizeStart",{target:b,width:c,height:d})},_n=function(a,b,c,d){a.fire("ObjectResized",{target:b,width:c,height:d})},ao=function(a,b){var c=function(a){return"table"===vd.name(pn(a))},d=function(b){var d=Zi.getGridSize(b);return!1===c(a)||d.rows()>1},e=function(b){var d=Zi.getGridSize(b);return!1===c(a)||d.columns()>1},f=Vn(a),h=function(b,c,d,e){return function(h,i){vn(h);var j=e(),k=kb.fromDom(a.getDoc()),l=g(Cn.directionAt),m=$f.cellOperations(d,k,f);return c(h)?b(j,h,i,m,l).bind(function(b){return Aa.each(b.newRows(),function(b){Yn(a,b.dom())}),Aa.each(b.newCells(),function(b){Zn(a,b.dom())}),b.cursor().map(function(b){var c=a.dom.createRng();return c.setStart(b.dom(),0),c.setEnd(b.dom(),0),c})}):T.none()}};return{deleteRow:h(on.eraseRows,d,M.noop,b),deleteColumn:h(on.eraseColumns,e,M.noop,b),insertRowsBefore:h(on.insertRowsBefore,M.always,M.noop,b),insertRowsAfter:h(on.insertRowsAfter,M.always,M.noop,b),insertColumnsBefore:h(on.insertColumnsBefore,M.always,xi.halve,b),insertColumnsAfter:h(on.insertColumnsAfter,M.always,xi.halve,b),mergeCells:h(on.mergeCells,M.always,M.noop,b),unmergeCells:h(on.unmergeCells,M.always,M.noop,b),pasteRowsBefore:h(on.pasteRowsBefore,M.always,M.noop,b),pasteRowsAfter:h(on.pasteRowsAfter,M.always,M.noop,b),pasteCells:h(on.pasteCells,M.always,M.noop,b)}},bo=function(a,b,c){var d=ze.fromTable(a),e=Ge.generate(d);return nl.onCells(e,b).map(function(a){var b=dk.toGrid(e,c,!1),d=b.slice(a[0].row(),a[a.length-1].row()+a[a.length-1].rowspan()),f=nl.toDetailList(d,c);return hk.copy(f)})},co={copyRows:bo},eo=tinymce.util.Tools.resolve("tinymce.util.Tools"),fo=function(a,b,c){var d,e=a.select("td,th",b);return d=function(b,d){for(var e=0;e<d.length;e++){var f=a.getStyle(d[e],c);if(void 0===b&&(b=f),b!==f)return""}return b}(d,e)},go=function(a,b,c){c&&a.formatter.apply("align"+c,{},b)},ho=function(a,b,c){c&&a.formatter.apply("valign"+c,{},b)},io=function(a,b){eo.each("left center right".split(" "),function(c){a.formatter.remove("align"+c,{},b)})},jo=function(a,b){eo.each("top middle bottom".split(" "),function(c){a.formatter.remove("valign"+c,{},b)})},ko={applyAlign:go,applyVAlign:ho,unApplyAlign:io,unApplyVAlign:jo,getTDTHOverallStyle:fo},lo=function(a,b,c){var d=function(a,c){return c=c||[],eo.each(a,function(a){var e={text:a.text||a.title};a.menu?e.menu=d(a.menu):(e.value=a.value,b&&b(e)),c.push(e)}),c};return d(a,c||[])},mo=function(a,b){var c=a.dom,d=b.control.rootControl,e=d.toJSON(),f=c.parseStyle(e.style);"style"===b.control.name()?(d.find("#borderStyle").value(f["border-style"]||"")[0].fire("select"),d.find("#borderColor").value(f["border-color"]||"")[0].fire("change"),d.find("#backgroundColor").value(f["background-color"]||"")[0].fire("change"),d.find("#width").value(f.width||"").fire("change"),d.find("#height").value(f.height||"").fire("change")):(f["border-style"]=e.borderStyle,f["border-color"]=e.borderColor,f["background-color"]=e.backgroundColor,f.width=e.width?un(e.width):"",f.height=e.height?un(e.height):""),d.find("#style").value(c.serializeStyle(c.parseStyle(c.serializeStyle(f))))},no=function(a,b){var c=a.parseStyle(a.getAttrib(b,"style")),d={};return c["border-style"]&&(d.borderStyle=c["border-style"]),c["border-color"]&&(d.borderColor=c["border-color"]),c["background-color"]&&(d.backgroundColor=c["background-color"]),d.style=a.serializeStyle(c),d},oo=function(a){var b=function(){var b=Tn(a);if(b)return function(c){return b.call(a,function(a){c.control.value(a).fire("change")},c.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:M.curry(mo,a)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:M.curry(mo,a),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:b()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:b()}]}]}},po={createStyleForm:oo,buildListItems:lo,updateStyleField:mo,extractAdvancedStyles:no},qo=function(a,b){delete a.dataset.mceStyle,a.style.cssText+=";"+b},ro=function(a,b){var c=a.dom,d={width:c.getStyle(b,"width")||c.getAttrib(b,"width"),height:c.getStyle(b,"height")||c.getAttrib(b,"height"),scope:c.getAttrib(b,"scope"),class:c.getAttrib(b,"class"),type:b.nodeName.toLowerCase(),style:"",align:"",valign:""};return eo.each("left center right".split(" "),function(c){a.formatter.matchNode(b,"align"+c)&&(d.align=c)}),eo.each("top middle bottom".split(" "),function(c){a.formatter.matchNode(b,"valign"+c)&&(d.valign=c)}),Kn(a)&&eo.extend(d,po.extractAdvancedStyles(c,b)),d},so=function(a,b,c){function d(a,b,c){c&&g.setAttrib(a,b,c)}function e(a,b,c){c&&g.setStyle(a,b,c)}var f,g=a.dom;po.updateStyleField(a,c),f=c.control.rootControl.toJSON(),a.undoManager.transact(function(){eo.each(b,function(c){d(c,"scope",f.scope),1===b.length?d(c,"style",f.style):qo(c,f.style),d(c,"class",f.class),e(c,"width",un(f.width)),e(c,"height",un(f.height)),f.type&&c.nodeName.toLowerCase()!==f.type&&(c=g.rename(c,f.type)),1===b.length&&(ko.unApplyAlign(a,c),ko.unApplyVAlign(a,c)),f.align&&ko.applyAlign(a,c,f.align),f.valign&&ko.applyVAlign(a,c,f.valign)}),a.focus()})},to=function(a){var b,c,d,e=[];if(e=a.dom.select("td[data-mce-selected],th[data-mce-selected]"),b=a.dom.getParent(a.selection.getStart(),"td,th"),!e.length&&b&&e.push(b),b=b||e[0]){c=e.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:b.nodeName.toLowerCase()}:ro(a,b),Qn(a).length>0&&(d={name:"class",type:"listbox",label:"Class",values:po.buildListItems(Qn(a),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({block:"td",classes:[b.value]})})})});var f={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:M.curry(po.updateStyleField,a)},{label:"Height",
name:"height",onchange:M.curry(po.updateStyleField,a)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},d]};Kn(a)?a.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:c,body:[{title:"General",type:"form",items:f},po.createStyleForm(a)],onsubmit:M.curry(so,a,e)}):a.windowManager.open({title:"Cell properties",data:c,body:f,onsubmit:M.curry(so,a,e)})}},uo={open:to},vo=function(a,b){var c=a.dom,d={height:c.getStyle(b,"height")||c.getAttrib(b,"height"),scope:c.getAttrib(b,"scope"),class:c.getAttrib(b,"class"),align:"",style:"",type:b.parentNode.nodeName.toLowerCase()};return eo.each("left center right".split(" "),function(c){a.formatter.matchNode(b,"align"+c)&&(d.align=c)}),Ln(a)&&eo.extend(d,po.extractAdvancedStyles(c,b)),d},wo=function(a,b,c){var d=a.getParent(b,"table"),e=b.parentNode,f=a.select(c,d)[0];f||(f=a.create(c),d.firstChild?"CAPTION"===d.firstChild.nodeName?a.insertAfter(f,d.firstChild):d.insertBefore(f,d.firstChild):d.appendChild(f)),f.appendChild(b),e.hasChildNodes()||a.remove(e)},xo=function(a){var b,c,d,e,f,g,h=a.dom,j=[];b=h.getParent(a.selection.getStart(),"table"),c=h.getParent(a.selection.getStart(),"td,th"),eo.each(b.rows,function(a){eo.each(a.cells,function(b){if(h.getAttrib(b,"data-mce-selected")||b===c)return j.push(a),!1})}),(d=j[0])&&(f=j.length>1?{height:"",scope:"",style:"",class:"",align:"",type:d.parentNode.nodeName.toLowerCase()}:vo(a,d),Rn(a).length>0&&(e={name:"class",type:"listbox",label:"Class",values:po.buildListItems(Rn(a),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({block:"tr",classes:[b.value]})})})}),g={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},e]},Ln(a)?a.windowManager.open({title:"Row properties",data:f,bodyType:"tabpanel",body:[{title:"General",type:"form",items:g},po.createStyleForm(a)],onsubmit:M.curry(i,a,j,f)}):a.windowManager.open({title:"Row properties",data:f,body:g,onsubmit:M.curry(i,a,j,f)}))},yo={open:xo},zo=tinymce.util.Tools.resolve("tinymce.Env"),Ao={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Bo=function(){return kb.fromTag("table")},Co=function(){return kb.fromTag("tbody")},Do=function(){return kb.fromTag("tr")},Eo=function(){return kb.fromTag("th")},Fo=function(){return kb.fromTag("td")},Go=function(a,b,c,d,e){void 0===e&&(e=Ao);var f=Bo();Ze.setAll(f,e.styles),Gd.setAll(f,e.attributes);var g=Co();ef.append(f,g);for(var h=[],i=0;i<a;i++){for(var j=Do(),k=0;k<b;k++){var l=i<c||k<d?Eo():Fo();k<d&&Gd.set(l,"scope","row"),i<c&&Gd.set(l,"scope","col"),ef.append(l,kb.fromTag("br")),e.percentages&&Ze.set(l,"width",100/b+"%"),ef.append(j,l)}h.push(j)}return kf.append(g,h),f},Ho=function(a){return a.dom().innerHTML},Io=function(a,b){var c=jd.owner(a),d=c.dom(),e=kb.fromDom(d.createDocumentFragment()),f=dg.fromHtml(b,d);kf.append(e,f),of.empty(a),ef.append(a,e)},Jo=function(a){var b=kb.fromTag("div"),c=kb.fromDom(a.dom().cloneNode(!0));return ef.append(b,c),Ho(b)},Ko={get:Ho,set:Io,getOuter:Jo},Lo=function(a,b){a.selection.select(b.dom(),!0),a.selection.collapse(!0)},Mo=function(a,b){ie.descendant(b,"td,th").each(M.curry(Lo,a))},No=function(a,b){Aa.each(Wd.descendants(b,"tr"),function(b){Yn(a,b.dom()),Aa.each(Wd.descendants(b,"th,td"),function(b){Zn(a,b.dom())})})},Oo=function(a){return W.isString(a)&&-1!==a.indexOf("%")},Po=function(a,b,c){var d=Hn(a),e={styles:d,attributes:Gn(a),percentages:Oo(d.width)&&!Un(a)},f=Go(c,b,0,0,e);Gd.set(f,"data-mce-id","__mce");var g=Ko.getOuter(f);return a.insertContent(g),ie.descendant(pn(a),'table[data-mce-id="__mce"]').map(function(b){return Un(a)&&Ze.set(b,"width",Ze.get(b,"width")),Gd.remove(b,"data-mce-id"),No(a,b),Mo(a,b),b.dom()}).getOr(null)},Qo={insert:Po},Ro=function(a,b){var c=a.dom,d={width:c.getStyle(b,"width")||c.getAttrib(b,"width"),height:c.getStyle(b,"height")||c.getAttrib(b,"height"),cellspacing:c.getStyle(b,"border-spacing")||c.getAttrib(b,"cellspacing"),cellpadding:c.getAttrib(b,"data-mce-cell-padding")||c.getAttrib(b,"cellpadding")||ko.getTDTHOverallStyle(a.dom,b,"padding"),border:c.getAttrib(b,"data-mce-border")||c.getAttrib(b,"border")||ko.getTDTHOverallStyle(a.dom,b,"border"),borderColor:c.getAttrib(b,"data-mce-border-color"),caption:!!c.select("caption",b)[0],class:c.getAttrib(b,"class")};return eo.each("left center right".split(" "),function(c){a.formatter.matchNode(b,"align"+c)&&(d.align=c)}),Mn(a)&&eo.extend(d,po.extractAdvancedStyles(c,b)),d},So=function(a,b,c){var d=a.dom,e={},f={};if(e.class=c.class,f.height=un(c.height),d.getAttrib(b,"width")&&!Pn(a)?e.width=tn(c.width):f.width=un(c.width),Pn(a)?(f["border-width"]=un(c.border),f["border-spacing"]=un(c.cellspacing),eo.extend(e,{"data-mce-border-color":c.borderColor,"data-mce-cell-padding":c.cellpadding,"data-mce-border":c.border})):eo.extend(e,{border:c.border,cellpadding:c.cellpadding,cellspacing:c.cellspacing}),Pn(a)&&b.children)for(var g=0;g<b.children.length;g++)j(d,b.children[g],{"border-width":un(c.border),"border-color":c.borderColor,padding:un(c.cellpadding)});c.style?eo.extend(f,d.parseStyle(c.style)):f=eo.extend({},d.parseStyle(d.getAttrib(b,"style")),f),e.style=d.serializeStyle(f),d.setAttribs(b,e)},To=function(a,b,c){var d,e,f=a.dom;po.updateStyleField(a,c),e=c.control.rootControl.toJSON(),!1===e.class&&delete e.class,a.undoManager.transact(function(){b||(b=Qo.insert(a,e.cols||1,e.rows||1)),So(a,b,e),d=f.select("caption",b)[0],d&&!e.caption&&f.remove(d),!d&&e.caption&&(d=f.create("caption"),d.innerHTML=zo.ie?"":'<br data-mce-bogus="1"/>',b.insertBefore(d,b.firstChild)),ko.unApplyAlign(a,b),e.align&&ko.applyAlign(a,b,e.align),a.focus(),a.addVisual()})},Uo=function(a,b){var c,d,e,f,g,h=a.dom,i={};!0===b?(c=h.getParent(a.selection.getStart(),"table"))&&(i=Ro(a,c)):(d={label:"Cols",name:"cols"},e={label:"Rows",name:"rows"}),Sn(a).length>0&&(i.class&&(i.class=i.class.replace(/\s*mce\-item\-table\s*/g,"")),f={name:"class",type:"listbox",label:"Class",values:po.buildListItems(Sn(a),function(b){b.value&&(b.textStyle=function(){return a.formatter.getCssText({block:"table",classes:[b.value]})})})}),g={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:Nn(a)?[d,e,{label:"Width",name:"width",onchange:M.curry(po.updateStyleField,a)},{label:"Height",name:"height",onchange:M.curry(po.updateStyleField,a)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[d,e,{label:"Width",name:"width",onchange:M.curry(po.updateStyleField,a)},{label:"Height",name:"height",onchange:M.curry(po.updateStyleField,a)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},f]},Mn(a)?a.windowManager.open({title:"Table properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:g},po.createStyleForm(a)],onsubmit:M.curry(To,a,c)}):a.windowManager.open({title:"Table properties",data:i,body:g,onsubmit:M.curry(To,a,c)})},Vo={open:Uo},Wo=eo.each,Xo=function(a,b,c,d,e){var f=sn(a),g=function(){var b=kb.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"));we.table(b,f).filter(M.not(f)).each(function(b){var c=kb.fromText("");ef.after(b,c),of.remove(b);var d=a.dom.createRng();d.setStart(c.dom(),0),d.setEnd(c.dom(),0),a.selection.setRng(d)})},h=function(){return kb.fromDom(a.dom.getParent(a.selection.getStart(),"th,td"))},i=function(a){return we.table(a,f)},j=function(a){return{width:qn(a.dom()),height:qn(a.dom())}},k=function(a,b,c){var d=j(c);b.width===d.width&&b.height===d.height||($n(a,c.dom(),b.width,b.height),_n(a,c.dom(),d.width,d.height))},l=function(b){var e=h();i(e).each(function(f){var g=Ch.forMenu(d,f,e),h=j(f);b(f,g).each(function(b){k(a,h,f),a.selection.setRng(b),a.focus(),c.clear(f),vn(f)})})},m=function(b){var c=h();return i(c).bind(function(b){var e=kb.fromDom(a.getDoc()),f=Ch.forMenu(d,b,c),g=$f.cellOperations(M.noop,e,T.none());return co.copyRows(b,f,g)})},n=function(b){e.get().each(function(e){var f=Aa.map(e,function(a){return Cf.deep(a)}),g=h();i(g).bind(function(e){var h=kb.fromDom(a.getDoc()),i=$f.paste(h),j=Ch.pasteRows(d,e,g,f,i);b(e,j).each(function(b){a.selection.setRng(b),a.focus(),c.clear(e)})})})};Wo({mceTableSplitCells:function(){l(b.unmergeCells)},mceTableMergeCells:function(){l(b.mergeCells)},mceTableInsertRowBefore:function(){l(b.insertRowsBefore)},mceTableInsertRowAfter:function(){l(b.insertRowsAfter)},mceTableInsertColBefore:function(){l(b.insertColumnsBefore)},mceTableInsertColAfter:function(){l(b.insertColumnsAfter)},mceTableDeleteCol:function(){l(b.deleteColumn)},mceTableDeleteRow:function(){l(b.deleteRow)},mceTableCutRow:function(a){e.set(m()),l(b.deleteRow)},mceTableCopyRow:function(a){e.set(m())},mceTablePasteRowBefore:function(a){n(b.pasteRowsBefore)},mceTablePasteRowAfter:function(a){n(b.pasteRowsAfter)},mceTableDelete:g},function(b,c){a.addCommand(c,b)}),Wo({mceInsertTable:M.curry(Vo.open,a),mceTableProps:M.curry(Vo.open,a,!0),mceTableRowProps:M.curry(yo.open,a),mceTableCellProps:M.curry(uo.open,a)},function(b,c){a.addCommand(c,function(a,c){b(c)})})},Yo={registerCommands:Xo},Zo=function(a){var b=T.from(a.dom().documentElement).map(kb.fromDom).getOr(a);return{parent:M.constant(b),view:M.constant(a),origin:M.constant(Bi(0,0))}},$o=function(a,b){var c=M.curry(Hi.absolute,b);return{parent:M.constant(b),view:M.constant(a),origin:c}},_o=function(a,b){return{parent:M.constant(b),view:M.constant(a),origin:M.constant(Bi(0,0))}},ap={only:Zo,detached:$o,body:_o},bp=function(a){return{registry:Ka.map(a,function(a){return{bind:a.bind,unbind:a.unbind}}),trigger:Ka.map(a,function(a){return a.trigger})}},cp={create:bp},dp=dj.exactly(["compare","extract","mutate","sink"]),ep=dj.exactly(["element","start","stop","destroy"]),fp=dj.exactly(["forceDrop","drop","move","delayDrop"]),gp={mode:dp,sink:ep,api:fp},hp=vk.css("ephox-dragster"),ip={resolve:hp.resolve},jp=function(a,b,c,d,e,f,g){return{target:M.constant(a),x:M.constant(b),y:M.constant(c),stop:d,prevent:e,kill:f,raw:M.constant(g)}},kp=function(a,b){return function(c){if(a(c)){var d=kb.fromDom(c.target),e=function(){c.stopPropagation()},f=function(){c.preventDefault()},g=M.compose(f,e),h=jp(d,c.clientX,c.clientY,e,f,g,c);b(h)}}},lp=function(a,b,c,d,e){var f=kp(c,d);return a.dom().addEventListener(b,f,e),{unbind:M.curry(op,a,b,f,e)}},mp=function(a,b,c,d){return lp(a,b,c,d,!1)},np=function(a,b,c,d){return lp(a,b,c,d,!0)},op=function(a,b,c,d){a.dom().removeEventListener(b,c,d)},pp={bind:mp,capture:np},qp=M.constant(!0),rp=function(a,b,c){return pp.bind(a,b,qp,c)},sp=function(a,b,c){return pp.capture(a,b,qp,c)},tp={bind:rp,capture:sp},up=function(a,b){return Bi(b.left()-a.left(),b.top()-a.top())},vp=function(a){return T.some(Bi(a.x(),a.y()))},wp=function(a,b){a.mutate(b.left(),b.top())},xp=function(a,b){var c=l(b),d=tp.bind(c.element(),"mousedown",a.forceDrop),e=tp.bind(c.element(),"mouseup",a.drop),f=tp.bind(c.element(),"mousemove",a.move),g=tp.bind(c.element(),"mouseout",a.delayDrop),h=function(){c.destroy(),e.unbind(),f.unbind(),g.unbind(),d.unbind()},i=function(a){ef.append(a,c.element())},j=function(){of.remove(c.element())};return gp.sink({element:c.element,start:i,stop:j,destroy:h})},yp=gp.mode({compare:up,extract:vp,sink:xp,mutate:wp}),zp=function(a,b){var c=null,d=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null,d=null)},throttle:function(){d=arguments,null===c&&(c=setTimeout(function(){a.apply(null,d),c=null,d=null},b))}}},Ap=function(a,b){var c=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null)},throttle:function(){var d=arguments;null===c&&(c=setTimeout(function(){a.apply(null,d),c=null,d=null},b))}}},Bp=function(a,b){var c=null;return{cancel:function(){null!==c&&(clearTimeout(c),c=null)},throttle:function(){var d=arguments;null!==c&&clearTimeout(c),c=setTimeout(function(){a.apply(null,d),c=null,d=null},b)}}},Cp={adaptable:zp,first:Ap,last:Bp},Dp=function(a,b,c){var d=!1,e=cp.create({start:k([]),stop:k([])}),f=o(),g=function(){p.stop(),f.isOn()&&(f.off(),e.trigger.stop())},h=Cp.last(g,200),i=function(a){p.start(a),f.on(),e.trigger.start()},j=function(a,c){h.cancel(),f.onEvent(a,b)};f.events.move.bind(function(c){b.mutate(a,c.info())});var l=function(){d=!0},m=function(){d=!1},n=function(a){return function(){var b=Array.prototype.slice.call(arguments,0);if(d)return a.apply(null,b)}},p=b.sink(gp.api({forceDrop:g,drop:n(g),move:n(j),delayDrop:n(h.throttle)}),c),q=function(){p.destroy()};return{element:p.element,go:i,on:l,off:m,destroy:q,events:e.registry}},Ep={setup:Dp},Fp=function(a,b){var c=void 0!==b?b:{},d=void 0!==c.mode?c.mode:yp;return Ep.setup(a,d,b)},Gp={transform:Fp},Hp=function(a){return ie.first(a).isSome()},Ip=function(a,b,c){return ie.ancestor(a,b,c).isSome()},Jp=function(a,b){return ie.sibling(a,b).isSome()},Kp=function(a,b){return ie.child(a,b).isSome()},Lp=function(a,b){return ie.descendant(a,b).isSome()},Mp=function(a,b,c){return ie.closest(a,b,c).isSome()},Np={any:Hp,ancestor:Ip,sibling:Jp,child:Kp,descendant:Lp,closest:Mp},Op=xk.resolve("resizer-bar-dragging"),Pp=function(){var a=kb.fromTag("div");return Ze.setAll(a,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ef.append(Kd.body(),a),a},Qp=function(a,b){return a.inline?ap.body(pn(a),Pp()):ap.only(kb.fromDom(a.getDoc()))},Rp=function(a,b){a.inline&&of.remove(b.parent())},Sp={get:Qp,remove:Rp},Tp=function(a){var b,c,d=T.none(),e=T.none(),f=T.none(),h=/(\d+(\.\d+)?)%/,i=function(a){return"TABLE"===a.nodeName},j=function(b){return a.dom.getStyle(b,"width")||a.dom.getAttrib(b,"width")},k=function(){return e},l=function(){return f.getOr(ap.only(kb.fromDom(a.getBody())))},m=function(){e.each(function(a){a.destroy()}),f.each(function(b){Sp.remove(a,b)})};return a.on("init",function(){var b=g(Cn.directionAt),c=Sp.get(a);if(f=T.some(c),Wn(a)&&In(a)){var h=s(c,b);h.on(),h.events.startDrag.bind(function(b){d=T.some(a.selection.getRng())}),h.events.beforeResize.bind(function(b){var c=b.table().dom();$n(a,c,qn(c),rn(c))}),h.events.afterResize.bind(function(b){var c=b.table(),e=c.dom();vn(c),d.each(function(b){a.selection.setRng(b),a.focus()}),_n(a,e,qn(e),rn(e)),a.undoManager.add()}),e=T.some(h)}}),a.on("ObjectResizeStart",function(a){var d=a.target;i(d)&&(b=a.width,c=j(d))}),a.on("ObjectResized",function(d){var e=d.target;if(i(e)){var f=e;if(h.test(c)){var g=parseFloat(h.exec(c)[1]),j=d.width*g/b;a.dom.setStyle(f,"width",j+"%")}else{var k=[];eo.each(f.rows,function(b){eo.each(b.cells,function(b){var c=a.dom.getStyle(b,"width",!0);k.push({cell:b,width:c})})}),eo.each(k,function(b){a.dom.setStyle(b.cell,"width",b.width),a.dom.setAttrib(b.cell,"width",null)})}}}),{lazyResize:k,lazyWire:l,destroy:m}},Up=function(a){return Yp(function(b,c,d,e){return b(a)})},Vp=function(a){return Yp(function(b,c,d,e){return c(a)})},Wp=function(a,b){return Yp(function(c,d,e,f){return e(a,b)})},Xp=function(a){return Yp(function(b,c,d,e){return e(a)})},Yp=function(a){return{fold:a}},Zp={none:Up,first:Vp,middle:Wp,last:Xp},$p=function(a,b){return we.table(a,b).bind(function(b){var c=we.cells(b);return Aa.findIndex(c,function(b){return Qc.eq(a,b)}).map(function(a){return{index:M.constant(a),all:M.constant(c)}})})},_p=function(a,b){return $p(a,b).fold(function(){return Zp.none(a)},function(b){return b.index()+1<b.all().length?Zp.middle(a,b.all()[b.index()+1]):Zp.last(a)})},aq=function(a,b){return $p(a,b).fold(function(){return Zp.none()},function(b){return b.index()-1>=0?Zp.middle(a,b.all()[b.index()-1]):Zp.first(a)})},bq={next:_p,prev:aq},cq=ph.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),dq=function(a,b,c,d){return a.fold(b,c,d)},eq=function(a){return a.fold(M.identity,M.identity,M.identity)},fq={before:cq.before,on:cq.on,after:cq.after,cata:dq,getStart:eq},gq=ph.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),hq=Sa.immutable("start","soffset","finish","foffset"),iq=function(a){return gq.exact(a.start(),a.soffset(),a.finish(),a.foffset())},jq=function(a){return a.match({domRange:function(a){return kb.fromDom(a.startContainer)},relative:function(a,b){return fq.getStart(a)},exact:function(a,b,c,d){return a}})},kq=function(a){var b=jq(a);return jd.defaultView(b)},lq={domRange:gq.domRange,relative:gq.relative,exact:gq.exact,exactFromRange:iq,range:hq,getWin:kq},mq=function(a,b,c,d){var e=jd.owner(a),f=e.dom().createRange();return f.setStart(a.dom(),b),f.setEnd(c.dom(),d),f},nq=function(a,b,c,d){var e=mq(a,b,c,d);return kb.fromDom(e.commonAncestorContainer)},oq=function(a,b,c,d){var e=mq(a,b,c,d),f=Qc.eq(a,c)&&b===d;return e.collapsed&&!f},pq={after:oq,commonAncestorContainer:nq},qq=function(a,b){var c=b||document,d=c.createDocumentFragment();return Aa.each(a,function(a){d.appendChild(a.dom())}),kb.fromDom(d)},rq={fromElements:qq},sq=function(a,b){var c=a.document.createRange();return tq(c,b),c},tq=function(a,b){a.selectNodeContents(b.dom())},uq=function(a,b){return b.compareBoundaryPoints(a.END_TO_START,a)<1&&b.compareBoundaryPoints(a.START_TO_END,a)>-1},vq=function(a){return a.document.createRange()},wq=function(a,b){b.fold(function(b){a.setStartBefore(b.dom())},function(b,c){a.setStart(b.dom(),c)},function(b){a.setStartAfter(b.dom())})},xq=function(a,b){b.fold(function(b){a.setEndBefore(b.dom())},function(b,c){a.setEnd(b.dom(),c)},function(b){a.setEndAfter(b.dom())})},yq=function(a,b){Bq(a),a.insertNode(b.dom())},zq=function(a,b,c){var d=a.document.createRange();return wq(d,b),xq(d,c),d},Aq=function(a,b,c,d,e){var f=a.document.createRange();return f.setStart(b.dom(),c),f.setEnd(d.dom(),e),f},Bq=function(a){a.deleteContents()},Cq=function(a){var b=a.cloneContents();return kb.fromDom(b)},Dq=function(a){return{left:M.constant(a.left),top:M.constant(a.top),right:M.constant(a.right),bottom:M.constant(a.bottom),width:M.constant(a.width),height:M.constant(a.height)}},Eq=function(a){var b=a.getClientRects(),c=b.length>0?b[0]:a.getBoundingClientRect();return c.width>0||c.height>0?T.some(c).map(Dq):T.none()},Fq=function(a){var b=a.getBoundingClientRect();return b.width>0||b.height>0?T.some(b).map(Dq):T.none()},Gq=function(a){return a.toString()},Hq={create:vq,replaceWith:yq,selectNodeContents:sq,selectNodeContentsUsing:tq,relativeToNative:zq,exactToNative:Aq,deleteContents:Bq,cloneFragment:Cq,getFirstRect:Eq,getBounds:Fq,isWithin:uq,toString:Gq},Iq=ph.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Jq=function(a,b,c){return b(kb.fromDom(c.startContainer),c.startOffset,kb.fromDom(c.endContainer),c.endOffset)},Kq=function(a,b){return b.match({domRange:function(a){return{ltr:M.constant(a),rtl:T.none}},relative:function(b,c){return{ltr:Lb.cached(function(){return Hq.relativeToNative(a,b,c)}),rtl:Lb.cached(function(){return T.some(Hq.relativeToNative(a,c,b))})}},exact:function(b,c,d,e){return{ltr:Lb.cached(function(){return Hq.exactToNative(a,b,c,d,e)}),rtl:Lb.cached(function(){return T.some(Hq.exactToNative(a,d,e,b,c))})}}})},Lq=function(a,b){var c=b.ltr();if(c.collapsed){return b.rtl().filter(function(a){return!1===a.collapsed}).map(function(a){return Iq.rtl(kb.fromDom(a.endContainer),a.endOffset,kb.fromDom(a.startContainer),a.startOffset)}).getOrThunk(function(){return Jq(0,Iq.ltr,c)})}return Jq(0,Iq.ltr,c)},Mq=function(a,b){var c=Kq(a,b);return Lq(0,c)},Nq=function(a,b){return Mq(a,b).match({ltr:function(b,c,d,e){var f=a.document.createRange();return f.setStart(b.dom(),c),f.setEnd(d.dom(),e),f},rtl:function(b,c,d,e){var f=a.document.createRange();return f.setStart(d.dom(),e),f.setEnd(b.dom(),c),f}})},Oq={ltr:Iq.ltr,rtl:Iq.rtl,diagnose:Mq,asLtrRange:Nq},Pq=function(a,b,c,d,e){if(0===e)return 0;if(b===d)return e-1;for(var f=d,g=1;g<e;g++){var h=a(g),i=Math.abs(b-h.left);if(c>h.bottom);else{if(c<h.top||i>f)return g-1;f=i}}return 0},Qq=function(a,b,c){return b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom},Rq={inRect:Qq,searchForPoint:Pq},Sq=function(a,b,c,d,e){var f=function(c){var d=a.dom().createRange();return d.setStart(b.dom(),c),d.collapse(!0),d},g=function(a){return f(a).getBoundingClientRect()},h=Hf.get(b).length,i=Rq.searchForPoint(g,c,d,e.right,h);return f(i)},Tq=function(a,b,c,d){var e=a.dom().createRange();e.selectNode(b.dom());var f=e.getClientRects();return Pj.findMap(f,function(a){return Rq.inRect(a,c,d)?T.some(a):T.none()}).map(function(e){return Sq(a,b,c,d,e)})},Uq={locate:Tq},Vq=function(a,b,c,d){var e=a.dom().createRange(),f=jd.children(b);return Pj.findMap(f,function(b){return e.selectNode(b.dom()),Rq.inRect(e.getBoundingClientRect(),c,d)?Wq(a,b,c,d):T.none()})},Wq=function(a,b,c,d){return(vd.isText(b)?Uq.locate:Vq)(a,b,c,d)},Xq=function(a,b,c,d){var e=a.dom().createRange();e.selectNode(b.dom());var f=e.getBoundingClientRect(),g=Math.max(f.left,Math.min(f.right,c)),h=Math.max(f.top,Math.min(f.bottom,d));return Wq(a,b,g,h)},Yq={locate:Xq},Zq=function(a,b){return b-a.left<a.right-b},$q=function(a,b,c){var d=a.dom().createRange();return d.selectNode(b.dom()),d.collapse(c),d},_q=function(a,b,c){var d=a.dom().createRange();d.selectNode(b.dom());var e=d.getBoundingClientRect(),f=Zq(e,c);return(!0===f?Sf.first:Sf.last)(b).map(function(b){return $q(a,b,f)})},ar=function(a,b,c){var d=b.dom().getBoundingClientRect(),e=Zq(d,c);return T.some($q(a,b,e))},br=function(a,b,c){return(0===jd.children(b).length?ar:_q)(a,b,c)},cr={search:br},dr=function(a,b,c){return T.from(a.dom().caretPositionFromPoint(b,c)).bind(function(b){if(null===b.offsetNode)return T.none();var c=a.dom().createRange();return c.setStart(b.offsetNode,b.offset),c.collapse(),T.some(c)})},er=function(a,b,c){return T.from(a.dom().caretRangeFromPoint(b,c))},fr=function(a,b,c,d){var e=a.dom().createRange();e.selectNode(b.dom());var f=e.getBoundingClientRect(),g=Math.max(f.left,Math.min(f.right,c)),h=Math.max(f.top,Math.min(f.bottom,d));return Yq.locate(a,b,g,h)},gr=function(a,b,c){return kb.fromPoint(a,b,c).bind(function(d){var e=function(){return cr.search(a,d,b)};return 0===jd.children(d).length?e():fr(a,d,b,c).orThunk(e)})},hr=document.caretPositionFromPoint?dr:document.caretRangeFromPoint?er:gr,ir=function(a,b,c){var d=kb.fromDom(a.document);return hr(d,b,c).map(function(a){return lq.range(kb.fromDom(a.startContainer),a.startOffset,kb.fromDom(a.endContainer),a.endOffset)})},jr={fromPoint:ir},kr=function(a,b,c,d){var e=Hq.create(a),f=sb.is(b,d)?[b]:[],g=f.concat(Wd.descendants(b,d));return Aa.filter(g,function(a){return Hq.selectNodeContentsUsing(e,a),Hq.isWithin(c,e)})},lr=function(a,b,c){var d=Oq.asLtrRange(a,b),e=kb.fromDom(d.commonAncestorContainer);return vd.isElement(e)?kr(a,e,d,c):[]},mr={find:lr},nr=function(a,b){var c=vd.name(a);return"input"===c?fq.after(a):Aa.contains(["br","img"],c)?0===b?fq.before(a):fq.after(a):fq.on(a,b)},or=function(a,b){var c=a.fold(fq.before,nr,fq.after),d=b.fold(fq.before,nr,fq.after);return lq.relative(c,d)},pr=function(a,b,c,d){var e=nr(a,b),f=nr(c,d);return lq.relative(e,f)},qr=function(a){return a.match({domRange:function(a){var b=kb.fromDom(a.startContainer),c=kb.fromDom(a.endContainer);return pr(b,a.startOffset,c,a.endOffset)},relative:or,exact:pr})},rr={beforeSpecial:nr,preprocess:qr,preprocessRelative:or,preprocessExact:pr},sr=function(a,b){T.from(a.getSelection()).each(function(a){a.removeAllRanges(),a.addRange(b)})},tr=function(a,b,c,d,e){var f=Hq.exactToNative(a,b,c,d,e);sr(a,f)},ur=function(a,b,c){return mr.find(a,b,c)},vr=function(a,b){return Oq.diagnose(a,b).match({ltr:function(b,c,d,e){tr(a,b,c,d,e)},rtl:function(b,c,d,e){var f=a.getSelection();f.setBaseAndExtent?f.setBaseAndExtent(b.dom(),c,d.dom(),e):f.extend?(f.collapse(b.dom(),c),f.extend(d.dom(),e)):tr(a,d,e,b,c)}})},wr=function(a,b,c,d,e){var f=rr.preprocessExact(b,c,d,e);vr(a,f)},xr=function(a,b,c){var d=rr.preprocessRelative(b,c);vr(a,d)},yr=function(a){var b=lq.getWin(a).dom(),c=function(a,c,d,e){return Hq.exactToNative(b,a,c,d,e)},d=rr.preprocess(a);return Oq.diagnose(b,d).match({ltr:c,rtl:c})},zr=function(a){if(a.rangeCount>0){var b=a.getRangeAt(0),c=a.getRangeAt(a.rangeCount-1);return T.some(lq.range(kb.fromDom(b.startContainer),b.startOffset,kb.fromDom(c.endContainer),c.endOffset))}return T.none()},Ar=function(a){var b=kb.fromDom(a.anchorNode),c=kb.fromDom(a.focusNode);return pq.after(b,a.anchorOffset,c,a.focusOffset)?T.some(lq.range(kb.fromDom(a.anchorNode),a.anchorOffset,kb.fromDom(a.focusNode),a.focusOffset)):zr(a)},Br=function(a,b){var c=Hq.selectNodeContents(a,b);sr(a,c)},Cr=function(a,b){var c=Hq.selectNodeContents(a,b);return lq.range(kb.fromDom(c.startContainer),c.startOffset,kb.fromDom(c.endContainer),c.endOffset)},Dr=function(a){return T.from(a.getSelection()).filter(function(a){return a.rangeCount>0}).bind(Ar)},Er=function(a){return Dr(a).map(function(a){return lq.exact(a.start(),a.soffset(),a.finish(),a.foffset())})},Fr=function(a,b){var c=Oq.asLtrRange(a,b);return Hq.getFirstRect(c)},Gr=function(a,b){var c=Oq.asLtrRange(a,b);return Hq.getBounds(c)},Hr=function(a,b,c){return jr.fromPoint(a,b,c)},Ir=function(a,b){var c=Oq.asLtrRange(a,b);return Hq.toString(c)},Jr=function(a){a.getSelection().removeAllRanges()},Kr=function(a,b){var c=Oq.asLtrRange(a,b);return Hq.cloneFragment(c)},Lr=function(a,b,c){var d=Oq.asLtrRange(a,b),e=rq.fromElements(c,a.document);Hq.replaceWith(d,e)},Mr=function(a,b){var c=Oq.asLtrRange(a,b);Hq.deleteContents(c)},Nr=function(a,b,c,d){return Qc.eq(a,c)&&b===d},Or={setExact:wr,getExact:Dr,get:Er,setRelative:xr,toNative:yr,setToElement:Br,clear:Jr,clone:Kr,replace:Lr,deleteAt:Mr,forElement:Cr,getFirstRect:Fr,getBounds:Gr,getAtPoint:Hr,findWithin:ur,getAsString:Ir,isCollapsed:Nr},Pr=tinymce.util.Tools.resolve("tinymce.util.VK"),Qr=function(a,b,c,d){return Ur(a,b,bq.next(c),d)},Rr=function(a,b,c,d){return Ur(a,b,bq.prev(c),d)},Sr=function(a,b){var c=lq.exact(b,0,b,0);return Or.toNative(c)},Tr=function(a,b){var c=Wd.descendants(b,"tr");return Aa.last(c).bind(function(a){return ie.descendant(a,"td,th").map(function(a){return Sr(0,a)})})},Ur=function(a,b,c,d,e){return c.fold(T.none,T.none,function(a,b){return Sf.first(b).map(function(a){return Sr(0,a)})},function(c){return we.table(c,b).bind(function(b){var e=Ch.noMenu(c);return a.undoManager.transact(function(){d.insertRowsAfter(b,e)}),Tr(0,b)})})},Vr=["table","li","dl"],Wr=function(a,b,c,d){if(a.keyCode===Pr.TAB){var e=pn(b),f=function(a){var b=vd.name(a);return Qc.eq(a,e)||Aa.contains(Vr,b)},g=b.selection.getRng();if(g.collapsed){var h=kb.fromDom(g.startContainer);we.cell(h,f).each(function(e){a.preventDefault(),(a.shiftKey?Rr:Qr)(b,f,e,c,d).each(function(a){b.selection.setRng(a)})})}}},Xr={handle:Wr},Yr=Sa.immutable("selection","kill"),Zr={response:Yr},$r=function(a){return function(b){return b===a}},_r=$r(38),as=$r(40),bs=function(a){return a>=37&&a<=40},cs={ltr:{isBackward:$r(37),isForward:$r(39)},rtl:{isBackward:$r(39),isForward:$r(37)},isUp:_r,isDown:as,isNavigation:bs},ds=function(a,b){var c=Oq.asLtrRange(a,b);return{start:M.constant(kb.fromDom(c.startContainer)),soffset:M.constant(c.startOffset),finish:M.constant(kb.fromDom(c.endContainer)),foffset:M.constant(c.endOffset)}},es=function(a,b,c,d){return{start:M.constant(fq.on(a,b)),finish:M.constant(fq.on(c,d))}},fs={convertToRange:ds,makeSitus:es},gs=Ic.detect().browser.isSafari(),hs=function(a){var b=void 0!==a?a.dom():document,c=b.body.scrollLeft||b.documentElement.scrollLeft,d=b.body.scrollTop||b.documentElement.scrollTop;return Bi(c,d)},is=function(a,b,c){(void 0!==c?c.dom():document).defaultView.scrollTo(a,b)},js=function(a,b,c){(void 0!==c?c.dom():document).defaultView.scrollBy(a,b)},ks=function(a,b){var c=Hi.absolute(b),d=kb.fromDom(a.document);is(c.left(),c.top(),d)},ls=function(a,b){var c=hs(a);b();var d=hs(a);c.top()===d.top()&&c.left()===d.left()||is(c.left(),c.top(),a)},ms=function(a){var b=T.none(),c=function(){b=T.some(hs(a))},d=function(){b.each(function(b){is(b.left(),b.top(),a)})};return c(),{save:c,restore:d}},ns=function(a,b){gs&&W.isFunction(a.dom().scrollIntoViewIfNeeded)?a.dom().scrollIntoViewIfNeeded(!1):a.dom().scrollIntoView(b)},os=function(a,b){var c=b.dom().getBoundingClientRect(),d=a.dom().getBoundingClientRect();d.top<c.top?ns(a,!0):d.bottom>c.bottom&&ns(a,!1)},ps=function(){var a=kb.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');ef.after(Kd.body(),a);var b=a.dom().offsetWidth-a.dom().clientWidth;return of.remove(a),b},qs={get:hs,to:is,by:js,preserve:ls,capture:ms,intoView:ns,intoViewIfNeeded:os,setToElement:ks,scrollBarWidth:ps},rs=function(a,b,c,d,e,f,g){return Qc.eq(c,e)&&d===f?T.none():ie.closest(c,"td,th",b).bind(function(c){return ie.closest(e,"td,th",b).bind(function(d){return ss(a,b,c,d,g)})})},ss=function(a,b,c,d,e){return Qc.eq(c,d)?T.none():ih.identify(c,d,b).bind(function(b){var d=b.boxes().getOr([]);return d.length>0?(e(a,d,b.start(),b.finish()),T.some(Zr.response(T.some(fs.makeSitus(c,0,c,Of.getEnd(c))),!0))):T.none()})},ts=function(a,b,c,d,e){var f=function(a){return e.clear(c),e.selectRange(c,a.boxes(),a.start(),a.finish()),a.boxes()};return ih.shiftSelection(d,a,b,e.firstSelectedSelector(),e.lastSelectedSelector()).map(f)},us={sync:rs,detect:ss,update:ts},vs=Sa.immutableBag(["left","top","right","bottom"],[]),ws=function(a,b){return vs({left:a.left(),top:a.top()+b,right:a.right(),bottom:a.bottom()+b})},xs=function(a,b){return vs({left:a.left(),top:a.top()-b,right:a.right(),bottom:a.bottom()-b})},ys=function(a,b){var c=a.bottom()-a.top();return vs({left:a.left(),top:b-c,right:a.right(),bottom:b})},zs=function(a,b){var c=a.bottom()-a.top();return vs({left:a.left(),top:b,right:a.right(),bottom:b+c})},As=function(a,b,c){return vs({left:a.left()+b,top:a.top()+c,right:a.right()+b,bottom:a.bottom()+c})},Bs=function(a){return a.top()},Cs=function(a){return a.bottom()},Ds=function(a){return"("+a.left()+", "+a.top()+") -> ("+a.right()+", "+a.bottom()+")"},Es={nu:vs,moveUp:xs,moveDown:ws,moveBottomTo:ys,moveTopTo:zs,getTop:Bs,getBottom:Cs,translate:As,toString:Ds},Fs=function(a,b,c){return c>=0&&c<Of.getEnd(b)?a.getRangedRect(b,c,b,c+1):c>0?a.getRangedRect(b,c-1,b,c):T.none()},Gs=function(a){return Es.nu({left:a.left,top:a.top,right:a.right,bottom:a.bottom})},Hs=function(a,b){return T.some(a.getRect(b))},Is=function(a,b,c){return vd.isElement(b)?Hs(a,b).map(Gs):vd.isText(b)?Fs(a,b,c).map(Gs):T.none()},Js=function(a,b){return vd.isElement(b)?Hs(a,b).map(Gs):vd.isText(b)?a.getRangedRect(b,0,b,Of.getEnd(b)).map(Gs):T.none()},Ks={getBoxAt:Is,getEntireBox:Js},Ls=Sa.immutable("item","mode"),Ms=function(a,b,c,d){var e=void 0!==d?d:Ns;return a.property().parent(b).map(function(a){return Ls(a,e)})
},Ns=function(a,b,c,d){var e=void 0!==d?d:Os;return c.sibling(a,b).map(function(a){return Ls(a,e)})},Os=function(a,b,c,d){var e=void 0!==d?d:Os,f=a.property().children(b);return c.first(f).map(function(a){return Ls(a,e)})},Ps=[{current:Ms,next:Ns,fallback:T.none()},{current:Ns,next:Os,fallback:T.some(Ms)},{current:Os,next:Os,fallback:T.some(Ns)}],Qs=function(a,b,c,d,e){var e=void 0!==e?e:Ps;return Aa.find(e,function(a){return a.current===c}).bind(function(c){return c.current(a,b,d,c.next).orThunk(function(){return c.fallback.bind(function(c){return Qs(a,b,c,d)})})})},Rs={backtrack:Ms,sidestep:Ns,advance:Os,go:Qs},Ss=function(){return{sibling:function(a,b){return a.query().prevSibling(b)},first:function(a){return a.length>0?T.some(a[a.length-1]):T.none()}}},Ts=function(){return{sibling:function(a,b){return a.query().nextSibling(b)},first:function(a){return a.length>0?T.some(a[0]):T.none()}}},Us={left:Ss,right:Ts},Vs=function(a,b,c,d,e,f){return Rs.go(a,b,d,e).bind(function(b){return f(b.item())?T.none():c(b.item())?T.some(b.item()):Vs(a,b.item(),c,b.mode(),e,f)})},Ws=function(a,b,c,d){return Vs(a,b,c,Rs.sidestep,Us.left(),d)},Xs=function(a,b,c,d){return Vs(a,b,c,Rs.sidestep,Us.right(),d)},Ys={left:Ws,right:Xs},Zs=function(a,b){return 0===a.property().children(b).length},$s=function(a,b,c){return at(a,b,M.curry(Zs,a),c)},_s=function(a,b,c){return bt(a,b,M.curry(Zs,a),c)},at=function(a,b,c,d){return Ys.left(a,b,c,d)},bt=function(a,b,c,d){return Ys.right(a,b,c,d)},ct=function(){return{left:Us.left,right:Us.right}},dt=function(a,b,c,d,e){return Rs.go(a,b,c,d,e)},et={before:$s,after:_s,seekLeft:at,seekRight:bt,walkers:ct,walk:dt,backtrack:Rs.backtrack,sidestep:Rs.sidestep,advance:Rs.advance},ft=e(),gt=function(a,b,c){return et.gather(ft,a,b,c)},ht=function(a,b){return et.before(ft,a,b)},it=function(a,b){return et.after(ft,a,b)},jt=function(a,b,c){return et.seekLeft(ft,a,b,c)},kt=function(a,b,c){return et.seekRight(ft,a,b,c)},lt=function(){return et.walkers()},mt=function(a,b,c,d){return et.walk(ft,a,b,c,d)},nt={gather:gt,before:ht,after:it,seekLeft:jt,seekRight:kt,walkers:lt,walk:mt},ot=ph.generate([{none:[]},{retry:["caret"]}]),pt=function(a,b){return a.left()<b.left()||Math.abs(b.right()-a.left())<1||a.left()>b.right()},qt=function(a,b,c){return be.closest(b,Dj.isBlock).fold(M.constant(!1),function(b){return Ks.getEntireBox(a,b).exists(function(a){return pt(c,a)})})},rt=function(a,b,c,d,e){var f=Es.moveDown(e,5);return Math.abs(c.bottom()-d.bottom())<1?ot.retry(f):c.top()>e.bottom()?ot.retry(f):c.top()===e.bottom()?ot.retry(Es.moveDown(e,1)):qt(a,b,e)?ot.retry(Es.translate(f,5,0)):ot.none()},st=function(a,b,c,d,e){var f=Es.moveUp(e,5);return Math.abs(c.top()-d.top())<1?ot.retry(f):c.bottom()<e.top()?ot.retry(f):c.bottom()===e.top()?ot.retry(Es.moveUp(e,1)):qt(a,b,e)?ot.retry(Es.translate(f,5,0)):ot.none()},tt={point:Es.getTop,adjuster:st,move:Es.moveUp,gather:nt.before},ut={point:Es.getBottom,adjuster:rt,move:Es.moveDown,gather:nt.after},vt=function(a,b,c){return a.elementFromPoint(b,c).filter(function(a){return"table"===vd.name(a)}).isSome()},wt=function(a,b,c,d,e){return xt(a,b,c,b.move(d,5),e)},xt=function(a,b,c,d,e){return 0===e?T.some(d):vt(a,d.left(),b.point(d))?wt(a,b,c,d,e-1):a.situsFromPoint(d.left(),b.point(d)).bind(function(f){return f.start().fold(T.none,function(f,g){return Ks.getEntireBox(a,f,g).bind(function(g){return b.adjuster(a,f,g,c,d).fold(T.none,function(d){return xt(a,b,c,d,e-1)})}).orThunk(function(){return T.some(d)})},T.none)})},yt=function(a,b){return a.situsFromPoint(b.left(),b.bottom()+5)},zt=function(a,b){return a.situsFromPoint(b.left(),b.top()-5)},At=function(a,b,c){return a.point(b)>c.getInnerHeight()?T.some(a.point(b)-c.getInnerHeight()):a.point(b)<0?T.some(-a.point(b)):T.none()},Bt=function(a,b,c){var d=a.move(c,5),e=xt(b,a,c,d,100).getOr(d);return At(a,e,b).fold(function(){return b.situsFromPoint(e.left(),a.point(e))},function(c){return b.scrollBy(0,c),b.situsFromPoint(e.left(),a.point(e)-c)})},Ct={tryUp:M.curry(Bt,tt),tryDown:M.curry(Bt,ut),ieTryUp:zt,ieTryDown:yt,getJumpSize:M.constant(5)},Dt=ph.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Et=function(a,b,c){var d=a.getRect(b),e=a.getRect(c);return e.right>d.left&&e.left<d.right},Ft=function(a,b,c,d,e,f,g){return ie.closest(d,"td,th",g).bind(function(c){return ie.closest(b,"td,th",g).map(function(b){return Qc.eq(c,b)?Qc.eq(d,c)&&Of.getEnd(c)===e?f(b):Dt.none("in same cell"):Jg.sharedOne(Gt,[c,b]).fold(function(){return Et(a,b,c)?Dt.success():f(b)},function(a){return f(b)})})}).getOr(Dt.none("default"))},Gt=function(a){return ie.closest(a,"tr")},Ht=function(a,b,c,d,e){return a.fold(b,c,d,e)},It={verify:Ft,cata:Ht,adt:Dt},Jt=Sa.immutable("element","offset"),Kt=Sa.immutable("element","deltaOffset"),Lt=Sa.immutable("element","start","finish"),Mt=Sa.immutable("begin","end"),Nt=Sa.immutable("element","text"),Ot={point:Jt,delta:Kt,range:Lt,points:Mt,text:Nt},Pt=Sa.immutable("ancestor","descendants","element","index"),Qt=Sa.immutable("parent","children","element","index"),Rt=function(a,b){return be.closest(a,function(a){return jd.parent(a).exists(function(a){return Qc.eq(a,b)})})},St=function(a){return jd.parent(a).bind(function(b){var c=jd.children(b);return Tt(c,a).map(function(d){return Qt(b,c,a,d)})})},Tt=function(a,b){return Aa.findIndex(a,M.curry(Qc.eq,b))},Ut=function(a,b){return jd.parent(a).bind(function(c){var d=Wd.children(c,b);return Tt(d,a).map(function(b){return Qt(c,d,a,b)})})},Vt=function(a,b,c){return ie.closest(a,b).bind(function(b){var d=Wd.descendants(b,c);return Tt(d,a).map(function(c){return Pt(b,d,a,c)})})},Wt={childOf:Rt,indexOf:Tt,indexInParent:St,selectorsInParent:Ut,descendantsInAncestor:Vt},Xt=function(a){return"br"===vd.name(a)},Yt=function(a,b,c){return b(a,c).bind(function(a){return vd.isText(a)&&0===Hf.get(a).trim().length?Yt(a,b,c):T.some(a)})},Zt=function(a,b,c){return c.traverse(b).orThunk(function(){return Yt(b,c.gather,a)}).map(c.relative)},$t=function(a,b){return jd.child(a,b).filter(Xt).orThunk(function(){return jd.child(a,b-1).filter(Xt)})},_t=function(a,b,c,d){return $t(b,c).bind(function(b){return d.traverse(b).fold(function(){return Yt(b,d.gather,a).map(d.relative)},function(a){return Wt.indexInParent(a).map(function(a){return fq.on(a.parent(),a.index())})})})},au=function(a,b,c,d){return(Xt(b)?Zt(a,b,d):_t(a,b,c,d)).map(function(a){return{start:M.constant(a),finish:M.constant(a)}})},bu=function(a){return It.cata(a,function(a){return T.none()},function(){return T.none()},function(a){return T.some(Ot.point(a,0))},function(a){return T.some(Ot.point(a,Of.getEnd(a)))})},cu={tryBr:au,process:bu},du=Ic.detect(),eu=function(a,b,c){return a.getSelection().bind(function(d){return cu.tryBr(b,d.finish(),d.foffset(),c).fold(function(){return T.some(Ot.point(d.finish(),d.foffset()))},function(e){var f=a.fromSitus(e),g=It.verify(a,d.finish(),d.foffset(),f.finish(),f.foffset(),c.failure,b);return cu.process(g)})})},fu=function(a,b,c,d,e,f){return 0===f?T.none():iu(a,b,c,d,e).bind(function(g){var h=a.fromSitus(g),i=It.verify(a,c,d,h.finish(),h.foffset(),e.failure,b);return It.cata(i,function(){return T.none()},function(){return T.some(g)},function(g){return Qc.eq(c,g)&&0===d?gu(a,c,d,Es.moveUp,e):fu(a,b,g,0,e,f-1)},function(g){return Qc.eq(c,g)&&d===Of.getEnd(g)?gu(a,c,d,Es.moveDown,e):fu(a,b,g,Of.getEnd(g),e,f-1)})})},gu=function(a,b,c,d,e){return Ks.getBoxAt(a,b,c).bind(function(b){return hu(a,e,d(b,Ct.getJumpSize()))})},hu=function(a,b,c){return du.browser.isChrome()||du.browser.isSafari()||du.browser.isFirefox()||du.browser.isEdge()?b.otherRetry(a,c):du.browser.isIE()?b.ieRetry(a,c):T.none()},iu=function(a,b,c,d,e){return Ks.getBoxAt(a,c,d).bind(function(b){return hu(a,e,b)})},ju=function(a,b,c){return eu(a,b,c).bind(function(d){return fu(a,b,d.element(),d.offset(),c,20).map(a.fromSitus)})},ku={handle:ju},lu=function(a){return be.first(a).isSome()},mu=function(a,b,c){return be.ancestor(a,b,c).isSome()},nu=function(a,b,c){return be.closest(a,b,c).isSome()},ou=function(a,b){return be.sibling(a,b).isSome()},pu=function(a,b){return be.child(a,b).isSome()},qu=function(a,b){return be.descendant(a,b).isSome()},ru={any:lu,ancestor:mu,closest:nu,sibling:ou,child:pu,descendant:qu},su=Ic.detect(),tu=function(a,b){return ru.ancestor(a,function(a){return jd.parent(a).exists(function(a){return Qc.eq(a,b)})})},uu=function(a,b,c,d,e){return ie.closest(d,"td,th",b).bind(function(d){return ie.closest(d,"table",b).bind(function(f){return tu(e,f)?ku.handle(a,b,c).bind(function(a){return ie.closest(a.finish(),"td,th",b).map(function(b){return{start:M.constant(d),finish:M.constant(b),range:M.constant(a)}})}):T.none()})})},vu=function(a,b,c,d,e,f){return su.browser.isIE()?T.none():f(d,b).orThunk(function(){return uu(a,b,c,d,e).map(function(a){var b=a.range();return Zr.response(T.some(fs.makeSitus(b.start(),b.soffset(),b.finish(),b.foffset())),!0)})})},wu=function(a,b){return ie.closest(a,"tr",b).bind(function(a){return ie.closest(a,"table",b).bind(function(c){var d=Wd.descendants(c,"tr");return Qc.eq(a,d[0])?nt.seekLeft(c,function(a){return Sf.last(a).isSome()},b).map(function(a){var b=Of.getEnd(a);return Zr.response(T.some(fs.makeSitus(a,b,a,b)),!0)}):T.none()})})},xu=function(a,b){return ie.closest(a,"tr",b).bind(function(a){return ie.closest(a,"table",b).bind(function(c){var d=Wd.descendants(c,"tr");return Qc.eq(a,d[d.length-1])?nt.seekRight(c,function(a){return Sf.first(a).isSome()},b).map(function(a){return Zr.response(T.some(fs.makeSitus(a,0,a,0)),!0)}):T.none()})})},yu=function(a,b,c,d,e,f,g){return uu(a,c,d,e,f).bind(function(a){return us.detect(b,c,a.start(),a.finish(),g)})},zu={navigate:vu,select:yu,firstUpCheck:wu,lastDownCheck:xu},Au=function(a,b){return ie.closest(a,"td,th",b)},Bu={down:{traverse:jd.nextSibling,gather:nt.after,relative:fq.before,otherRetry:Ct.tryDown,ieRetry:Ct.ieTryDown,failure:It.adt.failedDown},up:{traverse:jd.prevSibling,gather:nt.before,relative:fq.before,otherRetry:Ct.tryUp,ieRetry:Ct.ieTryUp,failure:It.adt.failedUp}},Cu=Sa.immutable("rows","cols"),Du=function(a,b,c,d){var e=t(a),f=u(e,b,c,d);return{mousedown:f.mousedown,mouseover:f.mouseover,mouseup:f.mouseup}},Eu=function(a,b,c,d){var e=t(a),f=function(){return d.clear(b),T.none()};return{keydown:function(a,g,h,i,j,k){var l=a.raw().which,m=!0===a.raw().shiftKey;return ih.retrieve(b,d.selectedSelector()).fold(function(){return cs.isDown(l)&&m?M.curry(zu.select,e,b,c,Bu.down,i,g,d.selectRange):cs.isUp(l)&&m?M.curry(zu.select,e,b,c,Bu.up,i,g,d.selectRange):cs.isDown(l)?M.curry(zu.navigate,e,c,Bu.down,i,g,zu.lastDownCheck):cs.isUp(l)?M.curry(zu.navigate,e,c,Bu.up,i,g,zu.firstUpCheck):T.none},function(a){var c=function(c){return function(){return Pj.findMap(c,function(c){return us.update(c.rows(),c.cols(),b,a,d)}).fold(function(){return ih.getEdges(b,d.firstSelectedSelector(),d.lastSelectedSelector()).map(function(a){var c=cs.isDown(l)||k.isForward(l)?fq.after:fq.before;return e.setRelativeSelection(fq.on(a.first(),0),c(a.table())),d.clear(b),Zr.response(T.none(),!0)})},function(a){return T.some(Zr.response(T.none(),!0))})}};return cs.isDown(l)&&m?c([Cu(1,0)]):cs.isUp(l)&&m?c([Cu(-1,0)]):k.isBackward(l)&&m?c([Cu(0,-1),Cu(-1,0)]):k.isForward(l)&&m?c([Cu(0,1),Cu(1,0)]):cs.isNavigation(l)&&!1===m?f:T.none})()},keyup:function(a,e,f,g,h){return ih.retrieve(b,d.selectedSelector()).fold(function(){var i=a.raw().which;return 0==(!0===a.raw().shiftKey)?T.none():cs.isNavigation(i)?us.sync(b,c,e,f,g,h,d.selectRange):T.none()},T.none)}}},Fu={mouse:Du,keyboard:Eu},Gu=function(a,b){Aa.each(b,function(b){Ok.add(a,b)})},Hu=function(a,b){Aa.each(b,function(b){Ok.remove(a,b)})},Iu=function(a,b){Aa.each(b,function(b){Ok.toggle(a,b)})},Ju=function(a,b){return Aa.forall(b,function(b){return Ok.has(a,b)})},Ku=function(a,b){return Aa.exists(b,function(b){return Ok.has(a,b)})},Lu=function(a){for(var b=a.dom().classList,c=new Array(b.length),d=0;d<b.length;d++)c[d]=b.item(d);return c},Mu=function(a){return Hk.supports(a)?Lu(a):Hk.get(a)},Nu={add:Gu,remove:Hu,toggle:Iu,hasAll:Ju,hasAny:Ku,get:Mu},Ou=function(a){return function(b){Ok.add(b,a)}},Pu=function(a){return function(b){Ok.remove(b,a)}},Qu=function(a){return function(b){Nu.remove(b,a)}},Ru=function(a){return function(b){return Ok.has(b,a)}},Su={addClass:Ou,removeClass:Pu,removeClasses:Qu,hasClass:Ru},Tu=function(a){var b=Su.addClass(a.selected()),c=Su.removeClasses([a.selected(),a.lastSelected(),a.firstSelected()]),d=function(b){var d=Wd.descendants(b,a.selectedSelector());Aa.each(d,c)};return{clear:d,selectRange:function(c,e,f,g){d(c),Aa.each(e,b),Ok.add(f,a.firstSelected()),Ok.add(g,a.lastSelected())},selectedSelector:a.selectedSelector,firstSelectedSelector:a.firstSelectedSelector,lastSelectedSelector:a.lastSelectedSelector}},Uu=function(a){var b=function(b){Gd.remove(b,a.selected()),Gd.remove(b,a.firstSelected()),Gd.remove(b,a.lastSelected())},c=function(b){Gd.set(b,a.selected(),"1")},d=function(c){var d=Wd.descendants(c,a.selectedSelector());Aa.each(d,b)};return{clear:d,selectRange:function(b,e,f,g){d(b),Aa.each(e,c),Gd.set(f,a.firstSelected(),"1"),Gd.set(g,a.lastSelected(),"1")},selectedSelector:a.selectedSelector,firstSelectedSelector:a.firstSelectedSelector,lastSelectedSelector:a.lastSelectedSelector}},Vu={byClass:Tu,byAttr:Uu},Wu=function(a){return!1===Ok.has(kb.fromDom(a.target),"ephox-snooker-resizer-bar")},Xu=function(a){return{get:function(){var b=pn(a);return lh.retrieve(b,nh.selectedSelector()).fold(function(){return void 0===a.selection.getStart()?sh.none():sh.single(a.selection)},function(a){return sh.multiple(a)})}}},Yu=eo.each,Zu=function(a){function b(b){return function(){a.execCommand(b)}}var c=[];Yu("inserttable tableprops deletetable | cell row column".split(" "),function(b){"|"===b?c.push({text:"-"}):c.push(a.menuItems[b])}),a.addButton("table",{type:"menubutton",title:"Table",menu:c}),a.addButton("tableprops",{title:"Table properties",onclick:b("mceTableProps"),icon:"table"}),a.addButton("tabledelete",{title:"Delete table",onclick:b("mceTableDelete")}),a.addButton("tablecellprops",{title:"Cell properties",onclick:b("mceTableCellProps")}),a.addButton("tablemergecells",{title:"Merge cells",onclick:b("mceTableMergeCells")}),a.addButton("tablesplitcells",{title:"Split cell",onclick:b("mceTableSplitCells")}),a.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:b("mceTableInsertRowBefore")}),a.addButton("tableinsertrowafter",{title:"Insert row after",onclick:b("mceTableInsertRowAfter")}),a.addButton("tabledeleterow",{title:"Delete row",onclick:b("mceTableDeleteRow")}),a.addButton("tablerowprops",{title:"Row properties",onclick:b("mceTableRowProps")}),a.addButton("tablecutrow",{title:"Cut row",onclick:b("mceTableCutRow")}),a.addButton("tablecopyrow",{title:"Copy row",onclick:b("mceTableCopyRow")}),a.addButton("tablepasterowbefore",{title:"Paste row before",onclick:b("mceTablePasteRowBefore")}),a.addButton("tablepasterowafter",{title:"Paste row after",onclick:b("mceTablePasteRowAfter")}),a.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:b("mceTableInsertColBefore")}),a.addButton("tableinsertcolafter",{title:"Insert column after",onclick:b("mceTableInsertColAfter")}),a.addButton("tabledeletecol",{title:"Delete column",onclick:b("mceTableDeleteCol")})},$u=function(a){var b=function(b){return a.dom.is(b,"table")&&a.getBody().contains(b)},c=Xn(a);c.length>0&&a.addContextToolbar(b,c.join(" "))},_u={addButtons:Zu,addToolbars:$u},av=function(a,b){function c(b){return function(){a.execCommand(b)}}var d=T.none(),e=[],f=[],g=[],h=[],i=function(a){a.disabled(!0)},j=function(a){a.disabled(!1)},k=function(){var a=this;e.push(a),d.fold(function(){i(a)},function(b){j(a)})},l=function(){var a=this;f.push(a),d.fold(function(){i(a)},function(b){j(a)})},m=function(){var a=this;g.push(a),d.fold(function(){i(a)},function(b){a.disabled(b.mergable().isNone())})},n=function(){var a=this;h.push(a),d.fold(function(){i(a)},function(b){a.disabled(b.unmergable().isNone())})},o=function(){d.fold(function(){Aa.each(e,i),Aa.each(f,i),Aa.each(g,i),Aa.each(h,i)},function(a){Aa.each(e,j),Aa.each(f,j),Aa.each(g,function(b){b.disabled(a.mergable().isNone())}),Aa.each(h,function(b){b.disabled(a.unmergable().isNone())})})};a.on("init",function(){a.on("nodechange",function(c){var e=T.from(a.dom.getParent(a.selection.getStart(),"th,td"));d=e.bind(function(a){var c=kb.fromDom(a);return we.table(c).map(function(a){return Ch.forMenu(b,a,c)})}),o()})});var p=function(a,b,c,d){var e,f,g,h,i,j=d.getEl().getElementsByTagName("table")[0],k=d.isRtl()||"tl-tr"===d.parent().rel;for(j.nextSibling.innerHTML=b+1+" x "+(c+1),k&&(b=9-b),f=0;f<10;f++)for(e=0;e<10;e++)h=j.rows[f].childNodes[e].firstChild,i=(k?e>=b:e<=b)&&f<=c,a.dom.toggleClass(h,"mce-active",i),i&&(g=h);return g.parentNode},q=!1===On(a)?{text:"Table",icon:"table",context:"table",onclick:c("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(b){b.aria&&(this.parent().hideAll(),b.stopImmediatePropagation(),a.execCommand("mceInsertTable"))},onshow:function(){p(a,0,0,this.menu.items()[0])},onhide:function(){var b=this.menu.items()[0].getEl().getElementsByTagName("a");a.dom.removeClass(b,"mce-active"),a.dom.addClass(b[0],"mce-active")},menu:[{type:"container",html:function(){var a="";a='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var b=0;b<10;b++){a+="<tr>";for(var c=0;c<10;c++)a+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*b+c)+'" href="#" data-mce-x="'+c+'" data-mce-y="'+b+'"></a></td>';a+="</tr>"}return a+="</table>",a+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(b){var c,d,e=b.target;"A"===e.tagName.toUpperCase()&&(c=parseInt(e.getAttribute("data-mce-x"),10),d=parseInt(e.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(c=9-c),c===this.lastX&&d===this.lastY||(p(a,c,d,b.control),this.lastX=c,this.lastY=d))},onclick:function(b){var c=this;"A"===b.target.tagName.toUpperCase()&&(b.preventDefault(),b.stopPropagation(),c.parent().cancel(),a.undoManager.transact(function(){Qo.insert(a,c.lastX+1,c.lastY+1)}),a.addVisual())}}]},r={text:"Table properties",context:"table",onPostRender:k,onclick:c("mceTableProps")},s={text:"Delete table",context:"table",onPostRender:k,cmd:"mceTableDelete"},t={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:c("mceTableInsertRowBefore"),onPostRender:l},{text:"Insert row after",onclick:c("mceTableInsertRowAfter"),onPostRender:l},{text:"Delete row",onclick:c("mceTableDeleteRow"),onPostRender:l},{text:"Row properties",onclick:c("mceTableRowProps"),onPostRender:l},{text:"-"},{text:"Cut row",onclick:c("mceTableCutRow"),onPostRender:l},{text:"Copy row",onclick:c("mceTableCopyRow"),onPostRender:l},{text:"Paste row before",onclick:c("mceTablePasteRowBefore"),onPostRender:l},{text:"Paste row after",onclick:c("mceTablePasteRowAfter"),onPostRender:l}]},u={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:c("mceTableInsertColBefore"),onPostRender:l},{text:"Insert column after",onclick:c("mceTableInsertColAfter"),onPostRender:l},{text:"Delete column",onclick:c("mceTableDeleteCol"),onPostRender:l}]},v={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:c("mceTableCellProps"),onPostRender:l},{text:"Merge cells",onclick:c("mceTableMergeCells"),onPostRender:m},{text:"Split cell",onclick:c("mceTableSplitCells"),onPostRender:n}]};a.addMenuItem("inserttable",q),a.addMenuItem("tableprops",r),a.addMenuItem("deletetable",s),a.addMenuItem("row",t),a.addMenuItem("column",u),a.addMenuItem("cell",v)},bv={addMenuItems:av},cv=function(a){return a.get().fold(function(){},function(a){return Aa.map(a,function(a){return a.dom()})})},dv=function(a,b){var c=Aa.map(a,kb.fromDom);b.set(T.from(c))},ev=function(a,b){return{insertTable:function(b,c){return Qo.insert(a,b,c)},setClipboardRows:function(a){return dv(a,b)},getClipboardRows:function(){return cv(b)}}};y.add("table",w)}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-template",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},d=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},e=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},f=function(a){return function(){return a}},g=function(a){return a},h=function(a,b){return a===b},i=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},j=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},k=function(a){return function(){throw new Error(a)}},l=function(a){return a()},m=function(a){a()},n=f(!1),o=f(!0),p={noop:c,noarg:d,compose:e,constant:f,identity:g,tripleEquals:h,curry:i,not:j,die:k,apply:l,call:m,never:n,always:o},q=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=tinymce.util.Tools.resolve("tinymce.util.XHR"),s=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),t=function(a){return a.getParam("template_cdate_classes","cdate")},u=function(a){return a.getParam("template_mdate_classes","mdate")},v=function(a){return a.getParam("template_selected_content_classes","selcontent")},w=function(a){return a.getParam("template_preview_replace_values")},x=function(a){return a.getParam("template_replace_values")},y=function(a){return a.templates},z=function(a){return a.getParam("template_cdate_format",a.getLang("template.cdate_format"))},A=function(a){return a.getParam("template_mdate_format",a.getLang("template.mdate_format"))},B=function(a){return a.getParam("template_popup_width",600)},C=function(a){return Math.min(s.DOM.getViewPort().h,a.getParam("template_popup_height",500))},D={getCreationDateClasses:t,getModificationDateClasses:u,getSelectedContentClasses:v,getPreviewReplaceValues:w,getTemplateReplaceValues:x,getTemplates:y,getCdateFormat:z,getMdateFormat:A,getDialogWidth:B,getDialogHeight:C},E=function(a,b){if(a=""+a,a.length<b)for(var c=0;c<b-a.length;c++)a="0"+a;return a},F=function(a,b,c){var d="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),f="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),g="January February March April May June July August September October November December".split(" ");return c=c||new Date,b=b.replace("%D","%m/%d/%Y"),b=b.replace("%r","%I:%M:%S %p"),b=b.replace("%Y",""+c.getFullYear()),b=b.replace("%y",""+c.getYear()),b=b.replace("%m",E(c.getMonth()+1,2)),b=b.replace("%d",E(c.getDate(),2)),b=b.replace("%H",""+E(c.getHours(),2)),b=b.replace("%M",""+E(c.getMinutes(),2)),b=b.replace("%S",""+E(c.getSeconds(),2)),b=b.replace("%I",""+((c.getHours()+11)%12+1)),b=b.replace("%p",c.getHours()<12?"AM":"PM"),b=b.replace("%B",""+a.translate(g[c.getMonth()])),b=b.replace("%b",""+a.translate(f[c.getMonth()])),b=b.replace("%A",""+a.translate(e[c.getDay()])),b=b.replace("%a",""+a.translate(d[c.getDay()])),b=b.replace("%%","%")},G={getDateTime:F},H=function(a,b){return function(){var c=D.getTemplates(a);if("function"==typeof c)return void c(b);"string"==typeof c?r.send({url:c,success:function(a){b(JSON.parse(a))}}):b(c)}},I=function(a,b,c){return q.each(c,function(a,c){"function"==typeof a&&(a=a(c)),b=b.replace(new RegExp("\\{\\$"+c+"\\}","g"),a)}),b},J=function(a,b){var c=a.dom,d=D.getTemplateReplaceValues(a);q.each(c.select("*",b),function(a){q.each(d,function(b,e){c.hasClass(a,e)&&"function"==typeof d[e]&&d[e](a)})})},K=function(a,b){return new RegExp("\\b"+b+"\\b","g").test(a.className)},L=function(a,b,c){var d,e,f=a.dom,g=a.selection.getContent();c=I(0,c,D.getTemplateReplaceValues(a)),d=f.create("div",null,c),e=f.select(".mceTmpl",d),e&&e.length>0&&(d=f.create("div",null),d.appendChild(e[0].cloneNode(!0))),q.each(f.select("*",d),function(b){K(b,D.getCreationDateClasses(a).replace(/\s+/g,"|"))&&(b.innerHTML=G.getDateTime(a,D.getCdateFormat(a))),K(b,D.getModificationDateClasses(a).replace(/\s+/g,"|"))&&(b.innerHTML=G.getDateTime(a,D.getMdateFormat(a))),K(b,D.getSelectedContentClasses(a).replace(/\s+/g,"|"))&&(b.innerHTML=g)}),J(a,d),a.execCommand("mceInsertContent",!1,d.innerHTML),a.addVisual()},M={createTemplateList:H,replaceTemplateValues:I,replaceVals:J,insertTemplate:L},N=function(a){a.addCommand("mceInsertTemplate",p.curry(M.insertTemplate,a))},O={register:N},P=function(a){a.on("PreProcess",function(b){var c=a.dom,d=D.getMdateFormat(a);q.each(c.select("div",b.node),function(b){c.hasClass(b,"mceTmpl")&&(q.each(c.select("*",b),function(b){c.hasClass(b,a.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(b.innerHTML=G.getDateTime(a,d))}),M.replaceVals(a,b))})})},Q={setup:P},R=function(a,b,c){if(-1===c.indexOf("<html>")){var d="";q.each(a.contentCSS,function(b){d+='<link type="text/css" rel="stylesheet" href="'+a.documentBaseURI.toAbsolute(b)+'">'});var e=a.settings.body_class||"";-1!==e.indexOf("=")&&(e=a.getParam("body_class","","hash"),e=e[a.id]||""),c="<!DOCTYPE html><html><head>"+d+'</head><body class="'+e+'">'+c+"</body></html>"}c=M.replaceTemplateValues(a,c,D.getPreviewReplaceValues(a));var f=b.find("iframe")[0].getEl().contentWindow.document;f.open(),f.write(c),f.close()},S=function(a,b){var c,d,e=[];if(!b||0===b.length){var f=a.translate("No templates defined.");return void a.notificationManager.open({text:f,type:"info"})}q.each(b,function(a){e.push({selected:!e.length,text:a.title,value:{url:a.url,content:a.content,description:a.description}})});var g=function(b){var e=b.control.value();e.url?r.send({url:e.url,success:function(b){d=b,R(a,c,d)}}):(d=e.content,R(a,c,d)),c.find("#description")[0].text(b.control.value().description)};c=a.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:e,onselect:g}}]},{type:"label",name:"description",label:"Description",text:""},{type:"iframe",flex:1,border:1}],onsubmit:function(){M.insertTemplate(a,!1,d)},minWidth:D.getDialogWidth(a),minHeight:D.getDialogHeight(a)}),c.find("listbox")[0].fire("select")},T={open:S},U=function(a){return function(b){T.open(a,b)}},V=function(a){a.addButton("template",{title:"Insert template",onclick:M.createTemplateList(a.settings,U(a))}),a.addMenuItem("template",{text:"Template",onclick:M.createTemplateList(a.settings,U(a)),icon:"template",context:"insert"})},W={register:V};b.add("template",function(a){W.register(a),O.register(a),Q.setup(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-textcolor",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=function(a,b){var c;return a.dom.getParents(a.selection.getStart(),function(a){var d;(d=a.style["forecolor"===b?"color":"background-color"])&&(c=d)}),c},d=function(a){var b,c=[];for(b=0;b<a.length;b+=2)c.push({text:a[b+1],color:"#"+a[b]});return c},e=function(a,b,c){a.undoManager.transact(function(){a.focus(),a.formatter.apply(b,{value:c}),a.nodeChanged()})},f=function(a,b){a.undoManager.transact(function(){a.focus(),a.formatter.remove(b,{value:null},null,!0),a.nodeChanged()})},g={getCurrentColor:c,mapColors:d,applyFormat:e,removeFormat:f},h=function(a){a.addCommand("mceApplyTextcolor",function(b,c){g.applyFormat(a,b,c)}),a.addCommand("mceRemoveTextcolor",function(b){g.removeFormat(a,b)})},i={register:h},j=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),k=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],m=function(a){return a.getParam("textcolor_map",l)},n=function(a){return a.getParam("forecolor_map",m(a))},o=function(a){return a.getParam("backcolor_map",m(a))},p=function(a){return a.getParam("textcolor_rows",5)},q=function(a){return a.getParam("textcolor_cols",8)},r=function(a){return a.getParam("forecolor_rows",p(a))},s=function(a){return a.getParam("backcolor_rows",p(a))},t=function(a){return a.getParam("forecolor_cols",q(a))},u=function(a){return a.getParam("backcolor_cols",q(a))},v=function(a){return a.getParam("color_picker_callback",null)},w=function(a){return"function"==typeof v(a)},x={getForeColorMap:n,getBackColorMap:o,getForeColorRows:r,getBackColorRows:s,getForeColorCols:t,getBackColorCols:u,getColorPickerCallback:v,hasColorPicker:w},y=tinymce.util.Tools.resolve("tinymce.util.I18n"),z=function(a,b,c,d){var e,f,h,i,k,l,m,n=0,o=j.DOM.uniqueId("mcearia"),p=function(a,b){var c="transparent"===a;return'<td class="mce-grid-cell'+(c?" mce-colorbtn-trans":"")+'"><div id="'+o+"-"+n+++'" data-mce-color="'+(a||"")+'" role="option" tabIndex="-1" style="'+(a?"background-color: "+a:"")+'" title="'+y.translate(b)+'">'+(c?"&#215;":"")+"</div></td>"};for(e=g.mapColors(c),e.push({text:y.translate("No color"),color:"transparent"}),h='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',i=e.length-1,l=0;l<b;l++){for(h+="<tr>",k=0;k<a;k++)m=l*a+k,m>i?h+="<td></td>":(f=e[m],h+=p(f.color,f.text));h+="</tr>"}if(d){for(h+='<tr><td colspan="'+a+'" class="mce-custom-color-btn"><div id="'+o+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+o+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+y.translate("Custom...")+"</button></div></td></tr>",h+="<tr>",k=0;k<a;k++)h+=p("","Custom color");h+="</tr>"}return h+="</tbody></table>"},A={getHtml:z},B=function(a,b){a.style.background=b,a.setAttribute("data-mce-color",b)},C=function(a){return function(b){var c=b.control;c._color?a.execCommand("mceApplyTextcolor",c.settings.format,c._color):a.execCommand("mceRemoveTextcolor",c.settings.format)}},D=function(a,b){return function(c){var d,e=this.parent(),f=g.getCurrentColor(a,e.settings.format),h=function(b){a.execCommand("mceApplyTextcolor",e.settings.format,b),e.hidePanel(),e.color(b)};if(j.DOM.getParent(c.target,".mce-custom-color-btn")){e.hidePanel();x.getColorPickerCallback(a).call(a,function(a){var c,d,f,g=e.panel.getEl().getElementsByTagName("table")[0];for(c=k.map(g.rows[g.rows.length-1].childNodes,function(a){return a.firstChild}),f=0;f<c.length&&(d=c[f],d.getAttribute("data-mce-color"));f++);if(f===b)for(f=0;f<b-1;f++)B(c[f],c[f+1].getAttribute("data-mce-color"));B(d,a),h(a)},f)}d=c.target.getAttribute("data-mce-color"),d?(this.lastId&&j.DOM.get(this.lastId).setAttribute("aria-selected","false"),c.target.setAttribute("aria-selected",!0),this.lastId=c.target.id,"transparent"===d?function(){
a.execCommand("mceRemoveTextcolor",e.settings.format),e.hidePanel(),e.resetColor()}():h(d)):null!==d&&e.hidePanel()}},E=function(a,b){return function(){var c=b?x.getForeColorCols(a):x.getBackColorCols(a),d=b?x.getForeColorRows(a):x.getBackColorRows(a),e=b?x.getForeColorMap(a):x.getBackColorMap(a),f=x.hasColorPicker(a);return A.getHtml(c,d,e,f)}},F=function(a){a.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:E(a,!0),onclick:D(a,x.getForeColorCols(a))},onclick:C(a)}),a.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:E(a,!1),onclick:D(a,x.getBackColorCols(a))},onclick:C(a)})},G={register:F};b.add("textcolor",function(a){i.register(a),G.register(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-textpattern",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(a,b){var c,d;c=B.applyInlineFormatEnter(a,b),c&&(d=a.dom.createRng(),d.setStart(c,c.data.length),d.setEnd(c,c.data.length),a.selection.setRng(d)),B.applyBlockFormat(a,b)}function b(a,b){var c,d,e,f,g;(c=B.applyInlineFormatSpace(a,b))&&(g=a.dom,d=c.data.slice(-1),/[\u00a0 ]/.test(d)&&(c.deleteData(c.data.length-1,1),e=g.doc.createTextNode(d),g.insertAfter(e,c.parentNode),f=g.createRng(),f.setStart(e,1),f.setEnd(e,1),a.selection.setRng(f)))}function c(){}var d=function(a){var b=a,c=function(){return b};return{get:c,set:function(a){b=a},clone:function(){return d(c())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=function(a){return{setPatterns:function(b){a.set(b)},getPatterns:function(){return a.get()}}},g={get:f},h=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"***",end:"***",format:["bold","italic"]},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],i=function(a){return void 0!==a.textpattern_patterns?a.textpattern_patterns:h},j={getPatterns:i},k=tinymce.util.Tools.resolve("tinymce.util.Delay"),l=tinymce.util.Tools.resolve("tinymce.util.VK"),m=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=function(a){return a.sort(function(a,b){return a.start.length>b.start.length?-1:a.start.length<b.start.length?1:0})},p=function(a,b){for(var c=0;c<a.length;c++)if(0===b.indexOf(a[c].start)&&(!a[c].end||b.lastIndexOf(a[c].end)===b.length-a[c].end.length))return a[c]},q=function(a,b,c,d){return b.substr(c-a.end.length-d,a.end.length)===a.end},r=function(a,b,c){return a-b-c.end.length-c.start.length>0},s=function(a,b,c,d){var e,f,g=o(a);for(f=0;f<g.length;f++)if(e=g[f],void 0!==e.end&&q(e,b,c,d)&&r(c,d,e))return e},t={findPattern:p,findEndPattern:s},u=function(a,b,c,d,e){return a=d>0?a.splitText(d):a,a.splitText(c-d+b.end.length),a.deleteData(0,b.start.length),a.deleteData(a.data.length-b.end.length,b.end.length),a},v=function(a,b,c){if(!1!==b.collapsed){var d=b.startContainer,e=d.data,f=!0===c?1:0;if(3===d.nodeType){var g=t.findEndPattern(a,e,b.startOffset,f);if(void 0!==g){var h=e.lastIndexOf(g.end,b.startOffset-f),i=e.lastIndexOf(g.start,h-g.end.length);if(h=e.indexOf(g.end,i+g.start.length),-1!==i){var j=document.createRange();j.setStart(d,i),j.setEnd(d,h+g.end.length);var k=t.findPattern(a,j.toString());if(!(void 0===g||k!==g||d.data.length<=g.start.length+g.end.length))return{pattern:g,startOffset:i,endOffset:h}}}}}},w=function(a,b,c,d){var e=n.isArray(c.pattern.format)?c.pattern.format:[c.pattern.format];if(0!==n.grep(e,function(b){var c=a.formatter.get(b);return c&&c[0].inline}).length)return a.undoManager.transact(function(){b=u(b,c.pattern,c.endOffset,c.startOffset),e.forEach(function(c){a.formatter.apply(c,{},b)})}),b},x=function(a,b,c){var d=a.selection.getRng(!0),e=v(b,d,c);if(e)return w(a,d.startContainer,e)},y=function(a,b){return x(a,b,!0)},z=function(a,b){return x(a,b,!1)},A=function(a,b){var c,d,e,f,g,h,i,j,k,l,o;if(c=a.selection,d=a.dom,c.isCollapsed()&&(i=d.getParent(c.getStart(),"p"))){for(k=new m(i,i);g=k.next();)if(3===g.nodeType){f=g;break}if(f){if(!(j=t.findPattern(b,f.data)))return;if(l=c.getRng(!0),e=l.startContainer,o=l.startOffset,f===e&&(o=Math.max(0,o-j.start.length)),n.trim(f.data).length===j.start.length)return;j.format&&(h=a.formatter.get(j.format))&&h[0].block&&(f.deleteData(0,j.start.length),a.formatter.apply(j.format,{},f),l.setStart(e,o),l.collapse(!0),c.setRng(l)),j.cmd&&a.undoManager.transact(function(){f.deleteData(0,j.start.length),a.execCommand(j.cmd)})}}},B={patternFromRng:v,applyInlineFormatSpace:y,applyInlineFormatEnter:z,applyBlockFormat:A},C=function(a,b,c){for(var d=0;d<a.length;d++)if(c(a[d],b))return!0},D=function(a,b){return C(a,b,function(a,b){return a===b.keyCode&&!1===l.modifierPressed(b)})},E=function(a,b){return C(a,b,function(a,b){return a.charCodeAt(0)===b.charCode})},F={handleEnter:a,handleInlineKey:b,checkCharCode:E,checkKeyCode:D},G=function(a,b){var c=[",",".",";",":","!","?"],d=[32];a.on("keydown",function(c){13!==c.keyCode||l.modifierPressed(c)||F.handleEnter(a,b.get())},!0),a.on("keyup",function(c){F.checkKeyCode(d,c)&&F.handleInlineKey(a,b.get())}),a.on("keypress",function(d){F.checkCharCode(c,d)&&k.setEditorTimeout(a,function(){F.handleInlineKey(a,b.get())})})},H={setup:G};e.add("textpattern",function(a){var b=d(j.getPatterns(a.settings));return H.setup(a,b),g.get(b)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-visualblocks",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(a,b){a.fire("VisualBlocks",{state:b})},e={fireVisualBlocks:d},f=function(a){return a.getParam("visualblocks_default_state",!1)},g=function(a){return a.settings.visualblocks_content_css},h={isEnabledByDefault:f,getContentCss:g},i=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),j=tinymce.util.Tools.resolve("tinymce.util.Tools"),k=i.DOM.uniqueId(),l=function(a,b){var c=j.toArray(a.getElementsByTagName("link"));if(0===j.grep(c,function(a){return a.id===k}).length){var d=i.DOM.create("link",{id:k,rel:"stylesheet",href:b});a.getElementsByTagName("head")[0].appendChild(d)}},m={load:l},n=function(a,b,c){var d=a.dom,f=h.getContentCss(a);m.load(a.getDoc(),f||b+"/css/visualblocks.css"),d.toggleClass(a.getBody(),"mce-visualblocks"),c.set(!c.get()),e.fireVisualBlocks(a,c.get())},o={toggleVisualBlocks:n},p=function(a,b,c){a.addCommand("mceVisualBlocks",function(){o.toggleVisualBlocks(a,b,c)})},q={register:p},r=function(a,b,c){a.on("PreviewFormats AfterPreviewFormats",function(b){c.get()&&a.dom.toggleClass(a.getBody(),"mce-visualblocks","afterpreviewformats"===b.type)}),a.on("init",function(){h.isEnabledByDefault(a)&&o.toggleVisualBlocks(a,b,c)}),a.on("remove",function(){a.dom.removeClass(a.getBody(),"mce-visualblocks")})},s={setup:r},t=function(a,b){return function(c){var d=c.control;d.active(b.get()),a.on("VisualBlocks",function(a){d.active(a.state)})}},u=function(a,b){a.addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:t(a,b)}),a.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:t(a,b),selectable:!0,context:"view",prependToContext:!0})},v={register:u};c.add("visualblocks",function(a,c){var d=b(!1);q.register(a,c,d),v.register(a,d),s.setup(a,c,d)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-visualchars",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=function(a){var c=a,d=function(){return c};return{get:d,set:function(a){c=a},clone:function(){return b(d())}}},c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(a){return{isEnabled:function(){return a.get()}}},e={get:d},f=function(a,b){return a.fire("VisualChars",{state:b})},g={fireVisualChars:f},h={"":"nbsp","":"shy"},i=function(a,b){var c,d="";for(c in a)d+=c;return new RegExp("["+d+"]",b?"g":"")},j=function(a){var b,c="";for(b in a)c&&(c+=","),c+="span.mce-"+a[b];return c},k={charMap:h,regExp:i(h),regExpGlobal:i(h,!0),selector:j(h),charMapToRegExp:i,charMapToSelector:j},l=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},m=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a()}},n=function(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return a(b.apply(null,arguments))}},o=function(a){return function(){return a}},p=function(a){return a},q=function(a,b){return a===b},r=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=new Array(arguments.length-1),e=1;e<arguments.length;e++)d[e-1]=arguments[e];return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];for(var e=new Array(arguments.length),f=0;f<e.length;f++)e[f]=arguments[f];var g=d.concat(e);return a.apply(null,g)}},s=function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return!a.apply(null,arguments)}},t=function(a){return function(){throw new Error(a)}},u=function(a){return a()},v=function(a){a()},w=o(!1),x=o(!0),y={noop:l,noarg:m,compose:n,constant:o,identity:p,tripleEquals:q,curry:r,not:s,die:t,apply:u,call:v,never:w,always:x},z=y.never,A=y.always,B=function(){return C},C=function(){var a=function(a){return a.isNone()},b=function(a){return a()},c=function(a){return a},d=function(){},e={fold:function(a,b){return a()},is:z,isSome:z,isNone:A,getOr:c,getOrThunk:b,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:c,orThunk:b,map:B,ap:B,each:d,bind:B,flatten:B,exists:z,forall:A,filter:B,equals:a,equals_:a,toArray:function(){return[]},toString:y.constant("none()")};return Object.freeze&&Object.freeze(e),e}(),D=function(a){var b=function(){return a},c=function(){return f},d=function(b){return D(b(a))},e=function(b){return b(a)},f={fold:function(b,c){return c(a)},is:function(b){return a===b},isSome:A,isNone:z,getOr:b,getOrThunk:b,getOrDie:b,or:c,orThunk:c,map:d,ap:function(b){return b.fold(B,function(b){return D(b(a))})},each:function(b){b(a)},bind:e,flatten:b,exists:e,forall:e,filter:function(b){return b(a)?f:C},equals:function(b){return b.is(a)},equals_:function(b,c){return b.fold(z,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return f},E=function(a){return null===a||void 0===a?C:D(a)},F={some:D,none:B,from:E},G=function(a){if(null===a)return"null";var b=typeof a;return"object"===b&&Array.prototype.isPrototypeOf(a)?"array":"object"===b&&String.prototype.isPrototypeOf(a)?"string":b},H=function(a){return function(b){return G(b)===a}},I={isString:H("string"),isObject:H("object"),isArray:H("array"),isNull:H("null"),isBoolean:H("boolean"),isUndefined:H("undefined"),isFunction:H("function"),isNumber:H("number")},J=function(){var a=Array.prototype.indexOf,b=function(b,c){return a.call(b,c)},c=function(a,b){return Z(a,b)};return void 0===a?c:b}(),K=function(a,b){var c=J(a,b);return-1===c?F.none():F.some(c)},L=function(a,b){return J(a,b)>-1},M=function(a,b){return Y(a,b).isSome()},N=function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},O=function(a,b){for(var c=[],d=0;d<a.length;d+=b){var e=a.slice(d,d+b);c.push(e)}return c},P=function(a,b){for(var c=a.length,d=new Array(c),e=0;e<c;e++){var f=a[e];d[e]=b(f,e,a)}return d},Q=function(a,b){for(var c=0,d=a.length;c<d;c++){b(a[c],c,a)}},R=function(a,b){for(var c=a.length-1;c>=0;c--){b(a[c],c,a)}},S=function(a,b){for(var c=[],d=[],e=0,f=a.length;e<f;e++){var g=a[e];(b(g,e,a)?c:d).push(g)}return{pass:c,fail:d}},T=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d];b(f,d,a)&&c.push(f)}return c},U=function(a,b){if(0===a.length)return[];for(var c=b(a[0]),d=[],e=[],f=0,g=a.length;f<g;f++){var h=a[f],i=b(h);i!==c&&(d.push(e),e=[]),c=i,e.push(h)}return 0!==e.length&&d.push(e),d},V=function(a,b,c){return R(a,function(a){c=b(c,a)}),c},W=function(a,b,c){return Q(a,function(a){c=b(c,a)}),c},X=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e,c,a))return F.some(e)}return F.none()},Y=function(a,b){for(var c=0,d=a.length;c<d;c++){if(b(a[c],c,a))return F.some(c)}return F.none()},Z=function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1},$=Array.prototype.push,_=function(a){for(var b=[],c=0,d=a.length;c<d;++c){if(!Array.prototype.isPrototypeOf(a[c]))throw new Error("Arr.flatten item "+c+" was not an array, input: "+a);$.apply(b,a[c])}return b},aa=function(a,b){var c=P(a,b);return _(c)},ba=function(a,b){for(var c=0,d=a.length;c<d;++c){if(!0!==b(a[c],c,a))return!1}return!0},ca=function(a,b){return a.length===b.length&&ba(a,function(a,c){return a===b[c]})},da=Array.prototype.slice,ea=function(a){var b=da.call(a,0);return b.reverse(),b},fa=function(a,b){return T(a,function(a){return!L(b,a)})},ga=function(a,b){for(var c={},d=0,e=a.length;d<e;d++){var f=a[d];c[String(f)]=b(f,d)}return c},ha=function(a){return[a]},ia=function(a,b){var c=da.call(a,0);return c.sort(b),c},ja=function(a){return 0===a.length?F.none():F.some(a[0])},ka=function(a){return 0===a.length?F.none():F.some(a[a.length-1])},la=I.isFunction(Array.from)?Array.from:function(a){return da.call(a)},ma={map:P,each:Q,eachr:R,partition:S,filter:T,groupBy:U,indexOf:K,foldr:V,foldl:W,find:X,findIndex:Y,flatten:_,bind:aa,forall:ba,exists:M,contains:L,equal:ca,reverse:ea,chunk:O,difference:fa,mapToObject:ga,pure:ha,sort:ia,range:N,head:ja,last:ka,from:la},na=function(a,b){var c=b||document,d=c.createElement("div");if(d.innerHTML=a,!d.hasChildNodes()||d.childNodes.length>1)throw console.error("HTML does not have a single root node",a),"HTML must have a single root node";return qa(d.childNodes[0])},oa=function(a,b){var c=b||document,d=c.createElement(a);return qa(d)},pa=function(a,b){var c=b||document,d=c.createTextNode(a);return qa(d)},qa=function(a){if(null===a||void 0===a)throw new Error("Node cannot be null or undefined");return{dom:y.constant(a)}},ra=function(a,b,c){return F.from(a.dom().elementFromPoint(b,c)).map(qa)},sa={fromHtml:na,fromTag:oa,fromText:pa,fromDom:qa,fromPoint:ra},ta={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12},ua=function(a){return a.dom().nodeName.toLowerCase()},va=function(a){return a.dom().nodeType},wa=function(a){return a.dom().nodeValue},xa=function(a){return function(b){return va(b)===a}},ya=function(a){return va(a)===ta.COMMENT||"#comment"===ua(a)},za=xa(ta.ELEMENT),Aa=xa(ta.TEXT),Ba=xa(ta.DOCUMENT),Ca={name:ua,type:va,value:wa,isElement:za,isText:Aa,isDocument:Ba,isComment:ya},Da=function(a){return'<span data-mce-bogus="1" class="mce-'+k.charMap[a]+'">'+a+"</span>"},Ea={wrapCharWithSpan:Da},Fa=function(a){return Ca.isText(a)&&void 0!==Ca.value(a)&&k.regExp.test(Ca.value(a))},Ga=function(a,b){var c=[],d=a.dom(),e=ma.map(d.childNodes,sa.fromDom);return ma.each(e,function(a){b(a)&&(c=c.concat([a])),c=c.concat(Ga(a,b))}),c},Ha=function(a,b){for(;a.parentNode;){if(a.parentNode===b)return a;a=a.parentNode}},Ia=function(a){return a.replace(k.regExpGlobal,Ea.wrapCharWithSpan)},Ja={isMatch:Fa,filterDescendants:Ga,findParentElm:Ha,replaceWithSpans:Ia},Ka=function(a,b){var c,d,e=Ja.filterDescendants(sa.fromDom(b),Ja.isMatch);ma.each(e,function(b){var e=Ja.replaceWithSpans(Ca.value(b));for(d=a.dom.create("div",null,e);c=d.lastChild;)a.dom.insertAfter(c,b.dom());a.dom.remove(b.dom())})},La=function(a,b){var c=a.dom.select(k.selector,b);ma.each(c,function(b){a.dom.remove(b,1)})},Ma=function(a){var b=a.getBody(),c=a.selection.getBookmark(),d=Ja.findParentElm(a.selection.getNode(),b);d=void 0!==d?d:b,La(a,d),Ka(a,d),a.selection.moveToBookmark(c)},Na={show:Ka,hide:La,toggle:Ma},Oa=function(a,b){var c,d=a.getBody(),e=a.selection;b.set(!b.get()),g.fireVisualChars(a,b.get()),c=e.getBookmark(),!0===b.get()?Na.show(a,d):Na.hide(a,d),e.moveToBookmark(c)},Pa={toggleVisualChars:Oa},Qa=function(a,b){a.addCommand("mceVisualChars",function(){Pa.toggleVisualChars(a,b)})},Ra={register:Qa},Sa=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ta=function(a,b){var c=Sa.debounce(function(){Na.toggle(a)},300);!1!==a.settings.forced_root_block&&a.on("keydown",function(d){!0===b.get()&&(13===d.keyCode?Na.toggle(a):c())})},Ua={setup:Ta},Va=function(a){return function(b){var c=b.control;a.on("VisualChars",function(a){c.active(a.state)})}},Wa=function(a){a.addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:Va(a)}),a.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:Va(a),selectable:!0,context:"view",prependToContext:!0})};c.add("visualchars",function(a){var c=b(!1);return Ra.register(a,c),Wa(a),Ua.setup(a,c),e.get(c)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-wordcount",["tinymce"],function(){return function(){!function(){!function(){"use strict";function a(){}var b=tinymce.util.Tools.resolve("tinymce.PluginManager"),c={aletter:"[A-Za-z---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]",midnumlet:"[-'\\.]",midletter:"[:]",midnum:"[+*/,;;]",numeric:"[0-9---------------------------------]",cr:"\\r",lf:"\\n",newline:"[\v\f\u2028\u2029]",extend:"[------------------------------------------------------------------------------------------------------]",format:"[----\ufeff-]",katakana:"[-------]",extendnumlet:"[=_--<>]",punctuation:"[!-#%-*,-\\/:;?@\\[-\\]_{};----------------------------------------------]"},d={ALETTER:0,MIDNUMLET:1,MIDLETTER:2,MIDNUM:3,NUMERIC:4,CR:5,LF:6,NEWLINE:7,EXTEND:8,FORMAT:9,KATAKANA:10,EXTENDNUMLET:11,AT:12,OTHER:13},e=[new RegExp(c.aletter),new RegExp(c.midnumlet),new RegExp(c.midletter),new RegExp(c.midnum),new RegExp(c.numeric),new RegExp(c.cr),new RegExp(c.lf),new RegExp(c.newline),new RegExp(c.extend),new RegExp(c.format),new RegExp(c.katakana),new RegExp(c.extendnumlet),new RegExp("@")],f=new RegExp("^"+c.punctuation+"$"),g=/^\s+$/,h={characterIndices:d,SETS:e,EMPTY_STRING:"",PUNCTUATION:f,WHITESPACE:g},i=function(a,b,c){var d,e;if(!a)return 0;if(c=c||a,void 0!==a.length){for(d=0,e=a.length;d<e;d++)if(!1===b.call(c,a[d],d,a))return 0}else for(d in a)if(a.hasOwnProperty(d)&&!1===b.call(c,a[d],d,a))return 0;return 1},j=function(a,b){var c=[];return i(a,function(d,e){c.push(b(d,e,a))}),c},k={each:i,map:j},l=h.SETS,m=h.characterIndices.OTHER,n=function(a){var b,c,d=m,e=l.length;for(b=0;b<e;++b)if((c=l[b])&&c.test(a)){d=b;break}return d},o=function(a){var b={};return function(c){if(b[c])return b[c];var d=a(c);return b[c]=d,d}},p=function(a){var b=o(n);return k.map(a.split(""),b)},q={classify:p},r=h.characterIndices,s=function(a,b){var c,d,e=a[b],f=a[b+1];return!(b<0||b>a.length-1&&0!==b)&&((e!==r.ALETTER||f!==r.ALETTER)&&(d=a[b+2],(e!==r.ALETTER||f!==r.MIDLETTER&&f!==r.MIDNUMLET&&f!==r.AT||d!==r.ALETTER)&&(c=a[b-1],(e!==r.MIDLETTER&&e!==r.MIDNUMLET&&f!==r.AT||f!==r.ALETTER||c!==r.ALETTER)&&((e!==r.NUMERIC&&e!==r.ALETTER||f!==r.NUMERIC&&f!==r.ALETTER)&&((e!==r.MIDNUM&&e!==r.MIDNUMLET||f!==r.NUMERIC||c!==r.NUMERIC)&&((e!==r.NUMERIC||f!==r.MIDNUM&&f!==r.MIDNUMLET||d!==r.NUMERIC)&&(e!==r.EXTEND&&e!==r.FORMAT&&c!==r.EXTEND&&c!==r.FORMAT&&f!==r.EXTEND&&f!==r.FORMAT&&((e!==r.CR||f!==r.LF)&&(e===r.NEWLINE||e===r.CR||e===r.LF||(f===r.NEWLINE||f===r.CR||f===r.LF||(e!==r.KATAKANA||f!==r.KATAKANA)&&((f!==r.EXTENDNUMLET||e!==r.ALETTER&&e!==r.NUMERIC&&e!==r.KATAKANA&&e!==r.EXTENDNUMLET)&&((e!==r.EXTENDNUMLET||f!==r.ALETTER&&f!==r.NUMERIC&&f!==r.KATAKANA)&&e!==r.AT))))))))))))},t={isWordBoundary:s},u=h.EMPTY_STRING,v=h.WHITESPACE,w=h.PUNCTUATION,x=function(a){return"http"===a||"https"===a},y=function(a,b){var c;for(c=b;c<a.length;++c){var d=a.charAt(c);if(v.test(d))break}return c},z=function(a,b,c){var d=y(b,c+1),e=b.substring(c+1,d);return"://"===e.substr(0,3)?{word:a+e,index:d}:{word:a,index:c}},A=function(a,b){var c,d,e,f=0,g=q.classify(a),h=g.length,i=[],j=[];for(b||(b={}),b.ignoreCase&&(a=a.toLowerCase()),d=b.includePunctuation,e=b.includeWhitespace;f<h;++f)if(c=a.charAt(f),i.push(c),t.isWordBoundary(g,f)){if((i=i.join(u))&&(e||!v.test(i))&&(d||!w.test(i)))if(x(i)){var k=z(i,a,f);j.push(k.word),f=k.index}else j.push(i);i=[]}return j},B=function(a,b){return A(a.replace(/\ufeff/g,""),b)},C={getWords:B},D=function(a){return a.removed?"":a.getBody().innerText},E=function(a){return C.getWords(D(a)).length},F={getCount:E},G=function(a){return{getCount:function(){return F.getCount(a)}}},H={get:G},I=tinymce.util.Tools.resolve("tinymce.util.Delay"),J=tinymce.util.Tools.resolve("tinymce.util.I18n"),K=function(a){var b=function(a){return J.translate(["{0} words",F.getCount(a)])},c=function(){a.theme.panel.find("#wordcount").text(b(a))};a.on("init",function(){var d=a.theme.panel&&a.theme.panel.find("#statusbar")[0],e=I.debounce(c,300);d&&I.setEditorTimeout(a,function(){d.insert({type:"label",name:"wordcount",text:b(a),classes:"wordcount",disabled:a.settings.readonly},0),a.on("setcontent beforeaddundo undo redo keyup",e)},0)})},L={setup:K};b.add("wordcount",function(a){return L.setup(a),H.get(a)})}()}()}.apply(a,arguments)})}(this),function(a){define("tinymce-compat3x",["tinymce"],function(){return function(){!function(a){function b(){}function c(a){!f&&window&&window.console&&(f=!0,console.log("Deprecated TinyMCE API call: "+a))}function d(a,d,e,f){a=a||this;var g=[];if(!d)return void(this.add=this.addToTop=this.remove=this.dispatch=b);this.add=function(b,h,i){function j(c){var g=[];if("string"==typeof e&&(e=e.split(" ")),e&&"function"!=typeof e)for(var i=0;i<e.length;i++)g.push(c[e[i]]);("function"!=typeof e||(g=e(d,c,a)))&&(e||(g=[c]),g.unshift(f||a),!1===b.apply(h||f||a,g)&&c.stopImmediatePropagation())}c("<target>.on"+d+".add(..)"),a.on(d,j,i);var k={original:b,patched:j};return g.push(k),j},this.addToTop=function(a,b){this.add(a,b,!0)},this.remove=function(b){return g.forEach(function(c,e){if(c.original===b)return g.splice(e,1),a.off(d,c.patched)}),a.off(d,b)},this.dispatch=function(){return a.fire(d),!0}}function e(e){function f(b){var c=e.settings.language||"en",d=[c,b].join("."),f=a.i18n.translate(d);return d!==f?f:a.i18n.translate(b)}function g(b,c){a.each(b.split(" "),function(a){e["on"+a]=new d(e,a,c)})}function h(a,b,c){return[b.level,c]}function i(a){return function(b,c){if(!c.selection&&!a||c.selection==a)return[c]}}function j(){function b(){return j()}var d={};return c("editor.controlManager.*"),a.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),function(a){d[a]=b}),d}if(!e.controlManager){e.controlManager={buttons:{},setDisabled:function(a,b){c("controlManager.setDisabled(..)"),this.buttons[a]&&this.buttons[a].disabled(b)},setActive:function(a,b){c("controlManager.setActive(..)"),this.buttons[a]&&this.buttons[a].active(b)},onAdd:new d,onPostRender:new d,add:function(a){return a},createButton:j,createColorSplitButton:j,createControl:j,createDropMenu:j,createListBox:j,createMenuButton:j,createSeparator:j,createSplitButton:j,createToolbar:j,createToolbarGroup:j,destroy:b,get:b,setControlType:j},g("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),g("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),g("BeforeExecCommand ExecCommand","command ui value args"),g("PreProcess PostProcess LoadContent SaveContent Change"),g("BeforeSetContent BeforeGetContent SetContent GetContent",i(!1)),g("SetProgressState","state time"),g("VisualAid","element hasVisual"),g("Undo Redo",h),g("NodeChange",function(a,b){return[e.controlManager,b.element,e.selection.isCollapsed(),b]});var k=e.addButton;e.addButton=function(a,b){function c(){if(e.controlManager.buttons[a]=this,d)return d.apply(this,arguments)}var d;for(var g in b)"onpostrender"===g.toLowerCase()&&(d=b[g],b.onPostRender=c);return d||(b.onPostRender=c),b.title&&(b.title=f(b.title)),k.call(this,a,b)},e.on("init",function(){var a=e.undoManager,b=e.selection;a.onUndo=new d(e,"Undo",h,null,a),a.onRedo=new d(e,"Redo",h,null,a),a.onBeforeAdd=new d(e,"BeforeAddUndo",null,a),a.onAdd=new d(e,"AddUndo",null,a),b.onBeforeGetContent=new d(e,"BeforeGetContent",i(!0),b),b.onGetContent=new d(e,"GetContent",i(!0),b),b.onBeforeSetContent=new d(e,"BeforeSetContent",i(!0),b),b.onSetContent=new d(e,"SetContent",i(!0),b)}),e.on("BeforeRenderUI",function(){var b=e.windowManager;b.onOpen=new d,b.onClose=new d,b.createInstance=function(b,d,e,f,g,h){return c("windowManager.createInstance(..)"),new(a.resolve(b))(d,e,f,g,h)}})}}var f;a.util.Dispatcher=d,a.onBeforeUnload=new d(a,"BeforeUnload"),a.onAddEditor=new d(a,"AddEditor","editor"),a.onRemoveEditor=new d(a,"RemoveEditor","editor"),a.util.Cookie={get:b,getHash:b,remove:b,set:b,setHash:b},a.on("SetupEditor",function(a){e(a.editor)}),a.PluginManager.add("compat3x",e),a.addI18n=function(b,c){var d=a.util.I18n,e=a.each;if("string"==typeof b&&-1===b.indexOf("."))return void d.add(b,c);a.is(b,"string")?e(c,function(a,c){d.data[b+"."+c]=a}):e(b,function(a,b){e(a,function(a,c){e(a,function(a,e){"common"===c?d.data[b+"."+e]=a:d.data[b+"."+c+"."+e]=a})})})}}(tinymce)}.apply(a,arguments)})}(this),define("mockup-patterns-tinymce",["jquery","underscore","pat-base","tinymce","text!mockup-patterns-tinymce-url/templates/result.xml","text!mockup-patterns-tinymce-url/templates/selection.xml","mockup-utils","mockup-patterns-tinymce-url/js/links","mockup-i18n","translate","tinymce-modern-theme","tinymce-advlist","tinymce-anchor","tinymce-autolink","tinymce-autoresize","tinymce-autosave","tinymce-bbcode","tinymce-charmap","tinymce-code","tinymce-colorpicker","tinymce-contextmenu","tinymce-directionality","tinymce-emoticons","tinymce-fullpage","tinymce-fullscreen","tinymce-hr","tinymce-image","tinymce-importcss","tinymce-insertdatetime","tinymce-legacyoutput","tinymce-link","tinymce-lists","tinymce-media","tinymce-nonbreaking","tinymce-noneditable","tinymce-pagebreak","tinymce-paste","tinymce-preview","tinymce-print","tinymce-save","tinymce-searchreplace","tinymce-spellchecker","tinymce-tabfocus","tinymce-table","tinymce-template","tinymce-textcolor","tinymce-textpattern","tinymce-visualblocks","tinymce-visualchars","tinymce-wordcount","tinymce-compat3x"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=["p","div","blockquote","h1","h2","h3","h4","h5","h6"];return c.extend({name:"tinymce",trigger:".pat-tinymce",parser:"mockup",defaults:{relatedItems:{attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],batchSize:20,vocabularyUrl:null,width:500,maximumSelectionSize:1,placeholder:j("Search for item on site...")},text:{insertBtn:j("Insert"),cancelBtn:j("Cancel"),insertHeading:j("Insert link"),title:j("Title"),internal:j("Internal"),external:j("External URL (can be relative within this site or absolute if it starts with http:// or https://)"),email:j("Email Address"),anchor:j("Anchor"),subject:j("Email Subject (optional)"),image:j("Image"),imageAlign:j("Align"),scale:j("Size"),alt:j("Alternative Text"),externalImage:j("External Image URL (can be relative within this site or absolute if it starts with http:// or https://)")},loadingBaseUrl:"../../../bower_components/tinymce-builded/js/tinymce/",prependToUrl:"",appendToUrl:"",linkAttribute:"path",prependToScalePart:"/imagescale/",appendToScalePart:"",appendToOriginalScalePart:"",defaultScale:"large",scales:j("Listing (16x16):listing,Icon (32x32):icon,Tile (64x64):tile,Thumb (128x128):thumb,Mini (200x200):mini,Preview (400x400):preview,Large (768x768):large"),targetList:[{text:j("Open in this window / frame"),value:""},{text:j("Open in new window"),value:"_blank"},{text:j("Open in parent window / frame"),value:"_parent"},{text:j("Open in top frame (replaces all frames)"),value:"_top"}],imageTypes:["Image"],folderTypes:["Folder","Plone Site"],tiny:{content_css:"../../../bower_components/tinymce-builded/js/tinymce/skins/lightgray/content.min.css",theme:"modern",plugins:["advlist","autolink","lists","charmap","print","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","contextmenu","paste","plonelink","ploneimage"],menubar:"edit table format tools view insert",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | unlink plonelink ploneimage",height:400,linkTypes:["internal","external","email","anchor"]},inline:!1},addLinkClicked:function(){var b=this;if(null===b.linkModal){var c=a("<div/>").insertAfter(b.$el),d=b.options.tiny.linkTypes;d||(d=["internal","external","email","anchor"]),b.linkModal=new h(c,a.extend(!0,{},b.options,{tinypattern:b,linkTypes:d})),b.linkModal.show()}else b.linkModal.reinitialize(),b.linkModal.show()},addImageClicked:function(){var b=this;if(null===b.imageModal){var c=["image","externalImage"],d=a.extend(!0,{},b.options,{tinypattern:b,linkTypes:c,initialLinkType:"image",text:{insertHeading:j("Insert Image")},relatedItems:{baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.list.contains",v:b.options.imageTypes.concat(b.options.folderTypes)}],selectableTypes:b.options.imageTypes,resultTemplate:e,selectionTemplate:f}}),g=a("<div/>").insertAfter(b.$el);b.imageModal=new h(g,d),b.imageModal.show()}else b.imageModal.reinitialize(),b.imageModal.show()},generateUrl:function(a){var b=this,c=a[b.options.linkAttribute];return b.options.prependToUrl+c+b.options.appendToUrl},generateImageUrl:function(a,b){var c=this,d=c.generateUrl(a);if(""!==b){for(var e=b,f=0;f<c.options.scales.length;f+=1)c.options.scales[f].name===b&&(e=c.options.scales[f].part);d=d+c.options.prependToScalePart+e+c.options.appendToScalePart}else d+=c.options.appendToOriginalScalePart;return d},stripGeneratedUrl:function(a){var b=this;if(a=a.split(b.options.prependToScalePart,2)[0],b.options.prependToUrl){var c=a.split(b.options.prependToUrl,2);2===c.length&&(a=c[1])}return b.options.appendToUrl&&(a=a.split(b.options.appendToUrl)[0]),a},getScaleFromUrl:function(a){var b=this,c=a.split(b.options.prependToScalePart)
;return 2!==c.length?null:(a=b.options.appendToScalePart?c[1].split(b.options.appendToScalePart)[0]:c[1],-1!==a.indexOf("/image_")&&(a=a.split("/image_")[1]),a)},initLanguage:function(a){a()},init:function(){var a=this;a.linkModal=a.imageModal=a.pasteModal=null;var c=g.setId(a.$el),e=a.options.tiny;!0===a.options.inline&&(a.options.tiny.inline=!0),a.tinyId=a.options.inline?c+"-editable":c,e.selector="#"+a.tinyId,e.addLinkClicked=function(){a.addLinkClicked.apply(a,[])},e.addImageClicked=function(b){a.addImageClicked.apply(a,[b])},e.skin=!1,a.options.relatedItems.generateImageUrl=function(b,c){return a.generateImageUrl.apply(a,[b,c])},e.init_instance_callback=function(b){void 0!==a.tiny&&null!==a.tiny||(a.tiny=b)};var f=[];e.importcss_selector_converter=function(a){var b=a.split(".");if(2===b.length){var c=b[1];if(c=c.split("::")[0].split(":")[0],-1===f.indexOf(c)&&-1===["callout","portalMessage"].indexOf(c)){var d=c.replace(/-/g," ");d=d[0].toUpperCase()+d.substring(1);var e={title:d,classes:c};return-1!==k.indexOf(b[0])&&(e.block=b[0]),f.push(c),e}}},a.initLanguage(function(){if("string"==typeof a.options.scales&&(a.options.scales=b.map(a.options.scales.split(","),function(a){return a=a.split(":"),{part:a[1],name:a[1],label:a[0]}})),"string"==typeof a.options.folderTypes&&(a.options.folderTypes=a.options.folderTypes.split(",")),"string"==typeof a.options.imageTypes&&(a.options.imageTypes=a.options.imageTypes.split(",")),!0===a.options.inline&&(a.$el.after('<div id="'+a.tinyId+'">'+a.$el.val()+"</div>"),a.$el.hide()),e.importcss_file_filter&&-1!==e.importcss_file_filter.indexOf(",")){var c=e.importcss_file_filter.split(",");e.importcss_file_filter=function(a){for(var b=0;b<c.length;b++)if(-1!==a.indexOf(c[b]))return!0;return!1}}d.init(e),a.tiny=d.get(a.tinyId),a.$el.parents("form").on("submit",function(){!0===a.options.inline?a.$el.val(a.tiny.getContent()):a.tiny.save()})})},destroy:function(){this.tiny&&(!0===this.options.inline&&(this.$el.val(this.tiny.getContent()),a("#"+this.tinyId).remove(),this.$el.show()),this.tiny.destroy(),this.tiny=void 0)}})}),define("mockup-patterns-textareamimetypeselector",["jquery","pat-base","pat-registry","mockup-patterns-tinymce"],function(a,b,c){"use strict";return b.extend({name:"textareamimetypeselector",trigger:".pat-textareamimetypeselector",parser:"mockup",textarea:void 0,currentWidget:void 0,defaults:{textareaName:"",widgets:{"text/html":{pattern:"tinymce",patternOptions:{}}}},init:function(){var b=this,c=b.$el;b.textarea=a('[name="'+b.options.textareaName+'"]'),c.change(function(a){b.initTextarea(a.target.value)}),b.initTextarea(c.val())},initTextarea:function(a){var b,d=this,e=d.options.widgets[a];d.currentWidget&&d.currentWidget.destroy(),e&&(b=new c.patterns[e.pattern](d.textarea,e.patternOptions||{}),d.currentWidget=b)}})}),define("castle-url/patterns/castledynamicform",["jquery","pat-base","mockup-utils"],function(a,b,c){"use strict";return b.extend({name:"castledynamicform",trigger:".pat-castledynamicform",parser:"mockup",defaults:{},init:function(){var a=this,b=a.$el.parents("form");0!==b.size()&&(a.$form=b,a.bind(),a.manipulate())},manipulate:function(){var b=this;1===b.getUseQuery().size()&&(a("input",b.getUseQuery())[0].checked?(b.getQuery().show(),b.getLimit().show(),b.getContent().hide()):(b.getQuery().hide(),b.getLimit().hide(),b.getContent().show())),1===b.getUseDescription().size()&&(a("input",b.getUseDescription())[0].checked?b.getCustomText().hide():b.getCustomText().show());var c=b.getNavType();if(1===c.size()){var d=c.val();"query"===d?(b.getQuery().show(),b.getContent().hide()):"content"===d?(b.getQuery().hide(),b.getContent().show()):(b.getQuery().hide(),b.getContent().hide())}},bind:function(){var b=this;a("input",b.getUseQuery()).change(function(){b.manipulate()}),a("input",b.getUseDescription()).change(function(){b.manipulate()}),b.getNavType().change(function(){b.manipulate()})},getLimit:function(){return a('div[id$="-limit"]',this.$form)},getUseQuery:function(){return a('div[id$="-use_query"]',this.$form)},getUseDescription:function(){return a('div[id$="-use_description"]',this.$form)},getQuery:function(){return a('div[id$="-query"]',this.$form)},getContent:function(){return a('div[id$="-content"],div[id$="-images"]',this.$form)},getCustomText:function(){return a('div[id$="-custom_text"]',this.$form)},getNavType:function(){return a("#castle-cms-navigation-nav_type",this.$form)}})}),define("castle-url/patterns/edittile",["jquery","pat-base","mockup-patterns-modal","mockup-utils"],function(a,b,c,d){"use strict";return b.extend({name:"edittile",trigger:".pat-edittile",parser:"mockup",defaults:{url:null,editUrl:null,label:"Tile"},init:function(){var b=this,e=a('<a href="'+b.options.editUrl+'" class="edit-tile">'+b.options.label+"</a>");e.click(function(e){d.loading.show(),e.preventDefault(),a.ajax({type:"GET",url:b.options.editUrl,success:function(e,f){d.loading.hide();var g=new c(b.$el,{html:e,loadLinksWithinModal:!0,buttons:'.formControls > input[type="submit"], .actionButtons > input[type="submit"]'});g.$el.off("after-render"),g.on("after-render",function(){a('input[name*="cancel"]',g.$modal).off("click").on("click",function(){g.hide()})}),g.show(),g.$el.off("formActionSuccess"),g.on("formActionSuccess",function(a,b,c,d){window.location.reload()})}})}),b.$el.append(e)}})}),define("castle-url/patterns/focalpointselect",["jquery","pat-base","underscore","castle-url/libs/react/react.min","castle-url/components/image-focal-point-selector","mockup-utils","castle-url/libs/moxie/bin/js/moxie"],function(a,b,c,d,e,f){"use strict";var g=d.DOM,h=d.createClass({getInitialState:function(){return{loading:!1,override_focal_point:this.props.focal_point,image_focal_point:this.props.focal_point,image:null,previewImage:null,previewWidth:"",previewHeight:"",originalFocalwUrl:"",originalFocal:!0}},getDefaultProps:function(){return{focal_point:[0,0],reference:null}},loadImage:function(a){var b=this;b.setState({loading:!0}),b.state.image=new mOxie.Image,f.loading.show(),b.state.image.onload=function(){b.props.width=b.state.image.width,b.props.height=b.state.image.height,(b.state.override_focal_point[0]>b.state.image.width||0===b.state.override_focal_point[0])&&(b.state.override_focal_point[0]=b.state.image.width/2),(b.state.override_focal_point[1]>b.state.image.height||0===b.state.override_focal_point[1])&&(b.state.override_focal_point[1]=b.state.image.height/2),b.props.exists=!0;var a=b.state.image.getAsBlob(),c=new mOxie.Image;c.onload=function(){c.onresize=function(){f.loading.hide(),b.setState({previewUrl:c.getAsDataURL("image/png"),previewWidth:c.width,previewHeight:c.height,loading:!1,previewImage:c})},c.downsize({width:300})},c.load(a)},b.state.image.onerror=function(){f.loading.hide(),b.props.exists=!1,b.setState({loading:!1})},b.state.image.load(a)},render:function(){var a=this;if(a.state.loading)return g.div({},"Loading image...");if(!a.props.exists)return g.div({},"No image selected");var b={readOnly:a.state.originalFocal,url:a.state.previewUrl,width:a.state.previewWidth,fullWidth:a.props.width,height:a.state.previewHeight,fullHeight:a.props.height,focalPoint:a.state.originalFocal?this.state.image_focal_point:a.state.override_focal_point,onFocalSet:function(b){a.state.originalFocal||(a.state.override_focal_point=b,a.setState({dirty:!0}),a.props.onSelected(b))}};return g.div({className:"imagewidget-image-container"},[d.createElement(e,b)])}});return b.extend({name:"focalpointselect",trigger:".pat-focalpointselect",parser:"mockup",defaults:{},init:function(){function b(){try{var b=i[0].value,d=i[1].value}catch(a){}var e=c;if(!b&&!d)return c.component.setState({exists:!1}),void k.hide();k.show(),e.component.loadImage(p+"/resolveuid/"+(b||d)+"/@@images/image?_="+f.generateId()),b&&a.ajax({url:p+"/resolveuid/"+b+"/@@imageinfo",dataType:"JSON",type:"GET"}).done(function(a){e.component.setState({image_focal_point:a.focal_point})})}var c=this;c.$el.attr("type","hidden");var e,g=c.$el.closest("form"),i=a(".pat-relateditems",g),j=a('[id*="-display_type"].field',g),k=c.$el.parent(),l=c.$el.val();e=l?JSON.parse(l):[0,0];var m=a('<div class="checkbox"><label><input type="checkbox"> Override focal point for selected image</label></div>'),n=a("input",m);k.append(m);var o=document.createElement("div");k.append(o),c.component=d.render(d.createElement(h,{onSelected:function(a){c.$el.val(JSON.stringify(a))},focal_point:e}),o);var p=a("body").attr("data-portal-url");i.on("change",b);var q=i.val();if(!q)try{q=i[1].value}catch(a){}if(q&&b(),l?(n[0].checked=!0,c.component.setState({originalFocal:!1})):c.component.setState({originalFocal:!0}),n.on("change",function(a){a.target.checked?c.component.setState({originalFocal:!1}):(c.component.setState({originalFocal:!0}),c.$el.attr("value",""))}),j.size()>0){var r=a("select",j).val();r&&"natural"!==r&&"fullwidth"!==r||k.hide(),a("select",j).on("change",function(a){var b=a.target.value;b&&"natural"!==b&&"fullwidth"!==b?k.show():k.hide()})}}})}),define("castle-url/patterns/imagewidget",["jquery","pat-base","castle-url/libs/react/react.min","castle-url/components/image-focal-point-selector","castle-url/components/image-editor","castle-url/components/utils","mockup-utils","mockup-patterns-relateditems","castle-url/libs/moxie/bin/js/moxie"],function(a,b,c,d,e,f,g,h){"use strict";var i=c.DOM,j=c.createClass({getInitialState:function(){return{dragging:!1,dirty:!1,remove:!1,imageDirty:!1,loading:!0,showEditor:!1,focal_point:this.props.focal_point,image:null,previewImage:null,previewWidth:"",previewHeight:"",previewUrl:"",selectReference:null!==this.props.reference}},getDefaultProps:function(){return{focal_point:[0,0],reference:null}},loadImage:function(a){var b=this;b.state.image=new mOxie.Image,g.loading.show(),b.state.image.onload=function(){b.props.width=b.state.image.width,b.props.height=b.state.image.height,b.props.focal_point||(b.props.focal_point=[0,0]),(b.props.focal_point[0]>b.state.image.width||0===b.props.focal_point[0])&&(b.props.focal_point[0]=b.state.image.width/2),(b.props.focal_point[1]>b.state.image.height||0===b.props.focal_point[1])&&(b.props.focal_point[1]=b.state.image.height/2),b.props.exists=!0;var a=b.state.image.getAsBlob(),c=new mOxie.Image;c.onload=function(){c.onresize=function(){g.loading.hide(),b.setState({previewUrl:c.getAsDataURL("image/png"),previewWidth:c.width,previewHeight:c.height,loading:!1,previewImage:c})},c.downsize({width:300})},c.load(a)},b.state.image.onerror=function(){g.loading.hide(),b.props.exists=!1,b.setState({loading:!1})},b.state.image.load(a)},componentDidMount:function(){var b=this;b.props.exists?b.loadImage(b.props.download_url):b.setState({loading:!1});var c=[{title:"Images",extensions:"jpg,gif,png"}],d=a("body").attr("data-portal-url");mOxie.Env.swf_url=d+"/++plone++castle/libs/moxie/bin/flash/Moxie.min.swf",mOxie.Env.xap_url=d+"/++plone++castle/libs/moxie/bin/silverlight/Moxie.min.xap";var e=new mOxie.FileInput({browse_button:b.refs.upload_btn.getDOMNode(),runtime_order:"html5,flash,html4",multiple:!1,accept:c}),g=function(a){b.props.filename=a.name,b.setState({dirty:!0,imageDirty:!0,loading:!0,remove:!1},function(){"image/gif"===a.type?b.loadGif(a):b.loadImage(a)})};e.onchange=function(a){g(a.target.files[0])},e.init();var i=b.refs.droparea.getDOMNode(),j=new mOxie.FileDrop({drop_zone:i,accept:c});j.ondrop=function(){g(this.files[0]),i.style.background=""},j.ondragenter=function(){b.setState({dragging:!0})},j.ondragleave=function(){b.setState({dragging:!1})},j.init();var k=[];this.props.reference&&(k=[this.props.reference]);var l=a(b.refs.relateditem.getDOMNode());try{var m=JSON.parse(a(".pat-relateditems").attr("data-pat-relateditems"))}catch(a){var m={}}var n=new h(l,f.extend(m,{vocabularyUrl:a("body").attr("data-portal-url")+"/@@getVocabulary?name=plone.app.vocabularies.Catalog",maximumSelectionSize:1,multiple:!1,allowAdd:!1,noItemsSelectedText:"No image selected",initial_selection:k,selectableTypes:["Image"],baseCriteria:[{i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:["Image","Folder"]}]}));l.on("change",function(){n.component.state.selected.length>0?b.props.reference=n.component.state.selected[0]:b.props.reference=null})},loadGif:function(b){var c=this;g.loading.show();var d=new mOxie.XMLHttpRequest,e=new mOxie.FormData;d.open("post",a("body").attr("data-base-url")+"/@@convert-to-png"),e.append("data",b.slice()),d.onload=function(){d.response?c.loadImage("data:image/png;base64,"+d.response):alert("error converting image"),g.loading.hide()},d.bind("error runtimeerror",function(){g.loading.hide(),alert("error converting image")}),d.send(e,{runtime_order:"html5,flash,html4",required_caps:{send_multipart:!0}})},renderImage:function(){var a=this;return a.state.loading?i.div({},"Loading image..."):a.props.exists?i.div({className:"imagewidget-image-container"},[c.createElement(d,{url:a.state.previewUrl,width:a.state.previewWidth,fullWidth:a.props.width,height:a.state.previewHeight,fullHeight:a.props.height,focalPoint:a.props.focal_point,onFocalSet:function(b){a.props.focal_point=b,a.setState({dirty:!0})}}),i.p({className:"discreet"},"Filename: "+a.props.filename)]):i.div({},"No image")},renderUploader:function(){var a=this,b={};return(a.state.loading||a.state.showEditor)&&(b={display:"none"}),i.div({ref:"droparea",className:"droparea",style:b},["Drop here to replace image or ",i.button({ref:"upload_btn",className:"btn btn-default castle-btn-select-files"},"Select an image")])},render:function(){var a=this,b=[],d=[],f=[a.renderUploader()];a.state.dirty&&d.push(i.button({className:"plone-btn plone-btn-default",onClick:function(b){b.preventDefault(),a.props.focal_point=a.props.original_focal_point,a.setState({dirty:!1,imageDirty:!1,loading:!0,remove:!1},function(){a.loadImage(a.props.download_url)})}},"Cancel changes")),a.props.exists&&!a.state.remove&&(b.push(a.renderImage()),a.props.required||d.push(i.button({className:"plone-btn plone-btn-default",onClick:function(b){b.preventDefault(),a.setState({remove:!0,dirty:!0})}},"Remove image")),a.state.loading||a.state.remove||(a.state.showEditor?f.push(c.createElement(e,{key:"image-editor",file:a.state.image,onSave:function(b){a.setState({showEditor:!1,loading:!0,dirty:!0,imageDirty:!0},function(){a.loadImage(b)})},onCancel:function(){a.setState({showEditor:!1})}})):d.push(i.button({className:"plone-btn plone-btn-default castle-btn-edit",onClick:function(b){b.preventDefault(),a.setState({showEditor:!0})}},"Edit Image"))));var g="col-md-5",h="col-md-7";return 0===b.length&&(g="",h="col-md-12"),i.div({className:"castle-imagewidget-container"},[i.div({style:a.state.selectReference&&{display:"none"}||{}},[i.div({className:"row"},[i.div({className:g},b),i.div({className:h},[f])]),i.div({className:"btn-container"},d)]),i.div({style:!a.state.selectReference&&{display:"none"}||{}},[i.input({ref:"relateditem",type:"hidden"})]),i.div({className:"form-group"},i.label({},[i.input({type:"checkbox",checked:a.state.selectReference,onClick:function(){a.setState({selectReference:!a.state.selectReference})}}),"Or, select image from site to use as the lead image"]))])}});return b.extend({name:"imagewidget",trigger:".pat-imagewidget",parser:"mockup",defaults:{},init:function(){var b=this;b.$action=b.$el.siblings(".imagewidget-action");var d=f.extend(b.options,{original_focal_point:b.options.focal_point});b.component=c.render(c.createElement(j,d),b.$el[0]),b.$el.closest("form").on("submit",function(){if(b.component.state.selectReference)b.component.props.reference?(b.$action.val(""),b.addReference()):b.$action.val("nochange");else if(b.component.state.remove)b.$action.val("remove");else if(b.component.state.dirty){if(b.component.state.imageDirty){b.$action.val("");var c=document.createElement("input");c.type="hidden",c.name=b.options.name,c.value=b.component.state.image.getAsDataURL(b.component.state.image.type,100),a(c).insertAfter(b.$el);var d=document.createElement("input");d.type="hidden",d.name=b.options.name+".filename",d.value=b.component.props.filename,a(d).insertAfter(b.$el)}else b.$action.val("nochange");var e=document.createElement("input");e.type="hidden",e.name=b.options.name+".focalX",e.value=b.component.props.focal_point[0],a(e).insertAfter(b.$el);var f=document.createElement("input");f.type="hidden",f.name=b.options.name+".focalY",f.value=b.component.props.focal_point[1],a(f).insertAfter(b.$el)}else b.$action.val("nochange")})},addReference:function(){var b=this,c=document.createElement("input");c.type="hidden",c.name=b.options.name,b.component.state.selectReference?c.value="reference:"+b.component.props.reference:(c.value="",b.$action.val("nochange")),a(c).insertAfter(b.$el)}})}),function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define("castle-url/libs/script",b):this.$script=b()}(0,function(){function a(a,b){for(var c=0,d=a.length;c<d;++c)if(!b(a[c]))return i;return 1}function b(b,c){a(b,function(a){return c(a),1})}function c(f,g,h){function i(a){return a.call?a():m[a]}function k(){if(!--s){m[r]=1,q&&q();for(var c in o)a(c.split("|"),i)&&!b(o[c],i)&&(o[c]=[])}}f=f[j]?f:[f];var l=g&&g.call,q=l?g:h,r=l?f.join(""):g,s=f.length;return setTimeout(function(){b(f,function a(b,c){return null===b?k():(!c&&!/^https?:\/\//.test(b)&&e&&(b=-1===b.indexOf(".js")?e+b+".js":e+b),p[b]?(r&&(n[r]=1),2==p[b]?k():setTimeout(function(){a(b,!0)},0)):(p[b]=1,r&&(n[r]=1),d(b,k),void 0))})},0),c}function d(a,b){var c,d=g.createElement("script");d.onload=d.onerror=d[l]=function(){d[k]&&!/^c|loade/.test(d[k])||c||(d.onload=d[l]=null,c=1,p[a]=2,b())},d.async=1,d.src=f?a+(-1===a.indexOf("?")?"?":"&")+f:a,h.insertBefore(d,h.lastChild)}var e,f,g=document,h=g.getElementsByTagName("head")[0],i=!1,j="push",k="readyState",l="onreadystatechange",m={},n={},o={},p={};return c.get=d,c.order=function(a,b,d){!function e(f){f=a.shift(),a.length?c(f,e):c(f,b,d)}()},c.path=function(a){e=a},c.urlArgs=function(a){f=a},c.ready=function(d,e,f){d=d[j]?d:[d];var g=[];return!b(d,function(a){m[a]||g[j](a)})&&a(d,function(a){return m[a]})?e():function(a){o[a]=o[a]||[],o[a][j](e),f&&f(g)}(d.join("|")),c},c.done=function(a){c([null],a)},c}),define("castle-url/patterns/mapselect",["jquery","mockup-patterns-base","underscore","pat-registry","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils","mockup-patterns-tinymce","pat-mockup-parser","castle-url/libs/script"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=e.DOM,m="",n=function(a){var b={Red:"#e6194b",Green:"#3cb44b",Yellow:"#ffe119",Blue:"#0082c8",Orange:"#f58231",Purple:"#911eb4",Cyan:"#46f0f0",Magenta:"#f032e6",Lime:"#d2f53c",Pink:"#fabebe",Teal:"#008080",Lavender:"#e6beff",Brown:"#aa6e28",Beige:"#fffac8",Maroon:"#800000",Mint:"#aaffc3",Olive:"#808000",Coral:"#ffd8b1",Navy:"#000080",Grey:"#808080",White:"#FFFFFF",Black:"#000000"},c=Object.keys(b);return[l.label({},"Color"),l.select({ref:"color",defaultValue:a,className:"input-group"},[c.map(function(a){var c=b[a];return l.option({value:c},a)})])]},o=function(a){return a.geometry.location.lat&&a.geometry.location.lat()||a.geometry.location.G},p=function(a){return a.geometry.location.lng&&a.geometry.location.lng()||a.geometry.location.K},q=function(a,b,c){return b&&c?a+"("+b.toFixed(6)+","+c.toFixed(6)+")":"No point selected"},r=e.createClass({getInitialState:function(){return{results:[],searchTerm:"",searched:!1,selected:-1}},searchClicked:function(a){a&&a.preventDefault();var b=this;f.loading.show(),(new window.google.maps.Geocoder).geocode({address:b.state.searchTerm},function(a){f.loading.hide(),b.setState({results:a,searched:!0,selected:-1})})},searchInput:function(a){this.setState({searchTerm:a.target.value})},selectItem:function(a,b){b.preventDefault(),this.setState({selected:a})},searchInputKeyPress:function(a){13===(a.charCode||a.keyCode)&&this.searchClicked()},render:function(){var a=this,b="";return a.state.searched&&(b=a.state.results.length>0?l.div({},[l.p({className:"discreet"},"Select item from results"),l.ul({className:"castle-map-search-results"},a.state.results.map(function(b,c){var d="";c===a.state.selected&&(d="selected glyphicon glyphicon-ok");var e=q(b.formatted_address,o(b),p(b));return l.li({className:d},[l.a({href:"#",onClick:a.selectItem.bind(a,c)},e)])}))]):""==m?l.div({},[l.span({},"Google Maps Api Key not configured. To set an api key go to Site Setup -> CastleCMS -> APIs tab. If you need an api key go "),l.a({href:"https://developers.google.com/maps/documentation/javascript/get-api-key"},"here"),l.span({}," and follow the instructions.")]):"No results"),l.div({className:"map-search-container"},[l.div({className:"form-group"},[l.label({},"Search Location"),l.div({className:"input-group"},[l.input({type:"text",placeholder:"Location",className:"form-control",value:a.state.searchTerm,onChange:a.searchInput,onKeyDown:a.searchInputKeyPress}),l.span({className:"input-group-btn"},l.button({className:"plone-btn plone-btn-primary",type:"button",onClick:a.searchClicked},"Search"))])]),b])}}),s=h.Class([g],{getInitialState:function(){return{customIcon:!1}},addButtonClicked:function(a){a.preventDefault();var b=this.refs.search,c=this.getIcon();if(-1!==b.state.selected){var d=b.state.results[b.state.selected],e={formatted:d.formatted_address,lat:o(d),lng:p(d),popup:this.props.tiny.tiny.getContent()};c&&(e.icon=c),this.props.parent.add(e),this.hide()}else alert("You have not selected a location")},componentDidMount:function(){g.componentDidMount.apply(this);var b=a(this.refs.tiny.getDOMNode()),c=a.extend({},!0,j.getOptions(b,"tinymce"),{tiny:{height:100}});this.props.tiny=new i(b,c)},getIcon:function(){return!!this.state.customIcon&&{color:this.refs.color.getDOMNode().value,iconText:this.refs.iconText.getDOMNode().value}},renderContent:function(){var a=this;return l.div({className:"castle-markers-container"},[e.createElement(r,{parent:a,ref:"search"}),l.div({className:"form-group"},[l.label({},"Custom Icon"),l.input({type:"checkbox",onClick:function(){a.setState({customIcon:!a.state.customIcon})}})]),this.renderCustomIconForm(),l.div({className:"form-group"},[l.label({},"Text"),l.textarea({ref:"tiny"})])])},renderCustomIconForm:function(){return this.state.customIcon?l.div({className:"form-group"},[n(!1),l.label({},"Label"),l.input({ref:"iconText",className:"input-group"})]):[]},renderFooter:function(){var a=[l.button({type:"button",className:"btn btn-default small",onClick:this.addButtonClicked},"Add")];return l.div({},a)},getDefaultProps:function(){return a.extend({},!0,g.getDefaultProps.apply(this),{id:"add-marker-modal",title:"Add Marker"})}}),t=h.Class([g],{getInitialState:function(){var a=!1;return 0!=this.props.icon&&(a=!0),{customIcon:a}},saveButtonClicked:function(a){a.preventDefault(),this.hide();var b=this.props.tiny.tiny.getContent(),c=!1;void 0!==this.refs.color&&(c={color:this.refs.color.getDOMNode().value,iconText:this.refs.iconText.getDOMNode().value}),this.props.callback(b,c)},componentDidMount:function(){g.componentDidMount.apply(this);var b=a(this.refs.tiny.getDOMNode()),c=a.extend({},!0,j.getOptions(b,"tinymce"),{tiny:{height:100}});this.props.tiny=new i(b,c)},renderCustomIconForm:function(){return this.state.customIcon?l.div({className:"form-group"},[n(this.props.icon.color),l.label({},"Label"),l.input({ref:"iconText",className:"input-group",defaultValue:this.props.icon.iconText})]):[]},renderContent:function(){var a=this;return l.div({className:"castle-edit-marker-container-container"},[l.div({className:"form-group"},[l.div({className:"form-group"},[l.label({},"Custom Icon"),l.input({type:"checkbox",checked:this.state.customIcon,onClick:function(){a.setState({customIcon:!a.state.customIcon})}})]),this.renderCustomIconForm(),l.label({},"Text"),l.textarea({ref:"tiny",value:this.props.data})])])},renderFooter:function(){var a=[l.button({type:"button",className:"btn btn-default small",onClick:this.saveButtonClicked},"Save")];return l.div({},a)},getDefaultProps:function(){return a.extend({},!0,g.getDefaultProps.apply(this),{id:"edit-marker-modal",title:"Edit Marker"})}}),u=e.createClass({addMarkerClicked:function(a){a.preventDefault(),h.createModalComponent(s,"castle-add-marker-modal",{parent:this})},add:function(a){this.props.value.push(a),this.forceUpdate(),this.props.el.value=JSON.stringify(this.props.value)},removeClicked:function(a,b){b.preventDefault(),this.props.value.splice(a,1),this.forceUpdate(),this.props.el.value=JSON.stringify(this.props.value)},editClicked:function(a,b){b.preventDefault();var c=this,d=this.props.value[a];h.createModalComponent(t,"castle-add-marker-modal",{parent:this,data:d.popup,icon:d.icon||!1,callback:function(a,b){d.popup=a,!1!==b?d.icon=b:delete d.icon,c.forceUpdate(),c.props.el.value=JSON.stringify(c.props.value)}})},render:function(){var a=this,b="";return 0===a.props.value.length&&(b=l.p({className:"discreet"},"Currently no custom markers set")),l.div({className:"markers-container"},[b,l.ul({},a.props.value.map(function(b,c){return l.li({},[l.span({className:"marker-label"},b.formatted),l.a({href:"#",className:"plone-btn plone-btn-default plone-btn-xs",onClick:a.editClicked.bind(a,c)},"Edit"),l.a({href:"#",className:"plone-btn plone-btn-warning plone-btn-xs",onClick:a.removeClicked.bind(a,c)},l.span({className:"glyphicon glyphicon-trash"},"Remove"))])})),l.a({href:"#",className:"plone-btn plone-btn-default plone-btn-sm",onClick:a.addMarkerClicked},"Add Marker")])}}),v=h.Class([g],{getInitialState:function(){return{}},addButtonClicked:function(a){a.preventDefault();var b=this.refs.search;if(-1!==b.state.selected){for(var c=b.state.results[b.state.selected],d=null,e=null,f=0;f<c.address_components.length;f++){var g=c.address_components[f];g.types.indexOf("administrative_area_level_1")>=0?d=g.short_name:g.types.indexOf("locality")>=0&&(e=g.long_name)}this.props.parent.set({formatted:c.formatted_address,lat:c.geometry.location.lat&&c.geometry.location.lat()||c.geometry.location.G,lng:c.geometry.location.lng&&c.geometry.location.lng()||c.geometry.location.K,city:e,state:d}),this.hide()}else alert("You have not selected a location")},renderContent:function(){var a=this;return l.div({className:"castle-markers-container"},[e.createElement(r,{parent:a,ref:"search"})])},renderFooter:function(){var a=[l.button({type:"button",className:"btn btn-default small",onClick:this.addButtonClicked},"Set")];return l.div({},a)},getDefaultProps:function(){return a.extend({},!0,g.getDefaultProps.apply(this),{id:"set-center-point-modal",title:"Set Center Point"})}}),w=e.createClass({setPointClicked:function(a){a.preventDefault(),h.createModalComponent(v,"castle-add-center-modal",{parent:this})},set:function(a){this.props.value=a,this.props.el.value=JSON.stringify(a),this.forceUpdate()},render:function(){var a=this,b="";return a.props.value&&(b=l.p({className:"discreet"},q(a.props.value.formatted,a.props.value.lat,a.props.value.lng))),l.div({className:"markers-container"},[b,l.a({href:"#",className:"btn btn-default",onClick:a.setPointClicked},"Set point")])}}),x=e.createClass({addPointClicked:function(a){a.preventDefault(),h.createModalComponent(v,"castle-add-center-modal",{parent:this})},set:function(a){this.props.value||(this.props.value=[]),this.props.value.push(a),this.props.el.value=JSON.stringify(this.props.value),this.forceUpdate()},removePoint:function(a,b){b.preventDefault(),this.props.value.splice(a,1),this.props.el.value=JSON.stringify(this.props.value),this.forceUpdate()},render:function(){var a=this,b=a.props.value||[],c=[];return b.forEach(function(b,d){c.push(l.li({className:"discreet",style:{display:"block"},key:"map-entry-"+d},[q(b.formatted,b.lat,b.lng)," - (",l.a({href:"#",onClick:a.removePoint.bind(a,d)},"Remove"),")"]))}),l.div({className:"markers-container"},[l.ul({},c),l.br({},""),l.a({href:"#",className:"btn btn-default",onClick:a.addPointClicked},"Add location")])}});return b.extend({name:"mapselect",trigger:".pat-mapselect",parser:"mockup",defaults:{type:"markers"},init:function(){var b=this;if(window.google&&window.google.maps)b.initialize();else{var c="https://maps.google.com/maps/api/js?v=3&sensor=false";m=a("body").attr("data-google-maps-api-key"),m&&(c+="&key="+m),k(c,function(){b.initialize()})}},initialize:function(){var b=this;b.val=a.parseJSON(b.$el.val()),b.$el.hide();var c=document.createElement("div");if(b.$el.parent().append(c),"markers"===b.options.type)e.render(e.createElement(u,{el:b.$el[0],value:b.val||[]}),c);else if("point"===b.options.type)e.render(e.createElement(w,{el:b.$el[0],value:b.val||{}}),c);else if("points"===b.options.type){var d=b.val;d&&d.lat&&d.lng&&(d=[d]),d||(d=[]),e.render(e.createElement(x,{el:b.$el[0],value:d}),c)}}})}),define("castle-url/patterns/previewselect",["jquery","pat-base","underscore"],function(a,b,c){"use strict";return b.extend({name:"previewselect",trigger:".pat-previewselect",defaults:{previews:{}},parser:"mockup",init:function(){var b=this,c=a('<div class="row previewselect-container"><div class="col-md-6 input"></div><div class="col-md-6 preview"></div></div>');b.$el.parent().append(c),a(".input",c).append(b.$el);var d=function(){var d=b.$el.val();a(".preview",c).empty(),b.options.previews[d]&&a(".preview",c).append('<div><h4>Preview</h4><img src="'+a("body").attr("data-portal-url")+"/"+b.options.previews[d]+'" /></div>')};d(),b.$el.on("change",d)}})}),define("mockup-ui-url/views/toolbar",["mockup-ui-url/views/container"],function(a){"use strict";return a.extend({tagName:"div",className:"navbar",idPrefix:"toolbar-"})}),define("mockup-ui-url/views/buttongroup",["underscore","mockup-ui-url/views/container"],function(a,b){"use strict";return b.extend({tagName:"div",className:"btn-group",idPrefix:"btngroup-",disable:function(){a.each(this.items,function(a){a.trigger("disable")})},enable:function(){a.each(this.items,function(a){a.trigger("enable")})}})}),define("mockup-patterns-tooltip",["jquery","pat-base"],function(a,b,c){"use strict";var d=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};return d.VERSION="3.2.0",d.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip mockup-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1,viewport:{selector:"body",padding:0}},d.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},d.prototype.getDefaults=function(){return d.DEFAULTS},d.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},d.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},d.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",!c.options.delay||!c.options.delay.show)return c.show();c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)},
d.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",!c.options.delay||!c.options.delay.hide)return c.hide();c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)},d.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(document.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element);var j=this.getPosition(),k=e[0].offsetWidth,l=e[0].offsetHeight;if(i){var m=g,n=this.$element.parent(),o=this.getPosition(n);g="bottom"==g&&j.top+j.height+l-o.scroll>o.height?"top":"top"==g&&j.top-o.scroll-l<0?"bottom":"right"==g&&j.right+k>o.width?"left":"left"==g&&j.left-k<o.left?"right":g,e.removeClass(m).addClass(g)}var p=this.getCalculatedOffset(g,j,k,l);this.applyPlacement(p,g);var q=function(){d.$element.trigger("shown.bs."+d.type),d.hoverState=null};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",q).emulateTransitionEnd(150):q()}},d.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=k.left?2*k.left-e+i:2*k.top-f+j,m=k.left?"left":"top",n=k.left?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(l,d[0][n],m)},d.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},d.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},d.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach(),c.$element.trigger("hidden.bs."+c.type)}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(e),!e.isDefaultPrevented())return d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one("bsTransitionEnd",b).emulateTransitionEnd(150):b(),this.hoverState=null,this},d.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},d.prototype.hasContent=function(){return this.getTitle()},d.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName;return a.extend({},"function"==typeof c.getBoundingClientRect?c.getBoundingClientRect():null,{scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop(),width:d?a(window).width():b.outerWidth(),height:d?a(window).height():b.outerHeight()},d?{top:0,left:0}:b.offset())},d.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},d.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},d.prototype.getTitle=function(){var a=this.$element,b=this.options;return a.attr("data-original-title")||("function"==typeof b.title?b.title.call(a[0]):b.title)},d.prototype.getUID=function(a){do{a+=~~(1e6*Math.random())}while(document.getElementById(a));return a},d.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},d.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},d.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},d.prototype.enable=function(){this.enabled=!0},d.prototype.disable=function(){this.enabled=!1},d.prototype.toggleEnabled=function(){this.enabled=!this.enabled},d.prototype.toggle=function(b){var c=this;b&&((c=a(b.currentTarget).data("bs."+this.type))||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},d.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)},b.extend({name:"tooltip",trigger:".pat-tooltip",parser:"mockup",defaults:{html:!1,placement:"top"},init:function(){"true"===this.options.html?this.options.html=!0:this.options.html=!1,this.data=new d(this.$el[0],this.options)}})}),define("mockup-ui-url/views/button",["underscore","mockup-ui-url/views/base","mockup-patterns-tooltip"],function(a,b,c){"use strict";return b.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(d){if(!d.id){var e=d.title||"";d.id=""!==e?e.toLowerCase().replace(" ","-"):this.cid}b.prototype.initialize.apply(this,[d]),this.on("disable",function(){this.disable()},this),this.on("enable",function(){this.enable()},this),this.on("render",function(){if(this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),a.each(this.extraClasses,function(a){this.$el.addClass(a)}),null!==this.tooltip){this.$el.attr("title",this.tooltip);new c(this.$el);this.$el.on("hidden",function(a){"hidden"===a.type&&a.stopPropagation()})}},this)},handleClick:function(a){a.preventDefault(),this.$el.is(".disabled")||this.uiEventTrigger("click",this,a)},serializedModel:function(){return a.extend({icon:"",title:""},this.options)},disable:function(){this.options.disabled=!0,this.$el.addClass("disabled")},enable:function(){this.options.disabled=!1,this.$el.removeClass("disabled")}})}),define("castle-url/patterns/structure//js/navigation",["backbone","mockup-utils"],function(a,b){"use strict";return a.Model.extend({initialize:function(a){this.options=a,this.app=a.app,this.model=a.model},folderClicked:function(a){a.preventDefault();var b=this;b.app.setCurrentPath(b.model.attributes.path),b.app.collection.goTo(b.app.collection.information.firstPage)}})}),define("castle-url/patterns/structure//js/models/result",["backbone"],function(a){"use strict";return a.Model.extend({defaults:function(){return{is_folderish:!1,review_state:"",getURL:""}},uid:function(){return this.attributes.UID}})}),define("castle-url/patterns/structure//js/actions",["jquery","underscore","backbone","castle-url/patterns/structure//js/models/result","mockup-utils","translate"],function(a,b,c,d,e,f){"use strict";return c.Model.extend({initialize:function(a){this.options=a,this.app=a.app,this.model=a.model,this.selectedCollection=this.app.selectedCollection},selectAll:function(c){c.preventDefault();var e=this,f=1,g=0,h=function(){e.app.loading.show(),a.ajax({url:e.app.collection.url,type:"GET",dataType:"json",data:{query:e.app.collection.queryParser({searchPath:e.model.attributes.path}),batch:JSON.stringify({page:f,size:100}),attributes:JSON.stringify(e.app.collection.queryHelper.options.attributes)}}).done(function(a){var c=e.app.collection.parse(a,g);g+=c.length,b.each(c,function(a){e.app.selectedCollection.add(new d(a))}),f+=1,a.total>g?h():(e.app.loading.hide(),e.app.tableView.render())})};h()},doAction:function(b,c,d){var g=this;a.ajax({url:g.app.buttons.get(b).options.url,data:{selection:JSON.stringify([g.model.attributes.UID]),folder:g.model.attributes.path,_authenticator:e.getAuthenticator()},dataType:"json",type:"POST"}).done(function(a){var b;"success"===a.status?(b=f(c+' "'+g.model.attributes.Title+'"'),g.app.collection.pager(),g.app.updateButtons()):b=f("Error "+d+' "'+g.model.attributes.Title+'"'),g.app.setStatus({text:b,type:a.status||"warning"})})},cutClicked:function(a){var b=this;a.preventDefault(),b.doAction("cut",f("Cut"),f("cutting"))},copyClicked:function(a){var b=this;a.preventDefault(),b.doAction("copy",f("Copied"),f("copying"))},pasteClicked:function(a){var b=this;a.preventDefault(),b.doAction("paste",f("Pasted into"),f("Error pasting into"))},moveTopClicked:function(a){a.preventDefault(),this.app.moveItem(this.model.attributes.id,"top")},moveBottomClicked:function(a){a.preventDefault(),this.app.moveItem(this.model.attributes.id,"bottom")},setDefaultPageClicked:function(b){b.preventDefault();var c=this;a.ajax({url:c.app.getAjaxUrl(c.app.setDefaultPageUrl),type:"POST",data:{_authenticator:a('[name="_authenticator"]').val(),id:this.model.attributes.id},success:function(a){c.app.ajaxSuccessResponse.apply(c.app,[a])},error:function(a){c.app.ajaxErrorResponse.apply(c.app,[a])}})}})}),define("castle-url/patterns/structure//js/actionmenu",["underscore"],function(a){"use strict";var b={openItem:{url:"#",title:"Open",category:"button",iconCSS:"glyphicon glyphicon-eye-open",css:"",modal:!1},editItem:{url:"#",title:"Edit",category:"button",iconCSS:"glyphicon glyphicon-pencil",css:"",modal:!1},cutItem:{library:"castle-url/patterns/structure//js/actions",method:"cutClicked",url:"#",title:"Cut",category:"dropdown",iconCSS:"glyphicon glyphicon-scissors",css:"",modal:!1},copyItem:{library:"castle-url/patterns/structure//js/actions",method:"copyClicked",url:"#",title:"Copy",category:"dropdown",iconCSS:"glyphicon glyphicon-duplicate",css:"",modal:!1},pasteItem:{library:"castle-url/patterns/structure//js/actions",method:"pasteClicked",url:"#",title:"Paste",category:"dropdown",iconCSS:"glyphicon glyphicon-open-file",css:"",modal:!1},"move-top":{library:"castle-url/patterns/structure//js/actions",method:"moveTopClicked",url:"#",title:"Move to top of folder",category:"dropdown",iconCSS:"glyphicon glyphicon-step-backward rright",css:"",modal:!1},"move-bottom":{library:"castle-url/patterns/structure//js/actions",method:"moveBottomClicked",url:"#",title:"Move to bottom of folder",category:"dropdown",iconCSS:"glyphicon glyphicon-step-backward rleft",css:"",modal:!1},"set-default-page":{library:"castle-url/patterns/structure//js/actions",method:"setDefaultPageClicked",url:"#",title:"Set as default page",category:"dropdown",iconCSS:"glyphicon glyphicon-ok-circle",css:"",modal:!1},selectAll:{library:"castle-url/patterns/structure//js/actions",method:"selectAll",url:"#",title:"Select all contained items",category:"dropdown",iconCSS:"glyphicon glyphicon-check",css:"",modal:!1}};return function(c){if(null!==c.menuOptions)return c.menuOptions;var d=c.model.attributes,e=c.app,f=a.clone(b);e.pasteAllowed&&d.is_folderish||delete f.pasteItem,(e.inQueryMode()||!1===c.options.canMove)&&(delete f["move-top"],delete f["move-bottom"]),!d.is_folderish&&e.setDefaultPageUrl||delete f["set-default-page"],d.is_folderish||delete f.selectAll;var g=e.options.typeToViewAction,h=g&&g[d.portal_type]||"";return f.openItem.url=d.getURL+h,f.editItem.url=d.getURL+"/@@edit",f}}),define("text!castle-url/patterns/structure//templates/actionmenu.xml",[],function(){return'<% _.each(menuOptions.button, function(menuOption){ %>\n<a class="action <%- menuOption.name %> <%- menuOption.idx %> pat-tooltip <%- menuOption.css %>"\n    href="<%- menuOption.url %>"\n    title="<%- _t(menuOption.title) %>">\n  <% if (menuOption.iconCSS) { %>\n  <span class="<%- menuOption.iconCSS %>"></span>\n  <% } else { %>\n  <%- _t(menuOption.title) %> \n  <% } %>\n</a>&nbsp;\n<% }); %>\n\n\n<% if (menuOptions.dropdown) { %>\n<a class="dropdown-toggle"\n    data-toggle="dropdown"\n    href="#"\n    aria-haspopup="true"\n    aria-expanded="true"\n    id="<%- id %>"\n    title="Actions">\n  <span class="glyphicon glyphicon-cog"></span><span class="caret"></span>\n</a>\n<ul class="dropdown-menu pull-right" aria-labelledby="<%- id %>">\n  <% if (header) { %>\n    <li class="dropdown-header"><%- header %></li>\n    <li class="divider"></li>\n  <% } %>\n\n  <% _.each(menuOptions.dropdown, function(menuOption){ %>\n  <li>\n    <a class="action <%- menuOption.name %> <%- menuOption.idx %> <%- menuOption.css %>"\n        href="<%- menuOption.url %>">\n      <% if (menuOption.iconCSS) { %>\n      <span class="<%- menuOption.iconCSS %>"></span>\n      <% } %>\n      <%- _t(menuOption.title) %>\n    </a>\n  </li>\n  <% }); %>\n</ul>\n<% } %>\n'}),define("castle-url/patterns/structure//js/views/actionmenu",["jquery","underscore","mockup-ui-url/views/base","mockup-utils","castle-url/patterns/structure//js/models/result","castle-url/patterns/structure//js/actions","castle-url/patterns/structure//js/actionmenu","text!castle-url/patterns/structure//templates/actionmenu.xml","pat-registry","translate","mockup-patterns-tooltip","bootstrap-dropdown"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return c.extend({className:"btn-group actionmenu",template:b.template(h),menuOptions:null,menuGenerator:"castle-url/patterns/structure//js/actionmenu",eventConstructor:function(a){var b=this,c=a.library,d=a.method;return"string"==typeof c&&"string"==typeof d&&function(a){var e=require(c),f=new e(b);return f[d]&&f[d](a)}},events:function(){var a=this,c={},e={};return b.each(a.menuOptions,function(b,f){var g=d.generateId();b.idx=g,b.name=f;var h=b.category||"dropdown";void 0===e[h]&&(e[h]=[]),e[h].push(b),b.css=b.css||"",!0===b.modal&&(b.css+=" pat-plone-modal");var i=a.eventConstructor(b);i&&(c["click a."+g]=i)}),a.menuOptionsCategorized=e,c},initialize:function(a){var b=this;c.prototype.initialize.apply(b,[a]),b.options=a,b.selectedCollection=b.app.selectedCollection;var d=b.options.menuGenerator||b.menuGenerator;if(d){var e=require(d),f=e(b);"object"==typeof f&&(b.menuOptions=f)}},render:function(){var b=this;b.$el.empty();var c=this.model.toJSON();return c.header=b.options.header||null,c.menuOptions=b.menuOptionsCategorized,b.$el.html(b.template(a.extend({_t:j,id:d.generateId()},c))),c.menuOptions.dropdown&&(b.$dropdown=b.$(".dropdown-toggle"),b.$dropdown.dropdown()),b.options.className&&b.$el.addClass(b.options.className),i.scan(this.$el),this}})}),define("text!castle-url/patterns/structure//templates/tablerow.xml",[],function(){return'<td class="selection"><input type="checkbox" <% if(selected){ %> checked="checked" <% } %>/></td>\n\n<td class="title">\n  <div class="pull-left">\n    <a href="<%- viewURL %>"\n        class="manage state-<%- review_state %> contenttype-<%- contenttype %>"\n        title="<%- portal_type %>">\n      <% if(Title){ %>\n        <%- Title %>\n      <% } else { %>\n        <em><%- id %></em>\n      <% } %>\n    </a>\n    <% if(expired){ %>\n      <span class="plone-item-expired"><%- _t(\'Expired\') %></span>\n    <% } %>\n  </div>\n  <% if(attributes["getIcon"] ){ %>\n  <img class="image-<%- iconSize %> pull-right" src="<%- getURL %>/@@images/image/<%- iconSize %>">\n  <% } %>\n</td>\n\n<% _.each(activeColumns, function(column) { %>\n  <% if(_.has(availableColumns, column)) { %>\n    <td class="<%- column %>"><%- attributes[column] %></td>\n  <% } %>\n<% }); %>\n\n<td class="actionmenu-container"></td>\n'}),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("moment",b):a.moment=b()}(this,function(){"use strict";function a(){return Ld.apply(null,arguments)}function b(a){return"[object Array]"===Object.prototype.toString.call(a)}function c(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function d(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function e(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function f(a,b){for(var c in b)e(b,c)&&(a[c]=b[c]);return e(b,"toString")&&(a.toString=b.toString),e(b,"valueOf")&&(a.valueOf=b.valueOf),a}function g(a,b,c,d){return Ba(a,b,c,d,!0).utc()}function h(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(a){return null==a._pf&&(a._pf=h()),a._pf}function j(a){if(null==a._isValid){var b=i(a);a._isValid=!(isNaN(a._d.getTime())||!(b.overflow<0)||b.empty||b.invalidMonth||b.invalidWeekday||b.nullInput||b.invalidFormat||b.userInvalidated),a._strict&&(a._isValid=a._isValid&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour)}return a._isValid}function k(a){var b=g(NaN);return null!=a?f(i(b),a):i(b).userInvalidated=!0,b}function l(a,b){var c,d,e;if(void 0!==b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject),void 0!==b._i&&(a._i=b._i),void 0!==b._f&&(a._f=b._f),void 0!==b._l&&(a._l=b._l),void 0!==b._strict&&(a._strict=b._strict),void 0!==b._tzm&&(a._tzm=b._tzm),void 0!==b._isUTC&&(a._isUTC=b._isUTC),void 0!==b._offset&&(a._offset=b._offset),void 0!==b._pf&&(a._pf=i(b)),void 0!==b._locale&&(a._locale=b._locale),Nd.length>0)for(c in Nd)d=Nd[c],void 0!==(e=b[d])&&(a[d]=e);return a}function m(b){l(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),!1===Od&&(Od=!0,a.updateOffset(this),Od=!1)}function n(a){return a instanceof m||null!=a&&null!=a._isAMomentObject}function o(a){return 0>a?Math.ceil(a):Math.floor(a)}function p(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=o(b)),c}function q(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&p(a[d])!==p(b[d]))&&g++;return g+f}function r(){}function s(a){return a?a.toLowerCase().replace("_","-"):a}function t(a){for(var b,c,d,e,f=0;f<a.length;){for(e=s(a[f]).split("-"),b=e.length,c=s(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=u(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&q(e,c,!0)>=b-1)break;b--}f++}return null}function u(a){var b=null;if(!Pd[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Md._abbr,require("./locale/"+a),v(b)}catch(a){}return Pd[a]}function v(a,b){var c;return a&&(c=void 0===b?x(a):w(a,b))&&(Md=c),Md._abbr}function w(a,b){return null!==b?(b.abbr=a,Pd[a]=Pd[a]||new r,Pd[a].set(b),v(a),Pd[a]):(delete Pd[a],null)}function x(a){var c;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Md;if(!b(a)){if(c=u(a))return c;a=[a]}return t(a)}function y(a,b){var c=a.toLowerCase();Qd[c]=Qd[c+"s"]=Qd[b]=a}function z(a){return"string"==typeof a?Qd[a]||Qd[a.toLowerCase()]:void 0}function A(a){var b,c,d={};for(c in a)e(a,c)&&(b=z(c))&&(d[b]=a[c]);return d}function B(b,c){return function(d){return null!=d?(D(this,b,d),a.updateOffset(this,c),this):C(this,b)}}function C(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function D(a,b,c){return a._d["set"+(a._isUTC?"UTC":"")+b](c)}function E(a,b){var c;if("object"==typeof a)for(c in a)this.set(c,a[c]);else if(a=z(a),"function"==typeof this[a])return this[a](b);return this}function F(a,b,c){var d=""+Math.abs(a),e=b-d.length;return(a>=0?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function G(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Ud[a]=e),b&&(Ud[b[0]]=function(){return F(e.apply(this,arguments),b[1],b[2])}),c&&(Ud[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function H(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function I(a){var b,c,d=a.match(Rd);for(b=0,c=d.length;c>b;b++)Ud[d[b]]?d[b]=Ud[d[b]]:d[b]=H(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function J(a,b){return a.isValid()?(b=K(b,a.localeData()),Td[b]=Td[b]||I(b),Td[b](a)):a.localeData().invalidDate()}function K(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Sd.lastIndex=0;d>=0&&Sd.test(a);)a=a.replace(Sd,c),Sd.lastIndex=0,d-=1;return a}function L(a){return"function"==typeof a&&"[object Function]"===Object.prototype.toString.call(a)}function M(a,b,c){he[a]=L(b)?b:function(a){return a&&c?c:b}}function N(a,b){return e(he,a)?he[a](b._strict,b._locale):new RegExp(O(a))}function O(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function P(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),"number"==typeof b&&(d=function(a,c){c[b]=p(a)}),c=0;c<a.length;c++)ie[a[c]]=d}function Q(a,b){P(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function R(a,b,c){null!=b&&e(ie,a)&&ie[a](b,c._a,c,a)}function S(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function T(a){return this._months[a.month()]}function U(a){return this._monthsShort[a.month()]}function V(a,b,c){var d,e,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;12>d;d++){if(e=g([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function W(a,b){var c;return"string"==typeof b&&"number"!=typeof(b=a.localeData().monthsParse(b))?a:(c=Math.min(a.date(),S(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function X(b){return null!=b?(W(this,b),a.updateOffset(this,!0),this):C(this,"Month")}function Y(){return S(this.year(),this.month())}function Z(a){var b,c=a._a;return c&&-2===i(a).overflow&&(b=c[ke]<0||c[ke]>11?ke:c[le]<1||c[le]>S(c[je],c[ke])?le:c[me]<0||c[me]>24||24===c[me]&&(0!==c[ne]||0!==c[oe]||0!==c[pe])?me:c[ne]<0||c[ne]>59?ne:c[oe]<0||c[oe]>59?oe:c[pe]<0||c[pe]>999?pe:-1,i(a)._overflowDayOfYear&&(je>b||b>le)&&(b=le),i(a).overflow=b),a}function $(b){!1===a.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function _(a,b){var c=!0;return f(function(){return c&&($(a+"\n"+(new Error).stack),c=!1),b.apply(this,arguments)},b)}function aa(a,b){se[a]||($(b),se[a]=!0)}function ba(a){var b,c,d=a._i,e=te.exec(d);if(e){for(i(a).iso=!0,b=0,c=ue.length;c>b;b++)if(ue[b][1].exec(d)){a._f=ue[b][0];break}for(b=0,c=ve.length;c>b;b++)if(ve[b][1].exec(d)){a._f+=(e[6]||" ")+ve[b][0];break}d.match(ee)&&(a._f+="Z"),ua(a)}else a._isValid=!1}function ca(b){var c=we.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(ba(b),void(!1===b._isValid&&(delete b._isValid,a.createFromInputFallback(b))))}function da(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function ea(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function fa(a){return ga(a)?366:365}function ga(a){return a%4==0&&a%100!=0||a%400==0}function ha(){return ga(this.year())}function ia(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=Ca(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ja(a){return ia(a,this._week.dow,this._week.doy).week}function ka(){return this._week.dow}function la(){return this._week.doy}function ma(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function na(a){var b=ia(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function oa(a,b,c,d,e){var f,g=6+e-d,h=ea(a,0,1+g),i=h.getUTCDay();return e>i&&(i+=7),c=null!=c?1*c:e,f=1+g+7*(b-1)-i+c,{year:f>0?a:a-1,dayOfYear:f>0?f:fa(a-1)+f}}function pa(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function qa(a,b,c){return null!=a?a:null!=b?b:c}function ra(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function sa(a){var b,c,d,e,f=[];if(!a._d){for(d=ra(a),a._w&&null==a._a[le]&&null==a._a[ke]&&ta(a),a._dayOfYear&&(e=qa(a._a[je],d[je]),a._dayOfYear>fa(e)&&(i(a)._overflowDayOfYear=!0),c=ea(e,0,a._dayOfYear),a._a[ke]=c.getUTCMonth(),a._a[le]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[me]&&0===a._a[ne]&&0===a._a[oe]&&0===a._a[pe]&&(a._nextDay=!0,a._a[me]=0),a._d=(a._useUTC?ea:da).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[me]=24)}}function ta(a){var b,c,d,e,f,g,h;b=a._w,null!=b.GG||null!=b.W||null!=b.E?(f=1,g=4,c=qa(b.GG,a._a[je],ia(Ca(),1,4).year),d=qa(b.W,1),e=qa(b.E,1)):(f=a._locale._week.dow,g=a._locale._week.doy,c=qa(b.gg,a._a[je],ia(Ca(),f,g).year),d=qa(b.w,1),null!=b.d?(e=b.d,f>e&&++d):e=null!=b.e?b.e+f:f),h=oa(c,d,e,g,f),a._a[je]=h.year,a._dayOfYear=h.dayOfYear}function ua(b){if(b._f===a.ISO_8601)return void ba(b);b._a=[],i(b).empty=!0;var c,d,e,f,g,h=""+b._i,j=h.length,k=0;for(e=K(b._f,b._locale).match(Rd)||[],c=0;c<e.length;c++)f=e[c],d=(h.match(N(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&i(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),k+=d.length),Ud[f]?(d?i(b).empty=!1:i(b).unusedTokens.push(f),R(f,d,b)):b._strict&&!d&&i(b).unusedTokens.push(f);i(b).charsLeftOver=j-k,h.length>0&&i(b).unusedInput.push(h),!0===i(b).bigHour&&b._a[me]<=12&&b._a[me]>0&&(i(b).bigHour=void 0),b._a[me]=va(b._locale,b._a[me],b._meridiem),sa(b),Z(b)}function va(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&12>b&&(b+=12),d||12!==b||(b=0),b):b}function wa(a){var b,c,d,e,g;if(0===a._f.length)return i(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)g=0,b=l({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],ua(b),j(b)&&(g+=i(b).charsLeftOver,g+=10*i(b).unusedTokens.length,i(b).score=g,(null==d||d>g)&&(d=g,c=b));f(a,c||b)}function xa(a){if(!a._d){var b=A(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],sa(a)}}function ya(a){var b=new m(Z(za(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function za(a){var d=a._i,e=a._f;return a._locale=a._locale||x(a._l),null===d||void 0===e&&""===d?k({nullInput:!0}):("string"==typeof d&&(a._i=d=a._locale.preparse(d)),n(d)?new m(Z(d)):(b(e)?wa(a):e?ua(a):c(d)?a._d=d:Aa(a),a))}function Aa(e){var f=e._i;void 0===f?e._d=new Date:c(f)?e._d=new Date(+f):"string"==typeof f?ca(e):b(f)?(e._a=d(f.slice(0),function(a){return parseInt(a,10)}),sa(e)):"object"==typeof f?xa(e):"number"==typeof f?e._d=new Date(f):a.createFromInputFallback(e)}function Ba(a,b,c,d,e){var f={};return"boolean"==typeof c&&(d=c,c=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=e,f._l=c,f._i=a,f._f=b,f._strict=d,ya(f)}function Ca(a,b,c,d){return Ba(a,b,c,d,!1)}function Da(a,c){var d,e;if(1===c.length&&b(c[0])&&(c=c[0]),!c.length)return Ca();for(d=c[0],e=1;e<c.length;++e)(!c[e].isValid()||c[e][a](d))&&(d=c[e]);return d}function Ea(){return Da("isBefore",[].slice.call(arguments,0))}function Fa(){return Da("isAfter",[].slice.call(arguments,0))}function Ga(a){var b=A(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=x(),this._bubble()}function Ha(a){return a instanceof Ga}function Ia(a,b){G(a,0,0,function(){var a=this.utcOffset(),c="+";return 0>a&&(a=-a,c="-"),c+F(~~(a/60),2)+b+F(~~a%60,2)})}function Ja(a){var b=(a||"").match(ee)||[],c=b[b.length-1]||[],d=(c+"").match(Be)||["-",0,0],e=60*d[1]+p(d[2]);return"+"===d[0]?e:-e}function Ka(b,d){var e,f;return d._isUTC?(e=d.clone(),f=(n(b)||c(b)?+b:+Ca(b))-+e,e._d.setTime(+e._d+f),a.updateOffset(e,!1),e):Ca(b).local()}function La(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Ma(b,c){var d,e=this._offset||0;return null!=b?("string"==typeof b&&(b=Ja(b)),Math.abs(b)<16&&(b*=60),!this._isUTC&&c&&(d=La(this)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),e!==b&&(!c||this._changeInProgress?ab(this,Xa(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?e:La(this)}function Na(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Oa(a){return this.utcOffset(0,a)}function Pa(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(La(this),"m")),this}function Qa(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ja(this._i)),this}function Ra(a){return a=a?Ca(a).utcOffset():0,(this.utcOffset()-a)%60==0}function Sa(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ta(){if(void 0!==this._isDSTShifted)return this._isDSTShifted;var a={};if(l(a,this),a=za(a),a._a){var b=a._isUTC?g(a._a):Ca(a._a);this._isDSTShifted=this.isValid()&&q(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ua(){return!this._isUTC}function Va(){return this._isUTC}function Wa(){return this._isUTC&&0===this._offset}function Xa(a,b){var c,d,f,g=a,h=null;return Ha(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=Ce.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:p(h[le])*c,h:p(h[me])*c,m:p(h[ne])*c,s:p(h[oe])*c,ms:p(h[pe])*c}):(h=De.exec(a))?(c="-"===h[1]?-1:1,g={y:Ya(h[2],c),M:Ya(h[3],c),d:Ya(h[4],c),h:Ya(h[5],c),m:Ya(h[6],c),s:Ya(h[7],c),w:Ya(h[8],c)}):null==g?g={}:"object"==typeof g&&("from"in g||"to"in g)&&(f=$a(Ca(g.from),Ca(g.to)),g={},g.ms=f.milliseconds,g.M=f.months),d=new Ga(g),Ha(a)&&e(a,"_locale")&&(d._locale=a._locale),d}function Ya(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function Za(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function $a(a,b){var c;return b=Ka(b,a),a.isBefore(b)?c=Za(a,b):(c=Za(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function _a(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(aa(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Xa(c,d),ab(this,e,a),this}}function ab(b,c,d,e){var f=c._milliseconds,g=c._days,h=c._months;e=null==e||e,f&&b._d.setTime(+b._d+f*d),g&&D(b,"Date",C(b,"Date")+g*d),h&&W(b,C(b,"Month")+h*d),e&&a.updateOffset(b,g||h)}function bb(a,b){var c=a||Ca(),d=Ka(c,this).startOf("day"),e=this.diff(d,"days",!0),f=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(b&&b[f]||this.localeData().calendar(f,this,Ca(c)))}function cb(){return new m(this)}function db(a,b){return b=z(void 0!==b?b:"millisecond"),"millisecond"===b?(a=n(a)?a:Ca(a),+this>+a):(n(a)?+a:+Ca(a))<+this.clone().startOf(b)}function eb(a,b){var c
;return b=z(void 0!==b?b:"millisecond"),"millisecond"===b?+(a=n(a)?a:Ca(a))>+this:(c=n(a)?+a:+Ca(a),+this.clone().endOf(b)<c)}function fb(a,b,c){return this.isAfter(a,c)&&this.isBefore(b,c)}function gb(a,b){var c;return b=z(b||"millisecond"),"millisecond"===b?(a=n(a)?a:Ca(a),+this==+a):(c=+Ca(a),+this.clone().startOf(b)<=c&&c<=+this.clone().endOf(b))}function hb(a,b,c){var d,e,f=Ka(a,this),g=6e4*(f.utcOffset()-this.utcOffset());return b=z(b),"year"===b||"month"===b||"quarter"===b?(e=ib(this,f),"quarter"===b?e/=3:"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:o(e)}function ib(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return 0>b-f?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)}function jb(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function kb(){var a=this.clone().utc();return 0<a.year()&&a.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():J(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):J(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function lb(b){var c=J(this,b||a.defaultFormat);return this.localeData().postformat(c)}function mb(a,b){return this.isValid()?Xa({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function nb(a){return this.from(Ca(),a)}function ob(a,b){return this.isValid()?Xa({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function pb(a){return this.to(Ca(),a)}function qb(a){var b;return void 0===a?this._locale._abbr:(b=x(a),null!=b&&(this._locale=b),this)}function rb(){return this._locale}function sb(a){switch(a=z(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function tb(a){return a=z(a),void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")}function ub(){return+this._d-6e4*(this._offset||0)}function vb(){return Math.floor(+this/1e3)}function wb(){return this._offset?new Date(+this):this._d}function xb(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function yb(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function zb(){return j(this)}function Ab(){return f({},i(this))}function Bb(){return i(this).overflow}function Cb(a,b){G(0,[a,a.length],0,b)}function Db(a,b,c){return ia(Ca([a,11,31+b-c]),b,c).week}function Eb(a){var b=ia(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")}function Fb(a){var b=ia(this,1,4).year;return null==a?b:this.add(a-b,"y")}function Gb(){return Db(this.year(),1,4)}function Hb(){var a=this.localeData()._week;return Db(this.year(),a.dow,a.doy)}function Ib(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Jb(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Kb(a){return this._weekdays[a.day()]}function Lb(a){return this._weekdaysShort[a.day()]}function Mb(a){return this._weekdaysMin[a.day()]}function Nb(a){var b,c,d;for(this._weekdaysParse=this._weekdaysParse||[],b=0;7>b;b++)if(this._weekdaysParse[b]||(c=Ca([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b}function Ob(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Jb(a,this.localeData()),this.add(a-b,"d")):b}function Pb(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Qb(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)}function Rb(a,b){G(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Sb(a,b){return b._meridiemParse}function Tb(a){return"p"===(a+"").toLowerCase().charAt(0)}function Ub(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Vb(a,b){b[pe]=p(1e3*("0."+a))}function Wb(){return this._isUTC?"UTC":""}function Xb(){return this._isUTC?"Coordinated Universal Time":""}function Yb(a){return Ca(1e3*a)}function Zb(){return Ca.apply(null,arguments).parseZone()}function $b(a,b,c){var d=this._calendar[a];return"function"==typeof d?d.call(b,c):d}function _b(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function ac(){return this._invalidDate}function bc(a){return this._ordinal.replace("%d",a)}function cc(a){return a}function dc(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)}function ec(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)}function fc(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function gc(a,b,c,d){var e=x(),f=g().set(d,b);return e[c](f,a)}function hc(a,b,c,d,e){if("number"==typeof a&&(b=a,a=void 0),a=a||"",null!=b)return gc(a,b,c,e);var f,g=[];for(f=0;d>f;f++)g[f]=gc(a,f,c,e);return g}function ic(a,b){return hc(a,b,"months",12,"month")}function jc(a,b){return hc(a,b,"monthsShort",12,"month")}function kc(a,b){return hc(a,b,"weekdays",7,"day")}function lc(a,b){return hc(a,b,"weekdaysShort",7,"day")}function mc(a,b){return hc(a,b,"weekdaysMin",7,"day")}function nc(){var a=this._data;return this._milliseconds=Ye(this._milliseconds),this._days=Ye(this._days),this._months=Ye(this._months),a.milliseconds=Ye(a.milliseconds),a.seconds=Ye(a.seconds),a.minutes=Ye(a.minutes),a.hours=Ye(a.hours),a.months=Ye(a.months),a.years=Ye(a.years),this}function oc(a,b,c,d){var e=Xa(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function pc(a,b){return oc(this,a,b,1)}function qc(a,b){return oc(this,a,b,-1)}function rc(a){return 0>a?Math.floor(a):Math.ceil(a)}function sc(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||0>=f&&0>=g&&0>=h||(f+=864e5*rc(uc(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=o(f/1e3),i.seconds=a%60,b=o(a/60),i.minutes=b%60,c=o(b/60),i.hours=c%24,g+=o(c/24),e=o(tc(g)),h+=e,g-=rc(uc(e)),d=o(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function tc(a){return 4800*a/146097}function uc(a){return 146097*a/4800}function vc(a){var b,c,d=this._milliseconds;if("month"===(a=z(a))||"year"===a)return b=this._days+d/864e5,c=this._months+tc(b),"month"===a?c:c/12;switch(b=this._days+Math.round(uc(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function wc(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*p(this._months/12)}function xc(a){return function(){return this.as(a)}}function yc(a){return a=z(a),this[a+"s"]()}function zc(a){return function(){return this._data[a]}}function Ac(){return o(this.days()/7)}function Bc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function Cc(a,b,c){var d=Xa(a).abs(),e=nf(d.as("s")),f=nf(d.as("m")),g=nf(d.as("h")),h=nf(d.as("d")),i=nf(d.as("M")),j=nf(d.as("y")),k=e<of.s&&["s",e]||1===f&&["m"]||f<of.m&&["mm",f]||1===g&&["h"]||g<of.h&&["hh",g]||1===h&&["d"]||h<of.d&&["dd",h]||1===i&&["M"]||i<of.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,Bc.apply(null,k)}function Dc(a,b){return void 0!==of[a]&&(void 0===b?of[a]:(of[a]=b,!0))}function Ec(a){var b=this.localeData(),c=Cc(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function Fc(){var a,b,c,d=pf(this._milliseconds)/1e3,e=pf(this._days),f=pf(this._months);a=o(d/60),b=o(a/60),d%=60,a%=60,c=o(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(0>m?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}function Gc(a,b){var c=a.split("_");return b%10==1&&b%100!=11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function Hc(a,b,c){var d={mm:b?"__":"__",hh:b?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":"h"===c?b?"":"":a+" "+Gc(d[c],+a)}function Ic(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function Jc(a,b){return{nominative:"______".split("_"),accusative:"______".split("_")}[/\[ ?[] ?(?:|)? ?\] ?dddd/.test(b)?"accusative":"nominative"][a.day()]}function Kc(a,b,c){return a+" "+Nc({mm:"munutenn",MM:"miz",dd:"devezh"}[c],a)}function Lc(a){switch(Mc(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function Mc(a){return a>9?Mc(a%10):a}function Nc(a,b){return 2===b?Oc(a):a}function Oc(a){var b={m:"v",b:"v",d:"z"};return void 0===b[a.charAt(0)]?a:b[a.charAt(0)]+a.substring(1)}function Pc(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}function Qc(a){return a>1&&5>a&&1!=~~(a/10)}function Rc(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"pr sekund":"pr sekundami";case"m":return b?"minuta":d?"minutu":"minutou";case"mm":return b||d?e+(Qc(a)?"minuty":"minut"):e+"minutami";case"h":return b?"hodina":d?"hodinu":"hodinou";case"hh":return b||d?e+(Qc(a)?"hodiny":"hodin"):e+"hodinami";case"d":return b||d?"den":"dnem";case"dd":return b||d?e+(Qc(a)?"dny":"dn"):e+"dny";case"M":return b||d?"msc":"mscem";case"MM":return b||d?e+(Qc(a)?"msce":"msc"):e+"msci";case"y":return b||d?"rok":"rokem";case"yy":return b||d?e+(Qc(a)?"roky":"let"):e+"lety"}}function Sc(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}function Tc(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}function Uc(a,b,c,d){var e={s:["mne sekundi","mni sekund","paar sekundit"],m:["he minuti","ks minut"],mm:[a+" minuti",a+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[a+" tunni",a+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[a+" kuu",a+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[a+" aasta",a+" aastat"]};return b?e[c][2]?e[c][2]:e[c][1]:d?e[c][0]:e[c][1]}function Vc(a,b,c,d){var e="";switch(c){case"s":return d?"muutaman sekunnin":"muutama sekunti";case"m":return d?"minuutin":"minuutti";case"mm":e=d?"minuutin":"minuuttia";break;case"h":return d?"tunnin":"tunti";case"hh":e=d?"tunnin":"tuntia";break;case"d":return d?"pivn":"piv";case"dd":e=d?"pivn":"piv";break;case"M":return d?"kuukauden":"kuukausi";case"MM":e=d?"kuukauden":"kuukautta";break;case"y":return d?"vuoden":"vuosi";case"yy":e=d?"vuoden":"vuotta"}return e=Wc(a,d)+" "+e}function Wc(a,b){return 10>a?b?Mf[a]:Lf[a]:a}function Xc(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}function Yc(a,b,c,d){var e=a;switch(c){case"s":return d||b?"nhny msodperc":"nhny msodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" ra":" rja");case"hh":return e+(d||b?" ra":" rja");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hnap":" hnapja");case"MM":return e+(d||b?" hnap":" hnapja");case"y":return"egy"+(d||b?" v":" ve");case"yy":return e+(d||b?" v":" ve")}return""}function Zc(a){return(a?"":"[mlt] ")+"["+Rf[this.day()]+"] LT[-kor]"}function $c(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function _c(a,b){return"___________".split("_")[a.month()]}function ad(a,b){return"______".split("_")[a.day()]}function bd(a){return a%100==11||a%10!=1}function cd(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"nokkrar sekndur":"nokkrum sekndum";case"m":return b?"mnta":"mntu";case"mm":return bd(a)?e+(b||d?"mntur":"mntum"):b?e+"mnta":e+"mntu";case"hh":return bd(a)?e+(b||d?"klukkustundir":"klukkustundum"):e+"klukkustund";case"d":return b?"dagur":d?"dag":"degi";case"dd":return bd(a)?b?e+"dagar":e+(d?"daga":"dgum"):b?e+"dagur":e+(d?"dag":"degi");case"M":return b?"mnuur":d?"mnu":"mnui";case"MM":return bd(a)?b?e+"mnuir":e+(d?"mnui":"mnuum"):b?e+"mnuur":e+(d?"mnu":"mnui");case"y":return b||d?"r":"ri";case"yy":return bd(a)?e+(b||d?"r":"rum"):e+(b||d?"r":"ri")}}function dd(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD] *MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function ed(a,b){return{nominative:"______".split("_"),accusative:"______".split("_")}[/(|)/.test(b)?"accusative":"nominative"][a.day()]}function fd(a,b,c,d){var e={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return b?e[c][0]:e[c][1]}function gd(a){return id(a.substr(0,a.indexOf(" ")))?"a "+a:"an "+a}function hd(a){return id(a.substr(0,a.indexOf(" ")))?"viru "+a:"virun "+a}function id(a){if(a=parseInt(a,10),isNaN(a))return!1;if(0>a)return!0;if(10>a)return a>=4&&7>=a;if(100>a){var b=a%10,c=a/10;return id(0===b?c:b)}if(1e4>a){for(;a>=10;)a/=10;return id(a)}return a/=1e3,id(a)}function jd(a,b,c,d){return b?"kelios sekunds":d?"keli sekundi":"kelias sekundes"}function kd(a,b){return{nominative:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),accusative:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function ld(a,b,c,d){return b?nd(c)[0]:d?nd(c)[1]:nd(c)[2]}function md(a){return a%10==0||a>10&&20>a}function nd(a){return Sf[a].split("_")}function od(a,b,c,d){var e=a+" ";return 1===a?e+ld(a,b,c[0],d):b?e+(md(a)?nd(c)[1]:nd(c)[0]):d?e+nd(c)[1]:e+(md(a)?nd(c)[1]:nd(c)[2])}function pd(a,b){var c=-1===b.indexOf("dddd HH:mm"),d=Tf[a.day()];return c?d:d.substring(0,d.length-2)+""}function qd(a,b,c){return c?b%10==1&&11!==b?a[2]:a[3]:b%10==1&&11!==b?a[0]:a[1]}function rd(a,b,c){return a+" "+qd(Uf[c],a,b)}function sd(a,b,c){return qd(Uf[c],a,b)}function td(a,b){return b?"daas sekundes":"dam sekundm"}function ud(a){return 5>a%10&&a%10>1&&~~(a/10)%10!=1}function vd(a,b,c){var d=a+" ";switch(c){case"m":return b?"minuta":"minut";case"mm":return d+(ud(a)?"minuty":"minut");case"h":return b?"godzina":"godzin";case"hh":return d+(ud(a)?"godziny":"godzin");case"MM":return d+(ud(a)?"miesice":"miesicy");case"yy":return d+(ud(a)?"lata":"lat")}}function wd(a,b,c){var d={mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},e=" ";return(a%100>=20||a>=100&&a%100==0)&&(e=" de "),a+e+d[c]}function xd(a,b){var c=a.split("_");return b%10==1&&b%100!=11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function yd(a,b,c){var d={mm:b?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":a+" "+xd(d[c],+a)}function zd(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function Ad(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function Bd(a,b){return{nominative:"______".split("_"),accusative:"______".split("_")}[/\[ ?[] ?(?:||)? ?\] ?dddd/.test(b)?"accusative":"nominative"][a.day()]}function Cd(a){return a>1&&5>a}function Dd(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"pr seknd":"pr sekundami";case"m":return b?"minta":d?"mintu":"mintou";case"mm":return b||d?e+(Cd(a)?"minty":"mint"):e+"mintami";case"h":return b?"hodina":d?"hodinu":"hodinou";case"hh":return b||d?e+(Cd(a)?"hodiny":"hodn"):e+"hodinami";case"d":return b||d?"de":"dom";case"dd":return b||d?e+(Cd(a)?"dni":"dn"):e+"dami";case"M":return b||d?"mesiac":"mesiacom";case"MM":return b||d?e+(Cd(a)?"mesiace":"mesiacov"):e+"mesiacmi";case"y":return b||d?"rok":"rokom";case"yy":return b||d?e+(Cd(a)?"roky":"rokov"):e+"rokmi"}}function Ed(a,b,c,d){var e=a+" ";switch(c){case"s":return b||d?"nekaj sekund":"nekaj sekundami";case"m":return b?"ena minuta":"eno minuto";case"mm":return e+=1===a?b?"minuta":"minuto":2===a?b||d?"minuti":"minutama":5>a?b||d?"minute":"minutami":b||d?"minut":"minutami";case"h":return b?"ena ura":"eno uro";case"hh":return e+=1===a?b?"ura":"uro":2===a?b||d?"uri":"urama":5>a?b||d?"ure":"urami":b||d?"ur":"urami";case"d":return b||d?"en dan":"enim dnem";case"dd":return e+=1===a?b||d?"dan":"dnem":2===a?b||d?"dni":"dnevoma":b||d?"dni":"dnevi";case"M":return b||d?"en mesec":"enim mesecem";case"MM":return e+=1===a?b||d?"mesec":"mesecem":2===a?b||d?"meseca":"mesecema":5>a?b||d?"mesece":"meseci":b||d?"mesecev":"meseci";case"y":return b||d?"eno leto":"enim letom";case"yy":return e+=1===a?b||d?"leto":"letom":2===a?b||d?"leti":"letoma":5>a?b||d?"leta":"leti":b||d?"let":"leti"}}function Fd(a,b,c,d){var e={s:["viensas secunds","'iensas secunds"],m:["'n mut","'iens mut"],mm:[a+" muts"," "+a+" muts"],h:["'n ora","'iensa ora"],hh:[a+" oras"," "+a+" oras"],d:["'n ziua","'iensa ziua"],dd:[a+" ziuas"," "+a+" ziuas"],M:["'n mes","'iens mes"],MM:[a+" mesen"," "+a+" mesen"],y:["'n ar","'iens ar"],yy:[a+" ars"," "+a+" ars"]};return d?e[c][0]:b?e[c][0]:e[c][1].trim()}function Gd(a,b){var c=a.split("_");return b%10==1&&b%100!=11?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function Hd(a,b,c){var d={mm:"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===c?b?"":"":"h"===c?b?"":"":a+" "+Gd(d[c],+a)}function Id(a,b){return{nominative:"___________".split("_"),accusative:"___________".split("_")}[/D[oD]? *MMMM?/.test(b)?"accusative":"nominative"][a.month()]}function Jd(a,b){return{nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")}[/(\[[]\]) ?dddd/.test(b)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(b)?"genitive":"nominative"][a.day()]}function Kd(a){return function(){return a+""+(11===this.hours()?"":"")+"] LT"}}var Ld,Md,Nd=a.momentProperties=[],Od=!1,Pd={},Qd={},Rd=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Sd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Td={},Ud={},Vd=/\d/,Wd=/\d\d/,Xd=/\d{3}/,Yd=/\d{4}/,Zd=/[+-]?\d{6}/,$d=/\d\d?/,_d=/\d{1,3}/,ae=/\d{1,4}/,be=/[+-]?\d{1,6}/,ce=/\d+/,de=/[+-]?\d+/,ee=/Z|[+-]\d\d:?\d\d/gi,fe=/[+-]?\d+(\.\d{1,3})?/,ge=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,he={},ie={},je=0,ke=1,le=2,me=3,ne=4,oe=5,pe=6;G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),G("MMMM",0,0,function(a){return this.localeData().months(this,a)}),y("month","M"),M("M",$d),M("MM",$d,Wd),M("MMM",ge),M("MMMM",ge),P(["M","MM"],function(a,b){b[ke]=p(a)-1}),P(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[ke]=e:i(c).invalidMonth=a});var qe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),se={};a.suppressDeprecationWarnings=!1;var te=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ue=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ve=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],we=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=_("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),y("year","y"),M("Y",de),M("YY",$d,Wd),M("YYYY",ae,Yd),M("YYYYY",be,Zd),M("YYYYYY",be,Zd),P(["YYYYY","YYYYYY"],je),P("YYYY",function(b,c){c[je]=2===b.length?a.parseTwoDigitYear(b):p(b)}),P("YY",function(b,c){c[je]=a.parseTwoDigitYear(b)}),a.parseTwoDigitYear=function(a){return p(a)+(p(a)>68?1900:2e3)};var xe=B("FullYear",!1);G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),y("week","w"),y("isoWeek","W"),M("w",$d),M("ww",$d,Wd),M("W",$d),M("WW",$d,Wd),Q(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=p(a)});var ye={dow:0,doy:6};G("DDD",["DDDD",3],"DDDo","dayOfYear"),y("dayOfYear","DDD"),M("DDD",_d),M("DDDD",Xd),P(["DDD","DDDD"],function(a,b,c){c._dayOfYear=p(a)}),a.ISO_8601=function(){};var ze=_("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=Ca.apply(null,arguments);return this>a?this:a}),Ae=_("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=Ca.apply(null,arguments);return a>this?this:a});Ia("Z",":"),Ia("ZZ",""),M("Z",ee),M("ZZ",ee),P(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ja(a)});var Be=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var Ce=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,De=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Xa.fn=Ga.prototype;var Ee=_a(1,"add"),Fe=_a(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Ge=_("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Cb("gggg","weekYear"),Cb("ggggg","weekYear"),Cb("GGGG","isoWeekYear"),Cb("GGGGG","isoWeekYear"),y("weekYear","gg"),y("isoWeekYear","GG"),M("G",de),M("g",de),M("GG",$d,Wd),M("gg",$d,Wd),M("GGGG",ae,Yd),M("gggg",ae,Yd),M("GGGGG",be,Zd),M("ggggg",be,Zd),Q(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=p(a)}),Q(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),G("Q",0,0,"quarter"),y("quarter","Q"),M("Q",Vd),P("Q",function(a,b){b[ke]=3*(p(a)-1)}),G("D",["DD",2],"Do","date"),y("date","D"),M("D",$d),M("DD",$d,Wd),M("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),P(["D","DD"],le),P("Do",function(a,b){b[le]=p(a.match($d)[0],10)});var He=B("Date",!0);G("d",0,"do","day"),G("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),G("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),G("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),y("day","d"),y("weekday","e"),y("isoWeekday","E"),M("d",$d),M("e",$d),M("E",$d),M("dd",ge),M("ddd",ge),M("dddd",ge),Q(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=d:i(c).invalidWeekday=a}),Q(["d","e","E"],function(a,b,c,d){b[d]=p(a)});var Ie="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Je="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ke="Su_Mo_Tu_We_Th_Fr_Sa".split("_");G("H",["HH",2],0,"hour"),G("h",["hh",2],0,function(){return this.hours()%12||12}),Rb("a",!0),Rb("A",!1),y("hour","h"),M("a",Sb),M("A",Sb),M("H",$d),M("h",$d),M("HH",$d,Wd),M("hh",$d,Wd),P(["H","HH"],me),P(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),P(["h","hh"],function(a,b,c){b[me]=p(a),i(c).bigHour=!0});var Le=/[ap]\.?m?\.?/i,Me=B("Hours",!0);G("m",["mm",2],0,"minute"),y("minute","m"),M("m",$d),M("mm",$d,Wd),P(["m","mm"],ne);var Ne=B("Minutes",!1);G("s",["ss",2],0,"second"),y("second","s"),M("s",$d),M("ss",$d,Wd),P(["s","ss"],oe);var Oe=B("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,function(){return 10*this.millisecond()}),G(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),G(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),G(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),G(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),G(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),y("millisecond","ms"),M("S",_d,Vd),M("SS",_d,Wd),M("SSS",_d,Xd);var Pe;for(Pe="SSSS";Pe.length<=9;Pe+="S")M(Pe,ce);for(Pe="S";Pe.length<=9;Pe+="S")P(Pe,Vb);var Qe=B("Milliseconds",!1);G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var Re=m.prototype;Re.add=Ee,Re.calendar=bb,Re.clone=cb,Re.diff=hb,Re.endOf=tb,Re.format=lb,Re.from=mb,Re.fromNow=nb,Re.to=ob,Re.toNow=pb,Re.get=E,Re.invalidAt=Bb,Re.isAfter=db,Re.isBefore=eb,Re.isBetween=fb,Re.isSame=gb,Re.isValid=zb,Re.lang=Ge,Re.locale=qb,Re.localeData=rb,Re.max=Ae,Re.min=ze,Re.parsingFlags=Ab,Re.set=E,Re.startOf=sb,Re.subtract=Fe,Re.toArray=xb,Re.toObject=yb,Re.toDate=wb,Re.toISOString=kb,Re.toJSON=kb,Re.toString=jb,Re.unix=vb,Re.valueOf=ub,Re.year=xe,Re.isLeapYear=ha,Re.weekYear=Eb,Re.isoWeekYear=Fb,Re.quarter=Re.quarters=Ib,Re.month=X,Re.daysInMonth=Y,Re.week=Re.weeks=ma,Re.isoWeek=Re.isoWeeks=na,Re.weeksInYear=Hb,Re.isoWeeksInYear=Gb,Re.date=He,Re.day=Re.days=Ob,Re.weekday=Pb,Re.isoWeekday=Qb,Re.dayOfYear=pa,Re.hour=Re.hours=Me,Re.minute=Re.minutes=Ne,Re.second=Re.seconds=Oe,Re.millisecond=Re.milliseconds=Qe,Re.utcOffset=Ma,Re.utc=Oa,Re.local=Pa,Re.parseZone=Qa,Re.hasAlignedHourOffset=Ra,Re.isDST=Sa,Re.isDSTShifted=Ta,Re.isLocal=Ua,Re.isUtcOffset=Va,Re.isUtc=Wa,Re.isUTC=Wa,Re.zoneAbbr=Wb,Re.zoneName=Xb,Re.dates=_("dates accessor is deprecated. Use date instead.",He),Re.months=_("months accessor is deprecated. Use month instead",X),Re.years=_("years accessor is deprecated. Use year instead",xe),Re.zone=_("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Na);var Se=Re,Te={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Ue={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ve=/\d{1,2}/,We={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Xe=r.prototype;Xe._calendar=Te,Xe.calendar=$b,Xe._longDateFormat=Ue,Xe.longDateFormat=_b,Xe._invalidDate="Invalid date",Xe.invalidDate=ac,Xe._ordinal="%d",Xe.ordinal=bc,Xe._ordinalParse=Ve,Xe.preparse=cc,Xe.postformat=cc,Xe._relativeTime=We,Xe.relativeTime=dc,Xe.pastFuture=ec,Xe.set=fc,Xe.months=T,Xe._months=qe,Xe.monthsShort=U,Xe._monthsShort=re,Xe.monthsParse=V,Xe.week=ja,Xe._week=ye,Xe.firstDayOfYear=la,Xe.firstDayOfWeek=ka,Xe.weekdays=Kb,Xe._weekdays=Ie,Xe.weekdaysMin=Mb,Xe._weekdaysMin=Ke,Xe.weekdaysShort=Lb,Xe._weekdaysShort=Je,Xe.weekdaysParse=Nb,Xe.isPM=Tb,Xe._meridiemParse=Le,Xe.meridiem=Ub,v("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10;return a+(1===p(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),a.lang=_("moment.lang is deprecated. Use moment.locale instead.",v),a.langData=_("moment.langData is deprecated. Use moment.localeData instead.",x);var Ye=Math.abs,Ze=xc("ms"),$e=xc("s"),_e=xc("m"),af=xc("h"),bf=xc("d"),cf=xc("w"),df=xc("M"),ef=xc("y"),ff=zc("milliseconds"),gf=zc("seconds"),hf=zc("minutes"),jf=zc("hours"),kf=zc("days"),lf=zc("months"),mf=zc("years"),nf=Math.round,of={s:45,m:45,h:22,d:26,M:11},pf=Math.abs,qf=Ga.prototype;qf.abs=nc,qf.add=pc,qf.subtract=qc,qf.as=vc,qf.asMilliseconds=Ze,qf.asSeconds=$e,qf.asMinutes=_e,qf.asHours=af,qf.asDays=bf,qf.asWeeks=cf,qf.asMonths=df,qf.asYears=ef,qf.valueOf=wc,qf._bubble=sc,qf.get=yc,qf.milliseconds=ff,qf.seconds=gf,qf.minutes=hf,qf.hours=jf,qf.days=kf,qf.weeks=Ac,qf.months=lf,qf.years=mf,qf.humanize=Ec,qf.toISOString=Fc,qf.toString=Fc,qf.toJSON=Fc,qf.locale=qb,qf.localeData=rb,qf.toIsoString=_("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Fc),qf.lang=Ge,G("X",0,0,"unix"),G("x",0,0,"valueOf"),M("x",de),
M("X",fe),P("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),P("x",function(a,b,c){c._d=new Date(p(a))}),a.version="2.10.6",function(a){Ld=a}(Ca),a.fn=Se,a.min=Ea,a.max=Fa,a.utc=g,a.unix=Yb,a.months=ic,a.isDate=c,a.locale=v,a.invalid=k,a.duration=Xa,a.isMoment=n,a.weekdays=kc,a.parseZone=Zb,a.localeData=x,a.isDuration=Ha,a.monthsShort=jc,a.weekdaysMin=mc,a.defineLocale=w,a.weekdaysShort=lc,a.normalizeUnits=z,a.relativeTimeThreshold=Dc;var rf=a,sf=(rf.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(a){return/^nm$/i.test(a)},meridiem:function(a,b,c){return 12>a?c?"vm":"VM":c?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},ordinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}}),rf.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),tf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},uf=(rf.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return 12>a?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return tf[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return sf[a]}).replace(/,/g,"")},week:{dow:6,doy:12}}),rf.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),vf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},wf=function(a){return 0===a?0:1===a?1:2===a?2:a%100>=3&&10>=a%100?3:a%100>=11?4:5},xf={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},yf=function(a){return function(b,c,d,e){var f=wf(b),g=xf[a][wf(b)];return 2===f&&(g=g[c?0:1]),g.replace(/%d/i,b)}},zf=["  "," "," "," "," "," "," "," "," ","  ","  ","  "],Af=(rf.defineLocale("ar",{months:zf,monthsShort:zf,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return 12>a?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:yf("s"),m:yf("m"),mm:yf("m"),h:yf("h"),hh:yf("h"),d:yf("d"),dd:yf("d"),M:yf("M"),MM:yf("M"),y:yf("y"),yy:yf("y")},preparse:function(a){return a.replace(/\u200f/g,"").replace(/[]/g,function(a){return vf[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return uf[a]}).replace(/,/g,"")},week:{dow:6,doy:12}}),{1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"}),Bf=(rf.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniyy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(a){return/^(gndz|axam)$/.test(a)},meridiem:function(a,b,c){return 4>a?"gec":12>a?"shr":17>a?"gndz":"axam"},ordinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(a){if(0===a)return a+"-nc";var b=a%10,c=a%100-b,d=a>=100?100:null;return a+(Af[b]||Af[c]||Af[d])},week:{dow:1,doy:7}}),rf.defineLocale("be",{months:Ic,monthsShort:"___________".split("_"),weekdays:Jc,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:Hc,mm:Hc,h:Hc,hh:Hc,d:"",dd:Hc,M:"",MM:Hc,y:"",yy:Hc},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":12>a?"":17>a?"":""},ordinalParse:/\d{1,2}-(||)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a%10!=2&&a%10!=3||a%100==12||a%100==13?a+"-":a+"-";case"D":return a+"-";default:return a}},week:{dow:1,doy:7}}),rf.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinalParse:/\d{1,2}-(|||||)/,ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&20>c?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Cf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Df=(rf.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Cf[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Bf[a]})},meridiemParse:/||||/,isPM:function(a){return/^(||)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Ef={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Ff=(rf.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Ef[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Df[a]})},meridiemParse:/||||/,isPM:function(a){return/^(||)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}}),rf.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",m:"ur vunutenn",mm:Kc,h:"un eur",hh:"%d eur",d:"un devezh",dd:Kc,M:"ur miz",MM:Kc,y:"ur bloaz",yy:Lc},ordinalParse:/\d{1,2}(a|vet)/,ordinal:function(a){return a+(1===a?"a":"vet")},week:{dow:1,doy:4}}),rf.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:Pc,mm:Pc,h:Pc,hh:Pc,d:"dan",dd:Pc,M:"mjesec",MM:Pc,y:"godinu",yy:Pc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),rf.defineLocale("ca",{months:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),monthsShort:"gen._febr._mar._abr._mai._jun._jul._ag._set._oct._nov._des.".split("_"),weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),longDateFormat:{LT:"H:mm",LTS:"LT:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd D MMMM YYYY H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(a,b){var c=1===a?"r":2===a?"n":3===a?"r":4===a?"t":"";return("w"===b||"W"===b)&&(c="a"),a+c},week:{dow:1,doy:4}}),"leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_")),Gf="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),Hf=(rf.defineLocale("cs",{months:Ff,monthsShort:Gf,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(Ff,Gf),weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:Rc,m:Rc,mm:Rc,h:Rc,hh:Rc,d:Rc,dd:Rc,M:Rc,MM:Rc,y:Rc,yy:Rc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(a){return a+(/$/i.exec(a)?"":/$/i.exec(a)?"":"")},past:"%s ",s:"- ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}}),rf.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},ordinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}}),rf.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY HH:mm"},calendar:{sameDay:"[I dag kl.] LT",nextDay:"[I morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[I gr kl.] LT",lastWeek:"[sidste] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[Heute um] LT [Uhr]",sameElse:"L",nextDay:"[Morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[Gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:Sc,mm:"%d Minuten",h:Sc,hh:"%d Stunden",d:Sc,dd:Sc,M:Sc,MM:Sc,y:Sc,yy:Sc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[Heute um] LT [Uhr]",sameElse:"L",nextDay:"[Morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[Gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:Tc,mm:"%d Minuten",h:Tc,hh:"%d Stunden",d:Tc,dd:Tc,M:Tc,MM:Tc,y:Tc,yy:Tc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(a,b){return/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(a,b,c){return a>11?c?"":"":c?"":""},isPM:function(a){return""===(a+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return"function"==typeof c&&(c=c.apply(b)),c.replace("{}",d%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),rf.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10;return a+(1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:1,doy:4}}),rf.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"D MMMM, YYYY",LLL:"D MMMM, YYYY h:mm A",LLLL:"dddd, D MMMM, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10;return a+(1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),rf.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(a){var b=a%10;return a+(1==~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:1,doy:4}}),rf.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"Dimano_Lundo_Mardo_Merkredo_ado_Vendredo_Sabato".split("_"),weekdaysShort:"Dim_Lun_Mard_Merk_a_Ven_Sab".split("_"),weekdaysMin:"Di_Lu_Ma_Me_a_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-an de] MMMM, YYYY",LLL:"D[-an de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-an de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(a){return"p"===a.charAt(0).toLowerCase()},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"je %s",past:"anta %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},ordinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}}),"Ene._Feb._Mar._Abr._May._Jun._Jul._Ago._Sep._Oct._Nov._Dic.".split("_")),If="Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_"),Jf=(rf.defineLocale("es",{months:"Enero_Febrero_Marzo_Abril_Mayo_Junio_Julio_Agosto_Septiembre_Octubre_Noviembre_Diciembre".split("_"),monthsShort:function(a,b){return/-MMM-/.test(b)?If[a.month()]:Hf[a.month()]},weekdays:"Domingo_Lunes_Martes_Mircoles_Jueves_Viernes_Sbado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mi._Jue._Vie._Sb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),rf.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:Uc,m:Uc,mm:Uc,h:Uc,hh:Uc,d:Uc,dd:"%d peva",M:Uc,MM:Uc,y:Uc,yy:Uc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",
llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Kf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Lf=(rf.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(a){return/  /.test(a)},meridiem:function(a,b,c){return 12>a?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[-]/g,function(a){return Kf[a]}).replace(//g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return Jf[a]}).replace(/,/g,"")},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}}),"nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" ")),Mf=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",Lf[7],Lf[8],Lf[9]],Nf=(rf.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:Vc,m:Vc,mm:Vc,h:Vc,hh:Vc,d:Vc,dd:Vc,M:Vc,MM:Vc,y:Vc,yy:Vc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnai",MM:"%d mnair",y:"eitt r",yy:"%d r"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinalParse:/\d{1,2}(er|e)/,ordinal:function(a){return a+(1===a?"er":"e")}}),rf.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinalParse:/\d{1,2}(er|)/,ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}}),"jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_")),Of="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),Pf=(rf.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(a,b){return/-MMM-/.test(b)?Of[a.month()]:Nf[a.month()]},weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},ordinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}}),rf.defineLocale("gl",{months:"Xaneiro_Febreiro_Marzo_Abril_Maio_Xuo_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"),monthsShort:"Xan._Feb._Mar._Abr._Mai._Xu._Xul._Ago._Set._Out._Nov._Dec.".split("_"),weekdays:"Domingo_Luns_Martes_Mrcores_Xoves_Venres_Sbado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mr._Xov._Ven._Sb.".split("_"),weekdaysMin:"Do_Lu_Ma_M_Xo_Ve_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd D MMMM YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return"uns segundos"===a?"nuns segundos":"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:7}}),rf.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:function(a){return 2===a?"":a+" "},d:"",dd:function(a){return 2===a?"":a+" "},M:"",MM:function(a){return 2===a?"":a+" "},y:"",yy:function(a){return 2===a?"":a%10==0&&10!==a?a+" ":a+" "}}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Qf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Rf=(rf.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Qf[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Pf[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?4>a?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}}),rf.defineLocale("hr",{months:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:Xc,mm:Xc,h:Xc,hh:Xc,d:"dan",dd:Xc,M:"mjesec",MM:Xc,y:"godinu",yy:Xc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),"vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ")),Sf=(rf.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(a){return"u"===a.charAt(1).toLowerCase()},meridiem:function(a,b,c){return 12>a?!0===c?"de":"DE":!0===c?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return Zc.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return Zc.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:Yc,m:Yc,mm:Yc,h:Yc,hh:Yc,d:Yc,dd:Yc,M:Yc,MM:Yc,y:Yc,yy:Yc},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),rf.defineLocale("hy-am",{months:$c,monthsShort:_c,weekdays:ad,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a){return 4>a?"":12>a?"":17>a?"":""},ordinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(a,b){switch(b){case"DDD":case"w":case"W":case"DDDo":return 1===a?a+"-":a+"-";default:return a}},week:{dow:1,doy:7}}),rf.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"siang"===b?a>=11?a:a+12:"sore"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){return 11>a?"pagi":15>a?"siang":19>a?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),rf.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:cd,m:cd,mm:cd,h:"klukkustund",hh:cd,d:cd,dd:cd,M:cd,MM:cd,y:cd,yy:cd},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"Domenica_Luned_Marted_Mercoled_Gioved_Venerd_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),rf.defineLocale("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahm",LTS:"Ahms",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhm",LLLL:"YYYYMDAhm dddd"},meridiemParse:/|/i,isPM:function(a){return""===a},meridiem:function(a,b,c){return 12>a?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}}),rf.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(a,b){return 12===a&&(a=0),"enjing"===b?a:"siyang"===b?a>=11?a:a+12:"sonten"===b||"ndalu"===b?a+12:void 0},meridiem:function(a,b,c){return 11>a?"enjing":15>a?"siyang":19>a?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}}),rf.defineLocale("ka",{months:dd,monthsShort:"___________".split("_"),weekdays:ed,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(a){return/(|||)/.test(a)?a.replace(/$/,""):a+""},past:function(a){return/(||||)/.test(a)?a.replace(/(|)$/," ")://.test(a)?a.replace(/$/," "):void 0},s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(a){return 0===a?a:1===a?a+"-":20>a||100>=a&&a%20==0||a%100==0?"-"+a:a+"-"},week:{dow:1,doy:7}}),rf.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}}),rf.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h m",LTS:"A h m s",L:"YYYY.MM.DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h m",LLLL:"YYYY MMMM D dddd A h m"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d",m:"",mm:"%d",h:"",hh:"%d",d:"",dd:"%d",M:"",MM:"%d",y:"",yy:"%d"},ordinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return 12>a?"":""}}),rf.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:gd,past:hd,s:"e puer Sekonnen",m:fd,mm:"%d Minutten",h:fd,hh:"%d Stonnen",d:fd,dd:"%d Deeg",M:fd,MM:"%d Mint",y:fd,yy:"%d Joer"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),{m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"}),Tf="sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),Uf=(rf.defineLocale("lt",{months:kd,monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:pd,weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:jd,m:ld,mm:od,h:ld,hh:od,d:ld,dd:od,M:ld,MM:od,y:ld,yy:od},ordinalParse:/\d{1,2}-oji/,ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}}),{m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")}),Vf=(rf.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:td,m:sd,mm:rd,h:sd,hh:rd,d:sd,dd:rd,M:sd,MM:rd,y:sd,yy:rd},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),{words:{m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&4>=a?b[1]:b[2]},translate:function(a,b,c){var d=Vf.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+Vf.correctGrammaticalCase(a,d)}}),Wf=(rf.defineLocale("me",{months:["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],monthsShort:["jan.","feb.","mar.","apr.","maj","jun","jul","avg.","sep.","okt.","nov.","dec."],weekdays:["nedjelja","ponedjeljak","utorak","srijeda","etvrtak","petak","subota"],weekdaysShort:["ned.","pon.","uto.","sri.","et.","pet.","sub."],weekdaysMin:["ne","po","ut","sr","e","pe","su"],longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",m:Vf.translate,mm:Vf.translate,h:Vf.translate,hh:Vf.translate,d:"dan",dd:Vf.translate,M:"mjesec",MM:Vf.translate,y:"godinu",yy:Vf.translate},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),rf.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},ordinalParse:/\d{1,2}-(|||||)/,ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-":0===c?a+"-":c>10&&20>c?a+"-":1===b?a+"-":2===b?a+"-":7===b||8===b?a+"-":a+"-"},week:{dow:1,doy:7}}),rf.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,isPM:function(a){return/^( ||)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":12>a?"":17>a?" ":20>a?"":""}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Xf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},Yf=(rf.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Xf[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Wf[a]})},meridiemParse:/|||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?4>a?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b?a+12:void 0},meridiem:function(a,b,c){return 4>a?"":10>a?"":17>a?"":20>a?"":""},week:{dow:0,doy:6}}),rf.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"tengahari"===b?a>=11?a:a+12:"petang"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){
return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),rf.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(a,b){return 12===a&&(a=0),"pagi"===b?a:"tengahari"===b?a>=11?a:a+12:"petang"===b||"malam"===b?a+12:void 0},meridiem:function(a,b,c){return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),Zf={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},$f=(rf.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(a){return a.replace(/[]/g,function(a){return Zf[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return Yf[a]})},week:{dow:1,doy:4}}),rf.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tirs_ons_tors_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"H.mm",LTS:"H.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H.mm",LLLL:"dddd D. MMMM YYYY [kl.] H.mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""}),_f={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},ag=(rf.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._.__._._._.".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(a){return a.replace(/[]/g,function(a){return _f[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return $f[a]})},meridiemParse:/|||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b?3>a?a:a+12:""===b?a:""===b?a>=10?a:a+12:""===b||""===b?a+12:void 0},meridiem:function(a,b,c){return 3>a?"":10>a?"":15>a?"":18>a?"":20>a?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}}),"jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_")),bg="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),cg=(rf.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,b){return/-MMM-/.test(b)?bg[a.month()]:ag[a.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},ordinalParse:/\d{1,2}(ste|de)/,ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}}),rf.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s sidan",s:"nokre sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),"stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_")),dg="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_"),eg=(rf.defineLocale("pl",{months:function(a,b){return""===b?"("+dg[a.month()]+"|"+cg[a.month()]+")":/D MMMM/.test(b)?dg[a.month()]:cg[a.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"nie_pon_wt_r_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:vd,mm:vd,h:vd,hh:vd,d:"1 dzie",dd:"%d dni",M:"miesic",MM:vd,y:"rok",yy:vd},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Tera-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Dom_2_3_4_5_6_Sb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}/,ordinal:"%d"}),rf.defineLocale("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-Feira_Tera-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Dom_2_3_4_5_6_Sb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),rf.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",m:"un minut",mm:wd,h:"o or",hh:wd,d:"o zi",dd:wd,M:"o lun",MM:wd,y:"un an",yy:wd},week:{dow:1,doy:7}}),rf.defineLocale("ru",{months:zd,monthsShort:Ad,weekdays:Bd,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:[/^/i,/^/i,/^/i,/^/i,/^[|]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT"},lastWeek:function(a){if(a.week()===this.week())return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT";switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:yd,mm:yd,h:"",hh:yd,d:"",dd:yd,M:"",MM:yd,y:"",yy:yd},meridiemParse:/|||/i,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":12>a?"":17>a?"":""},ordinalParse:/\d{1,2}-(||)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-";case"D":return a+"-";case"w":case"W":return a+"-";default:return a}},week:{dow:1,doy:7}}),rf.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},ordinalParse:/\d{1,2} /,ordinal:function(a){return a+" "},meridiem:function(a,b,c){return a>11?c?"..":" ":c?"..":" "}}),"janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_")),fg="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_"),gg=(rf.defineLocale("sk",{months:eg,monthsShort:fg,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(eg,fg),weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:Dd,m:Dd,mm:Dd,h:Dd,hh:Dd,d:Dd,dd:Dd,M:Dd,MM:Dd,y:Dd,yy:Dd},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:Ed,m:Ed,mm:Ed,h:Ed,hh:Ed,d:Ed,dd:Ed,M:Ed,MM:Ed,y:Ed,yy:Ed},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),rf.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),meridiemParse:/PD|MD/,isPM:function(a){return"M"===a.charAt(0)},meridiem:function(a,b,c){return 12>a?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),{words:{m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&4>=a?b[1]:b[2]},translate:function(a,b,c){var d=gg.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+gg.correctGrammaticalCase(a,d)}}),hg=(rf.defineLocale("sr-cyrl",{months:["","","","","","","","","","","",""],monthsShort:[".",".",".",".","","","",".",".",".",".","."],weekdays:["","","","","","",""],weekdaysShort:[".",".",".",".",".",".","."],weekdaysMin:["","","","","","",""],longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",m:gg.translate,mm:gg.translate,h:gg.translate,hh:gg.translate,d:"",dd:gg.translate,M:"",MM:gg.translate,y:"",yy:gg.translate},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),{words:{m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(a,b){return 1===a?b[0]:a>=2&&4>=a?b[1]:b[2]},translate:function(a,b,c){var d=hg.words[c];return 1===c.length?b?d[0]:d[1]:a+" "+hg.correctGrammaticalCase(a,d)}}),ig=(rf.defineLocale("sr",{months:["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],monthsShort:["jan.","feb.","mar.","apr.","maj","jun","jul","avg.","sep.","okt.","nov.","dec."],weekdays:["nedelja","ponedeljak","utorak","sreda","etvrtak","petak","subota"],weekdaysShort:["ned.","pon.","uto.","sre.","et.","pet.","sub."],weekdaysMin:["ne","po","ut","sr","e","pe","su"],longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",m:hg.translate,mm:hg.translate,h:hg.translate,hh:hg.translate,d:"dan",dd:hg.translate,M:"mesec",MM:hg.translate,y:"godinu",yy:hg.translate},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),rf.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},ordinalParse:/\d{1,2}(e|a)/,ordinal:function(a){var b=a%10;return a+(1==~~(a%100/10)?"e":1===b?"a":2===b?"a":"e")},week:{dow:1,doy:4}}),rf.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},ordinalParse:/\d{1,2}/,ordinal:function(a){return a+""},meridiemParse:/|||||/,meridiem:function(a,b,c){return 2>a?" ":6>a?" ":10>a?" ":14>a?" ":18>a?" ":22>a?" ":" "},meridiemHour:function(a,b){return 12===a&&(a=0),""===b?2>a?a:a+12:""===b||""===b?a:""===b&&a>=10?a:a+12},week:{dow:0,doy:6}}),rf.defineLocale("th",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),longDateFormat:{LT:"H  m ",LTS:"H  m  s ",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H  m ",LLLL:"dddd D MMMM YYYY  H  m "},meridiemParse:/|/,isPM:function(a){return""===a},meridiem:function(a,b,c){return 12>a?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),rf.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"[Ngayon sa] LT",nextDay:"[Bukas sa] LT",nextWeek:"dddd [sa] LT",lastDay:"[Kahapon sa] LT",lastWeek:"dddd [huling linggo] LT",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},ordinalParse:/\d{1,2}/,ordinal:function(a){return a},week:{dow:1,doy:4}}),{1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"}),jg=(rf.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinalParse:/\d{1,2}'(inci|nci|nc|nc|uncu|nc)/,ordinal:function(a){if(0===a)return a+"'nc";var b=a%10,c=a%100-b,d=a>=100?100:null;return a+(ig[b]||ig[c]||ig[d])},week:{dow:1,doy:7}}),rf.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"LT.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY LT",LLLL:"dddd, [li] D. MMMM [dallas] YYYY LT"},meridiem:function(a,b,c){return a>11?c?"d'o":"D'O":c?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:Fd,m:Fd,mm:Fd,h:Fd,hh:Fd,d:Fd,dd:Fd,M:Fd,MM:Fd,y:Fd,yy:Fd},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),rf.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}}),rf.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}}),rf.defineLocale("uk",{months:Id,monthsShort:"___________".split("_"),weekdays:Jd,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:Kd("[ "),nextDay:Kd("[ "),lastDay:Kd("[ "),nextWeek:Kd("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return Kd("[] dddd [").call(this);case 1:case 2:case 4:return Kd("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:Hd,mm:Hd,h:"",hh:Hd,d:"",dd:Hd,M:"",MM:Hd,y:"",yy:Hd},meridiemParse:/|||/,isPM:function(a){return/^(|)$/.test(a)},meridiem:function(a,b,c){return 4>a?"":12>a?"":17>a?"":""},ordinalParse:/\d{1,2}-(|)/,ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-";case"D":return a+"-";default:return a}},week:{dow:1,doy:7}}),rf.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}}),rf.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),longDateFormat:{LT:"HH:mm",
LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},ordinalParse:/\d{1,2}/,ordinal:function(a){return a},week:{dow:1,doy:4}}),rf.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahmm",LTS:"Ahms",L:"YYYY-MM-DD",LL:"YYYYMMMD",LLL:"YYYYMMMDAhmm",LLLL:"YYYYMMMDddddAhmm",l:"YYYY-MM-DD",ll:"YYYYMMMD",lll:"YYYYMMMDAhmm",llll:"YYYYMMMDddddAhmm"},meridiemParse:/|||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b||""===b||""===b?a:""===b||""===b?a+12:a>=11?a:a+12},meridiem:function(a,b,c){var d=100*a+b;return 600>d?"":900>d?"":1130>d?"":1230>d?"":1800>d?"":""},calendar:{sameDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},lastDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextWeek:function(){var a,b;return a=rf().startOf("week"),b=this.unix()-a.unix()>=604800?"[]":"[]",0===this.minutes()?b+"dddAh":b+"dddAhmm"},lastWeek:function(){var a,b;return a=rf().startOf("week"),b=this.unix()<a.unix()?"[]":"[]",0===this.minutes()?b+"dddAh":b+"dddAhmm"},sameElse:"LL"},ordinalParse:/\d{1,2}(||)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}}),rf.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahmm",LTS:"Ahms",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDAhmm",LLLL:"YYYYMMMDddddAhmm",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDAhmm",llll:"YYYYMMMDddddAhmm"},meridiemParse:/||||/,meridiemHour:function(a,b){return 12===a&&(a=0),""===b||""===b?a:""===b?a>=11?a:a+12:""===b||""===b?a+12:void 0},meridiem:function(a,b,c){var d=100*a+b;return 900>d?"":1130>d?"":1230>d?"":1800>d?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},ordinalParse:/\d{1,2}(||)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"";case"M":return a+"";case"w":case"W":return a+"";default:return a}},relativeTime:{future:"%s",past:"%s",s:"",m:"",mm:"%d",h:"",hh:"%d",d:"",dd:"%d",M:"",MM:"%d",y:"",yy:"%d"}}),rf);return jg.locale("en"),jg}),define("castle-url/patterns/structure//js/views/tablerow",["jquery","underscore","backbone","castle-url/patterns/structure//js/navigation","castle-url/patterns/structure//js/views/actionmenu","text!castle-url/patterns/structure//templates/tablerow.xml","mockup-utils","translate","moment"],function(a,b,c,d,e,f,g,h,i){"use strict";return c.View.extend({tagName:"tr",className:"itemRow",template:b.template(f),events:{"change input":"itemSelected","click td.title a.manage":"itemClicked"},initialize:function(a){this.options=a,this.app=a.app,this.selectedCollection=this.app.selectedCollection,this.table=this.options.table,this.now=i()},expired:function(a){return!!a.attributes.ExpirationDate&&i(a.attributes.ExpirationDate).diff(this.now,"seconds")<0},render:function(){var b=this,c=this.model.toJSON();c.selected=!1,this.selectedCollection.findWhere({UID:c.UID})&&(c.selected=!0),c.attributes=b.model.attributes,c.activeColumns=b.app.activeColumns,c.availableColumns=b.app.availableColumns,c.portal_type=c.portal_type?c.portal_type:"",c.contenttype=c.portal_type.toLowerCase().replace(/\.| /g,"-"),c._authenticator=g.getAuthenticator(),c.iconSize=b.app.iconSize;var d=b.app.typeToViewAction&&b.app.typeToViewAction[c.attributes.portal_type]||"";c.viewURL=c.attributes.getURL+d,c._t=h,c.expired=this.expired(c),b.$el.html(b.template(c));var f=b.model.attributes;b.$el.addClass("state-"+f.review_state).addClass("type-"+f.portal_type),f.is_folderish&&b.$el.addClass("folder"),b.$el.attr("data-path",c.path),b.$el.attr("data-UID",c.UID),b.$el.attr("data-id",c.id),b.$el.attr("data-type",c.portal_type),b.$el.attr("data-folderish",c.is_folderish),b.$el.removeClass("expired"),c.expired&&b.$el.addClass("expired"),b.el.model=this.model;var i=!!b.app.options.moveUrl;return b.menu=new e({app:b.app,model:b.model,menuOptions:b.app.menuOptions,menuGenerator:b.app.menuGenerator,canMove:i}),a(".actionmenu-container",b.$el).append(b.menu.render().el),this},itemClicked:function(a){var b,c=this,d=this.app.keyEvent;b=d&&d.ctrlKey||!this.model.attributes.is_folderish?"other":"folder";var e=c.app.options.tableRowItemAction[b]||[],f=e[0],g=e[1];if("string"!=typeof f||"string"!=typeof b)return null;var h=require(f),i=new h(c);return i[g]&&i[g](a)},itemSelected:function(){var b=this.$("input")[0];b.checked?this.app.selectedCollection.add(this.model.clone()):this.app.selectedCollection.removeResult(this.model);var c=this.selectedCollection,d=this.app.keyEvent;if(d&&d.shiftKey&&this.app.last_selected&&null!==this.app.last_selected.parentNode){var e=a(this.app.last_selected),f=e.index(),g=this.$el.index();this.app.tableView.$('input[type="checkbox"]').each(function(){e=a(this);var d=e.parents("tr").index();if(d>f&&d<g||d<f&&d>g){this.checked=b.checked;var h=a(this).closest("tr.itemRow");if(h.length>0){var i=h[0].model,j=c.getByUID(i.attributes.UID);this.checked?j||c.add(i.clone()):j&&c.removeResult(j)}}})}this.app.last_selected=this.el}})}),define("text!castle-url/patterns/structure//templates/table.xml",[],function(){return'<div class="alert alert-<%- status.type %> status">\n  <strong><%- status.label %></strong>\n  <span><%- status.text %></span>&nbsp;<% // &nbsp; to get correct height for empty alerts %>\n</div>\n\n<table class="table table-striped table-bordered">\n  <thead>\n    <tr class="fc-breadcrumbs-container">\n      <td class="fc-breadcrumbs" colspan="<%- activeColumns.length + 3 %>">\n        <a href="#" data-path="/">\n          <span class="glyphicon glyphicon-home"></span> /\n        </a>\n        <% _.each(pathParts, function(part, idx, list){\n          if(part){\n            if(idx > 0){ %>\n              /\n            <% } %>\n            <a href="#" class="crumb" data-path="<%- part %>"><%- part %></a>\n          <% }\n        }); %>\n      </td>\n    </tr>\n    <tr>\n      <th class="selection"><input type="checkbox" class="select-all" /></th>\n      <th class="title">Title</th>\n      <% _.each(activeColumns, function(column){ %>\n        <% if(_.has(availableColumns, column)) { %>\n          <th><%- availableColumns[column] %></th>\n        <% } %>\n      <% }); %>\n      <th class="actions"><%- _t("Actions") %></th>\n    </tr>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n'}),define("mockup-patterns-sortable",["jquery","pat-base","jquery.event.drop","jquery.event.drag"],function(a,b,c){"use strict";return b.extend({name:"sortable",trigger:".pat-sortable",parser:"mockup",defaults:{selector:"li",dragClass:"item-dragging",cloneClass:"dragging",createDragItem:function(a,b){return b.clone().addClass(a.options.cloneClass).css({opacity:.75,position:"absolute"}).appendTo(document.body)},drop:null},init:function(){var b=this,d=0;b.$el.find(b.options.selector).drag("start",function(e,f){var g=this,h=a(this);return a(g).addClass(b.options.dragClass),c({tolerance:function(c,d,e){if(0!==a(e.elem).closest(b.$el).length){var f=c.pageY>e.top+e.height/2;return a.data(e.elem,"drop+reorder",f?"insertAfter":"insertBefore"),this.contains(e,[c.pageX,c.pageY])}}}),d=h.index(),b.options.createDragItem(b,h)}).drag(function(b,c){a(c.proxy).css({top:c.offsetY,left:c.offsetX});var d=c.drop[0],e=a.data(d||{},"drop+reorder");e&&d&&(d!=c.current||e!=c.method)&&(a(this)[e](d),c.current=d,c.method=e,c.update())}).drag("end",function(c,e){var f=a(this);f.removeClass(b.options.dragClass),a(e.proxy).remove(),b.options.drop&&b.options.drop(f,f.index()-d)}).drop("init",function(a,b){return this!=b.drag})}})}),define("mockup-patterns-moment",["jquery","pat-base","moment","mockup-i18n"],function(a,b,c,d){"use strict";return b.extend({name:"moment",trigger:".pat-moment",parser:"mockup",defaults:{selector:null,format:"LLL",setTitle:!1},convert:function(b){var e=this,f=b.attr("data-date");f||(f=a.trim(b.html())),f&&"None"!==f&&(c.locale([(new d).currentLanguage,"en"]),f=c(f),f.isValid()&&(e.options.setTitle&&b.attr("title",f.format("LLLL")),(f="relative"===e.options.format?f.fromNow():"calendar"===e.options.format?f.calendar():f.format(e.options.format))&&b.html(f)))},init:function(){var b=this;b.options.selector?b.$el.find(b.options.selector).each(function(){b.convert(a(this))}):b.convert(b.$el)}})}),function(a){define("bootstrap-alert",["jquery"],function(){return function(){+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.4",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery)}.apply(a,arguments)})}(this),define("castle-url/patterns/structure//js/views/table",["jquery","underscore","castle-url/patterns/structure//js/views/tablerow","text!castle-url/patterns/structure//templates/table.xml","mockup-ui-url/views/base","mockup-patterns-sortable","mockup-patterns-moment","castle-url/patterns/structure//js/models/result","castle-url/patterns/structure//js/views/actionmenu","translate","bootstrap-alert"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return e.extend({tagName:"div",template:b.template(d),initialize:function(a){var b=this;e.prototype.initialize.apply(b,[a]),b.collection=b.app.collection,b.selectedCollection=b.app.selectedCollection,b.listenTo(b.collection,"sync",b.render),b.listenTo(b.selectedCollection,"remove",b.render),b.listenTo(b.selectedCollection,"reset",b.render),b.collection.pager(),b.subsetIds=[],b.contextInfo=null,b.app.on("context-info-loaded",function(a){b.contextInfo=a,b.setContextInfo()}),b.dateColumns=["ModificationDate","EffectiveDate","CreationDate","ExpirationDate","start","end","last_comment_date"]},events:{"click .fc-breadcrumbs a":"breadcrumbClicked","change .select-all":"selectAll"},setContextInfo:function(){var a=this,c=a.contextInfo,d=a.$('[data-id="'+c.defaultPage+'"]');d.length>0&&d.addClass("default-page");var e=c.breadcrumbs;if(e&&e.length){var f=a.$(".fc-breadcrumbs a.crumb");b.each(e,function(a,b){f.eq(b).html(a.title)})}},render:function(){var a=this;if(a.$el.html(a.template({_t:j,pathParts:b.filter(a.app.getCurrentPath().split("/").slice(1),function(a){return a.length>0}),status:a.app.status,activeColumns:a.app.activeColumns,availableColumns:a.app.availableColumns})),a.collection.length){var d=a.$("tbody");a.collection.each(function(b){a.dateColumns.map(function(a){!b.attributes.hasOwnProperty(a)||"None"!==b.attributes[a]&&b.attributes[a]||(b.attributes[a]="")});var e=new c({model:b,app:a.app,table:a}).render();d.append(e.el)})}return a.moment=new g(a.$el,{selector:"."+a.dateColumns.join(",."),format:a.options.app.momentFormat}),a.app.options.moveUrl&&a.addReordering(),a.storeOrder(),this},breadcrumbClicked:function(b){b.preventDefault();var c=a(b.target);"A"!==c[0].tagName&&(c=c.parent("a"));var d="";a(c.prevAll("a").get().reverse()).each(function(){var b=a(this).attr("data-path");d+=b,"/"!==b&&(d+="/")}),d+=c.attr("data-path"),this.app.setCurrentPath(d),this.collection.currentPage=1,this.collection.pager()},selectAll:function(b){a(b.target).is(":checked")?a('input[type="checkbox"]',this.$("tbody")).prop("checked",!0).change():(this.selectedCollection.remove(this.collection.models,{silent:!0}),this.selectedCollection.trigger("remove")),this.setContextInfo()},toggleSelectAll:function(b){a(b.target).is(":checked")||this.$(".select-all").prop("checked",!1)},addReordering:function(){var b=this;if(b.app.inQueryMode())return b.app.setStatus({text:j("Can not order items while querying"),type:"warning"}),void b.$el.removeClass("order-support");b.$el.addClass("order-support");new f(b.$("tbody"),{selector:"tr",createDragItem:function(b,c){var d=c.clone(),e=a("<table><tbody></tbody></table>");return a("tbody",e).append(d),e.addClass("structure-dragging").css({opacity:.85,position:"absolute"}),e.width(c.width()),e.height(c.height()),e.appendTo(document.body),e},drop:function(a,c){0!==c&&(b.app.moveItem(a.attr("data-id"),c,b.subsetIds),b.storeOrder())}})},storeOrder:function(){var b=this,c=[];b.$("tbody tr.itemRow").each(function(){c.push(a(this).attr("data-id"))}),b.subsetIds=c}})}),define("text!castle-url/patterns/structure//templates/selection_item.xml",[],function(){return'<span class="selected-item">\n  <a href="#" data-uid="<%- UID %>" title="remove" class="remove">\n    <span class="glyphicon glyphicon-remove-circle"></span>\n  </a>\n  <%- Title %>\n</span>\n'}),define("castle-url/patterns/structure//js/views/selectionwell",["jquery","underscore","mockup-ui-url/views/popover","text!castle-url/patterns/structure//templates/selection_item.xml"],function(a,b,c,d){"use strict";return c.extend({className:"popover selected-items",title:b.template('<input type="text" class="filter" placeholder="Filter" /><a href="#" class=" remove-all"><span class="glyphicon glyphicon-remove-circle"></span> <%- _t("remove all") %></a>'),content:b.template("<% collection.each(function(item) { %><%= item_template(item.toJSON()) %><% }); %>"),events:{"click a.remove":"itemRemoved","keyup input.filter":"filterSelected","click .remove-all":"removeAll"},initialize:function(a){c.prototype.initialize.apply(this,[a]);var e=this,f=0;this.listenTo(this.collection,"reset all add remove",function(){clearTimeout(f),f=setTimeout(function(){e.render()},50)}),this.options.item_template=b.template(d)},render:function(){return c.prototype.render.call(this),0===this.collection.length&&this.$el.removeClass("active"),this},itemRemoved:function(b){b.preventDefault();var c=a(b.currentTarget).data("uid");this.collection.removeByUID(c),0!==this.collection.length&&this.show()},filterSelected:function(b){var c=a(b.target).val().toLowerCase();a(".selected-item",this.$el).each(function(){var b=a(this);-1===b.text().toLowerCase().indexOf(c)?b.hide():b.show()})},removeAll:function(a){a.preventDefault(),this.collection.reset(),this.hide()}})}),define("castle-url/patterns/structure//js/views/generic-popover",["jquery","underscore","mockup-ui-url/views/popover","translate","pat-registry"],function(a,b,c,d,e){"use strict";return c.extend({events:{"click button.applyBtn":"applyButtonClicked","click button.closeBtn":"toggle"},submitText:d("Apply"),initialize:function(a){var b=this;b.app=a.app,b.className="popover "+a.id,b.title=a.form.title||a.title,b.submitText=a.form.submitText||d("Apply"),b.submitContext=a.form.submitContext||"primary",b.data={},b.options=a,b.setContent(a.form.template),c.prototype.initialize.apply(this,[a])},setContent:function(a){var c=this,d="<form>"+a+"</form>";d+='<button class="btn btn-block btn-'+c.submitContext+' applyBtn">'+c.submitText+" </button>",c.options.form.closeText&&(d+='<button class="btn btn-block btn-default closeBtn">'+c.options.form.closeText+" </button>"),this.content=b.template(d)},getTemplateOptions:function(){var b=this,c=[];return b.app.selectedCollection.each(function(a){c.push(a.toJSON())}),a.extend({},!0,b.options,{items:c,data:b.data})},applyButtonClicked:function(){var a=this,c={};b.each(a.$el.find("form").serializeArray(),function(a){c[a.name]=a.value}),a.app.buttonClickEvent(this.triggerView,c),a.hide()},afterRender:function(){var b=this;b.options.form.dataUrl?(b.$(".popover-content").html(d("Loading...")),b.app.loading.show(),a.ajax({url:b.options.form.dataUrl,dataType:"json",type:"POST",cache:!1,data:{selection:JSON.stringify(b.app.getSelectedUids()),transitions:!0,render:"yes"}}).done(function(a){b.data=a.data||a,b.renderContent(),e.scan(b.$el)}).fail(function(){var a=b.content;b.setContent("<p>"+d("Error loading popover from server.")+"</p>",!1),b.renderContent(),b.content=a}).always(function(){b.app.loading.hide(),b.position()})):(e.scan(b.$el),b.position())},toggle:function(a,b){c.prototype.toggle.apply(this,[a,b]),this.opened&&(this.$el.replaceWith(this.render().el),this.position())}})}),define("castle-url/patterns/structure//js/views/rearrange",["underscore","mockup-ui-url/views/popover","translate"],function(a,b,c){"use strict";return b.extend({className:"popover rearrange",title:a.template('<%- _t("Rearrange items in this folder") %>'),content:a.template('<div class="form-group"><label><%- _t("What to rearrange on") %></label><select name="rearrange_on" class="form-control"><% _.each(rearrangeProperties, function(title, property) { %><option value="<%- property %>"><%- title %></option><% }); %></select><p class="help-block"><b><%- _t("This permanently changes the order of items in this folder. This operation may take a long time depending on the size of the folder.") %></b></p></div><div><label> <input type="checkbox" name="reversed" /> <%- _t("Reverse") %></label></div><button class="btn btn-block btn-primary"><%- _t("Rearrange") %></button>'),events:{"click button":"rearrangeButtonClicked"},initialize:function(a){this.app=a.app,b.prototype.initialize.apply(this,[a]),this.options.rearrangeProperties=this.app.options.rearrange.properties},render:function(){return b.prototype.render.call(this),this.$rearrangeOn=this.$('[name="rearrange_on"]'),this.$reversed=this.$('[name="reversed"]'),this},rearrangeButtonClicked:function(){if("/"!==this.app.collection.queryHelper.getCurrentPath()||window.confirm(c("Sorting the content on the base of the site could affect your navigation order. Are you certain you want to do this?"))){var a={rearrange_on:this.$rearrangeOn.val(),reversed:!1};this.$reversed[0].checked&&(a.reversed=!0),this.app.buttonClickEvent(this.triggerView,a),this.hide()}}})}),define("text!castle-url/patterns/structure//templates/selection_button.xml",[],function(){return'<span class="glyphicon glyphicon-list"></span>\n<%- title %>\n<span class="label<% if (length > 0) { %> label-success<% } else { %> label-default<% } %>">\n  <%- length %>\n</span>\n'}),define("castle-url/patterns/structure//js/views/selectionbutton",["mockup-ui-url/views/button","text!castle-url/patterns/structure//templates/selection_button.xml"],function(a,b){"use strict";return a.extend({collection:null,template:b,initialize:function(b){a.prototype.initialize.apply(this,[b]);var c=this;c.timeout=0,null!==this.collection&&this.collection.on("add remove reset",function(){clearTimeout(c.timeout),c.timeout=setTimeout(function(){c.render(),0===c.collection.length&&c.$el.removeClass("active")},50)},this)},serializedModel:function(){var a={icon:"",title:this.options.title,length:0};return null!==this.collection&&(a.length=this.collection.length),a}})}),define("text!castle-url/patterns/structure/templates/paging.xml",[],function(){return'  <ul class="pagination pagination-sm pagination-centered">\n    <li class="<% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="serverfirst">\n        &laquo;\n      </a>\n    </li>\n    <li class="<% if (currentPage === 1) { %>disabled<% } %>">\n      <a href="#" class="serverprevious">\n        &lt;\n      </a>\n    </li>\n    <% _.each(pages, function(p){ %>\n    <li class="<% if (currentPage == p) { %>active<% } %>">\n      <a href="#" class="page"><%- p %></a>\n    </li>\n    <% }); %>\n    <li class="<% if (currentPage === totalPages) { %>disabled<% } %>">\n      <a href="#" class="servernext">\n        &gt;\n      </a>\n    </li>\n    <li class="<% if (currentPage === totalPages) { %>disabled<% } %>">\n      <a href="#" class="serverlast">\n        &raquo;\n      </a>\n    </li>\n  </ul>\n\n  <ul class="pagination pagination-sm">\n    <li class="disabled"><a href="#"><%- _t("Show:") %></a></li>\n    <li class="serverhowmany serverhowmany15 <% if(perPage == 15){ %>disabled<% } %>">\n      <a href="#" class="">15</a>\n    </li>\n    <li class="serverhowmany serverhowmany30 <% if(perPage == 30){ %>disabled<% } %>">\n      <a href="#" class="">30</a>\n    </li>\n    <li class="serverhowmany serverhowmany50 <% if(perPage == 50){ %>disabled<% } %>">\n      <a href="#" class="">50</a>\n    </li>\n    <li class="serverhowmany serverhowmany100000 <% if(perPage == 100000){ %>disabled<% } %>">\n      <a href="#" class="">All</a>\n    </li>\n  </ul>\n\n  <ul class="pagination pagination-sm">\n    <li class="disabled">\n      <a href="#">\n        <%- _t("Page:") %> <span class="current"><%- currentPage %></span>\n        <%- _t("of") %>\n        <span class="total"><%- totalPages %></span>\n              <%- _t("shown") %>\n      </a>\n    </li>\n  </ul>\n'}),define("castle-url/patterns/structure//js/views/paging",["jquery","underscore","backbone","text!castle-url/patterns/structure/templates/paging.xml","translate"],function(a,b,c,d,e){"use strict";return c.View.extend({events:{"click a.servernext":"nextResultPage","click a.serverprevious":"previousResultPage","click a.serverlast":"gotoLast","click a.page":"gotoPage","click a.serverfirst":"gotoFirst","click a.serverpage":"gotoPage","click .serverhowmany a":"changeCount"},tagName:"aside",template:b.template(d),maxPages:7,MAX_BATCH_SIZE:"100000",totalPagesExists:function(){return!!totalPages&&totalPages===parseInt(totalPages,10)},currentPageExists:function(){return!!currentPage&&currentPage===parseInt(currentPage,10)},pagesExist:function(){return this.currentPageExists()&&this.totalPagesExists()},initialize:function(a){this.options=a,this.app=this.options.app,this.collection=this.app.collection,this.collection.on("reset",this.render,this),this.collection.on("sync",this.render,this),this.$el.appendTo("#pagination")},render:function(){var b=this.collection.info();b.pages=this.getPages(b);var c=this.template(a.extend({_t:e},b));return this.$el.html(c),this},getPages:function(a){var b=a.totalPages;if(!b)return[];var c=a.currentPage,d=1,e=b;b>this.maxPages&&(d=Math.max(1,Math.floor(c-this.maxPages/2)),(e=Math.min(d+this.maxPages,b))-d<this.maxPages&&(d-=Math.floor(this.maxPages/2)));for(var f=[],g=d;g<=e;g+=1)f.push(g);return f[0]>1&&(f[0]>2&&(f=["..."].concat(f)),f=[1].concat(f)),f[f.length-1]<b-1&&(f[f.length-2]<b-2&&f.push("..."),f.push(b)),f},nextResultPage:function(a){a.preventDefault(),this.pagesExist()&&currentPage>=totalPages||this.collection.requestNextPage()},previousResultPage:function(a){a.preventDefault(),this.collection.requestPreviousPage()},gotoFirst:function(a){a.preventDefault(),this.collection.goTo(this.collection.information.firstPage)},gotoLast:function(a){a.preventDefault(),this.collection.goTo(this.collection.information.totalPages)},gotoPage:function(b){b.preventDefault();var c=a(b.target).text();this.collection.goTo(c)},changeCount:function(b){b.preventDefault();var c=a(b.target).text(),d="All"===c?this.MAX_BATCH_SIZE:c;this.collection.howManyPer(d),this.app.setCookieSetting("perPage",d)}})}),define("castle-url/patterns/structure//js/views/columns",["jquery","underscore","mockup-ui-url/views/popover","mockup-patterns-sortable"],function(a,b,c,d){"use strict";return c.extend({className:"popover attribute-columns",title:b.template('<%- _t("Columns") %>'),content:b.template('<label><%- _t("Select columns to show, drag and drop to reorder") %></label><ul></ul><button class="btn btn-block btn-success"><%- _t("Save") %></button>'),itemTemplate:b.template('<li><label><input type="checkbox" value="<%- id %>"/><%- title %></label></li>'),events:{"click button":"applyButtonClicked"},initialize:function(a){this.app=a.app,c.prototype.initialize.apply(this,[a])},afterRender:function(){var c=this,e=function(a,b){var d=c.app.availableColumns[a],e=c.app.availableColumns[b];return d<e?-1:d==e?0:1};c.$container=c.$("ul"),b.each(c.app.activeColumns,function(b){var d=a(c.itemTemplate({title:c.app.availableColumns[b],id:b}));d.find("input")[0].checked=!0,c.$container.append(d)});var f=b.keys(b.omit(c.app.availableColumns,c.app.activeColumns)).sort(e);b.each(f,function(b){var d=a(c.itemTemplate({title:c.app.availableColumns[b],id:b}));c.$container.append(d)});new d(c.$container,{selector:"li"});return this},applyButtonClicked:function(){var b=this;this.hide(),b.app.activeColumns=[],b.$("input:checked").each(function(){b.app.activeColumns.push(a(this).val())}),b.app.setCookieSetting(b.app.activeColumnsCookie,this.app.activeColumns),b.app.tableView.render()}})}),define("castle-url/patterns/structure//js/views/textfilter",["jquery","underscore","mockup-ui-url/views/base","mockup-ui-url/views/button","mockup-ui-url/views/popover","mockup-patterns-querystring","translate"],function(a,b,c,d,e,f,g){"use strict";return c.extend({tagName:"div",className:"navbar-search form-search ui-offset-parent",template:b.template('<div class="input-group"><input type="text" class="form-control search-query" placeholder="<%- _t("Filter") %>"><span class="input-group-btn"></span></div>'),popoverContent:b.template('<input class="pat-querystring" />'),events:{"keyup .search-query":"filter"},term:null,timeoutId:null,keyupDelay:300,initialize:function(a){c.prototype.initialize.apply(this,[a]),this.app=this.options.app},render:function(){this.$el.html(this.template({_t:g})),this.button=new d({title:g("Query"),icon:"search"}),this.popover=new e({triggerView:this.button,id:"structure-query",title:b.template(g("Query")),content:this.popoverContent,placement:"left"}),this.$(".input-group-btn").append(this.button.render().el),this.$el.append(this.popover.render().el),this.popover.$el.addClass("query"),this.$queryString=this.popover.$("input.pat-querystring"),this.queryString=new f(this.$queryString,{indexOptionsUrl:this.app.options.indexOptionsUrl,showPreviews:!1});var c=this;return c.queryString.$el.on("change",function(){c.timeoutId&&clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){var b=a.parseJSON(c.$queryString.val());c.app.additionalCriterias=b,c.app.collection.currentPage=1,c.app.collection.pager()},this.keyupDelay)}),c.queryString.$el.on("initialized",function(){c.queryString.$sortOn.on("change",function(){c.app.sort_on=c.queryString.$sortOn.val(),c.app.collection.currentPage=1,c.app.collection.pager()}),c.queryString.$sortOrder.change(function(){c.queryString.$sortOrder[0].checked?c.app.sort_order="reverse":c.app.sort_order="ascending",c.app.collection.currentPage=1,c.app.collection.pager()})}),this},filter:function(b){var c=this;c.timeoutId&&clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){c.term=a(b.currentTarget).val(),c.app.collection.currentPage=1,c.app.collection.pager()},this.keyupDelay)}})}),function(a){"function"==typeof define&&define.amd?define("dropzone",["jquery"],a):a(jQuery)}(function(a){var b={exports:{}};return function(){var c,d,e,f,g,h,i,j,k=[].slice,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=function(){},d=function(){function a(){}return a.prototype.addEventListener=a.prototype.on,a.prototype.on=function(a,b){return this._callbacks=this._callbacks||{},this._callbacks[a]||(this._callbacks[a]=[]),this._callbacks[a].push(b),this},a.prototype.emit=function(){var a,b,c,d,e,f;if(d=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],this._callbacks=this._callbacks||{},c=this._callbacks[d])for(e=0,f=c.length;e<f;e++)b=c[e],b.apply(this,a);return this},a.prototype.removeListener=a.prototype.off,a.prototype.removeAllListeners=a.prototype.off,a.prototype.removeEventListener=a.prototype.off,a.prototype.off=function(a,b){var c,d,e,f;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(!(c=this._callbacks[a]))return this;if(1===arguments.length)return delete this._callbacks[a],this;for(d=e=0,f=c.length;e<f;d=++e)if(c[d]===b){c.splice(d,1);break}return this},a}(),c=function(a){function b(a,d){var e,f,g;if(this.element=a,this.version=b.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(b.instances.push(this),this.element.dropzone=this,e=null!=(g=b.optionsForElement(this.element))?g:{},this.options=c({},this.defaultOptions,e,null!=d?d:{}),this.options.forceFallback||!b.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(f=this.getExistingFallback())&&f.parentNode&&f.parentNode.removeChild(f),!1!==this.options.previewsContainer&&(this.options.previewsContainer?this.previewsContainer=b.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(!0===this.options.clickable?this.clickableElements=[this.element]:this.clickableElements=b.getElements(this.options.clickable,"clickable")),this.init()}var c,e;return m(b,a),b.prototype.Emitter=d,b.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],b.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,
dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(a,b){return b()},init:function(){return i},forceFallback:!1,fallback:function(){var a,c,d,e,f,g;for(this.element.className=this.element.className+" dz-browser-not-supported",g=this.element.getElementsByTagName("div"),e=0,f=g.length;e<f;e++)a=g[e],/(^| )dz-message($| )/.test(a.className)&&(c=a,a.className="dz-message");return c||(c=b.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(c)),d=c.getElementsByTagName("span")[0],d&&(d.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;return b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height},c=a.width/a.height,b.optWidth=this.options.thumbnailWidth,b.optHeight=this.options.thumbnailHeight,null==b.optWidth&&null==b.optHeight?(b.optWidth=b.srcWidth,b.optHeight=b.srcHeight):null==b.optWidth?b.optWidth=c*b.optHeight:null==b.optHeight&&(b.optHeight=1/c*b.optWidth),d=b.optWidth/b.optHeight,a.height<b.optHeight||a.width<b.optWidth?(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d),b.srcX=(a.width-b.srcWidth)/2,b.srcY=(a.height-b.srcHeight)/2,b},drop:function(a){return this.element.classList.remove("dz-drag-hover")},dragstart:i,dragend:function(a){return this.element.classList.remove("dz-drag-hover")},dragenter:function(a){return this.element.classList.add("dz-drag-hover")},dragover:function(a){return this.element.classList.add("dz-drag-hover")},dragleave:function(a){return this.element.classList.remove("dz-drag-hover")},paste:i,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(a.previewElement=b.createElement(this.options.previewTemplate.trim()),a.previewTemplate=a.previewElement,this.previewsContainer.appendChild(a.previewElement),l=a.previewElement.querySelectorAll("[data-dz-name]"),f=0,i=l.length;f<i;f++)c=l[f],c.textContent=a.name;for(m=a.previewElement.querySelectorAll("[data-dz-size]"),g=0,j=m.length;g<j;g++)c=m[g],c.innerHTML=this.filesize(a.size);for(this.options.addRemoveLinks&&(a._removeLink=b.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink)),d=function(c){return function(d){return d.preventDefault(),d.stopPropagation(),a.status===b.UPLOADING?b.confirm(c.options.dictCancelUploadConfirmation,function(){return c.removeFile(a)}):c.options.dictRemoveFileConfirmation?b.confirm(c.options.dictRemoveFileConfirmation,function(){return c.removeFile(a)}):c.removeFile(a)}}(this),n=a.previewElement.querySelectorAll("[data-dz-remove]"),o=[],h=0,k=n.length;h<k;h++)e=n[h],o.push(e.addEventListener("click",d));return o}},removedfile:function(a){var b;return a.previewElement&&null!=(b=a.previewElement)&&b.parentNode.removeChild(a.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c,d,e,f;if(a.previewElement){for(a.previewElement.classList.remove("dz-file-preview"),f=a.previewElement.querySelectorAll("[data-dz-thumbnail]"),d=0,e=f.length;d<e;d++)c=f[d],c.alt=a.name,c.src=b;return setTimeout(function(b){return function(){return a.previewElement.classList.add("dz-image-preview")}}(),1)}},error:function(a,b){var c,d,e,f,g;if(a.previewElement){for(a.previewElement.classList.add("dz-error"),"String"!=typeof b&&b.error&&(b=b.error),f=a.previewElement.querySelectorAll("[data-dz-errormessage]"),g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(c.textContent=b);return g}},errormultiple:i,processing:function(a){if(a.previewElement&&(a.previewElement.classList.add("dz-processing"),a._removeLink))return a._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:i,uploadprogress:function(a,b,c){var d,e,f,g,h;if(a.previewElement){for(g=a.previewElement.querySelectorAll("[data-dz-uploadprogress]"),h=[],e=0,f=g.length;e<f;e++)d=g[e],"PROGRESS"===d.nodeName?h.push(d.value=b):h.push(d.style.width=b+"%");return h}},totaluploadprogress:i,sending:i,sendingmultiple:i,success:function(a){if(a.previewElement)return a.previewElement.classList.add("dz-success")},successmultiple:i,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:i,complete:function(a){if(a._removeLink&&(a._removeLink.textContent=this.options.dictRemoveFile),a.previewElement)return a.previewElement.classList.add("dz-complete")},completemultiple:i,maxfilesexceeded:i,maxfilesreached:i,queuecomplete:i,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},c=function(){var a,b,c,d,e,f,g;for(d=arguments[0],c=2<=arguments.length?k.call(arguments,1):[],f=0,g=c.length;f<g;f++){b=c[f];for(a in b)e=b[a],d[a]=e}return d},b.prototype.getAcceptedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.accepted&&e.push(a);return e},b.prototype.getRejectedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.accepted||e.push(a);return e},b.prototype.getFilesWithStatus=function(a){var b,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;c<d;c++)b=e[c],b.status===a&&f.push(b);return f},b.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(b.QUEUED)},b.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(b.UPLOADING)},b.prototype.getActiveFiles=function(){var a,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;c<d;c++)a=e[c],a.status!==b.UPLOADING&&a.status!==b.QUEUED||f.push(a);return f},b.prototype.init=function(){var a,c,d,e,f,g,h;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(b.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(d=function(a){return function(){return a.hiddenFileInput&&document.body.removeChild(a.hiddenFileInput),a.hiddenFileInput=document.createElement("input"),a.hiddenFileInput.setAttribute("type","file"),(null==a.options.maxFiles||a.options.maxFiles>1)&&a.hiddenFileInput.setAttribute("multiple","multiple"),a.hiddenFileInput.className="dz-hidden-input",null!=a.options.acceptedFiles&&a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles),null!=a.options.capture&&a.hiddenFileInput.setAttribute("capture",a.options.capture),a.hiddenFileInput.style.visibility="hidden",a.hiddenFileInput.style.position="absolute",a.hiddenFileInput.style.top="0",a.hiddenFileInput.style.left="0",a.hiddenFileInput.style.height="0",a.hiddenFileInput.style.width="0",document.body.appendChild(a.hiddenFileInput),a.hiddenFileInput.addEventListener("change",function(){var b,c,e,f;if(c=a.hiddenFileInput.files,c.length)for(e=0,f=c.length;e<f;e++)b=c[e],a.addFile(b);return d()})}}(this))(),this.URL=null!=(g=window.URL)?g:window.webkitURL,h=this.events,e=0,f=h.length;e<f;e++)a=h[e],this.on(a,this.options[a]);return this.on("uploadprogress",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("canceled",function(a){return function(b){return a.emit("complete",b)}}(this)),this.on("complete",function(a){return function(b){if(0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length)return setTimeout(function(){return a.emit("queuecomplete")},0)}}(this)),c=function(a){return a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(a){return function(b){return a.emit("dragstart",b)}}(this),dragenter:function(a){return function(b){return c(b),a.emit("dragenter",b)}}(this),dragover:function(a){return function(b){var d;try{d=b.dataTransfer.effectAllowed}catch(a){}return b.dataTransfer.dropEffect="move"===d||"linkMove"===d?"move":"copy",c(b),a.emit("dragover",b)}}(this),dragleave:function(a){return function(b){return a.emit("dragleave",b)}}(this),drop:function(a){return function(b){return c(b),a.drop(b)}}(this),dragend:function(a){return function(b){return a.emit("dragend",b)}}(this)}}],this.clickableElements.forEach(function(a){return function(c){return a.listeners.push({element:c,events:{click:function(d){if(c!==a.element||d.target===a.element||b.elementInside(d.target,a.element.querySelector(".dz-message")))return a.hiddenFileInput.click()}}})}}(this)),this.enable(),this.options.init.call(this)},b.prototype.destroy=function(){var a;return this.disable(),this.removeAllFiles(!0),(null!=(a=this.hiddenFileInput)?a.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,b.instances.splice(b.instances.indexOf(this),1)},b.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f,g,h;if(d=0,c=0,a=this.getActiveFiles(),a.length){for(h=this.getActiveFiles(),f=0,g=h.length;f<g;f++)b=h[f],d+=b.upload.bytesSent,c+=b.upload.total;e=100*d/c}else e=100;return this.emit("totaluploadprogress",e,c,d)},b.prototype._getParamName=function(a){return"function"==typeof this.options.paramName?this.options.paramName(a):this.options.paramName+(this.options.uploadMultiple?"["+a+"]":"")},b.prototype.getFallbackForm=function(){var a,c,d,e;return(a=this.getExistingFallback())?a:(d='<div class="dz-fallback">',this.options.dictFallbackText&&(d+="<p>"+this.options.dictFallbackText+"</p>"),d+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',c=b.createElement(d),"FORM"!==this.element.tagName?(e=b.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),e.appendChild(c)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=e?e:c)},b.prototype.getExistingFallback=function(){var a,b,c,d,e,f;for(b=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b},f=["div","form"],d=0,e=f.length;d<e;d++)if(c=f[d],a=b(this.element.getElementsByTagName(c)))return a},b.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,c,!1));return e}());return g},b.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g},b.prototype.disable=function(){var a,b,c,d,e;for(this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")}),this.removeEventListeners(),d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.cancelUpload(a));return e},b.prototype.enable=function(){return this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")}),this.setupEventListeners()},b.prototype.filesize=function(a){var b,c,d,e,f,g,h,i;for(g=["TB","GB","MB","KB","b"],d=e=null,c=h=0,i=g.length;h<i;c=++h)if(f=g[c],b=Math.pow(this.options.filesizeBase,4-c)/10,a>=b){d=a/Math.pow(this.options.filesizeBase,4-c),e=f;break}return"<strong>"+(d=Math.round(10*d)/10)+"</strong> "+e},b.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},b.prototype.drop=function(a){var b,c;a.dataTransfer&&(this.emit("drop",a),b=a.dataTransfer.files,b.length&&(c=a.dataTransfer.items,c&&c.length&&null!=c[0].webkitGetAsEntry?this._addFilesFromItems(c):this.handleFiles(b)))},b.prototype.paste=function(a){var b,c;if(null!=(null!=a&&null!=(c=a.clipboardData)?c.items:void 0))return this.emit("paste",a),b=a.clipboardData.items,b.length?this._addFilesFromItems(b):void 0},b.prototype.handleFiles=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this.addFile(b));return e},b.prototype._addFilesFromItems=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)c=a[d],null!=c.webkitGetAsEntry&&(b=c.webkitGetAsEntry())?b.isFile?f.push(this.addFile(c.getAsFile())):b.isDirectory?f.push(this._addFilesFromDirectory(b,b.name)):f.push(void 0):null!=c.getAsFile&&(null==c.kind||"file"===c.kind)?f.push(this.addFile(c.getAsFile())):f.push(void 0);return f},b.prototype._addFilesFromDirectory=function(a,b){var c,d;return c=a.createReader(),d=function(a){return function(c){var d,e,f;for(e=0,f=c.length;e<f;e++)d=c[e],d.isFile?d.file(function(c){if(!a.options.ignoreHiddenFiles||"."!==c.name.substring(0,1))return c.fullPath=b+"/"+c.name,a.addFile(c)}):d.isDirectory&&a._addFilesFromDirectory(d,b+"/"+d.name)}}(this),c.readEntries(d,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(a):void 0})},b.prototype.accept=function(a,c){return a.size>1024*this.options.maxFilesize*1024?c(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):b.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(c(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,c):c(this.options.dictInvalidFileType)},b.prototype.addFile=function(a){return a.upload={progress:0,total:a.size,bytesSent:0},this.files.push(a),a.status=b.ADDED,this.emit("addedfile",a),this._enqueueThumbnail(a),this.accept(a,function(b){return function(c){return c?(a.accepted=!1,b._errorProcessing([a],c)):(a.accepted=!0,b.options.autoQueue&&b.enqueueFile(a)),b._updateMaxFilesReachedClass()}}(this))},b.prototype.enqueueFiles=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)b=a[c],this.enqueueFile(b);return null},b.prototype.enqueueFile=function(a){if(a.status!==b.ADDED||!0!==a.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(a.status=b.QUEUED,this.options.autoProcessQueue)return setTimeout(function(a){return function(){return a.processQueue()}}(this),0)},b.prototype._thumbnailQueue=[],b.prototype._processingThumbnail=!1,b.prototype._enqueueThumbnail=function(a){if(this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(a),setTimeout(function(a){return function(){return a._processThumbnailQueue()}}(this),0)},b.prototype._processThumbnailQueue=function(){if(!this._processingThumbnail&&0!==this._thumbnailQueue.length)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(a){return function(){return a._processingThumbnail=!1,a._processThumbnailQueue()}}(this))},b.prototype.removeFile=function(a){if(a.status===b.UPLOADING&&this.cancelUpload(a),this.files=j(this.files,a),this.emit("removedfile",a),0===this.files.length)return this.emit("reset")},b.prototype.removeAllFiles=function(a){var c,d,e,f;for(null==a&&(a=!1),f=this.files.slice(),d=0,e=f.length;d<e;d++)c=f[d],(c.status!==b.UPLOADING||a)&&this.removeFile(c);return null},b.prototype.createThumbnail=function(a,b){var c;return c=new FileReader,c.onload=function(d){return function(){return"image/svg+xml"===a.type?(d.emit("thumbnail",a,c.result),void(null!=b&&b())):d.createThumbnailFromUrl(a,c.result,b)}}(this),c.readAsDataURL(a)},b.prototype.createThumbnailFromUrl=function(a,b,c){var d;return d=document.createElement("img"),d.onload=function(b){return function(){var e,f,g,i,j,k,l,m;if(a.width=d.width,a.height=d.height,g=b.options.resize.call(b,a),null==g.trgWidth&&(g.trgWidth=g.optWidth),null==g.trgHeight&&(g.trgHeight=g.optHeight),e=document.createElement("canvas"),f=e.getContext("2d"),e.width=g.trgWidth,e.height=g.trgHeight,h(f,d,null!=(j=g.srcX)?j:0,null!=(k=g.srcY)?k:0,g.srcWidth,g.srcHeight,null!=(l=g.trgX)?l:0,null!=(m=g.trgY)?m:0,g.trgWidth,g.trgHeight),i=e.toDataURL("image/png"),b.emit("thumbnail",a,i),null!=c)return c()}}(this),null!=c&&(d.onerror=c),d.src=b},b.prototype.processQueue=function(){var a,b,c,d;if(b=this.options.parallelUploads,c=this.getUploadingFiles().length,a=c,!(c>=b)&&(d=this.getQueuedFiles(),d.length>0)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));for(;a<b;){if(!d.length)return;this.processFile(d.shift()),a++}}},b.prototype.processFile=function(a){return this.processFiles([a])},b.prototype.processFiles=function(a){var c,d,e;for(d=0,e=a.length;d<e;d++)c=a[d],c.processing=!0,c.status=b.UPLOADING,this.emit("processing",c);return this.options.uploadMultiple&&this.emit("processingmultiple",a),this.uploadFiles(a)},b.prototype._getFilesWithXhr=function(a){var b;return function(){var c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;c<d;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)},b.prototype.cancelUpload=function(a){var c,d,e,f,g,h,i;if(a.status===b.UPLOADING){for(d=this._getFilesWithXhr(a.xhr),e=0,g=d.length;e<g;e++)c=d[e],c.status=b.CANCELED;for(a.xhr.abort(),f=0,h=d.length;f<h;f++)c=d[f],this.emit("canceled",c);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else(i=a.status)!==b.ADDED&&i!==b.QUEUED||(a.status=b.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]));if(this.options.autoProcessQueue)return this.processQueue()},e=function(){var a,b;return b=arguments[0],a=2<=arguments.length?k.call(arguments,1):[],"function"==typeof b?b.apply(this,a):b},b.prototype.uploadFile=function(a){return this.uploadFiles([a])},b.prototype.uploadFiles=function(a){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(w=new XMLHttpRequest,x=0,B=a.length;x<B;x++)d=a[x],d.xhr=w;p=e(this.options.method,a),u=e(this.options.url,a),w.open(p,u,!0),w.withCredentials=!!this.options.withCredentials,s=null,g=function(b){return function(){var c,e,f;for(f=[],c=0,e=a.length;c<e;c++)d=a[c],f.push(b._errorProcessing(a,s||b.options.dictResponseError.replace("{{statusCode}}",w.status),w));return f}}(this),t=function(b){return function(c){var e,f,g,h,i,j,k,l,m;if(null!=c)for(f=100*c.loaded/c.total,g=0,j=a.length;g<j;g++)d=a[g],d.upload={progress:f,total:c.total,bytesSent:c.loaded};else{for(e=!0,f=100,h=0,k=a.length;h<k;h++)d=a[h],100===d.upload.progress&&d.upload.bytesSent===d.upload.total||(e=!1),d.upload.progress=f,d.upload.bytesSent=d.upload.total;if(e)return}for(m=[],i=0,l=a.length;i<l;i++)d=a[i],m.push(b.emit("uploadprogress",d,f,d.upload.bytesSent));return m}}(this),w.onload=function(c){return function(d){var e;if(a[0].status!==b.CANCELED&&4===w.readyState){if(s=w.responseText,w.getResponseHeader("content-type")&&~w.getResponseHeader("content-type").indexOf("application/json"))try{s=JSON.parse(s)}catch(a){d=a,s="Invalid JSON response from server."}return t(),200<=(e=w.status)&&e<300?c._finished(a,s,d):g()}}}(this),w.onerror=function(c){return function(){if(a[0].status!==b.CANCELED)return g()}}(),r=null!=(G=w.upload)?G:w,r.onprogress=t,j={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&c(j,this.options.headers);for(h in j)i=j[h],w.setRequestHeader(h,i);if(f=new FormData,this.options.params){H=this.options.params;for(o in H)v=H[o],f.append(o,v)}for(y=0,C=a.length;y<C;y++)d=a[y],this.emit("sending",d,w,f);if(this.options.uploadMultiple&&this.emit("sendingmultiple",a,w,f),"FORM"===this.element.tagName)for(I=this.element.querySelectorAll("input, textarea, select, button"),z=0,D=I.length;z<D;z++)if(l=I[z],m=l.getAttribute("name"),n=l.getAttribute("type"),"SELECT"===l.tagName&&l.hasAttribute("multiple"))for(J=l.options,A=0,E=J.length;A<E;A++)q=J[A],q.selected&&f.append(m,q.value);else(!n||"checkbox"!==(K=n.toLowerCase())&&"radio"!==K||l.checked)&&f.append(m,l.value);for(k=F=0,L=a.length-1;0<=L?F<=L:F>=L;k=0<=L?++F:--F)f.append(this._getParamName(k),a[k],a[k].name);return w.send(f)},b.prototype._finished=function(a,c,d){var e,f,g;for(f=0,g=a.length;f<g;f++)e=a[f],e.status=b.SUCCESS,this.emit("success",e,c,d),this.emit("complete",e);if(this.options.uploadMultiple&&(this.emit("successmultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue)return this.processQueue()},b.prototype._errorProcessing=function(a,c,d){var e,f,g;for(f=0,g=a.length;f<g;f++)e=a[f],e.status=b.ERROR,this.emit("error",e,c,d),this.emit("complete",e);if(this.options.uploadMultiple&&(this.emit("errormultiple",a,c,d),this.emit("completemultiple",a)),this.options.autoProcessQueue)return this.processQueue()},b}(d),c.version="4.0.1",c.options={},c.optionsForElement=function(a){return a.getAttribute("id")?c.options[e(a.getAttribute("id"))]:void 0},c.instances=[],c.forElement=function(a){if("string"==typeof a&&(a=document.querySelector(a)),null==(null!=a?a.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone},c.autoDiscover=!0,c.discover=function(){var a,b,d,e,f,g;for(document.querySelectorAll?d=document.querySelectorAll(".dropzone"):(d=[],a=function(a){var b,c,e,f;for(f=[],c=0,e=a.length;c<e;c++)b=a[c],/(^| )dropzone($| )/.test(b.className)?f.push(d.push(b)):f.push(void 0);return f},a(document.getElementsByTagName("div")),a(document.getElementsByTagName("form"))),g=[],e=0,f=d.length;e<f;e++)b=d[e],!1!==c.optionsForElement(b)?g.push(new c(b)):g.push(void 0);return g},c.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],c.isBrowserSupported=function(){var a,b,d,e,f;if(a=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(f=c.blacklistedBrowsers,d=0,e=f.length;d<e;d++)b=f[d],b.test(navigator.userAgent)&&(a=!1);else a=!1;else a=!1;return a},j=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)(c=a[d])!==b&&f.push(c);return f},e=function(a){return a.replace(/[\-_](\w)/g,function(a){return a.charAt(1).toUpperCase()})},c.createElement=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},c.elementInside=function(a,b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1},c.getElement=function(a,b){var c;if("string"==typeof a?c=document.querySelector(a):null!=a.nodeType&&(c=a),null==c)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c},c.getElements=function(a,b){var c,d,e,f,g,h,i;if(a instanceof Array){d=[];try{for(e=0,g=a.length;e<g;e++)c=a[e],d.push(this.getElement(c,b))}catch(a){a,d=null}}else if("string"==typeof a)for(d=[],i=document.querySelectorAll(a),f=0,h=i.length;f<h;f++)c=i[f],d.push(c);else null!=a.nodeType&&(d=[a]);if(null==d||!d.length)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return d},c.confirm=function(a,b,c){return window.confirm(a)?b():null!=c?c():void 0},c.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;for(b=b.split(","),d=a.type,c=d.replace(/\/.*$/,""),f=0,g=b.length;f<g;f++)if(e=b[f],e=e.trim(),"."===e.charAt(0)){if(-1!==a.name.toLowerCase().indexOf(e.toLowerCase(),a.name.length-e.length))return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1},void 0!==a&&null!==a&&(a.fn.dropzone=function(a){return this.each(function(){return new c(this,a)})}),void 0!==b&&null!==b?b.exports=c:window.Dropzone=c,c.ADDED="added",c.QUEUED="queued",c.ACCEPTED=c.QUEUED,c.UPLOADING="uploading",c.PROCESSING=c.UPLOADING,c.CANCELED="canceled",c.ERROR="error",c.SUCCESS="success",g=function(a){var b,c,d,e,f,g,h,i,j;for(a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas"),c.width=1,c.height=g,d=c.getContext("2d"),d.drawImage(a,0,0),e=d.getImageData(0,0,1,g).data,j=0,f=g,h=g;h>j;)b=e[4*(h-1)+3],0===b?f=h:j=h,h=f+j>>1;return i=h/g,0===i?1:i},h=function(a,b,c,d,e,f,h,i,j,k){var l;return l=g(b),a.drawImage(b,c,d,e,f,h,i,j,k/l)},f=function(a,b){var c,d,e,f,g,h,i,j,k;if(e=!1,k=!0,d=a.document,j=d.documentElement,c=d.addEventListener?"addEventListener":"attachEvent",i=d.addEventListener?"removeEventListener":"detachEvent",h=d.addEventListener?"":"on",f=function(c){if("readystatechange"!==c.type||"complete"===d.readyState)return("load"===c.type?a:d)[i](h+c.type,f,!1),!e&&(e=!0)?b.call(a,c.type||c):void 0},g=function(){try{j.doScroll("left")}catch(a){return a,void setTimeout(g,50)}return f("poll")},"complete"!==d.readyState){if(d.createEventObject&&j.doScroll){try{k=!a.frameElement}catch(a){}k&&g()}return d[c](h+"DOMContentLoaded",f,!1),d[c](h+"readystatechange",f,!1),a[c](h+"load",f,!1)}},c._autoDiscoverFunction=function(){if(c.autoDiscover)return c.discover()},f(window,c._autoDiscoverFunction)}.call(this),b.exports}),define("text!mockup-patterns-upload-url/templates/upload.xml",[],function(){return'<div class="upload-container upload-multiple">\n    <h2 class="title"><%- _t("Upload here") %></h2>\n    <p class="help">\n        <%- _t(\'Drag and drop files from your computer onto the area below or click the "Browse" button.\') %>\n    </p>\n    <div class="upload-area">\n        <div class="fallback">\n            <input name="file" type="file" multiple />\n        </div>\n        <div class="dz-message"><p><%-_t("Drop files here...")%></p></div>\n        <div class="row browse-select">\n            <div class="col-md-9">\n                <input\n                    id="fakeUploadFile"\n                    placeholder="<%- _t("Choose File") %>"\n                    disabled="disabled"\n                    />\n            </div>\n            <div class="col-md-3">\n                <button\n                    type="button"\n                    class="btn btn-primary browse">\n                    Browse\n                </button>\n            </div>\n        </div>\n        <div class="upload-queue">\n            <div class="previews">\n            </div>\n            <div class="controls">\n                <% if (allowPathSelection) { %>\n                <div class="path">\n                    <label><%- _t("Upload to...") %></label>\n                    <p class="form-help">\n                        <%- _t("Select another destination folder or leave blank to add files to the current location.") %>\n                    </p>\n                    <input\n                        type="text"\n                        name="location"\n                        />\n                </div>\n                <% } %>\n                <div class="actions row">\n                    <div class="col-md-9">\n                        <div class="progress progress-striped active">\n                            <div class="progress-bar progress-bar-success"\n                                 role="progressbar"\n                                 aria-valuenow="0"\n                                 aria-valuemin="0"\n                                 aria-valuemax="100"\n                                 style="width: 0%">\n                                <span class="sr-only">40% Complete (success)</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3 align-right">\n                        <button\n                            type="button"\n                            class="btn btn-primary upload-all">\n                            <%- _t("Upload") %>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),
define("text!mockup-patterns-upload-url/templates/preview.xml",[],function(){return'<div class="row item form-inline">\n    <div class="col-md-1 action">\n        <button\n            type="button"\n            class="btn btn-danger btn-xs remove-item"\n            data-dz-remove=""\n            href="javascript:undefined;">\n            <span class="glyphicon glyphicon-remove"></span>\n        </button>\n    </div>\n    <div class="col-md-8 title">\n        <div class="dz-preview">\n          <div class="dz-details">\n            <div class="dz-filename"><span data-dz-name></span></div>\n          </div>\n          <div class="dz-error-message"><span data-dz-errormessage></span></div>\n        </div>\n        <div class="dz-progress">\n            <span class="dz-upload" data-dz-uploadprogress></span>\n        </div>\n    </div>\n    <div class="col-md-3 info">\n        <div class="dz-size" data-dz-size></div>\n        <img data-dz-thumbnail />\n    </div>\n</div>\n'}),define("mockup-patterns-upload",["jquery","underscore","pat-base","mockup-patterns-relateditems","dropzone","text!mockup-patterns-upload-url/templates/upload.xml","text!mockup-patterns-upload-url/templates/preview.xml","translate"],function(a,b,c,d,e,f,g,h){"use strict";return e.autoDiscover=!1,c.extend({name:"upload",trigger:".pat-upload",parser:"mockup",defaults:{showTitle:!0,url:null,className:"upload",wrap:!1,wrapperTemplate:'<div class="upload-wrapper"/>',fileaddedClassName:"dropping",useTus:!1,container:"",ajaxUpload:!0,paramName:"file",addRemoveLinks:!1,autoCleanResults:!0,previewsContainer:".previews",previewTemplate:null,maxFiles:null,maxFilesize:99999999,allowPathSelection:void 0,relatedItems:{attributes:["UID","Title","Description","getURL","portal_type","path","ModificationDate"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,selectableTypes:["Folder"]}},init:function(){var c=this,d=f;void 0===c.options.allowPathSelection&&(c.options.allowPathSelection=c.options.baseUrl&&c.options.relativePath),a(document).bind("paste",function(a){var b=a.originalEvent,d=b.clipboardData.items;if(d)for(var e=0;e<d.length;e++)if(-1!==d[e].type.indexOf("image")){var f=d[e].getAsFile();c.dropzone.addFile(f)}}),c.currentPath=c.options.currentPath,c.currentFile=0,d=b.template(d)({_t:h,allowPathSelection:c.options.allowPathSelection}),c.$el.addClass(c.options.className),c.$el.append(d),c.$progress=a(".progress-bar-success",c.$el),c.options.showTitle||c.$el.find("h2.title").hide(),c.options.ajaxUpload||(a(".fallback",this.$el).remove(),this.$el.hasClass(".upload-container")?this.$el.addClass("no-ajax-upload"):this.$el.closest(".upload-container").addClass("no-ajax-upload")),c.options.wrap&&(c.$el.wrap(c.options.wrapperTemplate),c.$el=c.$el.parent()),c.options.allowPathSelection?(c.$pathInput=a('input[name="location"]',c.$el),c.relatedItems=c.setupRelatedItems(c.$pathInput)):(a('input[name="location"]',c.$el).parent().remove(),c.relatedItems=null),c.$dropzone=a(".upload-area",c.$el),a("div.browse-select button.browse",c.$el).click(function(a){a.preventDefault(),a.stopPropagation(),(!c.options.maxFiles||c.dropzone.files.length<c.options.maxFiles)&&c.dropzone.hiddenFileInput.click()});var g=this.getDzoneOptions();try{c.dropzone=new e(c.$dropzone[0],g)}catch(a){throw window.DEBUG&&console.log(a),a}c.dropzone.on("maxfilesreached",function(){c.showHideControls()}),c.dropzone.on("addedfile",function(){c.showHideControls()}),c.dropzone.on("removedfile",function(){c.showHideControls()}),c.dropzone.on("success",function(b,d){var e;try{e=a.parseJSON(d)}catch(a){e=d}c.$el.trigger("uploadAllCompleted",{data:e,path_uid:c.$pathInput?c.$pathInput.val():null})}),c.options.autoCleanResults&&c.dropzone.on("complete",function(b){b.status===e.SUCCESS&&setTimeout(function(){a(b.previewElement).fadeOut()},3e3)}),c.dropzone.on("complete",function(a){a.status===e.SUCCESS&&1===c.dropzone.files.length&&c.showHideControls()}),c.dropzone.on("error",function(b,c,d){void 0!==d&&403!==d.status&&a(".dz-error-message span",b.previewElement).html(h("The file transfer failed"))}),c.dropzone.on("totaluploadprogress",function(a){a=(100*(c.currentFile-1)+a)/(100*c.dropzone.files.length)*100,c.$progress.attr("aria-valuenow",a).css("width",a+"%")}),a(".upload-all",c.$el).click(function(a){a.preventDefault(),a.stopPropagation(),c.processUpload({finished:function(){c.$progress.attr("aria-valuenow",0).css("width","0%")}})}),c.options.clipboardfile&&c.dropzone.addFile(c.options.clipboardfile)},showHideControls:function(){var a=this;a._showHideTimeout&&clearTimeout(a._showHideTimeout),a._showHideTimeout=setTimeout(function(){a._showHideControls()},50)},_showHideControls:function(){var b=this,c=a(".controls",b.$el),d=a(".browse-select",b.$el),e=a(".dz-hidden-input");if(b.options.maxFiles&&(b.dropzone.files.length<b.options.maxFiles?(d.show(),e.prop("disabled",!1)):(d.hide(),e.prop("disabled",!0))),b.dropzone.files.length>0){c.fadeIn("slow");var f=b.dropzone.files[0];a(".dz-error-message span",f.previewElement).html("")}else c.fadeOut("slow")},pathJoin:function(){var a=[];return b.each(arguments,function(b){b&&("/"===b[0]&&(b=b.substring(1)),"/"===b[b.length-1]&&(b=b.substring(0,b.length-1)),a.push(b))}),a.join("/")},getUrl:function(){var a=this,b=a.options.url;if(!b)if(a.options.baseUrl&&a.options.relativePath)b=a.options.baseUrl,"/"!==b[b.length-1]&&(b+="/"),b+=a.pathJoin(a.currentPath,a.options.relativePath);else{var c=a.$el.parents("form");b=c.length>0?c.attr("action"):window.location.href}return b},getDzoneOptions:function(){var b=this;b.options.clickable=!0;var c=a.extend({},b.options);if(c.url=b.getUrl(),c.uploadMultiple=!1,delete c.wrap,delete c.wrapperTemplate,delete c.resultTemplate,delete c.autoCleanResults,delete c.fileaddedClassName,delete c.useTus,b.options.previewsContainer){var d=b.$el.find(b.options.previewsContainer);d.length>0&&(c.previewsContainer=d[0])}return c.autoProcessQueue=!1,c.previewTemplate=g,c},processUpload:function(a){function b(){d=!0,0===c.dropzone.files.length&&(d=!1);var a=c.dropzone.files[0];if(d&&a.status===e.ERROR&&(a.status=e.QUEUED,d=!1),!d)return c.$el.removeClass(g),void(void 0!==h&&"function"==typeof h&&h());-1!==[e.SUCCESS,e.CANCELED].indexOf(a.status)?(c.dropzone.removeFile(a),b()):a.status!==e.UPLOADING?(f&&window.tus?c.handleTusUpload(a):(c.currentFile+=1,c.dropzone.processFile(a)),setTimeout(b,100)):setTimeout(b,100)}a||(a={});var c=this,d=!1,f=c.options.useTus,g=c.options.fileaddedClassName,h=a.finished;c.currentFile=0,b()},handleTusUpload:function(b){var c=this;a(b.previewElement);b.status=e.UPLOADING,window.tus.upload(b,{endpoint:c.dropzone.options.url,headers:{FILENAME:b.name},chunkSize:5242880}).fail(function(){window.DEBUG&&console.alert(h("Error uploading with TUS resumable uploads")),b.status=e.ERROR}).progress(function(a,b,d){var e=b/d*100;c.$progress.attr("aria-valuenow",e).css("width",e+"%"),c.$progress.html(h("uploading...")+"<br />"+c.formatBytes(b)+" / "+c.formatBytes(d))}).done(function(a,b){b.status=e.SUCCESS,c.dropzone.emit("success",b),c.dropzone.emit("complete",b)})},formatBytes:function(a){var b=Math.round(a/1024);if(b<1024)return b+" KiB";var c=Math.round(b/1024);return c<1024?c+" MB":Math.round(c/1024)+" GB"},setPath:function(a){var b=this;b.currentPath=a,b.options.url=null,b.options.url=b.dropzone.options.url=b.getUrl()},setupRelatedItems:function(b){var c=this,e=c.options.relatedItems;e.upload=!1,c.options.initialFolder&&b.attr("value",c.options.initialFolder);var f=new d(b,e);return f.$el.on("change",function(){var b=a(this).select2("data"),d=null;b.length>0&&(d=b[0].path),c.setPath(d)}),f}})}),define("castle-url/patterns/structure//js/views/upload",["underscore","mockup-ui-url/views/popover","mockup-patterns-upload"],function(a,b,c){"use strict";return b.extend({className:"popover upload",title:a.template('<%- _t("Upload files") %>'),content:a.template('<input type="text" name="upload" style="display:none" /><div class="uploadify-me"></div>'),initialize:function(a){var c=this;c.app=a.app,b.prototype.initialize.apply(c,[a]),c.currentPathData=null,c.app.on("context-info-loaded",function(a){c.currentPathData=a})},render:function(){var a=this;b.prototype.render.call(this);var d=a.app.options.upload;return d.success=function(){a.app.collection.pager()},d.currentPath=a.app.getCurrentPath(),d.allowPathSelection=!1,a.upload=new c(a.$(".uploadify-me").addClass("pat-upload"),d),this},toggle:function(a,c){b.prototype.toggle.apply(this,[a,c]);var d=this;if(this.opened){var e=d.app.getCurrentPath();d.currentPathData&&e!==d.upload.currentPath&&d.upload.setPath(e)}}})}),function(a){define("backbone.paginator",["backbone"],function(){return function(){return Backbone.Paginator=function(a,b,c){"use strict";var d=b.map(a.VERSION.split("."),function(a){return parseInt(a,10)}),e={};e.version="<%= pkg.version %>",e.clientPager=a.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var a=b.defaults(this.paginator_ui,this.defaults_ui);b.defaults(this,a)},addModel:function(a){this.origModels.push(a)},removeModel:function(a){var c=b.indexOf(this.origModels,a);this.origModels.splice(c,1)},sync:function(e,f,g){var h=this;this.setDefaults();var i={};b.each(b.result(h,"server_api"),function(a,c){b.isFunction(a)&&(a=b.bind(a,h),a=a()),i[c]=a});var j=b.clone(h.paginator_core);b.each(j,function(a,c){b.isFunction(a)&&(a=b.bind(a,h),a=a()),j[c]=a}),j=b.defaults(j,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),j=b.extend(j,{data:decodeURIComponent(c.param(i)),processData:!1,url:b.result(j,"url")},g);var k=!(0===d[0]&&9===d[1]&&10===d[2]),l=j.success;j.success=function(a,b,c){l&&(k?l(a,b,c):l(f,a,j)),f&&f.trigger&&f.trigger("sync",f,a,j)};var m=j.error;j.error=function(a){m&&m(f,a,j),f&&f.trigger&&f.trigger("error",f,a,j)};var n=j.xhr=a.ajax(j);return f&&f.trigger&&f.trigger("request",f,n,j),n},nextPage:function(a){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager(a))},previousPage:function(a){this.currentPage>1&&(this.currentPage=--this.currentPage,this.pager(a))},goTo:function(a,b){void 0!==a&&(this.currentPage=parseInt(a,10),this.pager(b))},howManyPer:function(a){if(void 0!==a){var b=this.perPage;this.perPage=parseInt(a,10),this.currentPage=Math.ceil((b*(this.currentPage-1)+1)/a),this.pager()}},setSort:function(a,b){void 0!==a&&void 0!==b&&(this.lastSortColumn=this.sortColumn,this.sortColumn=a,this.sortDirection=b,this.pager(),this.info())},setFieldFilter:function(a){b.isEmpty(a)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules="",this.pager(),this.info()):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=a,this.pager(),this.info())},doFakeFieldFilter:function(a){if(!b.isEmpty(a)){var c=this.origModels;return void 0===c&&(c=this.models),c=this._fieldFilter(c,a),""!==this.filterExpression&&(c=this._filter(c,this.filterFields,this.filterExpression)),c.length}},setFilter:function(a,b){void 0!==a&&void 0!==b&&(this.filterFields=a,this.lastFilterExpression=this.filterExpression,this.filterExpression=b,this.pager(),this.info())},doFakeFilter:function(a,c){if(void 0!==a&&void 0!==c){var d=this.origModels;return void 0===d&&(d=this.models),b.isEmpty(this.fieldFilterRules)||(d=this._fieldFilter(d,this.fieldFilterRules)),d=this._filter(d,a,c),d.length}},pager:function(a){var c=this,d=this.perPage,e=(c.currentPage-1)*d,f=e+d;void 0===c.origModels&&(c.origModels=c.models),c.models=c.origModels.slice(),""!==this.sortColumn&&(c.models=c._sort(c.models,this.sortColumn,this.sortDirection)),b.isEmpty(this.fieldFilterRules)||(c.models=c._fieldFilter(c.models,this.fieldFilterRules)),""!==this.filterExpression&&(c.models=c._filter(c.models,this.filterFields,this.filterExpression)),this.lastSortColumn===this.sortColumn&&this.lastFilterExpression===this.filterExpression&&b.isEqual(this.fieldFilterRules,this.lastFieldFilterRules)||(e=0,f=e+d,c.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression),c.sortedAndFilteredModels=c.models.slice(),c.info(),c.reset(c.models.slice(e,f)),b.result(a,"success")},_sort:function(a,c,d){return a=a.sort(function(a,e){var f=a.get(c),g=e.get(c);if(b.isUndefined(f)||b.isUndefined(g)||null===f||null===g)return 0;if(f=f.toString().toLowerCase(),g=g.toString().toLowerCase(),"desc"===d)if(!f.match(/[^\-\d\.]/)&&f.match(/-?[\d\.]+/)&&!g.match(/[^\-\d\.]/)&&g.match(/-?[\d\.]+/)){if(f-0<g-0)return 1;if(f-0>g-0)return-1}else{if(f<g)return 1;if(f>g)return-1}else if(!f.match(/[^\-\d\.]/)&&f.match(/-?[\d\.]+/)&&!g.match(/[^\-\d\.]/)&&g.match(/-?[\d\.]+/)){if(f-0<g-0)return-1;if(f-0>g-0)return 1}else{if(f<g)return-1;if(f>g)return 1}if(a.cid&&e.cid){var h=a.cid,i=e.cid;if(h<i)return-1;if(h>i)return 1}return 0})},_fieldFilter:function(a,c){if(b.isEmpty(c))return a;var d=[];return b.each(a,function(a){var e=!0;b.each(c,function(c){if(!e)return!1;if(e=!1,"function"===c.type){b.wrap(c.value,function(b){return b(a.get(c.field))})()&&(e=!0)}else"required"===c.type?b.isEmpty(a.get(c.field).toString())||(e=!0):"min"===c.type?!b.isNaN(Number(a.get(c.field)))&&!b.isNaN(Number(c.value))&&Number(a.get(c.field))>=Number(c.value)&&(e=!0):"max"===c.type?!b.isNaN(Number(a.get(c.field)))&&!b.isNaN(Number(c.value))&&Number(a.get(c.field))<=Number(c.value)&&(e=!0):"range"===c.type?!b.isNaN(Number(a.get(c.field)))&&b.isObject(c.value)&&!b.isNaN(Number(c.value.min))&&!b.isNaN(Number(c.value.max))&&Number(a.get(c.field))>=Number(c.value.min)&&Number(a.get(c.field))<=Number(c.value.max)&&(e=!0):"minLength"===c.type?a.get(c.field).toString().length>=c.value&&(e=!0):"maxLength"===c.type?a.get(c.field).toString().length<=c.value&&(e=!0):"rangeLength"===c.type?b.isObject(c.value)&&!b.isNaN(Number(c.value.min))&&!b.isNaN(Number(c.value.max))&&a.get(c.field).toString().length>=c.value.min&&a.get(c.field).toString().length<=c.value.max&&(e=!0):"oneOf"===c.type?b.isArray(c.value)&&b.include(c.value,a.get(c.field))&&(e=!0):"equalTo"===c.type?c.value===a.get(c.field)&&(e=!0):"containsAllOf"===c.type?b.isArray(c.value)&&b.isArray(a.get(c.field))&&b.intersection(c.value,a.get(c.field)).length===c.value.length&&(e=!0):"pattern"===c.type?a.get(c.field).toString().match(c.value)&&(e=!0):e=!1}),e&&d.push(a)}),d},_filter:function(c,d,e){var f=this,g={};if(b.isString(d)?g[d]={cmp_method:"regexp"}:b.isArray(d)?b.each(d,function(a){g[a]={cmp_method:"regexp"}}):b.each(d,function(a,c){g[c]=b.defaults(a,{cmp_method:"regexp"})}),d=g,b.has(a.Paginator,"removeDiacritics")&&f.useDiacriticsPlugin&&(e=a.Paginator.removeDiacritics(e)),""===e||!b.isString(e))return c;var h=b.map(e.match(/\w+/gi),function(a){return a.toLowerCase()}),i="("+b.uniq(h).join("|")+")",j=new RegExp(i,"igm"),k=[];return b.each(c,function(c){var g=[];b.each(d,function(d,i){var k=c.get(i);if(k){var l=[];if(k=b.has(a.Paginator,"removeDiacritics")&&f.useDiacriticsPlugin?a.Paginator.removeDiacritics(k.toString()):k.toString(),"levenshtein"===d.cmp_method&&b.has(a.Paginator,"levenshtein")&&f.useLevenshteinPlugin){var m=a.Paginator.levenshtein(k,e);b.defaults(d,{max_distance:0}),m<=d.max_distance&&(l=b.uniq(h))}else l=k.match(j);l=b.map(l,function(a){return a.toString().toLowerCase()}),b.each(l,function(a){g.push(a)})}}),g=b.uniq(b.without(g,"")),b.isEmpty(b.difference(h,g))&&k.push(c)}),k},info:function(){var a=this,b={},c=a.sortedAndFilteredModels?a.sortedAndFilteredModels.length:a.length,d=Math.ceil(c/a.perPage);return b={totalUnfilteredRecords:a.origModels.length,totalRecords:c,currentPage:a.currentPage,perPage:this.perPage,totalPages:d,lastPage:d,previous:!1,next:!1,startRecord:0===c?0:(a.currentPage-1)*this.perPage+1,endRecord:Math.min(c,a.currentPage*this.perPage)},a.currentPage>1&&(b.previous=a.currentPage-1),a.currentPage<b.totalPages&&(b.next=a.currentPage+1),b.pageSet=a.setPagination(b),a.information=b,b},setPagination:function(a){var b=[],c=0,d=0,e=2*this.pagesInRange,f=Math.ceil(a.totalRecords/a.perPage);if(f>1)if(f<=1+e)for(c=1,d=f;c<=d;c++)b.push(c);else if(a.currentPage<=this.pagesInRange+1)for(c=1,d=2+e;c<d;c++)b.push(c);else if(f-this.pagesInRange>a.currentPage&&a.currentPage>this.pagesInRange)for(c=a.currentPage-this.pagesInRange;c<=a.currentPage+this.pagesInRange;c++)b.push(c);else for(c=f-e;c<=f;c++)b.push(c);return b},bootstrap:function(a){return b.extend(this,a),this.goTo(1),this.info(),this}}),e.clientPager.prototype.prevPage=e.clientPager.prototype.previousPage;var f=function(){var a=new c.Deferred;return a.reject(),a.promise()};return e.requestPager=a.Collection.extend({sync:function(e,f,g){var h=this;h.setDefaults();var i={};b.each(b.result(h,"server_api"),function(a,c){b.isFunction(a)&&(a=b.bind(a,h),a=a()),i[c]=a});var j=b.clone(h.paginator_core);b.each(j,function(a,c){b.isFunction(a)&&(a=b.bind(a,h),a=a()),j[c]=a}),j=b.defaults(j,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),g.data?g.data=decodeURIComponent(c.param(b.extend(i,g.data))):g.data=decodeURIComponent(c.param(i)),j=b.extend(j,{data:decodeURIComponent(c.param(i)),processData:!1,url:b.result(j,"url")},g);var k=!(0===d[0]&&9===d[1]&&10===d[2]),l=j.success;j.success=function(a,b,c){l&&(k?l(a,b,c):l(f,a,j)),d[0]<1&&f&&f.trigger&&f.trigger("sync",f,a,j)};var m=j.error;j.error=function(a){m&&m(a),f&&f.trigger&&f.trigger("error",f,a,j)};var n=j.xhr=a.ajax(j);return f&&f.trigger&&f.trigger("request",f,n,j),n},setDefaults:function(){var a=this;b.defaults(a.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),b.each(a.paginator_ui,function(c,d){b.isUndefined(a[d])&&(a[d]=a.paginator_ui[d])})},requestNextPage:function(a){return void 0!==this.currentPage?(this.currentPage+=1,this.pager(a)):f()},requestPreviousPage:function(a){return void 0!==this.currentPage?(this.currentPage-=1,this.pager(a)):f()},updateOrder:function(a,b){return void 0!==a?(this.sortField=a,this.pager(b)):f()},goTo:function(a,b){return void 0!==a?(this.currentPage=parseInt(a,10),this.pager(b)):f()},howManyPer:function(a,b){return void 0!==a?(this.currentPage=this.firstPage,this.perPage=a,this.pager(b)):f()},info:function(){var a={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,previous:!1,next:!1};return this.currentPage>1&&(a.previous=this.currentPage-1),this.currentPage<a.totalPages&&(a.next=this.currentPage+1),a.hasNext=a.next,a.hasPrevious=a.next,a.pageSet=this.setPagination(a),this.information=a,a},setPagination:function(a){var b=[],c=0,d=0,e=2*this.pagesInRange,f=Math.ceil(a.totalRecords/a.perPage);if(f>1)if(f<=1+e)for(c=1,d=f;c<=d;c++)b.push(c);else if(a.currentPage<=this.pagesInRange+1)for(c=1,d=2+e;c<d;c++)b.push(c);else if(f-this.pagesInRange>a.currentPage&&a.currentPage>this.pagesInRange)for(c=a.currentPage-this.pagesInRange;c<=a.currentPage+this.pagesInRange;c++)b.push(c);else for(c=f-e;c<=f;c++)b.push(c);return b},pager:function(a){return b.isObject(a)||(a={}),this.fetch(a)},url:function(){return void 0!==this.paginator_core&&void 0!==this.paginator_core.url?this.paginator_core.url:null},bootstrap:function(a){return b.extend(this,a),this.setDefaults(),this.info(),this}}),e.requestPager.prototype.nextPage=e.requestPager.prototype.requestNextPage,e.requestPager.prototype.prevPage=e.requestPager.prototype.requestPreviousPage,e}(Backbone,_,jQuery),window.Backbone.Paginator}.apply(a,arguments)})}(this),define("castle-url/patterns/structure//js/collections/result",["jquery","underscore","backbone","castle-url/patterns/structure//js/models/result","mockup-utils","backbone.paginator"],function(a,b,c,d,e){"use strict";return c.Paginator.requestPager.extend({model:d,initialize:function(b,d){this.options=d,this.view=d.view,this.url=d.url,this.queryHelper=e.QueryHelper(a.extend(!0,{},this.view.options,{attributes:this.view.options.queryHelperAttributes})),this.queryParser=function(b){var c=this;void 0===b&&(b={});var d=null;c.view.toolbar&&(d=c.view.toolbar.get("filter").term);var e=c.view.sort_on,f=c.view.sort_order;return e||(e="getObjPositionInParent"),JSON.stringify({criteria:c.queryHelper.getCriterias(d,a.extend({},b,{additionalCriterias:c.view.additionalCriterias})),sort_on:e,sort_order:f})},"#/"===window.location.hash.substring(0,2)&&(this.queryHelper.currentPath=window.location.hash.substring(1)),c.Paginator.requestPager.prototype.initialize.apply(this,[b,d])},getCurrentPath:function(){return this.queryHelper.getCurrentPath()},setCurrentPath:function(a){this.queryHelper.currentPath=a},pager:function(){this.trigger("pager"),c.Paginator.requestPager.prototype.pager.apply(this,[])},paginator_core:{type:"GET",dataType:"json",url:function(){return this.url}},paginator_ui:{firstPage:1,currentPage:1,perPage:15},server_api:{query:function(){return this.queryParser()},batch:function(){return this.queryHelper.options.batchSize=this.perPage,JSON.stringify(this.queryHelper.getBatch(this.currentPage))},attributes:function(){return JSON.stringify(this.queryHelper.options.attributes)}},parse:function(a,c){void 0===c&&(c=0),this.totalRecords=a.total;var d=a.results;return b.each(d,function(a,b){a._sort=b}),d},comparator:"_sort"})}),define("castle-url/patterns/structure//js/collections/selected",["backbone","castle-url/patterns/structure//js/models/result"],function(a,b){"use strict";return a.Collection.extend({model:b,removeResult:function(a){return this.removeByUID(a.uid())},removeByUID:function(a){var b=this.getByUID(a);return b&&this.remove(b),b},getByUID:function(a){return this.findWhere({UID:a})}})}),function(a){"function"==typeof define&&define.amd?define("jquery.cookie",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(a){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;n<o;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)&&(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),define("castle-url/patterns/structure/js/views/app",["jquery","underscore","mockup-ui-url/views/toolbar","mockup-ui-url/views/buttongroup","mockup-ui-url/views/button","mockup-ui-url/views/base","castle-url/patterns/structure//js/views/table","castle-url/patterns/structure//js/views/selectionwell","castle-url/patterns/structure//js/views/generic-popover","castle-url/patterns/structure//js/views/rearrange","castle-url/patterns/structure//js/views/selectionbutton","castle-url/patterns/structure//js/views/paging","castle-url/patterns/structure//js/views/columns","castle-url/patterns/structure//js/views/textfilter","castle-url/patterns/structure//js/views/upload","castle-url/patterns/structure//js/collections/result","castle-url/patterns/structure//js/collections/selected","mockup-utils","translate","pat-logger","jquery.cookie"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";var u=t.getLogger("pat-structure");return f.extend({tagName:"div",status:{type:"none",text:"",label:""},pasteAllowed:!!a.cookie("__cp"),sort_on:"getObjPositionInParent",sort_order:"ascending",additionalCriterias:[],cookieSettingPrefix:"_fc_",initialize:function(b){var c=this;f.prototype.initialize.apply(c,[b]),c.loading=new r.Loading,c.loading.show(),c.pasteAllowed=!!a.cookie("__cp"),a(document).click(function(b){var c=a(b.target);if(c.is(":visible")&&"hidden"!==c.css("visibility")&&"0"!==c.css("opacity")&&!c.is("a")&&!c.parent().is("a")){var d=a(".popover:visible");if(d.length>0&&!a.contains(d[0],c[0])){var e=d.data("component");e&&e.hide()}}});var d=require(b.collectionConstructor);c.collection=new d([],{view:c,url:c.options.collectionUrl}),c.setAllCookieSettings(),c.selectedCollection=new q,c.tableView=new g({app:c}),c.pagingView=new l({app:c}),c.setupButtons(),c.wellView=new h({collection:c.selectedCollection,triggerView:c.toolbar.get("selected-items"),app:c,id:"structure-well"}),c.toolbar.get("selected-items").disable(),c.buttons.disable();var e=0;c.selectedCollection.on("add remove reset",function(){clearTimeout(e),e=setTimeout(function(){c.updateButtons()},100)},c),c.collection.on("sync",function(){c.contextInfoUrl&&a.ajax({url:c.getAjaxUrl(c.contextInfoUrl),dataType:"json",success:function(a){c.trigger("context-info-loaded",a)},error:function(a){404===a.status&&u.info("context info url not found")}}),c.loading.hide()}),c.collection.on("pager",function(){if(c.loading.show(),c.updateButtons(),window.history&&window.history.pushState){if(c.doNotPushState)return void(c.doNotPushState=!1);var b,d=c.getCurrentPath();if("/"===d&&(d=""),c.options.pushStateUrl){b=c.options.pushStateUrl.replace("/{path}","{path}").replace("{path}",d),window.history.pushState(null,null,b)}else c.options.urlStructure&&(b=c.options.urlStructure.base+d+c.options.urlStructure.appended,window.history.pushState(null,null,b));c.options.traverseView&&(d=""),a("body").trigger("structure-url-changed",d)}}),(c.options.pushStateUrl||c.options.urlStructure)&&r.featureSupport.history()&&(a(window).bind("popstate",function(){var b,d,e=r.getWindow(),f=e.location.href;if(-1!==f.indexOf("?")&&(f=f.split("?")[0]),-1!==f.indexOf("#")&&(f=f.split("#")[0]),c.options.pushStateUrl){var g=c.options.pushStateUrl.split("{path}");b=g[0],d=g[1]}else b=c.options.urlStructure.base,d=c.options.urlStructure.appended;var h=f.substring(b.length);h.substring(h.length-d.length)===d&&(h=h.substring(0,h.length-d.length)),h||(h="/"),c.setCurrentPath(h),a("body").trigger("structure-url-changed",h),c.doNotPushState=!0,c.collection.goTo(c.collection.information.firstPage)}),a(document).bind("keyup keydown",function(a){c.keyEvent=a})),c.togglePasteBtn()},updateButtons:function(){var a=this;a.selectedCollection.length?(a.toolbar.get("selected-items").enable(),a.buttons.enable()):(this.toolbar.get("selected-items").disable(),a.buttons.disable()),a.togglePasteBtn()},togglePasteBtn:function(){var c=this;b.find(c.buttons.items,function(a){return"paste"===a.id})&&(c.pasteAllowed=!!a.cookie("__cp"),c.pasteAllowed?c.buttons.get("paste").enable():c.buttons.get("paste").disable())},inQueryMode:function(){return this.additionalCriterias.length>0||(!(!this.sort_on||"getObjPositionInParent"===this.sort_on)||"ascending"!==this.sort_order)},getSelectedUids:function(a){var b=this;void 0===a&&(a=b.selectedCollection);var c=[];return a.each(function(a){c.push(a.uid())}),c},getCurrentPath:function(){return this.collection.getCurrentPath()},setCurrentPath:function(a){this.collection.setCurrentPath(a)},getAjaxUrl:function(a){return a.replace("{path}",this.getCurrentPath())},buttonClickEvent:function(b){var c=this,d=null,e=null;if(b.url){if(c.loading.show(),arguments.length>1){var f=arguments[1];f.preventDefault||(d=f)}if(arguments.length>2){var g=arguments[2];"function"==typeof g&&(e=g)}null===d&&(d={}),void 0===d.selection&&(d.selection=JSON.stringify(c.getSelectedUids())),d._authenticator=r.getAuthenticator(),void 0===d.folder&&(d.folder=c.getCurrentPath());var h=c.getAjaxUrl(b.url);a.ajax({url:h,type:"POST",data:d,success:function(a){c.ajaxSuccessResponse.apply(c,[a,e]),c.loading.hide()},error:function(a){c.ajaxErrorResponse.apply(c,[a,h]),c.loading.hide()}},c)}},ajaxSuccessResponse:function(a,b){var c=this;c.selectedCollection.reset(),"success"===a.status&&c.collection.reset(),a.msg&&c.setStatus(a.msg,a.status||"warning"),null!==b&&void 0!==b&&b(a),c.collection.pager()},ajaxErrorResponse:function(a,b){404===a.status?window.alert(s("operation url ${url} is not valid",{url:b})):window.alert(s("there was an error performing action"))},setupButtons:function(){var a=this,f=[],g=new e({id:"attribute-columns",tooltip:s("Configure displayed columns"),icon:"th"});if(a.columnsView=new m({app:a,triggerView:g,id:"structure-columns"}),f.push(g),f.push(new k({title:s("Selected"),id:"selected-items",collection:this.selectedCollection})),a.options.rearrange){var h=new e({id:"rearrange",title:s("Rearrange"),icon:"sort-by-attributes",tooltip:s("Rearrange folder contents"),url:a.options.rearrange.url});a.rearrangeView=new j({triggerView:h,app:a,id:"structure-rearrange"}),f.push(h)}if(a.options.upload&&r.featureSupport.dragAndDrop()&&r.featureSupport.fileApi()){var l=new e({id:"upload",title:s("Upload"),tooltip:s("Upload files"),icon:"upload"});a.uploadView=new o({triggerView:l,app:a}),f.push(l)}var p=[];b.each(a.options.buttons,function(b){try{var c=new e(b);if(p.push(c),c.form){b.triggerView=c,b.app=a;var d=new i(b);a.$el.append(d.el)}else c.on("button:click",a.buttonClickEvent,a)}catch(a){u.error("Error initializing button "+b.title+" "+a)}}),a.buttons=new d({items:p,id:"mainbuttons",app:a}),f.push(a.buttons),f.push(new n({id:"filter",app:this})),this.toolbar=new c({items:f})},moveItem:function(b,c,d){var e=this;a.ajax({url:this.getAjaxUrl(this.options.moveUrl),type:"POST",data:{delta:c,id:b,_authenticator:r.getAuthenticator(),subsetIds:JSON.stringify(d)},dataType:"json",success:function(a){a.msg?e.setStatus(a.msg):"success"!==a.status&&e.setStatus({text:"error moving item",type:"error"}),e.collection.pager()},error:function(){e.setStatus({text:"error moving item",type:"error"})}})},setStatus:function(b,c){b?"string"==typeof b?(this.status.text=b,this.status.label="",this.status.type=c||"warning"):(this.status.label=b.label||"",this.status.text=b.text,this.status.type=b.type||"warning"):(this.status.text="",this.status.label="",this.status.type="none");var d=this.$(".status");d[0].className="alert alert-"+this.status.type+" status";var e=a("<span></span>");e.text(this.status.text);var f=a("<strong></strong>");f.text(this.status.label),d.empty().append(f).append(e)},render:function(){var b=this;return b.$el.append(b.toolbar.render().el),b.$el.append(b.wellView.render().el),b.$el.append(b.columnsView.render().el),b.rearrangeView&&b.$el.append(b.rearrangeView.render().el),b.uploadView&&b.$el.append(b.uploadView.render().el),b.$el.append(b.tableView.render().el),b.$el.append(b.pagingView.render().el),null!==b.options.backdropSelector?a(b.options.backdropSelector).addClass("ui-backdrop-element"):b.$el.addClass("ui-backdrop-element"),b},getCookieSetting:function(b,c){void 0===c&&(c=null);var d;try{d=a.cookie(this.cookieSettingPrefix+b),d=a.parseJSON(d).value}catch(a){return c}return void 0===d||null===d?c:d},setCookieSetting:function(b,c){a.cookie(this.cookieSettingPrefix+b,JSON.stringify({value:c}))},setAllCookieSettings:function(){this.activeColumns=this.getCookieSetting(this.activeColumnsCookie,this.activeColumns);var a=this.getCookieSetting("perPage",15);"string"==typeof a&&(a=parseInt(a)),this.collection.howManyPer(a)}})}),define("castle-url/patterns/structure/pattern",["jquery","underscore","pat-base","castle-url/patterns/structure/js/views/app"],function(a,b,c,d){"use strict"
;return c.extend({name:"structure",trigger:".pat-structure",parser:"mockup",defaults:{urlStructure:null,vocabularyUrl:null,indexOptionsUrl:null,contextInfoUrl:null,setDefaultPageUrl:null,menuOptions:null,menuGenerator:"castle-url/patterns/structure//js/actionmenu",backdropSelector:".plone-modal",activeColumnsCookie:"activeColumns",iconSize:"thumb",attributes:null,_default_attributes:["CreationDate","EffectiveDate","ExpirationDate","exclude_from_nav","getIcon","getObjSize","getURL","id","is_folderish","last_comment_date","ModificationDate","path","portal_type","review_state","Subject","Title","total_comments","UID"],activeColumns:null,_default_activeColumns:["ModificationDate","EffectiveDate","review_state"],availableColumns:null,_default_availableColumns:{id:"ID",ModificationDate:"Last modified",EffectiveDate:"Published",ExpirationDate:"Expiration",CreationDate:"Created",review_state:"Review state",Subject:"Tags",portal_type:"Type",is_folderish:"Folder",exclude_from_nav:"Excluded from navigation",getObjSize:"Object Size",last_comment_date:"Last comment date",total_comments:"Total comments"},tableRowItemAction:null,_default_tableRowItemAction:{folder:["castle-url/patterns/structure//js/navigation","folderClicked"],other:[]},typeToViewAction:null,_default_typeToViewAction:{File:"/view",Image:"/view",Blob:"/view"},collectionConstructor:"castle-url/patterns/structure//js/collections/result",momentFormat:"L LT",rearrange:{properties:{id:"ID",sortable_title:"Title"},url:"/rearrange"},moveUrl:null,buttons:null,_default_buttons:[{title:"Cut",url:"/cut"},{title:"Copy",url:"/copy"},{title:"Paste",url:"/paste"},{title:"Delete",url:"/delete",context:"danger",icon:"trash"},{title:"Workflow",url:"/workflow"},{title:"Tags",url:"/tags"},{title:"Properties",url:"/properties"},{title:"Rename",url:"/rename"},{title:"Template",url:"/convert_template"}],upload:{uploadMultiple:!0,showTitle:!0}},init:function(){var c=this,e=["attributes","activeColumns","availableColumns","buttons","typeToViewAction"];b.each(e,function(a){null===c.options[a]&&(c.options[a]=c.options["_default_"+a])});var f=["tableRowItemAction"];b.each(f,function(b){var d=c.options[b];c.options[b]=a.extend(!1,c.options["_default_"+b],d)}),c.browsing=!0,c.options.collectionUrl=c.options.vocabularyUrl,c.options.pattern=c,c.options.queryHelperAttributes=c.options.attributes,delete c.options.attributes,c.view=new d(c.options),c.$el.append(c.view.render().$el)}})}),require(["castle-url/patterns/structure/pattern","pat-registry"],function(a,b){"use strict";return a}),define("castle-url/patterns/structure",function(){}),define("castle-url/patterns/toolbar/menu-item",["jquery","mockup-patterns-base","pat-registry","mockup-utils","castle-url/components/utils","castle-url/libs/react/react.min","mockup-patterns-modal"],function(a,b,c,d,e,f,g){"use strict";var h=f.DOM;return{getDefaultProps:function(){return{showIcon:!0}},getInitialState:function(){return{hovered:!1,focussed:!1}},onClick:void 0,getLabel:function(){return this.props.item.title},getClassName:function(){return"castle-toolbar-item castle-toolbar-"+this.props.item.id},stripQS:function(a){return a.split("?")[0]},isActive:function(){return this.stripQS(window.location.href)===this.stripQS(this.props.item.url)},render:function(){var a=this.props.item,b=this.getClassName();this.isActive()&&(b+=" active");var c="";return(void 0===this.props.showIcon||this.props.showIcon)&&(c=h.span({className:a.icon_class,"aria-hidden":!0})),h.li({className:b},[h.span({className:"simpletooltip_container"},[h.a({href:a.url,onClick:this.onClick,ref:"a",className:"js-simple-tooltip",onFocus:function(){this.setState({focussed:!0})}.bind(this),onMouseEnter:function(){this.setState({hovered:!0})}.bind(this),onBlur:function(){this.setState({focussed:!1})}.bind(this),onMouseLeave:function(){this.setState({hovered:!1})}.bind(this),onKeyDown:function(){27==event.keyCode&&this.setState({focussed:!1})}.bind(this),"aria-describedby":"label_simpletooltip_"+this.props.item.id},[c,this.getLabel()]),h.span({className:"js-simpletooltip simpletooltip",id:"label_simpletooltip_"+this.props.item.id,"aria-hidden":!this.state.focussed&&!this.state.hovered,role:"tooltip"},this.props.item.description)])])}}}),define("castle-url/patterns/toolbar/modal-item",["jquery","mockup-patterns-base","pat-registry","mockup-utils","castle-url/components/utils","castle-url/libs/react/react.min","mockup-patterns-modal","castle-url/patterns/toolbar/menu-item"],function(a,b,c,d,e,f,g,h){"use strict";f.DOM;return e.extend(h,{onClick:function(a){a.preventDefault(),e.createModalComponent(this.props.ModalComponent,this.props.id,this.getSettings())},getSettings:function(){return{parent:this.props.parent}}})}),define("castle-url/components/preview-content-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils"],function(a,b,c,d,e,f,g){"use strict";var h=d.DOM;return g.Class([f],{getInitialState:function(){return{size:"full"}},componentDidMount:function(){e.loading.show();var b=this;f.componentDidMount.apply(this);var c=function(){var d=a(b.refs.iframe.getDOMNode()),f=0;d.contents().find("body > *").each(function(){f+=a(this).height()}),f>d.height()&&(d.height(f),e.loading.hide()),b.props.timeout=setTimeout(c,500)};b.props.timeout=setTimeout(c,500)},componentWillUnmount:function(){clearTimeout(this.props.timeout)},componentDidUpdate:function(){clearTimeout(this.props.timeout),this.componentDidMount()},sizeChanged:function(a){var b=a.target.value;"full"===b?this.props.width=null:"phone"===b?this.props.width="500px":"phablet"===b?this.props.width="680px":"tablet"===b&&(this.props.width="800px"),this.setState({size:b})},renderContent:function(){var b=this;return h.div({className:"castle-preview form-horizontal"},[h.div({className:"form-group"},[h.label({className:"col-sm-4 control-label"},"Select device size"),h.div({className:"col-sm-6"},h.select({value:b.state.size,onChange:b.sizeChanged,className:"form-control"},[h.option({value:"full"},"Full Size"),h.option({value:"tablet"},"Tablet"),h.option({value:"phablet"},"Phablet"),h.option({value:"phone"},"Phone")]))]),h.iframe({src:a("body").attr("data-view-url")+"?VIEW_AS_ANONYMOUS_VIEW=true",width:"100%",ref:"iframe",key:this.props.width})])},renderFooter:function(){var a=[h.button({type:"button",className:"plone-btn plone-btn-primary","data-dismiss":"modal"},"Done")];return h.div({},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"preview-content-modal",title:"Preview content",timeout:0})}})}),define("castle-quality-check",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils"],function(a,b,c,d,e){"use strict";var f=d.DOM,g=function(a){var b=[];return c.each(a.split(" "),function(a){a.length>3&&b.push(a)}),b.length},h=[{name:"Short name format",warning:'starts with "copy", contains a space or contains a capital letter',run:function(a,b){return b(/copy_?/.test(a.id)?!1:-1!==a.id.indexOf(" ")?!1:a.id.toLowerCase()!==a.id?!1:!0)}},{name:"Title length",warning:"should have no more than 8 significant words",run:function(a,b){return b(g(a.title)<=8)}},{name:"Title format",warning:"should begin with upper case letter",run:function(a,b){return b(a.title[0].toUpperCase()!=a.title[0]?!1:!0)}},{name:"Summary length",warning:"should not be empty or have no more than 25 significant words",run:function(a,b){return b(a.description?g(a.description)<=25:!1)}},{name:"Summary format",warning:"should begin with upper case letter",run:function(a,b){return b(a.description&&a.description[0].toUpperCase()==a.description[0]?!0:!1)}},{name:"Links",warning:"You have links in the content that are referencing unpublished content",run:function(a,b){return b(a.linksValid)}},{name:"Headers",warning:"You have headers that are out of order. Headers should be in order of h1, h2, h3, etc and not skip a level.",run:function(a,b){return b(a.headersOrdered)}},{name:"Template",warning:"This object is a template and is unpublishable.",run:function(a,b){return b(!a.template)}}],i={name:"Spelling/Grammar",warning:function(a){if(a.state.data.atdError)return f.span({},": Error connecting to AtD to check spelling/grammar.");var b=[];return a.state.data.atdResponse.forEach(function(a){b.push(f.li({},[f.span({className:"desc"},a.description),": ",f.span({className:"quote pre"},'"'),f.span({className:"string"},a.string),f.span({className:"quote post"},'"')]))}),f.ul({className:"atd-errors"},b)},run:function(b,c){b.atdError=!1,b.atdResponse=[],a.ajax({method:"POST",url:a("body").attr("data-base-url")+"/checkDocument",data:{data:b.html,key:"castle-qualitycheck"}}).done(function(d){var e=[];a(d).find("error").each(function(b,c){var d=a(c);e.push({string:d.find("string")[0].innerHTML,description:d.find("description")[0].innerHTML,precontext:d.find("precontext")[0].innerHTML,type:d.find("type")[0].innerHTML})}),b.atdResponse=e,c(e>0)}).fail(function(){console.log("Error checking after the deadline"),b.atdError=!0,c(!1)})}};return d.createClass({getInitialState:function(){return{checked:{},data:{}}},getDefaultProps:function(){var b=h.slice(),c=a("body").attr("data-pat-tinymce");return c&&(c=JSON.parse(c),c.tiny.atd_rpc_url&&b.push(i)),{delay:!1,onFinished:function(){},checks:b}},componentDidMount:function(){var b=this;e.loading.show();var c=a("body").attr("data-base-url");c===a("body").attr("data-portal-url")&&(c+="/"+a("body").attr("data-site-default")),a.ajax({url:c+"/@@quality-check",dataType:"json",cache:!1}).done(function(a){b.check(a)}).fail(function(){alert("Error checking content")}).always(function(){e.loading.hide()})},check:function(a){var b=this;b.state.data=a;var d=function(){for(var e=0;e<b.props.checks.length;e++){var f=b.props.checks[e];if(void 0===b.state.checked[f.name]){f.run(a,function(a){b.state.checked[f.name]=a,b.forceUpdate(),c.size(b.state.checked)!==b.props.checks.length?b.props.delay?setTimeout(d,[250,500,750,1e3][Math.floor(4*Math.random())]):d():b.props.onFinished()});break}}};d()},done:function(){return c.size(this.state.checked)===this.props.checks.length},isValid:function(){for(var a=this,b=0;b<a.props.checks.length;b++){var c=a.props.checks[b];if(!this.state.checked[c.name])return!1}return!0},render:function(){var a=this,b="";return a.done()&&(b=a.isValid()?f.div({className:"portalMessage info"},[f.strong({},"Success"),"All checks are successful."]):f.div({className:"portalMessage error"},[f.strong({},"Double check"),"Problems have been detected. It is recommended you fix them."])),f.div({className:"castle-quality"},[f.ul({},a.props.checks.map(function(b){var c="",d=b.name,e="",g=a.state.checked[b.name];return void 0!==g&&(g?c="glyphicon glyphicon-ok":(c="glyphicon glyphicon-remove","function"!=typeof b.warning?d+=": "+b.warning:e=b.warning(a))),f.li({},[f.span({className:c}),d,e])})),b])}})}),define("castle-url/components/quality-check-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-quality-check","castle-url/components/utils"],function(a,b,c,d,e,f,g,h){"use strict";var i=d.DOM;return h.Class([f],{renderContent:function(){return d.createElement(g,{})},renderFooter:function(){var a=[i.button({type:"button",className:"plone-btn plone-btn-default pull-right","data-dismiss":"modal"},"Done")];return i.div({},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"quality-content-modal",title:"Quality Check"})}})}),define("castle-url/components/analytics-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils","moment","castle-url/libs/script"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=d.DOM,k=d.createClass({getDefaultProps:function(){return{height:"500px"}},componentDidMount:function(){new this.props.Type(this.refs.chart.getDOMNode()).draw(this.props.data,this.props.options)},componentDidUpdate:function(){this.componentDidMount()},render:function(){return j.div({ref:"chart",key:this.props.key||this.props.name,style:{height:this.props.height}})}}),l={type:"realtime",labels:{referralPath:"Referral",deviceCategory:"Device type",pagePath:"Page"},dimensionOptions:[],metricOptions:[],translate:function(a){if(this.labels[a])return this.labels[a];if(a=a.replace("rt:","").replace("ga:",""),this.labels[a])return this.labels[a];a=a.replace("avg","average").replace("pageviews","pageViews");var b=a.substring(0,1).toUpperCase();return a.substring(1).split("").forEach(function(a){a===a.toUpperCase()?b+=" "+a.toLowerCase():b+=a}),b},getInitialState:function(){return{loading:!0,chartsLoaded:!1,metrics:this.metricOptions[0],dimensions:null,sort:null,max_results:5,global:!1,data:{},paths:[],chartType:"column"}},componentDidMount:function(){var a=this;if(this.load(),window.google&&window.google.charts)return void a.setState({chartsLoaded:!0});i("https://www.gstatic.com/charts/loader.js",function(){google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(function(){a.setState({chartsLoaded:!0})})})},getQueryData:function(){var a={metrics:this.state.metrics,global:this.state.global,sort:"-"+this.state.metrics};return this.state.dimensions&&(a.dimensions=this.state.dimensions),this.state.max_results&&(a.max_results=this.state.max_results),a},load:function(){var b=this;e.loading.show(),a.ajax({url:a("body").attr("data-base-url")+"/@@content-analytics",data:{api:"ga",type:this.type,params:JSON.stringify(b.getQueryData()),cache_duration:300}}).done(function(a){a.loading=!1,b.setState({loading:!1,data:a.data,paths:a.paths})}).fail(function(){alert("failed to load analytic data")}).always(function(){e.loading.hide()})},timedLoad:function(){var a=this;this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){a.load()},500)},changeValue:function(a,b){var c=b.target.value;this.state[a]=c,this.forceUpdate(),this.timedLoad()},globalClicked:function(a){this.setState({global:a.target.checked}),this.timedLoad()},createOption:function(a,b){return b||(b=this.translate(a)),j.option({value:a},b)},render:function(){var b=this;if(b.state.loading||!b.state.chartsLoaded)return j.p({},"Loading data...");if(!this.state.data)return j.p({},"No data could be retrieved. Google Analytics API support may not be configured.");var e=[["Count",this.translate(this.state.metrics)]];c.each(this.state.data.rows,function(a){a.length>1?e.push([a[0]+"",parseInt(a[1])]):e.push([a[0],parseInt(a[0])])}),e=google.visualization.arrayToDataTable(e);var f={title:"Real time statistics",hAxis:{title:"Count",minValue:0},vAxis:{title:this.translate(this.state.metrics)}},g=google.visualization.ColumnChart;"pie"===this.state.chartType&&(g=google.visualization.PieChart);var h="No data found";return this.state.data.rows&&(h=d.createElement(k,{name:"context",data:e,options:f,Type:g})),j.div({},this.renderFields(),h,j.div({className:"checkbox pull-right"},j.label({},[j.input({type:"checkbox",checked:this.state.global,onClick:this.globalClicked}),"Analyze entire site"])),j.p({className:"discreet"},"Totals for current page: "+a("body").attr("data-base-url")))},renderFields:function(){var a=this,b=[a.createOption("","N/A")];this.dimensionOptions.forEach(function(c){b.push(a.createOption(c))});var c=[];this.metricOptions.forEach(function(b){c.push(a.createOption(b))});var d=[j.div({className:"form-group col-md-2"},[j.label({},"Aggregate"),j.select({className:"form-control",value:this.state.metrics,onChange:this.changeValue.bind(this,"metrics")},c)]),j.div({className:"form-group col-md-2"},[j.label({},"Dimensions"),j.select({className:"form-control",value:this.state.dimensions,onChange:this.changeValue.bind(this,"dimensions")},b)]),j.div({className:"form-group col-md-2"},[j.label({},"Max results"),j.select({className:"form-control",value:this.state.max_results,onChange:this.changeValue.bind(this,"max_results")},[j.option({value:"5"},"5"),j.option({value:"10"},"10"),j.option({value:"15"},"15")])]),j.div({className:"form-group col-md-2"},[j.label({},"Chart type"),j.select({className:"form-control",value:this.state.chartType,onChange:this.changeValue.bind(this,"chartType")},[j.option({value:"column"},"Columns"),j.option({value:"pie"},"Pie")])])].concat(this.renderAdditionalFields());return j.div({className:"row"},d)},renderAdditionalFields:function(){return[]}},m=g.Class([l],{type:"realtime",dimensionOptions:["rt:userType","rt:medium","rt:trafficType","rt:browser","rt:operatingSystem","rt:deviceCategory","rt:country","rt:region","rt:pagePath"],metricOptions:["rt:pageViews","rt:activeUsers"]}),n=g.Class([l],{type:"ga",dimensionOptions:["ga:userType","ga:sessionCount","ga:socialNetwork","ga:hasSocialSourceReferral","ga:medium","ga:trafficType","ga:browser","ga:operatingSystem","ga:deviceCategory","ga:pagePath","ga:country","ga:region","ga:continent","ga:subContinent","ga:metro","ga:city","ga:flashVersion","ga:javaEnabled","ga:language","ga:exitPagePath"],metricOptions:["ga:hits","ga:users","ga:newUsers","ga:sessions","ga:pageviews","ga:bounces","ga:bounceRate","ga:avgSessionDuration","ga:entranceRate","ga:pageviewsPerSession","ga:avgTimeOnPage","ga:avgPageLoadTime"],getInitialState:function(){var a=l.getInitialState.call(this);return a.to=h().local().format("YYYY-MM-DD"),a.from=h().local().subtract(7,"days").format("YYYY-MM-DD"),a},componentDidUpdate:function(){var b=this;this.refs.from&&(a(this.refs.from.getDOMNode()).pickadate({format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",onSet:function(a){b.state.from=h(a.select).local().format("YYYY-MM-DD"),b.timedLoad()}}),a(this.refs.to.getDOMNode()).pickadate({format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",onSet:function(a){b.state.to=h(a.select).local().format("YYYY-MM-DD"),b.timedLoad()}}))},getQueryData:function(){var a=l.getQueryData.call(this),b=h().local(),c=h(this.state.from,"YYYY-MM-DD").local(),d=h(this.state.to,"YYYY-MM-DD").local();return a.start_date=parseInt((b-c)/1e3/60/60/24)+"daysAgo",a.end_date=parseInt((b-d)/1e3/60/60/24)+"daysAgo",a},renderAdditionalFields:function(){return[j.div({className:"form-group col-md-2"},[j.label({},"From"),j.input({className:"form-control",ref:"from",value:this.state.from})]),j.div({className:"form-group col-md-2"},[j.label({},"To"),j.input({className:"form-control",ref:"to",value:this.state.to})])]}});return g.Class([f],{dataMappings:{pinterest:"Pinterest",twitter_matomo:"Twitter (Matomo)",facebook_matomo:"Facebook (Matomo)"},getInitialState:function(){return{social:null,analytics:null,tab:"realtime",loading:!1}},componentDidMount:function(){f.componentDidMount.call(this);var b=this;e.loading.show(),a.ajax({url:a("body").attr("data-base-url")+"/@@content-analytics",data:{api:"social"}}).done(function(a){b.setState({social:a.data})}).fail(function(){alert("failed to load analytic data")}).always(function(){e.loading.hide()})},tabClicked:function(a){this.setState({tab:a})},renderTabItem:function(a,b){return j.a({href:"#"+a,className:this.state.tab===a&&"active"||"",onClick:this.tabClicked.bind(this,a)},b)},renderContent:function(){var a=this;return a.state.loading?j.div({className:"castle-analytics"},[j.p({className:"discreet"},"Loading analytic data...")]):j.div({className:"castle-analytics pat-autotoc autotabs"},[j.nav({className:"autotoc-nav"},[a.renderTabItem("realtime","Real time"),a.renderTabItem("history","Historical"),a.renderTabItem("social","Social")]),a.renderTab()])},renderTab:function(){return"realtime"===this.state.tab?d.createElement(m,{parent:this}):"history"===this.state.tab?d.createElement(n,{parent:this}):"social"===this.state.tab?this.renderSocialTab():void 0},renderSiteTab:function(){if(null===this.state.analytics)return j.p({className:"discreet"},"Analytics API not configured");var a=this.state.analytics,b=google.visualization.arrayToDataTable([["Type","Count",{role:"style"},{role:"annotation"}],["Users",a.activeUsers,"color: gray",a.activeUsers],["Page Views",a.activePageViews,"color: #76A7FA",a.activePageViews]]),c={title:"Real-time data"};return d.createElement(k,{name:"site",data:b,options:c,Type:google.visualization.ColumnChart})},renderSocialTab:function(){var a=this;if(null===this.state.social)return j.p({className:"discreet"},"No social data found (Make sure social count monitoring is configured)");var b="",c=this.state.social,e=[["Platform","Shares"]];Object.keys(this.dataMappings).forEach(function(b){c[b]&&e.push([a.dataMappings[b],c[b]])}),c.twitter?(e.push(["Twitter",c.twitter]),b=j.p({className:"discreet"},"Twitter shares as reported via Twitter's streaming API")):c.twitter_matomo||(b=j.p({className:"discreet"},"Twitter API keys may not be set (Make sure twitter monitoring is configured)")),e=google.visualization.arrayToDataTable(e);var f={title:"Social media shares",hAxis:{title:"Platform",minValue:0},vAxis:{title:"Shares"}};return[d.createElement(k,{name:"realtime",key:"realtime-"+this.state.metrics+this.state.dimensions+this.state.max_results+this.state.chartType,data:e,options:f,Type:google.visualization.ColumnChart}),b]},renderFooter:function(){var a=[j.button({type:"button",className:"plone-btn plone-btn-primary","data-dismiss":"modal"},"Done")];return j.div({},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"analytics-content-modal",title:"Content Analytics",width:"95%"})}})}),define("castle-url/components/workflow-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-quality-check","castle-url/components/utils"],function(a,b,c,d,e,f,g,h){"use strict";var i=d.DOM,j=d.createClass({getInitialState:function(){return{checked:!1,open:!1,valid:!1}},getDefaultProps:function(){return{onQACheck:function(){}}},onChecked:function(){if(this.refs.qa){var a=this.refs.qa.isValid();this.setState({checked:!0,valid:a}),a||this.state.open||this.setState({open:!0}),this.props.onQACheck(a)}},onToggleClicked:function(a){a.preventDefault(),this.setState({open:!this.state.open})},render:function(){var a=d.createElement(g,{delay:!1,onFinished:this.onChecked,ref:"qa"}),b="Show Quality Check";this.state.open&&(b="Hide Quality Check");var c="plone-btn plone-btn-warning";return this.state.valid&&(c="plone-btn plone-btn-default"),i.div({className:"quality-check-wrapper"},[i.button({className:c,onClick:this.onToggleClicked},[i.span({className:""}),b]),i.div({style:{display:this.state.open&&"block"||"none"}},[a])])}});return h.Class([f],{getInitialState:function(){return{transition:"",comment:"",qaValid:!1}},transitionClicked:function(a){var b={transition:a.target.value};this.state.transition=a.target.value,this.isQARequired()?0===this.state.comment.length?b.comment="OVERRIDE: ":-1===this.state.comment.indexOf("OVERRIDE:")&&(b.comment="OVERRIDE: "+this.state.comment):"OVERRIDE:"===this.state.comment.trim()&&(b.comment=""),this.setState(b)},commentChanged:function(a){var b={comment:a.target.value};this.isQARequired()&&-1===b.comment.indexOf("OVERRIDE:")||this.setState(b)},qaDone:function(a){this.setState({qaValid:a})},renderContent:function(){var a=this,b=[i.div({className:"radio"},i.label({},[i.input({type:"radio",value:"",name:"transition",checked:""===a.state.transition,onClick:a.transitionClicked}),"No change"]))];b=b.concat(a.props.workflow.transitions.map(function(b){return i.div({className:"radio"},i.label({},[i.input({type:"radio",value:b.id,name:"transition",checked:a.state.transition===b.id,onClick:a.transitionClicked}),b.title]))}));var c="form-group ";return this.isQARequired()&&(c+="has-error"),i.div({className:"castle-preview form-horizontal"},[d.createElement(j,{delay:!1,ref:"qa",onQACheck:this.qaDone}),i.hr({}),i.div({className:"form-group"},[i.label({htmlFor:""},"Change state"),i.div({className:"formHelp"},"Select the transition to be used for modifying the item's state."),b]),i.div({className:c},[i.label({},"Comment"),i.div({className:"formHelp"},"Comments will be added to the publishing history. Comments are required when quality check does not pass and you are attempting to publish."),i.textarea({className:"form-control",value:a.state.comment,onChange:a.commentChanged})])])},onChangeClicked:function(b){b.preventDefault(),e.loading.show(),a.ajax({url:a("body").attr("data-base-url")+"/@@content-workflow",data:{_authenticator:e.getAuthenticator(),transition_id:this.state.transition,comment:this.state.comment,action:"transition"}}).always(function(){e.loading.hide()}).fail(function(){alert("Error performing transition")}).done(function(){window.location.reload()}),this.hide()},isQARequired:function(){return!this.state.qaValid&&"publish"===this.state.transition&&this.props.workflow.publishRequireQualityCheck},renderFooter:function(){var a=[i.button({type:"button",className:"plone-btn plone-btn-default","data-dismiss":"modal"},"Cancel"),i.button({type:"button",className:"plone-btn plone-btn-primary pull-right",disabled:this.isQARequired()&&this.state.comment.trim().length<="OVERRIDE:".length||!this.state.transition,onClick:this.onChangeClicked},"Change")];return i.div({className:"btn-container"},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"workflow-content-modal",title:"Publishing Process",workflow:{}})}})}),define("castle-url/components/slot-manager-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils","mockup-patterns-modal","pat-registry","moment","jquery.cookie"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=d.DOM,l=d.createClass({getInitialState:function(){var b=a("body").attr("data-base-url").replace(a("body").attr("data-portal-url"),"");return b&&"/"===b[0]||(b="/"+b),{current:b,mode:"parent",effective_tiles:[],tiles:[],dirty:!1}},componentDidMount:function(){var a=this;a.props.slot.workingId?a.doAction({}):a.startEditing()},startEditing:function(b){var c=this,d={action:"copymeta",metaId:c.props.slot.id,_authenticator:e.getAuthenticator()};b&&(d.override="yes"),e.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+c.state.current+"/@@meta-tile-manager",data:d}).done(function(a){if(a.success)c.props.slot.workingId=a.newId,c.doAction({});else if(a.locked){var b=a.lock_data;confirm("This slot currently has an unfinished edit started by "+b.user+" "+j(b.when).fromNow()+". Do you want to override this person's edit? This will destroy of the other user's changes.")&&c.startEditing(!0)}else alert("unknown error occurred")}).always(function(){e.loading.hide()})},doAction:function(b,c){var d=this;e.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+d.state.current+"/@@meta-tile-manager",data:a.extend({},!0,{metaId:d.props.slot.id,_authenticator:e.getAuthenticator()},b)}).done(function(a){a.loading=!1,d.setState(a),c&&c(a)}).always(function(){e.loading.hide()})},_editTile:function(b){e.loading.show();var d=this.state.current_url+"/@@edit-tile/"+b.type+"/"+b.id+"?X-Tile-Persistent=yes",f=new h(a(this.getDOMNode()),{ajaxUrl:d,loadLinksWithinModal:!0,buttons:'.formControls > input[type="submit"], .actionButtons > input[type="submit"]'});f.$el.off("after-render");var g=null,j=null;e.loading.show(),f.on("after-render",function(){if(f.$modal.parents(".plone-modal-wrapper").css("z-index","9998"),a('input[name*="cancel"]',f.$modal).off("click").on("click",function(){f.hide()}),a("form",f.$modal).append(a('<input type="hidden" name="X-Tile-Persistent" value="yes" />')),g=a('[name="plone.app.standardtiles.rawhtml.content"]',f.$modal),g.size()>0){var b=a.parseJSON(a("body").attr("data-pat-tinymce"));b.tiny.external_plugins&&c.each(c.keys(b.tiny.external_plugins),function(c){b.tiny.external_plugins[c]=a("body").attr("data-portal-url")+"/"+b.tiny.external_plugins[c]}),j=new i.patterns.tinymce(g,b)}e.loading.hide()}),f.show(),f.$el.off("formActionSuccess"),f.on("hide",function(){if(g){try{g.data("pattern-tinymce").destroy()}catch(a){}g.removeData("pattern-tinymce")}j&&j.tiny&&j.tiny.remove()}),f.on("formActionSuccess",function(){f.hide()})},addTileSelected:function(a){var b=this;b.state.dirty=!0,b.doAction({type:a.target.value,action:"addtile"},function(a){b._editTile(a.tiles[a.tiles.length-1])})},deleteTile:function(a,b){var c=this;c.state.dirty=!0,b.preventDefault(),c.doAction({type:b.target.value,action:"deletetile",idx:a})},moveUp:function(a,b){var c=this;c.state.dirty=!0,b.preventDefault(),c.doAction({type:b.target.value,action:"moveup",idx:a})},moveDown:function(a,b){var c=this;c.state.dirty=!0,b.preventDefault(),c.doAction({type:b.target.value,action:"movedown",idx:a})},modeClicked:function(a){var b=this;b.state.dirty=!0,a.preventDefault(),b.doAction({value:a.target.value,action:"mode"})},editTile:function(a,b){b.preventDefault(),this.state.dirty=!0,this._editTile(this.state.tiles[a])},renderLinkedPath:function(b){return"/"===b?k.a({href:a("body").attr("data-portal-url"),target:"_blank",className:"slot-manager-link-path"},[k.span({className:"glyphicon glyphicon-home"})," /"]):k.a({href:a("body").attr("data-portal-url")+b+"/view",target:"_blank",className:"slot-manager-link-path"},b)},renderTileListing:function(){var a=this;if("hide"===this.state.mode)return k.p({className:"discreet"},"This slot is hidden");var b=[];if("parent"===this.state.mode||"add"===this.state.mode){var c=[];a.state.effective_tiles.forEach(function(b){b.path!==a.state.current&&0!==b.data.length&&c.push(k.table({className:"table listing slot-manager-showing-parent"},[k.thead({},[k.th({className:"slot-manager-parent-location"},[k.span({className:"slot-manager-location-label"},"Location: "),a.renderLinkedPath(b.path)])]),k.tbody({},b.data.map(function(a,b){return k.tr({},k.td({},[b+1,": ",a.label]))}))]))}),c.length>0?b.push(k.div({className:"slot-manager-parents"},[k.h3({},"Parent tiles"),c])):b.push(k.div({},[k.p({className:"discreet"},"There are no tiles assign here.")]))}if("show"===a.state.mode||"add"===a.state.mode){var d=[];this.state.tiles.length>0&&(d.push(k.h3({},["Tiles rendered here"])),d.push(k.table({className:"listing table",style:{width:"100%"}},[k.thead({},[k.th({},"Tile"),k.th({},"Actions")]),k.tbody({},this.state.tiles.map(function(b,c){return k.tr({},[k.td({},[c+1,": ",b.label]),k.td({},[k.a({href:"#",className:"btn btn-default icon-move-up",onClick:a.moveUp.bind(this,c)},"Up"),k.a({href:"#",className:"btn btn-default icon-move-down",onClick:a.moveDown.bind(this,c)},"Down"),k.a({href:"#",onClick:a.editTile.bind(this,c),className:"btn btn-default icon-edit"},"Edit"),k.a({href:"#",onClick:a.deleteTile.bind(this,c),className:"btn btn-default icon-trash"},"Delete")])])}))]))),b.push(k.div({className:"slot-manager-render-here"},[k.div({},d),k.div({className:"form-group"},[k.label({className:""},"Select a Tile"),k.select({onChange:this.addTileSelected,value:"add"},this.getAvailableSlots())])]))}return b},getAvailableSlots:function(){var b=[k.option({value:"add"},"Select Tile...")],d=a("body").attr("data-available-slots");return d?(d=a.parseJSON(d),c.each(c.keys(d).sort(),function(a){var e=[],f=c.sortBy(d[a],function(a){return a.label});c.each(f,function(a){e.push(k.option({value:a.id},a.label))}),b.push(k.optgroup({label:a},e))})):b.push(k.optgroup({label:"Structure"},[k.option({value:"plone.app.standardtiles.rawhtml"},"Text")])),b},clickSelected:function(a,b){b.preventDefault(),this.state.selected=a,this.doAction({})},renderMode:function(){var a=this,b=[];return"/"!==a.state.current&&b.push(k.label({className:"checkbox-inline"},[k.input({type:"radio",name:"slotMode",value:"parent",checked:"parent"==a.state.mode,onClick:a.modeClicked}),"Inherit"])),b.push(k.label({className:"checkbox-inline"},[k.input({type:"radio",name:"slotMode",value:"hide",checked:"hide"==a.state.mode,onClick:a.modeClicked}),"Hide"])),b.push(k.label({className:"checkbox-inline"},[k.input({type:"radio",
name:"slotMode",value:"show",checked:"show"==a.state.mode,onClick:a.modeClicked}),"Replace"])),b.push(k.label({className:"checkbox-inline"},[k.input({type:"radio",name:"slotMode",value:"add",checked:"add"==a.state.mode,onClick:a.modeClicked}),"Add"])),k.div({className:"form-group radio-group slot-manager-display-mode"},[k.label({},"Display Mode"),k.div({className:"radio"},b)])},cancelEdit:function(b){var c=this,d={action:"cancelcopy",metaId:c.props.slot.id,_authenticator:e.getAuthenticator()};e.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+c.state.current+"/@@meta-tile-manager",data:d}).done(function(){b()}).always(function(){e.loading.hide()}).fail(function(){alert("Unknown error")})},editRoot:function(a){a.preventDefault();var b=this;b.setState({current:"/"},function(){b.props.slot.workingId=void 0,b.startEditing()})},editHomepage:function(a){a.preventDefault();var b=this;b.setState({current:"/"+b.props.defaultPage},function(){b.props.slot.workingId=void 0,b.startEditing()})},renderCurrentLocation:function(){var a=this,b="";return a.state.current==="/"+a.props.defaultPage?b=k.div({className:"portalMessage info"},[k.strong({},"Info")," You are managing slots from the home page of the site. ",k.a({href:"#",onClick:a.editRoot},"Click here")," to manage slots that apply to the entire site. "]):"/"===a.state.current&&(b=k.div({className:"portalMessage info"},[k.strong({},"Info")," You are managing slots from the root of the site. ",k.a({href:"#",onClick:a.editHomepage},"Click here")," to manage slots that only apply at the homepage. "])),k.div({className:"castle-slot-location-container"},[b,k.div({className:"input-group location"},[k.span({className:"input-group-addon"},"Location"),k.span({className:"form-control"},a.state.current)])])},render:function(){var a=this;return k.div({className:"castle-slots"},[a.renderCurrentLocation(),a.renderMode(),a.renderTileListing()])},getDefaultProps:function(){return{slot:{},defaultPage:a("body").attr("data-site-default")}}});return g.Class([f],{getInitialState:function(){return{slot:null,layout:null}},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"slot-manager-modal",title:"Choose slot to manage",slots:[]})},componentDidMount:function(){var b=this;f.componentDidMount.apply(b),b.getModalEl().on("hidden.bs.modal",function(){b.refs.manager.state.dirty&&window.location.reload()});var c=a.cookie("plone.app.drafts.path");c&&(a.removeCookie("plone.app.drafts.path",{path:c}),a.removeCookie("plone.app.drafts.draftName",{path:c}),a.removeCookie("plone.app.drafts.targetKey",{path:c}),a.removeCookie("plone.app.drafts.userId",{path:c})),b.bindIframe()},componentDidUpdate:function(){this.bindIframe()},bindIframe:function(){var b=this;if(b.refs.iframe){var c=a(b.refs.iframe.getDOMNode());c.load(function(){var d=0;c.contents().find("body > *").each(function(){d+=a(this).height()}),c.height(d),a(".castle-tile-container",c.contents()).off("click").on("click",function(){var c=a(this);b.props.title="Manage "+c.attr("data-tile-title")+" Slot",b.setState({slot:{id:c.attr("data-tile-id"),title:c.attr("data-tile-title")}})})})}},renderContent:function(){var b=this;return b.state.slot?d.createElement(l,{slot:this.state.slot,key:b.state.slot.id,ref:"manager"}):k.div({className:"slot-chooser"},[k.p({className:"discreet"},"Slots are areas in the theme where you can place tiles into that are outside the main content area."),k.iframe({src:a("body").attr("data-portal-url")+"/@@render-slots-site-layout?layout="+a("body").attr("data-site-layout"),width:"100%",style:{"min-height":"400px"},className:"castle-slot-selector",ref:"iframe",name:"choose_slot"})])},cancelEditClicked:function(b,c){var d=this;if(b&&b.preventDefault(),!d.refs.manager)return d.setState({slot:null});var f=d.refs.manager.state;if(c||confirm("You have unsaved changes. Are you certain you want to cancel those changes?")){var g={action:"cancelcopy",metaId:d.state.slot.id,_authenticator:e.getAuthenticator()};e.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+f.current+"/@@meta-tile-manager",data:g}).done(function(){d.refs.manager.state.dirty=!1,d.setState({slot:null})}).always(function(){e.loading.hide()})}},saveEditClicked:function(b){var c=this;if(b&&b.preventDefault(),!c.refs.manager)return c.hide();var d=c.refs.manager.state,f={action:"savecopy",metaId:c.state.slot.id,_authenticator:e.getAuthenticator()};e.loading.show(),a.ajax({url:a("body").attr("data-portal-url")+d.current+"/@@meta-tile-manager",data:f}).done(function(){c.refs.manager.state.dirty=!1,c.hide(),window.location.reload()}).always(function(){e.loading.hide()}).fail(function(){alert("Error saving slot changes.")})},renderFooter:function(){var a=this,b=[];return a.state.slot?b.push(k.button({type:"button",className:"plone-btn plone-btn-primary pull-right",onClick:a.saveEditClicked},"Save")):b.push(k.button({type:"button",className:"plone-btn plone-btn-default pull-right",onClick:a.hide},"Close")),k.div({},b)}})}),define("castle-url/components/design-modal",["jquery","mockup-patterns-base","underscore","castle-url/libs/react/react.min","mockup-utils","castle-url/components/modal","castle-url/components/utils"],function(a,b,c,d,e,f,g){"use strict";var h=d.DOM;return g.Class([f],{getInitialState:function(){return{loading:!0,available:[],applied:null,context:null,applied_context:null,page_layout:null,section_layout:null,folder:null,dirtyPage:!1,dirtySection:!1}},componentDidMount:function(){e.loading.show();var b=this;f.componentDidMount.apply(this),a.ajax({url:a("body").attr("data-base-url")+"/@@page-layout-selector"}).done(function(a){a.available[a.page_layout]||(a.page_layout=null),a.original_page_layout=a.page_layout,a.original_applied_context=a.applied_context,a.original_applied=a.applied,b.setState(a)}).fail(function(){alert("error loading design data")}).always(function(){e.loading.hide()})},renderSelected:function(){var a=this.state.available[this.state.applied];a||(a="Default");var b=h.span({className:"selected-design default"},"Default site design");return"/"!==this.state.applied_context&&(b=this.state.applied_context!==this.state.context?h.span({className:"selected-design"},['"'+a+'" applied from ',h.span({className:"selected-design-path"},this.state.applied_context)]):h.span({className:"selected-design"},a)),h.p({className:"selected-design-container"},[h.span({className:"selected-design-label"},"Selected Design"),": ",b])},renderAvailableOptions:function(){var a=this,b=[h.option({value:""}," - Use parent setting"),h.option({value:"index.html"},"Default")];return c.keys(this.state.available).sort().forEach(function(c){"index.html"!==c&&b.push(h.option({value:c},a.state.available[c]))}),b},pageChanged:function(a){!a.target.value&&this.state.dirtyPage?this.setState({page_layout:this.state.original_page_layout,applied_context:this.state.original_applied_context,applied:this.state.original_applied}):this.setState({page_layout:a.target.value,applied_context:this.state.context,applied:a.target.value,dirtyPage:!0})},renderPageSelection:function(){return h.div({className:"form-group"},[h.label({},["Page Design",h.span({className:"formHelp"},"Design that will be applied to this page only.")]),h.select({className:"form-control",value:this.state.page_layout,onChange:this.pageChanged},this.renderAvailableOptions())])},sectionChanged:function(a){this.setState({section_layout:a.target.value,dirtySection:!0})},renderSectionSelection:function(){return h.div({className:"form-group"},[h.label({},["Section Design",h.span({className:"formHelp"},"Design that will be applied to all pages inside this folder.")]),h.select({className:"form-control",value:this.state.section_layout,onChange:this.sectionChanged},this.renderAvailableOptions())])},renderContent:function(){var a=this;return h.div({className:"castle-design-container"},[a.renderSelected(),a.renderPageSelection(),a.renderSectionSelection()])},saveClicked:function(b){b.preventDefault(),e.loading.show();var c=this;a.ajax({url:a("body").attr("data-base-url")+"/@@page-layout-selector",type:"POST",data:{action:"save",_authenticator:e.getAuthenticator(),data:JSON.stringify(this.state)}}).done(function(a){if(!a.success)return alert("Error saving design change");c.state.dirtyPage?window.location.reload():c.hide()}).fail(function(){alert("error loading design data")}).always(function(){e.loading.hide()})},renderFooter:function(){var a=[h.button({type:"button",className:"plone-btn plone-btn-default",onClick:this.hide},"Cancel"),h.button({type:"button",className:"plone-btn plone-btn-primary",onClick:this.saveClicked,disabled:!this.state.dirtyPage&&!this.state.dirtySection},"Save")];return h.div({},a)},getDefaultProps:function(){return a.extend({},!0,f.getDefaultProps.apply(this),{id:"design-modal",title:"Design"})}})}),define("castle-url/patterns/toolbar",["jquery","mockup-patterns-base","pat-registry","mockup-utils","castle-url/components/utils","castle-url/libs/react/react.min","mockup-patterns-modal","castle-url/patterns/toolbar/menu-item","castle-url/patterns/toolbar/modal-item","castle-url/components/add-content-modal","castle-url/components/preview-content-modal","castle-url/components/quality-check-modal","castle-url/components/analytics-modal","castle-url/components/workflow-modal","castle-url/components/slot-manager-modal","castle-url/components/design-modal","moment"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";var r=f.DOM,s=f.createClass(h),t=e.Class([h],{isActive:function(){return a("body").attr("data-base-url")===window.location.href||h.isActive.apply(this)}}),u=function(a,b){return e.Class([i],{getDefaultProps:function(){return e.extend(i.getDefaultProps.apply(this),{ModalComponent:a,id:b})}})},v=e.extend(h,{componentDidMount:function(){var b=new g(a(this.refs.a.getDOMNode()),this.props);b.$el.off("after-render"),b.on("after-render",function(){a('input[name*="cancel"]',b.$modal).off("click").on("click",function(){b.hide()})})}}),w=function(a){return e.Class([v],{getDefaultProps:function(){return a}})},x=e.Class([i],{getSettings:function(){return e.extend(this.props.parent.props.add,{parent:this.props.parent})},getDefaultProps:function(){return e.extend(i.getDefaultProps.apply(this),{ModalComponent:j,id:"add-modal-react-container"})}}),y=e.Class([i],{getSettings:function(){return{parent:this.props.parent,workflow:this.props.parent.props.workflow}},getWorkflow:function(){return this.props.parent.props.workflow},getClassName:function(){var a=h.getClassName.apply(this),b=this.getWorkflow();return b&&(a+=" state-"+b.state.id),a},getLabel:function(){var a=this.getWorkflow();return a?this.props.item.title+": "+a.state.title:this.props.item.title},getDefaultProps:function(){return e.extend(i.getDefaultProps.apply(this),{ModalComponent:n,id:"workflow-modal-react-container"})}}),z=e.Class([i],{getSettings:function(){return{parent:this.props.parent}},getDefaultProps:function(){return e.extend(i.getDefaultProps.apply(this),{ModalComponent:o,id:"slot-manager-modal-react-container"})}}),A=e.Class([i],{getSettings:function(){return{parent:this.props.parent}},getDefaultProps:function(){return e.extend(i.getDefaultProps.apply(this),{ModalComponent:p,id:"design-modal-react-container"})}}),B={getDefaultProps:function(){return{showIcon:!0,modal:!1,itemMapping:{}}},addAdditionalMenuItems:function(a){var b=this.state.itemMapping;Object.keys(a).forEach(function(c){b[c]=a[c]}),this.setState({itemMapping:b})},renderMenuItem:function(a){if("spacer"===a)return r.li({className:"spacer"});var b=s;return void 0!==this.state.itemMapping&&this.state.itemMapping[a.id]?b=this.state.itemMapping[a.id]:a.modal&&(b=w(a.modalAttributes)),f.createElement(b,{parent:this,item:a,showIcon:this.props.showIcon})}},C=e.Class([B],{itemMapping:{impersonate:w({actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0}})},getInitialState:function(){return{open:!1}},getDefaultProps:function(){return{name:"",items:[],title:"",icon:"",onClick:function(){},showIcon:!1}},btnClicked:function(a){a.preventDefault(),this.props.onClick(this),this.setState({open:!this.state.open})},render:function(){var a=this,b="castle-btn-dropdown castle-btn-dropdown-"+this.props.name,c=[r.button({className:"icon-"+this.props.icon+" plone-btn plone-btn-default",onClick:this.btnClicked},[r.span({},this.props.title)])];return this.state.open&&(b+="opened",c.push(r.ul({},a.props.items.map(function(b){return a.renderMenuItem(b)})))),r.div({className:b},c)}}),D=e.Class([C],{getInitialState:function(){return null===this.props.chat_info?{}:(this.checkMissedMessages(),{token:this.props.chat_info.token,open:!1,missed:!1})},checkMissedMessages:function(){var b=this.props.chat_info.frontpage;if(void 0!==b&&null!==b){b.lastIndexOf("/")!==b.length-1&&(b+="/");var c=b+"api/messageWaiting",d={token:this.props.chat_info.token,user:{email:this.props.chat_info.email,name:this.props.username}};a.ajax({url:c,data:d,method:"POST"}).done(function(a){this.setState({missed:a})}.bind(this))}},renderChannels:function(){var a=this,b=this.state.missed,c=Object.keys(this.state.missed),d=[];for(var e in c){e=c[e];d.push(r.li({className:"castle-chat-missed-channel"},[r.div({className:"castle-chat-channel-header"},[e,r.span({className:"castle-chat-missed"},b[e].length.toString())]),r.ul({},a.renderMessages(b[e]))]))}return d},renderMessages:function(a){var b=[],c=0,d="";for(var e in a){if(10==(c+=1))return b.push(r.div({className:"castle-chat-divider-link"},r.a({className:"castle-chat-missed-message",href:this.props.chat_info.frontpage+"plone/"+this.state.token,target:"_blank"},"View more"))),b;e=a[e];var f=[];d!==e.u.username&&(f=r.div({className:"castle-chat-username"},e.u.username+": ")),d=e.u.username,b.push(r.li({className:"castle-chat-missed-message"},[f,e.msg]))}return b},render:function(){if(null===this.props.chat_info)return null;if(window.location.href.indexOf("/chat")>=0)return null;if(null===this.props.chat_info.frontpage||null===this.props.chat_info.chat_url)return null;var a="plone-btn plone-btn-default chat-link";this.state.missed&&(a+=" chat-alert");var b=[r.button({className:a,onClick:this.btnClicked},"Chat")];if(this.state.open){var c=[],d="No new messages",e=!1;if(""===this.props.chat_info.email&&(e=!0,d="A valid email must be associated with your profile before using chat"),this.state.missed){var f=(Object.keys(this.state.missed),this.state.missed,this.renderChannels());c.push(r.ul({className:"castle-chat-preview"},f))}else c.push(r.div({className:"castle-chat-empty"},d));var g=this.props.chat_info.frontpage+"plone/"+this.state.token;g+="/"+this.props.username+"/"+this.props.chat_info.email,e||c.push(r.div({className:"castle-chat-goto-link"},r.a({href:g,disabled:e,target:"_blank",className:"castle-chat-bottom-link"},"Open chat"))),b.push(r.div({className:"castle-chat-dropdown"},c))}return r.div({className:"castle-btn-dropdown",id:"castle-chat-menu-item"},b)}}),E=e.Class([C],{infoIcon:r.svg({id:"557c1826-141b-488e-8cbf-023297e947fc","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[r.defs({},r.style({},".\\37 41286a0-08da-4764-b1d8-fc4a2fdaf01d{fill:#5bc0de;}")),r.path({className:"741286a0-08da-4764-b1d8-fc4a2fdaf01d",d:"M10,.1A9.9,9.9,0,1,0,19.9,10,9.9,9.9,0,0,0,10,.1ZM9.8,15.5h.5a6,6,0,0,0,1.1-1.3l.3.2q-1.5,2.6-3.2,2.6a1.4,1.4,0,0,1-1-.4,1.2,1.2,0,0,1-.4-.9,3.4,3.4,0,0,1,.2-.9l1.4-4.7a4,4,0,0,0,.2-1,.5.5,0,0,0-.2-.4l-.5-.2H7.9V8.1l3.3-.5h.6l-2,7a3.9,3.9,0,0,0-.2.8Zm2.5-10a1.4,1.4,0,0,1-2.5-1,1.4,1.4,0,0,1,.4-1,1.4,1.4,0,0,1,2,0,1.4,1.4,0,0,1,.4,1A1.4,1.4,0,0,1,12.4,5.5Z"})]),warningIcon:r.svg({id:"43116b3f-bcf4-4eff-a6a9-4ce4def2b718","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[r.defs({},r.style({},".\\32 928bb63-e350-4856-b63e-f748b9d2849c{fill:#efac4c;}")),r.path({className:"2928bb63-e350-4856-b63e-f748b9d2849c",d:"M10,1.1.1,18.2H19.9ZM9,5.7a1.4,1.4,0,0,1,2,0,1.3,1.3,0,0,1,.4,1A12.2,12.2,0,0,1,10.9,9l-.4,1.8a14.8,14.8,0,0,0-.3,2.2H9.8a13.4,13.4,0,0,0-.4-2.2L9,9a11.3,11.3,0,0,1-.4-2.3A1.4,1.4,0,0,1,9,5.7Zm1.9,10.7a1.3,1.3,0,0,1-2.3-.9,1.3,1.3,0,0,1,.4-.9,1.3,1.3,0,0,1,1.9,0,1.3,1.3,0,0,1,0,1.9Z"})]),errorIcon:r.svg({id:"28e26966-46bc-480e-ae10-740701234303","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[r.defs({},r.style({},".\\35 80fe009-4c8c-460f-b362-42cfa88ea0f5{fill:#d85450;}")),r.path({className:"580fe009-4c8c-460f-b362-42cfa88ea0f5",d:"M14.1.1H5.9L.1,5.9v8.2l5.8,5.8h8.2l5.8-5.8V5.9ZM11.2,16.6a1.6,1.6,0,0,1-2.8-1.1,1.6,1.6,0,0,1,.5-1.2,1.6,1.6,0,0,1,2.3,0,1.6,1.6,0,0,1,0,2.3Zm0-9.2-.5,2.2a18.2,18.2,0,0,0-.4,2.8H9.8a16.5,16.5,0,0,0-.5-2.8L8.8,7.4a13.9,13.9,0,0,1-.5-2.8,1.7,1.7,0,0,1,.5-1.2A1.6,1.6,0,0,1,10,2.9a1.6,1.6,0,0,1,1.7,1.7A15,15,0,0,1,11.2,7.4Z"})]),maxMessages:50,getInitialState:function(){return{open:!1,messages:this.props.items,unread:[],showUnread:!1}},getDataKey:function(){return a("body").attr("data-portal-url")+this.props.user_id+"readmessages"},getStoredData:function(){var a=this.getDataKey(),b=localStorage.getItem(a);return b=b?JSON.parse(b):{messages:[],timestamps:[]}},componentDidMount:function(){var b=this,c=this.getStoredData(),d=[];this.props.items.forEach(function(a){var b=a.timestamp+"";-1===c.timestamps.indexOf(b)&&(c.timestamps.push(b),c.messages.unshift(a),d.push(b))}),c.messages.splice(this.maxMessages,c.messages.length+1).forEach(function(a){var b=a.timestamp+"",d=c.timestamps.indexOf(b);-1===d&&c.timestamps.splice(d,1)}),d.length>0?this.setState({showUnread:!0,unread:d,open:!0,messages:c.messages},function(){setTimeout(function(){b.refs.menuItems&&a(b.refs.menuItems.getDOMNode()).fadeOut(function(){b.setState({open:!1,showUnread:!1})})},3e3)}):this.setState({messages:c.messages}),localStorage.setItem(this.getDataKey(),JSON.stringify(c))},getIcon:function(a){return"info"===a.type?this.infoIcon:"warning"===a.type?this.warningIcon:"error"===a.type?this.errorIcon:void 0},btnClicked:function(a){a.preventDefault(),this.props.onClick(this),this.setState({open:!this.state.open,showUnread:!1})},renderMenuItem:function(b){var c="";return b.context&&(c=r.div({className:"location"},[r.span({},"Location: "),r.span({className:"link"},r.a({href:a("body").attr("data-portal-url")+b.context},b.context||"/"))])),r.li({className:"castle-status-message-item "+b.type},[r.div({className:"row"},[r.div({className:"col-md-1 svg-container"},this.getIcon(b)),r.div({className:"col-md-11"},[r.div({className:"date"},q(new Date(1e3*b.timestamp)).fromNow()),r.div({className:"text"},b.text),c])])])},render:function(){var a=this,b="castle-btn-dropdown castle-btn-dropdown-"+this.props.name,c="";a.state.unread.length>0&&(c=r.span({className:"castle-toolbar-unread-message-count"},a.state.unread.length));var d=[r.button({className:" plone-btn plone-btn-default",onClick:this.btnClicked},[c,"Notifications"])];if(this.state.open){b+="opened";var e=[];a.state.messages.forEach(function(b){a.state.showUnread&&-1===a.state.unread.indexOf(b.timestamp+"")||e.push(b)}),d.push(r.ul({ref:"menuItems"},e.map(function(b){return a.renderMenuItem(b)})))}return r.div({className:b},d)}}),F=f.createClass({renderBreadcrumbs:function(){var b=this;return r.ol({className:"castle-toolbar-breadcrumbs"},[r.li({className:"castle-toolbar-crumb castle-toolbar-crumb-home"},r.a({href:a("body").attr("data-portal-url")},"Home"))].concat(b.props.breadcrumbs.map(function(a){var b="castle-toolbar-crumb castle-toolbar-crumb-"+a.Title.toLowerCase().split(" ").join("-");return a.state&&(b+=" crumb-state-"+a.state),r.li({className:b},r.a({href:a.absolute_url},a.Title))})))},btnClicked:function(a){this.refs.cog&&"cog"!==a.props.icon&&this.refs.cog.state.open&&this.refs.cog.setState({open:!1}),this.refs.chat&&"chat"!==a.props.name&&this.refs.chat.state.open&&this.refs.chat.setState({open:!1}),this.refs.user&&"user"!==a.props.name&&this.refs.user.state.open&&this.refs.user.setState({open:!1}),this.refs.messages&&"messages"!==a.props.name&&this.refs.messages.state.open&&this.refs.messages.setState({open:!1})},render:function(){var b=[r.img({src:a("body").attr("data-portal-url")+"/++plone++castle/images/castle-logo.png",alt:"CastleCMS"})];return r.div({className:"castle-toolbar-container-top"},[r.a({href:a("body").attr("data-portal-url"),className:"castle-toolbar-logo"},b),this.renderBreadcrumbs(),r.div({className:"castle-toolbar-buttons",onClick:function(a){a.stopPropagation()}},[f.createElement(D,{chat_info:this.props.chat_info,username:this.props.user.name,onClick:this.btnClicked,ref:"chat",name:"chat"}),f.createElement(E,{items:this.props.messages,user_id:this.props.user_id,ref:"messages",onClick:this.btnClicked,name:"messages"}),f.createElement(C,{icon:"cog",items:this.props.management_menu,ref:"cog",onClick:this.btnClicked,name:"cog",title:"Site Settings"}),f.createElement(C,{icon:"user",title:this.props.user.name,ref:"user",items:this.props.user_menu,onClick:this.btnClicked,name:"user"})])])}}),G=e.Class([B],{getInitialState:function(){return{hideButtons:!0,itemMapping:{"view-page":t,add:x,quality:u(l,"quality-modal-react-container"),preview:u(k,"preview-modal-react-container"),analytics:u(m,"analytics-modal-react-container"),slots:z,design:A,state:y,rename:w({actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0}}),delete:w({loadLinksWithinModal:!1,actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0,displayInModal:!1}}),trash:w({actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0}}),invalidate:w({}),aliases:w({}),syndication:w({actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0}}),convert_template:w({actionOptions:{disableAjaxFormSubmit:!0,redirectOnResponse:!0}})}}},getMore:function(a){var b="none";return this.state.hideButtons||(b="inherit"),0===a.length?null:r.li({ref:"moreMenu",className:"castle-toolbar-item"},[r.a({href:"#",onClick:function(a){a.preventDefault(),this.setState({hideButtons:!this.state.hideButtons})}.bind(this)},[r.span({className:"icon-add"}),r.span({},"More")]),r.ul({className:"castle-toolbar-btn-container",style:{display:b}},a)])},render:function(){var a=this,b=[],c=a.props.main_menu.length,d=a.props.hidden||0,e=a.props.main_menu.map(function(e){return c-=1,c<d?void b.push(a.renderMenuItem(e)):a.renderMenuItem(e)});return e.push(this.getMore(b)),r.div({className:"castle-toolbar-container-side"},r.ul({},e))}}),H=f.createClass({getInitialState:function(){return{hiddenButtons:0}},render:function(){return r.div({className:"castle-toolbar-container"},[f.createElement(F,e.extend(this.props,{ref:"top"})),f.createElement(G,e.extend(this.props,{ref:"side",hidden:this.state.hiddenButtons}))])},calculateHidden:function(){var b=this.refs.side,c={};try{c=a(b.getDOMNode()).find("li")}catch(a){return}var d=0,e=a(window).height()-a(this.refs.top.getDOMNode()).height(),f=a(c[0]).height()-2,g=0;a(c).each(function(){var b=a(this).height();0!==b||a(this).hasClass("spacer")||(b=f),(d+=b)>e&&(g+=1,b>0&&d-b<e&&(g+=1))}),this.setState({hiddenButtons:g})},loadAddonButtons:function(){var a=this.props.addon_buttons,b=[];void 0!==a.side_toolbar&&(b=b.concat(a.side_toolbar)),require(b,function(){for(var a={top:{},side:{}},b=["name","menu","renderer"],c=0;c<arguments.length;c++){var d=arguments[c],e=Object.keys(d);if(b.every(function(a){return e.indexOf(a)>=0})){this.refs[d.menu];a[d.menu][d.name]=d.renderer}}this.refs.side.addAdditionalMenuItems(a.side)}.bind(this)).bind(this)},componentDidMount:function(){this.calculateHidden(),this.loadAddonButtons(),window.addEventListener("resize",this.calculateHidden)},componentWillUnmount:function(){window.removeEventListener("resize",this.calculateHidden)}});return b.extend({name:"castletoolbar",trigger:".pat-castletoolbar",parser:"mockup",defaults:{},init:function(){var b=this,c=f.render(f.createElement(H,b.options),b.$el[0],function(){-1===document.body.className.indexOf("toolbar-initialized")&&(document.body.className+=" toolbar-initialized"),a("body").trigger("toolbar-initialized",b,c)});a(window).on("click",function(){c.refs.top.refs.cog.setState({open:!1}),c.refs.top.refs.user.setState({open:!1}),c.refs.top.refs.messages.setState({open:!1,showUnread:!1});try{c.refs.top.refs.chat.setState({open:!1})}catch(a){}}),a("body").off("structure-url-changed").on("structure-url-changed",function(c,d){a.ajax({url:a("body").attr("data-portal-url")+d+"/@@castle-toolbar",data:{"fc-reload":"yes"},dataType:"json"}).done(function(c){a("body").attr("data-base-url",c["data-base-url"]).attr("data-view-url",c["data-view-url"]),b.$el.empty(),f.render(f.createElement(H,c),b.$el[0])})})}})}),define("castle-url/patterns/upload-update",["jquery","mockup-patterns-base","castle-url/libs/react/react.min","castle-url/components/add-content-modal","mockup-utils"],function(a,b,c,d,e){"use strict";return b.extend({name:"upload-update",trigger:".pat-upload-update",parser:"mockup",defaults:{uid:null,tmp_field_id:null},bytesToSize:function(a){var b=["Bytes","KB","MB","GB","TB"];if(0==a)return"0 Byte";var c=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,c),2)+" "+b[c]},updateReplacement:function(b,c,d){var e=a(this.$el);e.find(".new-value").remove();var f=a('<p class="discreet new-value"/>');e.append(f),f.html(b+"("+c+"): "+this.bytesToSize(d));var g=e.find("#form-widgets-file-replace");0===g.size()&&(g=a('<input id="form-widgets-file-replace" name="form.widgets.file.action" type="hidden"/>'),e.append(g)),g.attr("value",JSON.stringify({replace:!0,name:b,type:c,size:d,tmp_field_id:this.options.tmp_field_id}))},init:function(){var b=this;b.component=null,b.options.tmp_field_id||(b.tmp_field_id="tmp_"+e.generateId());var f=a(this.$el),g=f.find("#form-widgets-file-replace"),h=g.attr("value");if(h&&-1!==h.indexOf("{"))try{var i=JSON.parse(h);i.replace&&(b.updateReplacement(i.name,i.type,i.size),b.options.tmp_field_id=i.tmp_field_id)}catch(a){}f.find("#form-widgets-file-input").click(function(e){e.preventDefault();var g=a("<div/>");f.append(g);var h={update:!0,content:b.options.uid,field:b.options.tmp_field_id,autoUpload:!0,onUploadFinished:function(c,d){var e=d.state.files[0];b.component.hide(),g.remove(),a(".modal-backdrop").remove(),a("body").removeClass("modal-open"),a("#form-widgets-file").css("opacity","0.2"),b.updateReplacement(e.name,e.type,e.size)}};b.el=c.createElement(d,h),b.component=c.render(b.el,g[0]),a(".modal-backdrop").css("z-index","auto"),a(".modal-content").css("margin-top","100px")})}})}),define("castle-url/patterns/widgets",["jquery","pat-base","castle-url/libs/react/react.min"],function(a,b,c){"use strict";var d=c.DOM,e=c.createClass({getDefaultProps:function(){return{changeEvent:function(a){}}},getInitialState:function(){return{value:[]}},notifyChange:function(){this.setState({value:this.state.value}),this.props.changeEvent(this.state.value)},valueChanged:function(a,b,c,d){this.state.value[a][b]="checkbox"==c?d.target.checked:d.target.value,this.notifyChange()},renderFieldField:function(a,b,c,e){var f,g="upload-fields-"+a+"-"+e;return"widget"===a?f=d.select({id:g,value:c,onChange:this.valueChanged.bind(this,e,a,"select")},[d.option({value:"text"},"Text"),d.option({value:"textarea"},"Textarea"),d.option({value:"tags"},"Tags"),d.option({value:"checkbox"},"Checkbox")]):"required"===a?("string"==typeof c&&(c="true"===c),f=d.input({id:g,type:"checkbox",checked:c,onChange:this.valueChanged.bind(this,e,a,"checkbox")})):f=d.input({id:g,value:c,onChange:this.valueChanged.bind(this,e,a,"text")}),d.li({className:"field",id:g+"-container"},[d.label({htmlFor:g},b),f])},removeClicked:function(a,b){b.preventDefault(),this.state.value.splice(a,1),this.notifyChange()},renderField:function(a,b){return d.div({className:"file-upload-field-container"},[d.h4({},a.label),d.ul({className:"file-upload-fields"},[this.renderFieldField("name","Name",a.name,b),this.renderFieldField("label","Label",a.label,b),this.renderFieldField("widget","Widget",a.widget,b),this.renderFieldField("required","Required",a.required,b),this.renderFieldField("for-file-types","For types",a["for-file-types"],b)]),d.button({className:"btn btn-danger btn-xs remove-btn",onClick:this.removeClicked.bind(this,b)},"Remove")])},addClicked:function(a){a.preventDefault(),this.state.value.push({name:"fieldname",label:"Field label",widget:"text","for-file-types":"*",required:!1}),this.notifyChange()},render:function(){var a=[],b=this;return this.state.value.forEach(function(c,d){a.push(b.renderField(c,d))}),d.div({className:"file-upload-fields-container"},[d.div({},a),d.button({className:"btn btn-primary btn-xs add-btn",onClick:this.addClicked},"Add")])}});return b.extend({name:"fileuploadfieldswidget",trigger:".pat-fileuploadfieldswidget",parser:"mockup",defaults:{timeout:0},init:function(){var b=this;b.$el.hide();var d=a("<div/>");b.$el.after(d),b.component=c.render(c.createElement(e,{changeEvent:function(a){clearTimeout(b.options.timeout),b.options.timeout=setTimeout(function(){b.$el[0].setAttribute("value",JSON.stringify(a))},100)}}),d[0]);var f=JSON.parse(b.$el.val());b.component.setState({value:f})}})}),require(["jquery","mockup-patterns-modal"],function(a,b){if(void 0===b.prototype._init&&(b.prototype._init=b.prototype.init,b.prototype.init=function(){this.options.loadLinksWithinModal=!1,this.options.backdropOptions.closeOnClick=!1,this.options.backdropOptions.closeOnEsc=!1,b.prototype._init.apply(this,[])}),a("#formfield-form-widgets-ILayoutAware-content").size()>0){var c=a(".portalMessage.error");if(c.size()>0){var d=createElement("div",{className:"castle-editor-errors"});a("body").append(d),c.each(function(){d.appendChild(this)});var e=a(".field.error");if(e.size()>0){var f=document.createElement("ul");c.find("dd").append(f),e.each(function(){var b=a(this);if(b.find("label").size()>0&&b.find(".fieldErrorBox .error").size()>0){var c=createElement("li",{children:[createElement("span",{className:"title",text:b.find("label")[0].textContent.trim()}),createElement("span",{className:"details",text:b.find(".fieldErrorBox .error")[0].textContent})]});f.appendChild(c)}})}}}a(document).ready(function(){!0!=("selected"===a("#form-widgets-use_cookie_negotiation > input").value)?a("#formfield-form-widgets-authenticated_users_only").hide():a("#formfield-form-widgets-authenticated_users_only").show(),a("#form-widgets-upload_to_youtube-0").on("change",function(){var a=document.getElementById("form-widgets-youtube_url");this.checked?(a.setAttribute("readonly",!0),a.value=""):a.removeAttribute("readonly")})})}),define("castle-url/scripts/patches",function(){}),require(["jquery","mockup-utils"],function(a,b){"use strict";a(document).ready(function(){if(a(".template-edit").size()>0){var c=function(){setTimeout(function(){a.ajax({url:a("body").attr("data-base-url")+"/@@ping-draft",method:"POST",data:{_authenticator:b.getAuthenticator()}}).done(function(){c()})},3e5)};c()}})}),define("castle-url/scripts/drafts",function(){}),require(["jquery"],function(a){"use strict";var b=function(){localStorage.setItem("sessionRefreshLastCheck",(new Date).getTime())},c=function(){var a=localStorage.getItem("sessionRefreshLastCheck"),c=(new Date).getTime();if(a)try{if(a=parseInt(a),c-a>3e5)return d()}catch(a){b()}else b()},d=function(){setTimeout(function(){a.ajax({url:a("body").attr("data-portal-url")+"/acl_users/session/refresh"}).done(function(){b(),c()})},5e3)},e=-1;a("body").bind("mouseover click keydown",function(){clearTimeout(e),e=setTimeout(c,400)})}),define("castle-url/scripts/session",function(){}),window.jQuery&&define("jquery",[],function(){"use strict";return window.jQuery}),
require(["jquery","mockup-patterns-inlinevalidation","mockup-patterns-modal","mockup-patterns-querystring","mockup-patterns-recurrence","mockup-patterns-relateditems","mockup-patterns-textareamimetypeselector","mockup-patterns-tinymce","castle-url/patterns/castledynamicform","castle-url/patterns/edittile","castle-url/patterns/focalpointselect","castle-url/patterns/imagewidget","castle-url/patterns/mapselect","castle-url/patterns/previewselect","castle-url/patterns/structure","castle-url/patterns/toolbar","castle-url/patterns/upload-update","castle-url/patterns/widgets","castle-url/scripts/patches","castle-url/scripts/drafts","castle-url/scripts/session"],function(a){"use strict";a(window).width()>1040&&a(document).ready(function(){a("body").attr("data-show-tour")&&require(["castle-url/components/tour"],function(){})})}),define("/Users/brian.duncan/castle-instances/test-icons-again/castle.cms/castle/cms/static/plone-logged-in.js",function(){});
//# sourceMappingURL=plone-logged-in-compiled.min.js.map